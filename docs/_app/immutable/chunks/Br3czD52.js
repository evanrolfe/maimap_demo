const ar=JSON.parse('[{"id":338,"source_service_id":14,"source_handler_id":345,"source_output_id":1995,"source_service_name":"service-profile","dest_service_id":10,"dest_handler_id":327,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":345,"type":"http","method":"ANY","path":"/api/v1/profiles/","source_function_name":"RegisterRoutes","function_name":"profileByID","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","outputs":[],"created_at":"2026-01-30T10:32:26.010595066Z","updated_at":null},"dest_handler":{"id":327,"type":"kafka","method":"","path":"profile.deleted","source_function_name":"registerHandlerForTopic","function_name":"handleProfileDeleted","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:162:25","outputs":[],"created_at":"2026-01-30T10:30:35.122264959Z","updated_at":null}},{"id":339,"source_service_id":14,"source_handler_id":345,"source_output_id":1991,"source_service_name":"service-profile","dest_service_id":10,"dest_handler_id":326,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":345,"type":"http","method":"ANY","path":"/api/v1/profiles/","source_function_name":"RegisterRoutes","function_name":"profileByID","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","outputs":[],"created_at":"2026-01-30T10:32:26.010595066Z","updated_at":null},"dest_handler":{"id":326,"type":"kafka","method":"","path":"profile.updated","source_function_name":"registerHandlerForTopic","function_name":"handleProfileUpdated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:148:25","outputs":[],"created_at":"2026-01-30T10:30:35.120361367Z","updated_at":null}},{"id":340,"source_service_id":14,"source_handler_id":345,"source_output_id":1984,"source_service_name":"service-profile","dest_service_id":12,"dest_handler_id":271,"dest_service_name":"service-media","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":345,"type":"http","method":"ANY","path":"/api/v1/profiles/","source_function_name":"RegisterRoutes","function_name":"profileByID","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","outputs":[],"created_at":"2026-01-30T10:32:26.010595066Z","updated_at":null},"dest_handler":{"id":271,"type":"http","method":"GET","path":"/api/v1/media/profile/","source_function_name":"RegisterRoutes","function_name":"handleMediaByProfile","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","outputs":[],"created_at":"2026-01-30T10:25:14.954628012Z","updated_at":null}},{"id":341,"source_service_id":14,"source_handler_id":342,"source_output_id":1978,"source_service_name":"service-profile","dest_service_id":10,"dest_handler_id":325,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":342,"type":"http","method":"ANY","path":"/api/v1/profiles","source_function_name":"RegisterRoutes","function_name":"profiles","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","outputs":[],"created_at":"2026-01-30T10:32:26.004444544Z","updated_at":null},"dest_handler":{"id":325,"type":"kafka","method":"","path":"profile.created","source_function_name":"registerHandlerForTopic","function_name":"handleProfileCreated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:134:25","outputs":[],"created_at":"2026-01-30T10:30:35.119324598Z","updated_at":null}},{"id":342,"source_service_id":13,"source_handler_id":340,"source_output_id":1907,"source_service_name":"service-notification","dest_service_id":15,"dest_handler_id":291,"dest_service_name":"service-user","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":340,"type":"kafka","method":"","path":"match.created","source_function_name":"NewMatchConsumer","function_name":"handleMatchCreated","source_function_id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:24:6","function_id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","outputs":[],"created_at":"2026-01-30T10:32:15.269337851Z","updated_at":null},"dest_handler":{"id":291,"type":"http","method":"GET","path":"/api/v1/users/","source_function_name":"RegisterRoutes","function_name":"userByID","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","outputs":[],"created_at":"2026-01-30T10:25:26.075007333Z","updated_at":null}},{"id":343,"source_service_id":13,"source_handler_id":340,"source_output_id":1908,"source_service_name":"service-notification","dest_service_id":15,"dest_handler_id":291,"dest_service_name":"service-user","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":340,"type":"kafka","method":"","path":"match.created","source_function_name":"NewMatchConsumer","function_name":"handleMatchCreated","source_function_id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:24:6","function_id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","outputs":[],"created_at":"2026-01-30T10:32:15.269337851Z","updated_at":null},"dest_handler":{"id":291,"type":"http","method":"GET","path":"/api/v1/users/","source_function_name":"RegisterRoutes","function_name":"userByID","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","outputs":[],"created_at":"2026-01-30T10:25:26.075007333Z","updated_at":null}},{"id":344,"source_service_id":9,"source_handler_id":316,"source_output_id":1733,"source_service_name":"service-gateway","dest_service_id":10,"dest_handler_id":318,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":316,"type":"http","method":"ANY","path":"/api/v1/analytics","source_function_name":"routeAPI","function_name":"proxyToService","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19","outputs":[],"created_at":"2026-01-30T10:25:47.99214106Z","updated_at":null},"dest_handler":{"id":318,"type":"http","method":"GET","path":"/api/v1/analytics/stats","source_function_name":"RegisterRoutes","function_name":"getOverallStats","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","outputs":[],"created_at":"2026-01-30T10:30:35.10774496Z","updated_at":null}},{"id":345,"source_service_id":9,"source_handler_id":315,"source_output_id":1770,"source_service_name":"service-gateway","dest_service_id":12,"dest_handler_id":265,"dest_service_name":"service-media","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":315,"type":"http","method":"ANY","path":"/api/v1/media","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[],"created_at":"2026-01-30T10:25:47.990716684Z","updated_at":null},"dest_handler":{"id":265,"type":"http","method":"POST","path":"/api/v1/media","source_function_name":"RegisterRoutes","function_name":"handleMedia","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","outputs":[],"created_at":"2026-01-30T10:25:14.94197405Z","updated_at":null}},{"id":346,"source_service_id":9,"source_handler_id":314,"source_output_id":1813,"source_service_name":"service-gateway","dest_service_id":12,"dest_handler_id":267,"dest_service_name":"service-media","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":314,"type":"http","method":"GET","path":"/api/v1/media","source_function_name":"routeAPI","function_name":"proxyToService","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19","outputs":[],"created_at":"2026-01-30T10:25:47.987642365Z","updated_at":null},"dest_handler":{"id":267,"type":"http","method":"GET","path":"/api/v1/media/","source_function_name":"RegisterRoutes","function_name":"handleMediaByID","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","outputs":[],"created_at":"2026-01-30T10:25:14.948553933Z","updated_at":null}},{"id":347,"source_service_id":9,"source_handler_id":313,"source_output_id":1818,"source_service_name":"service-gateway","dest_service_id":13,"dest_handler_id":334,"dest_service_name":"service-notification","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":313,"type":"http","method":"ANY","path":"/api/v1/notifications","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[],"created_at":"2026-01-30T10:25:47.97975642Z","updated_at":null},"dest_handler":{"id":334,"type":"http","method":"ANY","path":"/api/v1/notifications","source_function_name":"RegisterRoutes","function_name":"handleNotifications","source_function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","outputs":[],"created_at":"2026-01-30T10:32:15.257178547Z","updated_at":null}},{"id":348,"source_service_id":9,"source_handler_id":312,"source_output_id":1840,"source_service_name":"service-gateway","dest_service_id":11,"dest_handler_id":225,"dest_service_name":"service-matching","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":312,"type":"http","method":"ANY","path":"/api/v1/matches","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[],"created_at":"2026-01-30T10:25:47.978540276Z","updated_at":null},"dest_handler":{"id":225,"type":"http","method":"GET","path":"/api/v1/matches","source_function_name":"RegisterRoutes","function_name":"handleMatches","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","outputs":[],"created_at":"2026-01-30T08:56:32.865285607Z","updated_at":null}},{"id":349,"source_service_id":9,"source_handler_id":311,"source_output_id":1804,"source_service_name":"service-gateway","dest_service_id":11,"dest_handler_id":223,"dest_service_name":"service-matching","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":311,"type":"http","method":"ANY","path":"/api/v1/swipes","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[],"created_at":"2026-01-30T10:25:47.977173379Z","updated_at":null},"dest_handler":{"id":223,"type":"http","method":"POST","path":"/api/v1/swipe","source_function_name":"RegisterRoutes","function_name":"Swipe","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","outputs":[],"created_at":"2026-01-30T08:56:32.862487013Z","updated_at":null}},{"id":350,"source_service_id":9,"source_handler_id":310,"source_output_id":1848,"source_service_name":"service-gateway","dest_service_id":14,"dest_handler_id":343,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":310,"type":"http","method":"ANY","path":"/api/v1/profiles/me","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[],"created_at":"2026-01-30T10:25:47.975572644Z","updated_at":null},"dest_handler":{"id":343,"type":"http","method":"ANY","path":"/api/v1/profiles/me","source_function_name":"RegisterRoutes","function_name":"myProfiles","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","outputs":[],"created_at":"2026-01-30T10:32:26.006624071Z","updated_at":null}},{"id":351,"source_service_id":9,"source_handler_id":309,"source_output_id":1809,"source_service_name":"service-gateway","dest_service_id":14,"dest_handler_id":342,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":309,"type":"http","method":"ANY","path":"/api/v1/profiles","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[],"created_at":"2026-01-30T10:25:47.974092421Z","updated_at":null},"dest_handler":{"id":342,"type":"http","method":"ANY","path":"/api/v1/profiles","source_function_name":"RegisterRoutes","function_name":"profiles","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","outputs":[],"created_at":"2026-01-30T10:32:26.004444544Z","updated_at":null}},{"id":352,"source_service_id":9,"source_handler_id":308,"source_output_id":1772,"source_service_name":"service-gateway","dest_service_id":14,"dest_handler_id":342,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":308,"type":"http","method":"GET","path":"/api/v1/profiles","source_function_name":"routeAPI","function_name":"proxyToService","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19","outputs":[],"created_at":"2026-01-30T10:25:47.972399931Z","updated_at":null},"dest_handler":{"id":342,"type":"http","method":"ANY","path":"/api/v1/profiles","source_function_name":"RegisterRoutes","function_name":"profiles","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","outputs":[],"created_at":"2026-01-30T10:32:26.004444544Z","updated_at":null}},{"id":353,"source_service_id":9,"source_handler_id":307,"source_output_id":1859,"source_service_name":"service-gateway","dest_service_id":15,"dest_handler_id":291,"dest_service_name":"service-user","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":307,"type":"http","method":"ANY","path":"/api/v1/users","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[],"created_at":"2026-01-30T10:25:47.970928085Z","updated_at":null},"dest_handler":{"id":291,"type":"http","method":"GET","path":"/api/v1/users/","source_function_name":"RegisterRoutes","function_name":"userByID","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","outputs":[],"created_at":"2026-01-30T10:25:26.075007333Z","updated_at":null}},{"id":354,"source_service_id":9,"source_handler_id":306,"source_output_id":1843,"source_service_name":"service-gateway","dest_service_id":15,"dest_handler_id":287,"dest_service_name":"service-user","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":306,"type":"http","method":"ANY","path":"/api/v1/auth","source_function_name":"routeAPI","function_name":"proxyToService","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19","outputs":[],"created_at":"2026-01-30T10:25:47.969361926Z","updated_at":null},"dest_handler":{"id":287,"type":"http","method":"POST","path":"/api/v1/auth/login","source_function_name":"RegisterRoutes","function_name":"login","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","outputs":[],"created_at":"2026-01-30T10:25:26.069852388Z","updated_at":null}},{"id":355,"source_service_id":9,"source_handler_id":305,"source_output_id":1860,"source_service_name":"service-gateway","dest_service_id":14,"dest_handler_id":342,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":305,"type":"http","method":"ANY","path":"/api/v1/","source_function_name":"RegisterRoutes","function_name":"routeAPI","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","outputs":[],"created_at":"2026-01-30T10:25:47.967563685Z","updated_at":null},"dest_handler":{"id":342,"type":"http","method":"ANY","path":"/api/v1/profiles","source_function_name":"RegisterRoutes","function_name":"profiles","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","outputs":[],"created_at":"2026-01-30T10:32:26.004444544Z","updated_at":null}},{"id":356,"source_service_id":9,"source_handler_id":304,"source_output_id":1659,"source_service_name":"service-gateway","dest_service_id":14,"dest_handler_id":341,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":304,"type":"http","method":"ANY","path":"/health/services","source_function_name":"RegisterRoutes","function_name":"HealthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","outputs":[],"created_at":"2026-01-30T10:25:47.964456759Z","updated_at":null},"dest_handler":{"id":341,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:39:19","outputs":[],"created_at":"2026-01-30T10:32:25.990264495Z","updated_at":null}},{"id":357,"source_service_id":9,"source_handler_id":304,"source_output_id":1659,"source_service_name":"service-gateway","dest_service_id":13,"dest_handler_id":333,"dest_service_name":"service-notification","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":304,"type":"http","method":"ANY","path":"/health/services","source_function_name":"RegisterRoutes","function_name":"HealthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","outputs":[],"created_at":"2026-01-30T10:25:47.964456759Z","updated_at":null},"dest_handler":{"id":333,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"Health","source_function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:39:19","outputs":[],"created_at":"2026-01-30T10:32:15.243826413Z","updated_at":null}},{"id":358,"source_service_id":9,"source_handler_id":304,"source_output_id":1659,"source_service_name":"service-gateway","dest_service_id":10,"dest_handler_id":317,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":304,"type":"http","method":"ANY","path":"/health/services","source_function_name":"RegisterRoutes","function_name":"HealthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","outputs":[],"created_at":"2026-01-30T10:25:47.964456759Z","updated_at":null},"dest_handler":{"id":317,"type":"http","method":"GET","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:40:19","outputs":[],"created_at":"2026-01-30T10:30:35.094717115Z","updated_at":null}},{"id":359,"source_service_id":9,"source_handler_id":304,"source_output_id":1659,"source_service_name":"service-gateway","dest_service_id":9,"dest_handler_id":303,"dest_service_name":"service-gateway","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":304,"type":"http","method":"ANY","path":"/health/services","source_function_name":"RegisterRoutes","function_name":"HealthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","outputs":[],"created_at":"2026-01-30T10:25:47.964456759Z","updated_at":null},"dest_handler":{"id":303,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:35:19","outputs":[],"created_at":"2026-01-30T10:25:47.951578048Z","updated_at":null}},{"id":360,"source_service_id":9,"source_handler_id":304,"source_output_id":1659,"source_service_name":"service-gateway","dest_service_id":15,"dest_handler_id":285,"dest_service_name":"service-user","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":304,"type":"http","method":"ANY","path":"/health/services","source_function_name":"RegisterRoutes","function_name":"HealthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","outputs":[],"created_at":"2026-01-30T10:25:47.964456759Z","updated_at":null},"dest_handler":{"id":285,"type":"http","method":"GET","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:40:19","outputs":[],"created_at":"2026-01-30T10:25:26.052036314Z","updated_at":null}},{"id":361,"source_service_id":9,"source_handler_id":304,"source_output_id":1659,"source_service_name":"service-gateway","dest_service_id":12,"dest_handler_id":263,"dest_service_name":"service-media","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":304,"type":"http","method":"ANY","path":"/health/services","source_function_name":"RegisterRoutes","function_name":"HealthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","outputs":[],"created_at":"2026-01-30T10:25:47.964456759Z","updated_at":null},"dest_handler":{"id":263,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:38:19","outputs":[],"created_at":"2026-01-30T10:25:14.928088789Z","updated_at":null}},{"id":366,"source_service_id":9,"source_handler_id":304,"source_output_id":1659,"source_service_name":"service-gateway","dest_service_id":17,"dest_handler_id":233,"dest_service_name":"service-subscription","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":304,"type":"http","method":"ANY","path":"/health/services","source_function_name":"RegisterRoutes","function_name":"HealthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","outputs":[],"created_at":"2026-01-30T10:25:47.964456759Z","updated_at":null},"dest_handler":{"id":233,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:40:19","outputs":[],"created_at":"2026-01-30T09:39:41.810061505Z","updated_at":null}},{"id":367,"source_service_id":9,"source_handler_id":304,"source_output_id":1659,"source_service_name":"service-gateway","dest_service_id":11,"dest_handler_id":222,"dest_service_name":"service-matching","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":304,"type":"http","method":"ANY","path":"/health/services","source_function_name":"RegisterRoutes","function_name":"HealthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","outputs":[],"created_at":"2026-01-30T10:25:47.964456759Z","updated_at":null},"dest_handler":{"id":222,"type":"http","method":"GET","path":"/health","source_function_name":"RegisterRoutes","function_name":"Health","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","outputs":[],"created_at":"2026-01-30T08:56:32.859541007Z","updated_at":null}},{"id":368,"source_service_id":15,"source_handler_id":290,"source_output_id":1788,"source_service_name":"service-user","dest_service_id":10,"dest_handler_id":324,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":290,"type":"http","method":"PUT","path":"/api/v1/users/me","source_function_name":"RegisterRoutes","function_name":"me","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","outputs":[],"created_at":"2026-01-30T10:25:26.074174223Z","updated_at":null},"dest_handler":{"id":324,"type":"kafka","method":"","path":"user.updated","source_function_name":"registerHandlerForTopic","function_name":"handleUserUpdated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:120:25","outputs":[],"created_at":"2026-01-30T10:30:35.118188238Z","updated_at":null}},{"id":369,"source_service_id":15,"source_handler_id":289,"source_output_id":1686,"source_service_name":"service-user","dest_service_id":10,"dest_handler_id":324,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":289,"type":"http","method":"GET","path":"/api/v1/users/me","source_function_name":"RegisterRoutes","function_name":"me","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","outputs":[],"created_at":"2026-01-30T10:25:26.073007805Z","updated_at":null},"dest_handler":{"id":324,"type":"kafka","method":"","path":"user.updated","source_function_name":"registerHandlerForTopic","function_name":"handleUserUpdated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:120:25","outputs":[],"created_at":"2026-01-30T10:30:35.118188238Z","updated_at":null}},{"id":370,"source_service_id":15,"source_handler_id":286,"source_output_id":1694,"source_service_name":"service-user","dest_service_id":10,"dest_handler_id":323,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":286,"type":"http","method":"POST","path":"/api/v1/auth/signup","source_function_name":"RegisterRoutes","function_name":"signup","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","outputs":[],"created_at":"2026-01-30T10:25:26.066537619Z","updated_at":null},"dest_handler":{"id":323,"type":"kafka","method":"","path":"user.created","source_function_name":"registerHandlerForTopic","function_name":"handleUserCreated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:106:25","outputs":[],"created_at":"2026-01-30T10:30:35.116802085Z","updated_at":null}},{"id":371,"source_service_id":15,"source_handler_id":286,"source_output_id":1694,"source_service_name":"service-user","dest_service_id":14,"dest_handler_id":346,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":286,"type":"http","method":"POST","path":"/api/v1/auth/signup","source_function_name":"RegisterRoutes","function_name":"signup","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","outputs":[],"created_at":"2026-01-30T10:25:26.066537619Z","updated_at":null},"dest_handler":{"id":346,"type":"kafka","method":"","path":"user.created","source_function_name":"NewUserEventConsumer","function_name":"handleUserCreated","source_function_id":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:28:6","function_id":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:51:29","outputs":[],"created_at":"2026-01-30T10:32:26.012300933Z","updated_at":null}},{"id":372,"source_service_id":12,"source_handler_id":273,"source_output_id":1825,"source_service_name":"service-media","dest_service_id":14,"dest_handler_id":345,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":273,"type":"http","method":"POST","path":"/api/v1/media/primary/","source_function_name":"RegisterRoutes","function_name":"handlePrimary","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","outputs":[],"created_at":"2026-01-30T10:25:14.95758343Z","updated_at":null},"dest_handler":{"id":345,"type":"http","method":"ANY","path":"/api/v1/profiles/","source_function_name":"RegisterRoutes","function_name":"profileByID","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","outputs":[],"created_at":"2026-01-30T10:32:26.010595066Z","updated_at":null}},{"id":373,"source_service_id":12,"source_handler_id":269,"source_output_id":1798,"source_service_name":"service-media","dest_service_id":10,"dest_handler_id":332,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":269,"type":"http","method":"DELETE","path":"/api/v1/media/","source_function_name":"RegisterRoutes","function_name":"handleMediaByID","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","outputs":[],"created_at":"2026-01-30T10:25:14.951515389Z","updated_at":null},"dest_handler":{"id":332,"type":"kafka","method":"","path":"media.deleted","source_function_name":"registerHandlerForTopic","function_name":"handleMediaDeleted","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:232:25","outputs":[],"created_at":"2026-01-30T10:30:35.128357057Z","updated_at":null}},{"id":374,"source_service_id":12,"source_handler_id":269,"source_output_id":1791,"source_service_name":"service-media","dest_service_id":14,"dest_handler_id":345,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":269,"type":"http","method":"DELETE","path":"/api/v1/media/","source_function_name":"RegisterRoutes","function_name":"handleMediaByID","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","outputs":[],"created_at":"2026-01-30T10:25:14.951515389Z","updated_at":null},"dest_handler":{"id":345,"type":"http","method":"ANY","path":"/api/v1/profiles/","source_function_name":"RegisterRoutes","function_name":"profileByID","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","outputs":[],"created_at":"2026-01-30T10:32:26.010595066Z","updated_at":null}},{"id":375,"source_service_id":12,"source_handler_id":265,"source_output_id":1762,"source_service_name":"service-media","dest_service_id":10,"dest_handler_id":331,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":265,"type":"http","method":"POST","path":"/api/v1/media","source_function_name":"RegisterRoutes","function_name":"handleMedia","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","outputs":[],"created_at":"2026-01-30T10:25:14.94197405Z","updated_at":null},"dest_handler":{"id":331,"type":"kafka","method":"","path":"media.uploaded","source_function_name":"registerHandlerForTopic","function_name":"handleMediaUploaded","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:218:25","outputs":[],"created_at":"2026-01-30T10:30:35.12698178Z","updated_at":null}},{"id":376,"source_service_id":12,"source_handler_id":265,"source_output_id":1755,"source_service_name":"service-media","dest_service_id":14,"dest_handler_id":345,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":265,"type":"http","method":"POST","path":"/api/v1/media","source_function_name":"RegisterRoutes","function_name":"handleMedia","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","outputs":[],"created_at":"2026-01-30T10:25:14.94197405Z","updated_at":null},"dest_handler":{"id":345,"type":"http","method":"ANY","path":"/api/v1/profiles/","source_function_name":"RegisterRoutes","function_name":"profileByID","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","outputs":[],"created_at":"2026-01-30T10:32:26.010595066Z","updated_at":null}},{"id":377,"source_service_id":12,"source_handler_id":265,"source_output_id":1754,"source_service_name":"service-media","dest_service_id":15,"dest_handler_id":291,"dest_service_name":"service-user","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":265,"type":"http","method":"POST","path":"/api/v1/media","source_function_name":"RegisterRoutes","function_name":"handleMedia","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","outputs":[],"created_at":"2026-01-30T10:25:14.94197405Z","updated_at":null},"dest_handler":{"id":291,"type":"http","method":"GET","path":"/api/v1/users/","source_function_name":"RegisterRoutes","function_name":"userByID","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","outputs":[],"created_at":"2026-01-30T10:25:26.075007333Z","updated_at":null}},{"id":378,"source_service_id":18,"source_handler_id":245,"source_output_id":1461,"source_service_name":"service-payment-gateway","dest_service_id":21,"dest_handler_id":257,"dest_service_name":"service-payment-worldpay","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":245,"type":"http","method":"GET","path":"/api/v1/providers/health","source_function_name":"RegisterRoutes","function_name":"providerHealth","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","outputs":[],"created_at":"2026-01-30T09:41:57.986220767Z","updated_at":null},"dest_handler":{"id":257,"type":"http","method":"GET","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:40:19","outputs":[],"created_at":"2026-01-30T09:46:47.501074058Z","updated_at":null}},{"id":379,"source_service_id":18,"source_handler_id":245,"source_output_id":1461,"source_service_name":"service-payment-gateway","dest_service_id":20,"dest_handler_id":252,"dest_service_name":"service-payment-stripe","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":245,"type":"http","method":"GET","path":"/api/v1/providers/health","source_function_name":"RegisterRoutes","function_name":"providerHealth","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","outputs":[],"created_at":"2026-01-30T09:41:57.986220767Z","updated_at":null},"dest_handler":{"id":252,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:37:19","outputs":[],"created_at":"2026-01-30T09:46:08.809635226Z","updated_at":null}},{"id":380,"source_service_id":18,"source_handler_id":245,"source_output_id":1461,"source_service_name":"service-payment-gateway","dest_service_id":19,"dest_handler_id":246,"dest_service_name":"service-payment-braintree","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":245,"type":"http","method":"GET","path":"/api/v1/providers/health","source_function_name":"RegisterRoutes","function_name":"providerHealth","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","outputs":[],"created_at":"2026-01-30T09:41:57.986220767Z","updated_at":null},"dest_handler":{"id":246,"type":"http","method":"GET","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:40:19","outputs":[],"created_at":"2026-01-30T09:45:33.60565764Z","updated_at":null}},{"id":381,"source_service_id":18,"source_handler_id":243,"source_output_id":1491,"source_service_name":"service-payment-gateway","dest_service_id":21,"dest_handler_id":260,"dest_service_name":"service-payment-worldpay","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":243,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.982535504Z","updated_at":null},"dest_handler":{"id":260,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","outputs":[],"created_at":"2026-01-30T09:46:47.505481316Z","updated_at":null}},{"id":382,"source_service_id":18,"source_handler_id":243,"source_output_id":1491,"source_service_name":"service-payment-gateway","dest_service_id":20,"dest_handler_id":255,"dest_service_name":"service-payment-stripe","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":243,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.982535504Z","updated_at":null},"dest_handler":{"id":255,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","outputs":[],"created_at":"2026-01-30T09:46:08.826425126Z","updated_at":null}},{"id":383,"source_service_id":18,"source_handler_id":243,"source_output_id":1491,"source_service_name":"service-payment-gateway","dest_service_id":19,"dest_handler_id":249,"dest_service_name":"service-payment-braintree","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":243,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.982535504Z","updated_at":null},"dest_handler":{"id":249,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","outputs":[],"created_at":"2026-01-30T09:45:33.623149774Z","updated_at":null}},{"id":384,"source_service_id":18,"source_handler_id":243,"source_output_id":1493,"source_service_name":"service-payment-gateway","dest_service_id":21,"dest_handler_id":261,"dest_service_name":"service-payment-worldpay","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":243,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.982535504Z","updated_at":null},"dest_handler":{"id":261,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","outputs":[],"created_at":"2026-01-30T09:46:47.506292621Z","updated_at":null}},{"id":385,"source_service_id":18,"source_handler_id":243,"source_output_id":1493,"source_service_name":"service-payment-gateway","dest_service_id":20,"dest_handler_id":256,"dest_service_name":"service-payment-stripe","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":243,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.982535504Z","updated_at":null},"dest_handler":{"id":256,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","outputs":[],"created_at":"2026-01-30T09:46:08.828192422Z","updated_at":null}},{"id":386,"source_service_id":18,"source_handler_id":243,"source_output_id":1493,"source_service_name":"service-payment-gateway","dest_service_id":19,"dest_handler_id":250,"dest_service_name":"service-payment-braintree","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":243,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.982535504Z","updated_at":null},"dest_handler":{"id":250,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","outputs":[],"created_at":"2026-01-30T09:45:33.624264962Z","updated_at":null}},{"id":387,"source_service_id":18,"source_handler_id":242,"source_output_id":1483,"source_service_name":"service-payment-gateway","dest_service_id":21,"dest_handler_id":260,"dest_service_name":"service-payment-worldpay","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":242,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.980427924Z","updated_at":null},"dest_handler":{"id":260,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","outputs":[],"created_at":"2026-01-30T09:46:47.505481316Z","updated_at":null}},{"id":388,"source_service_id":18,"source_handler_id":242,"source_output_id":1483,"source_service_name":"service-payment-gateway","dest_service_id":20,"dest_handler_id":255,"dest_service_name":"service-payment-stripe","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":242,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.980427924Z","updated_at":null},"dest_handler":{"id":255,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","outputs":[],"created_at":"2026-01-30T09:46:08.826425126Z","updated_at":null}},{"id":389,"source_service_id":18,"source_handler_id":242,"source_output_id":1483,"source_service_name":"service-payment-gateway","dest_service_id":19,"dest_handler_id":249,"dest_service_name":"service-payment-braintree","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":242,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.980427924Z","updated_at":null},"dest_handler":{"id":249,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","outputs":[],"created_at":"2026-01-30T09:45:33.623149774Z","updated_at":null}},{"id":390,"source_service_id":18,"source_handler_id":242,"source_output_id":1485,"source_service_name":"service-payment-gateway","dest_service_id":21,"dest_handler_id":261,"dest_service_name":"service-payment-worldpay","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":242,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.980427924Z","updated_at":null},"dest_handler":{"id":261,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","outputs":[],"created_at":"2026-01-30T09:46:47.506292621Z","updated_at":null}},{"id":391,"source_service_id":18,"source_handler_id":242,"source_output_id":1485,"source_service_name":"service-payment-gateway","dest_service_id":20,"dest_handler_id":256,"dest_service_name":"service-payment-stripe","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":242,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.980427924Z","updated_at":null},"dest_handler":{"id":256,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","outputs":[],"created_at":"2026-01-30T09:46:08.828192422Z","updated_at":null}},{"id":392,"source_service_id":18,"source_handler_id":242,"source_output_id":1485,"source_service_name":"service-payment-gateway","dest_service_id":19,"dest_handler_id":250,"dest_service_name":"service-payment-braintree","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":242,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[],"created_at":"2026-01-30T09:41:57.980427924Z","updated_at":null},"dest_handler":{"id":250,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","outputs":[],"created_at":"2026-01-30T09:45:33.624264962Z","updated_at":null}},{"id":393,"source_service_id":18,"source_handler_id":241,"source_output_id":1472,"source_service_name":"service-payment-gateway","dest_service_id":21,"dest_handler_id":259,"dest_service_name":"service-payment-worldpay","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":241,"type":"http","method":"POST","path":"/api/v1/payments/refund","source_function_name":"RegisterRoutes","function_name":"refund","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","outputs":[],"created_at":"2026-01-30T09:41:57.978396785Z","updated_at":null},"dest_handler":{"id":259,"type":"http","method":"POST","path":"/api/v1/refund","source_function_name":"RegisterRoutes","function_name":"refund","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","outputs":[],"created_at":"2026-01-30T09:46:47.504572371Z","updated_at":null}},{"id":394,"source_service_id":18,"source_handler_id":241,"source_output_id":1472,"source_service_name":"service-payment-gateway","dest_service_id":20,"dest_handler_id":254,"dest_service_name":"service-payment-stripe","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":241,"type":"http","method":"POST","path":"/api/v1/payments/refund","source_function_name":"RegisterRoutes","function_name":"refund","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","outputs":[],"created_at":"2026-01-30T09:41:57.978396785Z","updated_at":null},"dest_handler":{"id":254,"type":"http","method":"POST","path":"/api/v1/refund","source_function_name":"RegisterRoutes","function_name":"refund","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19","outputs":[],"created_at":"2026-01-30T09:46:08.824562041Z","updated_at":null}},{"id":395,"source_service_id":18,"source_handler_id":241,"source_output_id":1472,"source_service_name":"service-payment-gateway","dest_service_id":19,"dest_handler_id":248,"dest_service_name":"service-payment-braintree","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":241,"type":"http","method":"POST","path":"/api/v1/payments/refund","source_function_name":"RegisterRoutes","function_name":"refund","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","outputs":[],"created_at":"2026-01-30T09:41:57.978396785Z","updated_at":null},"dest_handler":{"id":248,"type":"http","method":"POST","path":"/api/v1/refund","source_function_name":"RegisterRoutes","function_name":"refund","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","outputs":[],"created_at":"2026-01-30T09:45:33.62163603Z","updated_at":null}},{"id":396,"source_service_id":18,"source_handler_id":240,"source_output_id":1477,"source_service_name":"service-payment-gateway","dest_service_id":21,"dest_handler_id":258,"dest_service_name":"service-payment-worldpay","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":240,"type":"http","method":"POST","path":"/api/v1/payments/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","outputs":[],"created_at":"2026-01-30T09:41:57.9757475Z","updated_at":null},"dest_handler":{"id":258,"type":"http","method":"POST","path":"/api/v1/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","outputs":[],"created_at":"2026-01-30T09:46:47.503507463Z","updated_at":null}},{"id":397,"source_service_id":18,"source_handler_id":240,"source_output_id":1477,"source_service_name":"service-payment-gateway","dest_service_id":20,"dest_handler_id":253,"dest_service_name":"service-payment-stripe","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":240,"type":"http","method":"POST","path":"/api/v1/payments/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","outputs":[],"created_at":"2026-01-30T09:41:57.9757475Z","updated_at":null},"dest_handler":{"id":253,"type":"http","method":"POST","path":"/api/v1/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19","outputs":[],"created_at":"2026-01-30T09:46:08.822976773Z","updated_at":null}},{"id":398,"source_service_id":18,"source_handler_id":240,"source_output_id":1477,"source_service_name":"service-payment-gateway","dest_service_id":19,"dest_handler_id":247,"dest_service_name":"service-payment-braintree","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":240,"type":"http","method":"POST","path":"/api/v1/payments/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","outputs":[],"created_at":"2026-01-30T09:41:57.9757475Z","updated_at":null},"dest_handler":{"id":247,"type":"http","method":"POST","path":"/api/v1/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","outputs":[],"created_at":"2026-01-30T09:45:33.617907737Z","updated_at":null}},{"id":399,"source_service_id":17,"source_handler_id":237,"source_output_id":1447,"source_service_name":"service-subscription","dest_service_id":18,"dest_handler_id":240,"dest_service_name":"service-payment-gateway","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":237,"type":"http","method":"GET,PUT,POST","path":"/api/v1/subscriptions/","source_function_name":"RegisterRoutes","function_name":"handleSubscriptionByID","source_function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","outputs":[],"created_at":"2026-01-30T09:39:41.833169727Z","updated_at":null},"dest_handler":{"id":240,"type":"http","method":"POST","path":"/api/v1/payments/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","outputs":[],"created_at":"2026-01-30T09:41:57.9757475Z","updated_at":null}},{"id":400,"source_service_id":11,"source_handler_id":226,"source_output_id":1355,"source_service_name":"service-matching","dest_service_id":10,"dest_handler_id":330,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":226,"type":"http","method":"DELETE","path":"/api/v1/matches/","source_function_name":"RegisterRoutes","function_name":"handleMatchByID","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","outputs":[],"created_at":"2026-01-30T08:56:32.866578142Z","updated_at":null},"dest_handler":{"id":330,"type":"kafka","method":"","path":"match.deleted","source_function_name":"registerHandlerForTopic","function_name":"handleMatchDeleted","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:204:25","outputs":[],"created_at":"2026-01-30T10:30:35.125549071Z","updated_at":null}},{"id":401,"source_service_id":11,"source_handler_id":225,"source_output_id":1340,"source_service_name":"service-matching","dest_service_id":14,"dest_handler_id":345,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":225,"type":"http","method":"GET","path":"/api/v1/matches","source_function_name":"RegisterRoutes","function_name":"handleMatches","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","outputs":[],"created_at":"2026-01-30T08:56:32.865285607Z","updated_at":null},"dest_handler":{"id":345,"type":"http","method":"ANY","path":"/api/v1/profiles/","source_function_name":"RegisterRoutes","function_name":"profileByID","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","outputs":[],"created_at":"2026-01-30T10:32:26.010595066Z","updated_at":null}},{"id":402,"source_service_id":11,"source_handler_id":224,"source_output_id":1337,"source_service_name":"service-matching","dest_service_id":14,"dest_handler_id":342,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":224,"type":"http","method":"GET","path":"/api/v1/swipe/queue","source_function_name":"RegisterRoutes","function_name":"GetSwipeQueue","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","outputs":[],"created_at":"2026-01-30T08:56:32.864076997Z","updated_at":null},"dest_handler":{"id":342,"type":"http","method":"ANY","path":"/api/v1/profiles","source_function_name":"RegisterRoutes","function_name":"profiles","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","outputs":[],"created_at":"2026-01-30T10:32:26.004444544Z","updated_at":null}},{"id":403,"source_service_id":11,"source_handler_id":223,"source_output_id":1376,"source_service_name":"service-matching","dest_service_id":10,"dest_handler_id":329,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":223,"type":"http","method":"POST","path":"/api/v1/swipe","source_function_name":"RegisterRoutes","function_name":"Swipe","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","outputs":[],"created_at":"2026-01-30T08:56:32.862487013Z","updated_at":null},"dest_handler":{"id":329,"type":"kafka","method":"","path":"match.created","source_function_name":"registerHandlerForTopic","function_name":"handleMatchCreated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:190:25","outputs":[],"created_at":"2026-01-30T10:30:35.124479353Z","updated_at":null}},{"id":404,"source_service_id":11,"source_handler_id":223,"source_output_id":1377,"source_service_name":"service-matching","dest_service_id":13,"dest_handler_id":340,"dest_service_name":"service-notification","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":223,"type":"http","method":"POST","path":"/api/v1/swipe","source_function_name":"RegisterRoutes","function_name":"Swipe","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","outputs":[],"created_at":"2026-01-30T08:56:32.862487013Z","updated_at":null},"dest_handler":{"id":340,"type":"kafka","method":"","path":"match.created","source_function_name":"NewMatchConsumer","function_name":"handleMatchCreated","source_function_id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:24:6","function_id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","outputs":[],"created_at":"2026-01-30T10:32:15.269337851Z","updated_at":null}},{"id":405,"source_service_id":11,"source_handler_id":223,"source_output_id":1377,"source_service_name":"service-matching","dest_service_id":10,"dest_handler_id":328,"dest_service_name":"service-analytics","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":223,"type":"http","method":"POST","path":"/api/v1/swipe","source_function_name":"RegisterRoutes","function_name":"Swipe","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","outputs":[],"created_at":"2026-01-30T08:56:32.862487013Z","updated_at":null},"dest_handler":{"id":328,"type":"kafka","method":"","path":"swipe.created","source_function_name":"registerHandlerForTopic","function_name":"handleSwipeCreated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:176:25","outputs":[],"created_at":"2026-01-30T10:30:35.123407941Z","updated_at":null}},{"id":406,"source_service_id":11,"source_handler_id":223,"source_output_id":1374,"source_service_name":"service-matching","dest_service_id":14,"dest_handler_id":344,"dest_service_name":"service-profile","created_at":"0001-01-01T00:00:00Z","updated_at":null,"source_handler":{"id":223,"type":"http","method":"POST","path":"/api/v1/swipe","source_function_name":"RegisterRoutes","function_name":"Swipe","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","outputs":[],"created_at":"2026-01-30T08:56:32.862487013Z","updated_at":null},"dest_handler":{"id":344,"type":"http","method":"ANY","path":"/api/v1/profiles/user/","source_function_name":"RegisterRoutes","function_name":"profilesByUserID","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","outputs":[],"created_at":"2026-01-30T10:32:26.008677053Z","updated_at":null}}]'),or=Object.freeze(Object.defineProperty({__proto__:null,default:ar},Symbol.toStringTag,{value:"Module"})),sr=[{id:9,name:"service-gateway",git_repo_url:"/home/evan/Code/rinder/services/gateway",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-21T10:18:45.644263748Z",updated_at:"2026-01-21T10:18:48.633648053Z",status:"analyzing-completed",handlers:[]},{id:10,name:"service-analytics",git_repo_url:"/home/evan/Code/rinder/services/analytics",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-21T10:22:45.668404999Z",updated_at:"2026-01-21T10:22:48.62892047Z",status:"analyzing-completed",handlers:[]},{id:11,name:"service-matching",git_repo_url:"/home/evan/Code/rinder/services/matching",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-21T10:23:07.436190382Z",updated_at:"2026-01-21T10:23:09.09657659Z",status:"analyzing-completed",handlers:[]},{id:12,name:"service-media",git_repo_url:"/home/evan/Code/rinder/services/media",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-21T10:23:37.3516147Z",updated_at:"2026-01-21T10:23:38.920708626Z",status:"analyzing-completed",handlers:[]},{id:13,name:"service-notification",git_repo_url:"/home/evan/Code/rinder/services/notification",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-21T10:24:04.941535279Z",updated_at:"2026-01-21T10:24:08.646485275Z",status:"analyzing-completed",handlers:[]},{id:14,name:"service-profile",git_repo_url:"/home/evan/Code/rinder/services/profile",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-21T10:24:35.990340355Z",updated_at:"2026-01-21T10:24:38.621573077Z",status:"analyzing-completed",handlers:[]},{id:15,name:"service-user",git_repo_url:"/home/evan/Code/rinder/services/user",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-21T10:24:51.1652729Z",updated_at:"2026-01-21T10:24:53.618656084Z",status:"analyzing-completed",handlers:[]},{id:17,name:"service-subscription",git_repo_url:"/home/evan/Code/rinder/services/subscription",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-30T09:38:59.919701614Z",updated_at:"2026-01-30T09:39:02.267044298Z",status:"analyzing-completed",handlers:[]},{id:18,name:"service-payment-gateway",git_repo_url:"/home/evan/Code/rinder/services/payment-gateway",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-30T09:41:23.225010472Z",updated_at:"2026-01-30T09:41:27.264355061Z",status:"analyzing-completed",handlers:[]},{id:19,name:"service-payment-braintree",git_repo_url:"/home/evan/Code/rinder/services/payment-braintree",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-30T09:45:04.58756129Z",updated_at:"2026-01-30T09:45:07.255103453Z",status:"analyzing-completed",handlers:[]},{id:20,name:"service-payment-stripe",git_repo_url:"/home/evan/Code/rinder/services/payment-stripe",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-30T09:45:37.495275322Z",updated_at:"2026-01-30T09:45:42.262594154Z",status:"analyzing-completed",handlers:[]},{id:21,name:"service-payment-worldpay",git_repo_url:"/home/evan/Code/rinder/services/payment-worldpay",entrypoint_path:"cmd/main.go",entrypoint_function:"main",git_org_url:"github.com/rinder",git_commit:null,created_at:"2026-01-30T09:46:08.765907362Z",updated_at:"2026-01-30T09:46:12.265426095Z",status:"analyzing-completed",handlers:[]}],dr=Object.freeze(Object.defineProperty({__proto__:null,default:sr},Symbol.toStringTag,{value:"Module"})),c=10,u="service-analytics",h="/home/evan/Code/rinder/services/analytics",p="cmd/main.go",v="main",m="github.com/rinder",_=null,f="2026-01-21T10:22:45.668404999Z",g="2026-01-21T10:22:48.62892047Z",y="analyzing-completed",C=JSON.parse(`[{"id":322,"type":"http","method":"GET","path":"/api/v1/analytics/events/","source_function_name":"RegisterRoutes","function_name":"getEventsByType","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","outputs":[{"id":1890,"handler_id":322,"type":"database","label":"SELECT id, event_type, entity_id, COALESCE(user_id, ''), metadata, created_at FROM events WHERE event_type = $1 ORDER BY created_at DESC LIMIT $2","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:196:31","function_name":"GetEventsByType","description":"A SQL query is executed against the service database to retrieve up to \`limit\` analytics events matching the requested event type. Parameters passed: eventType, limit.","created_at":"2026-01-30T10:31:18.566439178Z","updated_at":null},{"id":1891,"handler_id":322,"type":"http_response","label":"HTTP 200 JSON response with events","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","function_name":"getEventsByType","description":"If events are successfully retrieved, the handler writes an HTTP 200 response to the client containing the list of analytics events (serialized, typically as JSON).","created_at":"2026-01-30T10:31:18.57958138Z","updated_at":null},{"id":1893,"handler_id":322,"type":"http_response","label":"HTTP 400 Bad Request response (event type is required)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","function_name":"getEventsByType","description":"If the event type cannot be extracted from the request path (empty), the handler returns an HTTP error response indicating a bad request (event type required).","created_at":"2026-01-30T10:31:18.583482338Z","updated_at":null},{"id":1892,"handler_id":322,"type":"http_response","label":"HTTP 400 Bad Request response (method not allowed)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","function_name":"getEventsByType","description":"If the incoming request method is not GET, the handler returns an HTTP error response indicating a bad request (the code is produced by response.Error with a BadRequest error).","created_at":"2026-01-30T10:31:18.582139436Z","updated_at":null},{"id":1894,"handler_id":322,"type":"http_response","label":"HTTP error response propagated from service/repository (e.g. 500)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","function_name":"getEventsByType","description":"If the repository or service returns an error (for example a database error while querying events), the handler writes an HTTP error response to the client with the status/code derived from the returned error.","created_at":"2026-01-30T10:31:18.584769303Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.115421983Z","updated_at":null},{"id":320,"type":"http","method":"GET","path":"/api/v1/analytics/events/counts","source_function_name":"RegisterRoutes","function_name":"getEventCounts","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","outputs":[{"id":1877,"handler_id":320,"type":"database","label":"SELECT event_type, COUNT(*) as count FROM events GROUP BY event_type ORDER BY count DESC","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:65:31","function_name":"GetEventCounts","description":"A SQL query is executed against the configured database to count events grouped by event_type, returning rows of (event_type, count).","created_at":"2026-01-30T10:31:05.195041822Z","updated_at":null},{"id":1878,"handler_id":320,"type":"http_response","label":"HTTP 200 JSON response (response.OK)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","function_name":"getEventCounts","description":"On success the handler writes an HTTP 200 response containing the list of event counts (counts serialized in the response body).","created_at":"2026-01-30T10:31:05.208172465Z","updated_at":null},{"id":1880,"handler_id":320,"type":"http_response","label":"HTTP error response: Database query failure (internal server error)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","function_name":"getEventCounts","description":"If the database query (QueryContext) fails, the repository returns an error and the handler sends an HTTP error response (internal server error) to the client.","created_at":"2026-01-30T10:31:05.213148289Z","updated_at":null},{"id":1879,"handler_id":320,"type":"http_response","label":"HTTP error response: Method not allowed (BadRequest)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","function_name":"getEventCounts","description":"If the incoming request method is not GET the handler returns an HTTP error response (bad request / method not allowed) to the client.","created_at":"2026-01-30T10:31:05.2112879Z","updated_at":null},{"id":1881,"handler_id":320,"type":"http_response","label":"HTTP error response: Row scan failure (internal server error)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","function_name":"getEventCounts","description":"If scanning rows into the event count structure fails while iterating result rows, the repository returns an error and the handler sends an HTTP error response (internal server error) to the client.","created_at":"2026-01-30T10:31:05.214748499Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.112619407Z","updated_at":null},{"id":321,"type":"http","method":"GET","path":"/api/v1/analytics/events/recent","source_function_name":"RegisterRoutes","function_name":"getRecentEvents","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","outputs":[{"id":1887,"handler_id":321,"type":"database","label":"SELECT id, event_type, entity_id, COALESCE(user_id, ''), metadata, created_at FROM events ORDER BY created_at DESC LIMIT $1","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:170:31","function_name":"GetRecentEvents","description":"The repository executes a SQL query (r.db.QueryContext) against the configured database to fetch the most recent events, using the provided limit as the query parameter.","created_at":"2026-01-30T10:31:15.446722655Z","updated_at":null},{"id":1888,"handler_id":321,"type":"http_response","label":"HTTP 200 JSON response with events (response.OK)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","function_name":"getRecentEvents","description":"When the repository successfully returns events, the handler writes an HTTP 200 response containing the serialized list of AnalyticsEvent objects returned from the database.","created_at":"2026-01-30T10:31:15.450371054Z","updated_at":null},{"id":1886,"handler_id":321,"type":"http_response","label":"HTTP error response (BadRequest) for non-GET method","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","function_name":"getRecentEvents","description":"If the incoming HTTP request method is not GET, the handler returns an HTTP error response produced by response.Error using an errors.BadRequest value (client receives an error response without any DB or downstream calls).","created_at":"2026-01-30T10:31:15.434684004Z","updated_at":null},{"id":1889,"handler_id":321,"type":"http_response","label":"HTTP error response (response.Error) on repository/service failure","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","function_name":"getRecentEvents","description":"If the repository or service returns an error (e.g. QueryContext or rows.Scan failure), the error propagates back to the handler and it writes an HTTP error response via response.Error (client receives an error response; no further external calls are made).","created_at":"2026-01-30T10:31:15.452113551Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.113978341Z","updated_at":null},{"id":318,"type":"http","method":"GET","path":"/api/v1/analytics/stats","source_function_name":"RegisterRoutes","function_name":"getOverallStats","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","outputs":[{"id":1873,"handler_id":318,"type":"database","label":"SELECT COALESCE(...) FROM events","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:137:31","function_name":"GetOverallStats","description":"A single SQL query is executed against the service database to aggregate event counts (total_users, total_profiles, total_swipes, right_swipes, total_matches, total_media). The query is executed via QueryRowContext(...).Scan(...) to read the aggregated values.","created_at":"2026-01-30T10:31:02.739210933Z","updated_at":null},{"id":1874,"handler_id":318,"type":"http_response","label":"HTTP 200 OK response with overall stats (response.OK)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","function_name":"getOverallStats","description":"If analyticsService.GetOverallStats returns successfully, an HTTP 200 response is written to the client containing the OverallStats payload (the aggregated counts and derived rates).","created_at":"2026-01-30T10:31:02.751784628Z","updated_at":null},{"id":1875,"handler_id":318,"type":"http_response","label":"HTTP 400 Bad Request response (method not allowed)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","function_name":"getOverallStats","description":"If the incoming HTTP request method is not GET, the handler returns a Bad Request error response to the client using response.Error(...).","created_at":"2026-01-30T10:31:02.754812279Z","updated_at":null},{"id":1876,"handler_id":318,"type":"http_response","label":"HTTP error response (internal server error when stats retrieval fails)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","function_name":"getOverallStats","description":"If analyticsService.GetOverallStats (backed by the repository) returns an error (for example due to a database query failure), the handler returns an HTTP error response to the client via response.Error(...). The repository wraps DB failures as internal server errors.","created_at":"2026-01-30T10:31:02.756694717Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.10774496Z","updated_at":null},{"id":319,"type":"http","method":"GET","path":"/api/v1/analytics/stats/daily","source_function_name":"RegisterRoutes","function_name":"getDailyStats","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","outputs":[{"id":1882,"handler_id":319,"type":"database","label":"SELECT (WITH daily_events ...) FROM events WHERE created_at >= $1 AND created_at < $2","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:91:31","function_name":"GetDailyStats","description":"A SQL query is executed against the events table that aggregates event counts per UTC date and event_type between the provided startDate and endDate (passed as parameters $1 and $2). The query is run via QueryContext on the repository's DB connection.","created_at":"2026-01-30T10:31:12.874495196Z","updated_at":null},{"id":1885,"handler_id":319,"type":"http_response","label":"HTTP 200 OK JSON response with daily stats","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","function_name":"getDailyStats","description":"On success the handler returns an HTTP 200 response containing the daily statistics payload (the slice of DailyStats) to the client via response.OK.","created_at":"2026-01-30T10:31:12.879347575Z","updated_at":null},{"id":1883,"handler_id":319,"type":"http_response","label":"HTTP 400 Bad Request (method not allowed)","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","function_name":"getDailyStats","description":"If the HTTP request method is not GET, the handler returns a Bad Request error response to the client (response.Error is invoked with an errors.BadRequest).","created_at":"2026-01-30T10:31:12.877179862Z","updated_at":null},{"id":1884,"handler_id":319,"type":"http_response","label":"HTTP error response (e.g. 500) returned to client when service/repository returns an error","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","function_name":"getDailyStats","description":"If analyticsService.GetDailyStats (or the repository it calls) returns an error (for example due to the DB query failing), the handler forwards that error to the client using response.Error, resulting in an HTTP error response (the specific status depends on the error).","created_at":"2026-01-30T10:31:12.878343054Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.110784969Z","updated_at":null},{"id":317,"type":"http","method":"GET","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:40:19","outputs":[{"id":1862,"handler_id":317,"type":"http_response","label":"HTTP 200 JSON response","function_id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:40:19","function_name":"healthCheck","description":"An HTTP 200 response is sent to the client with Content-Type: application/json and the JSON body {\\"success\\": true, \\"data\\": {\\"status\\":\\"healthy\\",\\"service\\":\\"analytics\\"}}.","created_at":"2026-01-30T10:30:48.783894982Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.094717115Z","updated_at":null},{"id":329,"type":"kafka","method":"","path":"match.created","source_function_name":"registerHandlerForTopic","function_name":"handleMatchCreated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:190:25","outputs":[{"id":1866,"handler_id":329,"type":"database","label":"INSERT INTO events (event_type, entity_id, user_id, metadata, created_at) RETURNING id","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","function_name":"RecordEvent","description":"An analytics event is written to the database by inserting event_type, entity_id, user_id, metadata and created_at into the events table; the new event ID is returned and scanned into the event object.","created_at":"2026-01-30T10:30:52.050587718Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.124479353Z","updated_at":null},{"id":330,"type":"kafka","method":"","path":"match.deleted","source_function_name":"registerHandlerForTopic","function_name":"handleMatchDeleted","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:204:25","outputs":[{"id":1871,"handler_id":330,"type":"database","label":"INSERT INTO events (event_type, entity_id, user_id, metadata, created_at) VALUES ($1, $2, $3, $4, $5) RETURNING id","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","function_name":"RecordEvent","description":"An analytics event is persisted to the database by executing an INSERT into the events table; the newly inserted row's id is returned and scanned into the event object (QueryRowContext + Scan).","created_at":"2026-01-30T10:30:57.924589158Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.125549071Z","updated_at":null},{"id":332,"type":"kafka","method":"","path":"media.deleted","source_function_name":"registerHandlerForTopic","function_name":"handleMediaDeleted","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:232:25","outputs":[{"id":1863,"handler_id":332,"type":"database","label":"INSERT INTO events (event_type, entity_id, user_id, metadata, created_at) VALUES ($1, $2, $3, $4, $5) RETURNING id","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","function_name":"RecordEvent","description":"An analytics event is persisted to the database: a new row is inserted into the events table with event_type, entity_id, user_id, metadata (JSON stringified payload), and created_at; the new row's id is returned and scanned into the event object.","created_at":"2026-01-30T10:30:49.518512696Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.128357057Z","updated_at":null},{"id":331,"type":"kafka","method":"","path":"media.uploaded","source_function_name":"registerHandlerForTopic","function_name":"handleMediaUploaded","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:218:25","outputs":[{"id":1872,"handler_id":331,"type":"database","label":"INSERT INTO events (event_type, entity_id, user_id, metadata, created_at) VALUES ($1, $2, $3, $4, $5) RETURNING id","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","function_name":"RecordEvent","description":"An analytics event row is inserted into the events table with columns event_type, entity_id, user_id, metadata and created_at; the new row's id is returned and scanned into the event object.","created_at":"2026-01-30T10:31:00.586747079Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.12698178Z","updated_at":null},{"id":325,"type":"kafka","method":"","path":"profile.created","source_function_name":"registerHandlerForTopic","function_name":"handleProfileCreated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:134:25","outputs":[{"id":1865,"handler_id":325,"type":"database","label":"INSERT INTO events (event_type, entity_id, user_id, metadata, created_at) VALUES ($1, $2, $3, $4, $5) RETURNING id","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","function_name":"RecordEvent","description":"An analytics event row is inserted into the events table. The database is called via QueryRowContext to execute the INSERT and return the newly created row id which is scanned into the event object.","created_at":"2026-01-30T10:30:51.882853552Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.119324598Z","updated_at":null},{"id":327,"type":"kafka","method":"","path":"profile.deleted","source_function_name":"registerHandlerForTopic","function_name":"handleProfileDeleted","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:162:25","outputs":[{"id":1867,"handler_id":327,"type":"database","label":"INSERT INTO events (event_type, entity_id, user_id, metadata, created_at) RETURNING id","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","function_name":"RecordEvent","description":"A new analytics event row is inserted into the database 'events' table with event_type, entity_id, user_id, metadata and created_at; the newly created row's id is returned and scanned into the event object.","created_at":"2026-01-30T10:30:53.716270972Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.122264959Z","updated_at":null},{"id":326,"type":"kafka","method":"","path":"profile.updated","source_function_name":"registerHandlerForTopic","function_name":"handleProfileUpdated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:148:25","outputs":[{"id":1868,"handler_id":326,"type":"database","label":"INSERT INTO events (event_type, entity_id, user_id, metadata, created_at) VALUES ($1, $2, $3, $4, $5) RETURNING id","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","function_name":"RecordEvent","description":"An analytics event record is inserted into the events table (the new row id is returned via RETURNING and scanned into the event struct). The metadata field is populated with the JSON serialization of the profile updated event.","created_at":"2026-01-30T10:30:54.647722134Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.120361367Z","updated_at":null},{"id":328,"type":"kafka","method":"","path":"swipe.created","source_function_name":"registerHandlerForTopic","function_name":"handleSwipeCreated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:176:25","outputs":[{"id":1870,"handler_id":328,"type":"database","label":"INSERT INTO events (event_type, entity_id, user_id, metadata, created_at) VALUES ($1, $2, $3, $4, $5) RETURNING id","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","function_name":"RecordEvent","description":"A new analytics event row is inserted into the events table and the generated id is returned into the event object.","created_at":"2026-01-30T10:30:56.24723022Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.123407941Z","updated_at":null},{"id":323,"type":"kafka","method":"","path":"user.created","source_function_name":"registerHandlerForTopic","function_name":"handleUserCreated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:106:25","outputs":[{"id":1869,"handler_id":323,"type":"database","label":"INSERT INTO events (event_type, entity_id, user_id, metadata, created_at) RETURNING id","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","function_name":"RecordEvent","description":"An analytics event row is inserted into the events table with event_type, entity_id, user_id, metadata, and created_at; the newly created row id is returned via QueryRowContext/Scan.","created_at":"2026-01-30T10:30:55.160060645Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.116802085Z","updated_at":null},{"id":324,"type":"kafka","method":"","path":"user.updated","source_function_name":"registerHandlerForTopic","function_name":"handleUserUpdated","source_function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","function_id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:120:25","outputs":[{"id":1864,"handler_id":324,"type":"database","label":"INSERT INTO events (event_type, entity_id, user_id, metadata, created_at) VALUES ($1, $2, $3, $4, $5) RETURNING id","function_id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","function_name":"RecordEvent","description":"An analytics event is inserted into the events table and the generated id is returned (RecordEvent executes the INSERT using QueryRowContext and Scan).","created_at":"2026-01-30T10:30:50.757254049Z","updated_at":null}],"created_at":"2026-01-30T10:30:35.118188238Z","updated_at":null}]`),lr={id:c,name:u,git_repo_url:h,entrypoint_path:p,entrypoint_function:v,git_org_url:m,git_commit:_,created_at:f,updated_at:g,status:y,handlers:C},cr=Object.freeze(Object.defineProperty({__proto__:null,created_at:f,default:lr,entrypoint_function:v,entrypoint_path:p,git_commit:_,git_org_url:m,git_repo_url:h,handlers:C,id:c,name:u,status:y,updated_at:g},Symbol.toStringTag,{value:"Module"})),T=JSON.parse(`[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"analytics\\", 8087)\\n\\tkafkaCfg := config.NewKafkaConfig(\\"analytics-service\\")\\n\\n\\t// Database configuration\\n\\tdbHost := config.GetEnv(\\"ANALYTICS_DB_HOST\\", \\"localhost\\")\\n\\tdbPort := config.GetEnvInt(\\"ANALYTICS_DB_PORT\\", 5440)\\n\\tdbUser := config.GetEnv(\\"ANALYTICS_DB_USER\\", \\"rinder\\")\\n\\tdbPassword := config.GetEnv(\\"ANALYTICS_DB_PASSWORD\\", \\"rinder123\\")\\n\\tdbName := config.GetEnv(\\"ANALYTICS_DB_NAME\\", \\"rinder_analytics\\")\\n\\tdbSSLMode := config.GetEnv(\\"ANALYTICS_DB_SSLMODE\\", \\"disable\\")\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting analytics service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t)\\n\\n\\t// Connect to PostgreSQL\\n\\tdsn := fmt.Sprintf(\\"host=%s port=%d user=%s password=%s dbname=%s sslmode=%s\\",\\n\\t\\tdbHost, dbPort, dbUser, dbPassword, dbName, dbSSLMode)\\n\\n\\tdb, err := sql.Open(\\"postgres\\", dsn)\\n\\tif err != nil {\\n\\t\\tlogger.Fatal(\\"failed to connect to postgres\\", zap.Error(err))\\n\\t}\\n\\tdefer db.Close()\\n\\n\\t// Configure connection pool\\n\\tdb.SetMaxOpenConns(25)\\n\\tdb.SetMaxIdleConns(5)\\n\\tdb.SetConnMaxLifetime(5 * time.Minute)\\n\\n\\tif err = db.Ping(); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to ping postgres\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"connected to postgres database\\")\\n\\n\\t// Initialize repositories\\n\\tanalyticsRepo := repository.NewAnalyticsRepository(db)\\n\\n\\t// Run migrations\\n\\tif err := analyticsRepo.CreateSchema(context.Background()); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to run database migrations\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"database migrations completed\\")\\n\\n\\t// Initialize services\\n\\tanalyticsService := service.NewAnalyticsService(analyticsRepo)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(analyticsService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Start Kafka consumer for all events\\n\\teventConsumer := consumer.NewEventConsumer(kafkaCfg.Brokers, analyticsService)\\n\\tconsumerCtx, consumerCancel := context.WithCancel(context.Background())\\n\\tgo eventConsumer.Start(consumerCtx)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  15 * time.Second,\\n\\t\\tWriteTimeout: 15 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"analytics service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt signal\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Stop consumer\\n\\tconsumerCancel()\\n\\n\\t// Graceful shutdown\\n\\tctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer cancel()\\n\\n\\tif err := server.Shutdown(ctx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server exited properly\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/cmd/main.go:24:1","name":"ROOT","node_type":"function"},{"code":"func NewAnalyticsRepository(db *sql.DB) *AnalyticsRepository {\\n\\treturn &AnalyticsRepository{db: db}\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:19:6","name":"NewAnalyticsRepository","node_type":"function"},{"code":"func (r *AnalyticsRepository) CreateSchema(ctx context.Context) error {\\n\\tqueries := []string{\\n\\t\\t\`CREATE TABLE IF NOT EXISTS events (\\n\\t\\t\\tid BIGSERIAL PRIMARY KEY,\\n\\t\\t\\tevent_type VARCHAR(50) NOT NULL,\\n\\t\\t\\tentity_id VARCHAR(100) NOT NULL,\\n\\t\\t\\tuser_id VARCHAR(100),\\n\\t\\t\\tmetadata JSONB DEFAULT '{}',\\n\\t\\t\\tcreated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()\\n\\t\\t)\`,\\n\\t\\t\`CREATE INDEX IF NOT EXISTS idx_events_event_type ON events (event_type)\`,\\n\\t\\t\`CREATE INDEX IF NOT EXISTS idx_events_entity_id ON events (entity_id)\`,\\n\\t\\t\`CREATE INDEX IF NOT EXISTS idx_events_user_id ON events (user_id)\`,\\n\\t\\t\`CREATE INDEX IF NOT EXISTS idx_events_created_at ON events (created_at)\`,\\n\\t}\\n\\n\\tfor _, query := range queries {\\n\\t\\tif _, err := r.db.ExecContext(ctx, query); err != nil {\\n\\t\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to create analytics schema\\", 500)\\n\\t\\t}\\n\\t}\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:24:31","name":"CreateSchema","node_type":"function"},{"code":"func NewAnalyticsService(repo *repository.AnalyticsRepository) *AnalyticsService {\\n\\treturn &AnalyticsService{repo: repo}\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:19:6","name":"NewAnalyticsService","node_type":"function"},{"code":"func NewHandler(analyticsService *service.AnalyticsService) *Handler {\\n\\treturn &Handler{\\n\\t\\tanalyticsService: analyticsService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:21:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\t// Health check\\n\\tmux.HandleFunc(\\"/health\\", h.healthCheck)\\n\\n\\t// Analytics routes\\n\\tmux.HandleFunc(\\"/api/v1/analytics/stats\\", h.getOverallStats)\\n\\tmux.HandleFunc(\\"/api/v1/analytics/stats/daily\\", h.getDailyStats)\\n\\tmux.HandleFunc(\\"/api/v1/analytics/events/counts\\", h.getEventCounts)\\n\\tmux.HandleFunc(\\"/api/v1/analytics/events/recent\\", h.getRecentEvents)\\n\\tmux.HandleFunc(\\"/api/v1/analytics/events/\\", h.getEventsByType)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) healthCheck(w http.ResponseWriter, r *http.Request) {\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tjson.NewEncoder(w).Encode(map[string]interface{}{\\n\\t\\t\\"success\\": true,\\n\\t\\t\\"data\\": map[string]string{\\n\\t\\t\\t\\"status\\":  \\"healthy\\",\\n\\t\\t\\t\\"service\\": \\"analytics\\",\\n\\t\\t},\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:40:19","name":"healthCheck","node_type":"function"},{"code":"func (h *Handler) getOverallStats(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tstats, err := h.analyticsService.GetOverallStats(r.Context())\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, stats)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","name":"getOverallStats","node_type":"function"},{"code":"func (s *AnalyticsService) GetOverallStats(ctx context.Context) (*model.OverallStats, error) {\\n\\treturn s.repo.GetOverallStats(ctx)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:199:28","name":"GetOverallStats","node_type":"function"},{"code":"func (r *AnalyticsRepository) GetOverallStats(ctx context.Context) (*model.OverallStats, error) {\\n\\tquery := \`\\n\\t\\tSELECT\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'user.created' THEN 1 ELSE 0 END), 0) as total_users,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'profile.created' THEN 1 ELSE 0 END), 0) as total_profiles,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type IN ('swipe.right', 'swipe.left') THEN 1 ELSE 0 END), 0) as total_swipes,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'swipe.right' THEN 1 ELSE 0 END), 0) as right_swipes,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'match.created' THEN 1 ELSE 0 END), 0) as total_matches,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'media.uploaded' THEN 1 ELSE 0 END), 0) as total_media\\n\\t\\tFROM events\\n\\t\`\\n\\tvar stats model.OverallStats\\n\\tvar rightSwipes int64\\n\\terr := r.db.QueryRowContext(ctx, query).Scan(\\n\\t\\t&stats.TotalUsers, &stats.TotalProfiles, &stats.TotalSwipes,\\n\\t\\t&rightSwipes, &stats.TotalMatches, &stats.TotalMedia,\\n\\t)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get overall stats\\", 500)\\n\\t}\\n\\n\\t// Calculate rates\\n\\tif stats.TotalSwipes > 0 {\\n\\t\\tstats.SwipeRightRate = float64(rightSwipes) / float64(stats.TotalSwipes) * 100\\n\\t}\\n\\tif rightSwipes > 0 {\\n\\t\\tstats.MatchRate = float64(stats.TotalMatches) / float64(rightSwipes) * 100\\n\\t}\\n\\n\\treturn &stats, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:137:31","name":"GetOverallStats","node_type":"function"},{"code":"func (h *Handler) getDailyStats(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Default to last 7 days\\n\\tdays := 7\\n\\tif d := r.URL.Query().Get(\\"days\\"); d != \\"\\" {\\n\\t\\tif parsed, err := strconv.Atoi(d); err == nil && parsed > 0 && parsed <= 90 {\\n\\t\\t\\tdays = parsed\\n\\t\\t}\\n\\t}\\n\\n\\tstats, err := h.analyticsService.GetDailyStats(r.Context(), days)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, stats)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","name":"getDailyStats","node_type":"function"},{"code":"func (s *AnalyticsService) GetDailyStats(ctx context.Context, days int) ([]model.DailyStats, error) {\\n\\tendDate := time.Now().UTC().Truncate(24 * time.Hour).Add(24 * time.Hour)\\n\\tstartDate := endDate.AddDate(0, 0, -days)\\n\\treturn s.repo.GetDailyStats(ctx, startDate, endDate)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:204:28","name":"GetDailyStats","node_type":"function"},{"code":"func (r *AnalyticsRepository) GetDailyStats(ctx context.Context, startDate, endDate time.Time) ([]model.DailyStats, error) {\\n\\tquery := \`\\n\\t\\tWITH daily_events AS (\\n\\t\\t\\tSELECT\\n\\t\\t\\t\\t(created_at AT TIME ZONE 'UTC')::date as date,\\n\\t\\t\\t\\tevent_type,\\n\\t\\t\\t\\tCOUNT(*) as count\\n\\t\\t\\tFROM events\\n\\t\\t\\tWHERE created_at >= $1 AND created_at < $2\\n\\t\\t\\tGROUP BY (created_at AT TIME ZONE 'UTC')::date, event_type\\n\\t\\t)\\n\\t\\tSELECT\\n\\t\\t\\tdate,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'user.created' THEN count ELSE 0 END), 0) as new_users,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'profile.created' THEN count ELSE 0 END), 0) as new_profiles,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type IN ('swipe.right', 'swipe.left') THEN count ELSE 0 END), 0) as total_swipes,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'swipe.right' THEN count ELSE 0 END), 0) as right_swipes,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'swipe.left' THEN count ELSE 0 END), 0) as left_swipes,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'match.created' THEN count ELSE 0 END), 0) as new_matches,\\n\\t\\t\\tCOALESCE(SUM(CASE WHEN event_type = 'media.uploaded' THEN count ELSE 0 END), 0) as media_uploads\\n\\t\\tFROM daily_events\\n\\t\\tGROUP BY date\\n\\t\\tORDER BY date DESC\\n\\t\`\\n\\trows, err := r.db.QueryContext(ctx, query, startDate, endDate)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get daily stats\\", 500)\\n\\t}\\n\\tdefer rows.Close()\\n\\n\\tvar stats []model.DailyStats\\n\\tfor rows.Next() {\\n\\t\\tvar s model.DailyStats\\n\\t\\tvar date time.Time\\n\\t\\tif err := rows.Scan(&date, &s.NewUsers, &s.NewProfiles, &s.TotalSwipes,\\n\\t\\t\\t&s.RightSwipes, &s.LeftSwipes, &s.NewMatches, &s.MediaUploads); err != nil {\\n\\t\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to scan daily stats\\", 500)\\n\\t\\t}\\n\\t\\ts.Date = date.Format(\\"2006-01-02\\")\\n\\t\\tstats = append(stats, s)\\n\\t}\\n\\n\\treturn stats, rows.Err()\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:91:31","name":"GetDailyStats","node_type":"function"},{"code":"func (h *Handler) getEventCounts(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tcounts, err := h.analyticsService.GetEventCounts(r.Context())\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, counts)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","name":"getEventCounts","node_type":"function"},{"code":"func (s *AnalyticsService) GetEventCounts(ctx context.Context) ([]model.EventCount, error) {\\n\\treturn s.repo.GetEventCounts(ctx)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:211:28","name":"GetEventCounts","node_type":"function"},{"code":"func (r *AnalyticsRepository) GetEventCounts(ctx context.Context) ([]model.EventCount, error) {\\n\\tquery := \`\\n\\t\\tSELECT event_type, COUNT(*) as count\\n\\t\\tFROM events\\n\\t\\tGROUP BY event_type\\n\\t\\tORDER BY count DESC\\n\\t\`\\n\\trows, err := r.db.QueryContext(ctx, query)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get event counts\\", 500)\\n\\t}\\n\\tdefer rows.Close()\\n\\n\\tvar counts []model.EventCount\\n\\tfor rows.Next() {\\n\\t\\tvar ec model.EventCount\\n\\t\\tif err := rows.Scan(&ec.EventType, &ec.Count); err != nil {\\n\\t\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to scan event count\\", 500)\\n\\t\\t}\\n\\t\\tcounts = append(counts, ec)\\n\\t}\\n\\n\\treturn counts, rows.Err()\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:65:31","name":"GetEventCounts","node_type":"function"},{"code":"func (h *Handler) getRecentEvents(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Default to 50 events\\n\\tlimit := 50\\n\\tif l := r.URL.Query().Get(\\"limit\\"); l != \\"\\" {\\n\\t\\tif parsed, err := strconv.Atoi(l); err == nil && parsed > 0 && parsed <= 100 {\\n\\t\\t\\tlimit = parsed\\n\\t\\t}\\n\\t}\\n\\n\\tevents, err := h.analyticsService.GetRecentEvents(r.Context(), limit)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, events)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","name":"getRecentEvents","node_type":"function"},{"code":"func (s *AnalyticsService) GetRecentEvents(ctx context.Context, limit int) ([]model.AnalyticsEvent, error) {\\n\\tif limit <= 0 || limit > 100 {\\n\\t\\tlimit = 50\\n\\t}\\n\\treturn s.repo.GetRecentEvents(ctx, limit)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:216:28","name":"GetRecentEvents","node_type":"function"},{"code":"func (r *AnalyticsRepository) GetRecentEvents(ctx context.Context, limit int) ([]model.AnalyticsEvent, error) {\\n\\tquery := \`\\n\\t\\tSELECT id, event_type, entity_id, COALESCE(user_id, ''), metadata, created_at\\n\\t\\tFROM events\\n\\t\\tORDER BY created_at DESC\\n\\t\\tLIMIT $1\\n\\t\`\\n\\trows, err := r.db.QueryContext(ctx, query, limit)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get recent events\\", 500)\\n\\t}\\n\\tdefer rows.Close()\\n\\n\\tvar events []model.AnalyticsEvent\\n\\tfor rows.Next() {\\n\\t\\tvar e model.AnalyticsEvent\\n\\t\\tif err := rows.Scan(&e.ID, &e.EventType, &e.EntityID, &e.UserID, &e.Metadata, &e.CreatedAt); err != nil {\\n\\t\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to scan event\\", 500)\\n\\t\\t}\\n\\t\\tevents = append(events, e)\\n\\t}\\n\\n\\treturn events, rows.Err()\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:170:31","name":"GetRecentEvents","node_type":"function"},{"code":"func (h *Handler) getEventsByType(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Extract event type from path /api/v1/analytics/events/{eventType}\\n\\tpath := strings.TrimPrefix(r.URL.Path, \\"/api/v1/analytics/events/\\")\\n\\teventType := strings.TrimSuffix(path, \\"/\\")\\n\\n\\tif eventType == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"event type is required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Default to 50 events\\n\\tlimit := 50\\n\\tif l := r.URL.Query().Get(\\"limit\\"); l != \\"\\" {\\n\\t\\tif parsed, err := strconv.Atoi(l); err == nil && parsed > 0 && parsed <= 100 {\\n\\t\\t\\tlimit = parsed\\n\\t\\t}\\n\\t}\\n\\n\\tevents, err := h.analyticsService.GetEventsByType(r.Context(), model.EventType(eventType), limit)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, events)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","name":"getEventsByType","node_type":"function"},{"code":"func (s *AnalyticsService) GetEventsByType(ctx context.Context, eventType model.EventType, limit int) ([]model.AnalyticsEvent, error) {\\n\\tif limit <= 0 || limit > 100 {\\n\\t\\tlimit = 50\\n\\t}\\n\\treturn s.repo.GetEventsByType(ctx, eventType, limit)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:224:28","name":"GetEventsByType","node_type":"function"},{"code":"func (r *AnalyticsRepository) GetEventsByType(ctx context.Context, eventType model.EventType, limit int) ([]model.AnalyticsEvent, error) {\\n\\tquery := \`\\n\\t\\tSELECT id, event_type, entity_id, COALESCE(user_id, ''), metadata, created_at\\n\\t\\tFROM events\\n\\t\\tWHERE event_type = $1\\n\\t\\tORDER BY created_at DESC\\n\\t\\tLIMIT $2\\n\\t\`\\n\\trows, err := r.db.QueryContext(ctx, query, eventType, limit)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get events by type\\", 500)\\n\\t}\\n\\tdefer rows.Close()\\n\\n\\tvar events []model.AnalyticsEvent\\n\\tfor rows.Next() {\\n\\t\\tvar e model.AnalyticsEvent\\n\\t\\tif err := rows.Scan(&e.ID, &e.EventType, &e.EntityID, &e.UserID, &e.Metadata, &e.CreatedAt); err != nil {\\n\\t\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to scan event\\", 500)\\n\\t\\t}\\n\\t\\tevents = append(events, e)\\n\\t}\\n\\n\\treturn events, rows.Err()\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:196:31","name":"GetEventsByType","node_type":"function"},{"code":"func NewEventConsumer(brokers []string, analyticsService *service.AnalyticsService) *EventConsumer {\\n\\treturn &EventConsumer{\\n\\t\\tbrokers:          brokers,\\n\\t\\tgroupID:          \\"analytics-service\\",\\n\\t\\tanalyticsService: analyticsService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:24:6","name":"NewEventConsumer","node_type":"function"},{"code":"func (c *EventConsumer) Start(ctx context.Context) {\\n\\ttopics := []string{\\n\\t\\tkafka.TopicUserCreated,\\n\\t\\tkafka.TopicUserUpdated,\\n\\t\\tkafka.TopicProfileCreated,\\n\\t\\tkafka.TopicProfileUpdated,\\n\\t\\tkafka.TopicProfileDeleted,\\n\\t\\tkafka.TopicSwipeCreated,\\n\\t\\tkafka.TopicMatchCreated,\\n\\t\\tkafka.TopicMatchDeleted,\\n\\t\\tkafka.TopicMediaUploaded,\\n\\t\\tkafka.TopicMediaDeleted,\\n\\t}\\n\\n\\tlogger.Info(\\"starting analytics event consumers\\",\\n\\t\\tzap.Strings(\\"topics\\", topics),\\n\\t)\\n\\n\\t// Create a consumer for each topic\\n\\tc.consumers = kafka.NewMultiTopicConsumer(c.brokers, c.groupID, topics)\\n\\n\\t// Register handlers for each consumer based on the topic\\n\\tfor i, consumer := range c.consumers {\\n\\t\\ttopic := topics[i]\\n\\t\\tc.registerHandlerForTopic(consumer, topic)\\n\\n\\t\\t// Start each consumer in its own goroutine\\n\\t\\tgo func(cons *kafka.Consumer, t string) {\\n\\t\\t\\tlogger.Info(\\"starting consumer for topic\\", zap.String(\\"topic\\", t))\\n\\t\\t\\tif err := cons.Start(ctx); err != nil {\\n\\t\\t\\t\\tlogger.Error(\\"consumer stopped with error\\",\\n\\t\\t\\t\\t\\tzap.String(\\"topic\\", t),\\n\\t\\t\\t\\t\\tzap.Error(err),\\n\\t\\t\\t\\t)\\n\\t\\t\\t}\\n\\t\\t}(consumer, topic)\\n\\t}\\n\\n\\t// Wait for context cancellation\\n\\t<-ctx.Done()\\n\\tlogger.Info(\\"shutting down analytics consumers\\")\\n\\n\\t// Close all consumers\\n\\tfor _, consumer := range c.consumers {\\n\\t\\tconsumer.Close()\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:33:25","name":"Start","node_type":"function"},{"code":"func (c *EventConsumer) registerHandlerForTopic(consumer *kafka.Consumer, topic string) {\\n\\tswitch topic {\\n\\tcase kafka.TopicUserCreated:\\n\\t\\tconsumer.RegisterHandler(kafka.TopicUserCreated, c.handleUserCreated)\\n\\tcase kafka.TopicUserUpdated:\\n\\t\\tconsumer.RegisterHandler(kafka.TopicUserUpdated, c.handleUserUpdated)\\n\\tcase kafka.TopicProfileCreated:\\n\\t\\tconsumer.RegisterHandler(kafka.TopicProfileCreated, c.handleProfileCreated)\\n\\tcase kafka.TopicProfileUpdated:\\n\\t\\tconsumer.RegisterHandler(kafka.TopicProfileUpdated, c.handleProfileUpdated)\\n\\tcase kafka.TopicProfileDeleted:\\n\\t\\tconsumer.RegisterHandler(kafka.TopicProfileDeleted, c.handleProfileDeleted)\\n\\tcase kafka.TopicSwipeCreated:\\n\\t\\tconsumer.RegisterHandler(kafka.TopicSwipeCreated, c.handleSwipeCreated)\\n\\tcase kafka.TopicMatchCreated:\\n\\t\\tconsumer.RegisterHandler(kafka.TopicMatchCreated, c.handleMatchCreated)\\n\\tcase kafka.TopicMatchDeleted:\\n\\t\\tconsumer.RegisterHandler(kafka.TopicMatchDeleted, c.handleMatchDeleted)\\n\\tcase kafka.TopicMediaUploaded:\\n\\t\\tconsumer.RegisterHandler(kafka.TopicMediaUploaded, c.handleMediaUploaded)\\n\\tcase kafka.TopicMediaDeleted:\\n\\t\\tconsumer.RegisterHandler(kafka.TopicMediaDeleted, c.handleMediaDeleted)\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","name":"registerHandlerForTopic","node_type":"function"},{"code":"func (c *EventConsumer) handleUserCreated(ctx context.Context, event kafka.Event) error {\\n\\tlogger.Debug(\\"received user.created event\\", zap.String(\\"event_id\\", event.ID))\\n\\n\\tvar userEvent model.UserCreatedEvent\\n\\tif err := json.Unmarshal(event.Data, &userEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal user created payload\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tif userEvent.CreatedAt.IsZero() {\\n\\t\\tuserEvent.CreatedAt = time.Now().UTC()\\n\\t}\\n\\treturn c.analyticsService.RecordUserCreated(ctx, &userEvent)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:106:25","name":"handleUserCreated","node_type":"function"},{"code":"func (s *AnalyticsService) RecordUserCreated(ctx context.Context, event *model.UserCreatedEvent) error {\\n\\tanalyticsEvent := &model.AnalyticsEvent{\\n\\t\\tEventType: model.EventTypeUserCreated,\\n\\t\\tEntityID:  event.UserID,\\n\\t\\tUserID:    event.UserID,\\n\\t\\tMetadata:  repository.ToMetadata(event),\\n\\t\\tCreatedAt: event.CreatedAt,\\n\\t}\\n\\tif err := s.repo.RecordEvent(ctx, analyticsEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to record user created event\\", zap.Error(err), zap.String(\\"user_id\\", event.UserID))\\n\\t\\treturn err\\n\\t}\\n\\tlogger.Info(\\"recorded user created event\\", zap.String(\\"user_id\\", event.UserID))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:24:28","name":"RecordUserCreated","node_type":"function"},{"code":"func ToMetadata(v interface{}) string {\\n\\tdata, err := json.Marshal(v)\\n\\tif err != nil {\\n\\t\\treturn \\"{}\\"\\n\\t}\\n\\treturn string(data)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","name":"ToMetadata","node_type":"function"},{"code":"func (r *AnalyticsRepository) RecordEvent(ctx context.Context, event *model.AnalyticsEvent) error {\\n\\tquery := \`\\n\\t\\tINSERT INTO events (event_type, entity_id, user_id, metadata, created_at)\\n\\t\\tVALUES ($1, $2, $3, $4, $5)\\n\\t\\tRETURNING id\\n\\t\`\\n\\terr := r.db.QueryRowContext(ctx, query,\\n\\t\\tevent.EventType, event.EntityID, event.UserID, event.Metadata, event.CreatedAt,\\n\\t).Scan(&event.ID)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to record event\\", 500)\\n\\t}\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","name":"RecordEvent","node_type":"function"},{"code":"func (c *EventConsumer) handleUserUpdated(ctx context.Context, event kafka.Event) error {\\n\\tlogger.Debug(\\"received user.updated event\\", zap.String(\\"event_id\\", event.ID))\\n\\n\\tvar userEvent model.UserUpdatedEvent\\n\\tif err := json.Unmarshal(event.Data, &userEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal user updated payload\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tif userEvent.UpdatedAt.IsZero() {\\n\\t\\tuserEvent.UpdatedAt = time.Now().UTC()\\n\\t}\\n\\treturn c.analyticsService.RecordUserUpdated(ctx, &userEvent)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:120:25","name":"handleUserUpdated","node_type":"function"},{"code":"func (s *AnalyticsService) RecordUserUpdated(ctx context.Context, event *model.UserUpdatedEvent) error {\\n\\tanalyticsEvent := &model.AnalyticsEvent{\\n\\t\\tEventType: model.EventTypeUserUpdated,\\n\\t\\tEntityID:  event.UserID,\\n\\t\\tUserID:    event.UserID,\\n\\t\\tMetadata:  repository.ToMetadata(event),\\n\\t\\tCreatedAt: event.UpdatedAt,\\n\\t}\\n\\tif err := s.repo.RecordEvent(ctx, analyticsEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to record user updated event\\", zap.Error(err), zap.String(\\"user_id\\", event.UserID))\\n\\t\\treturn err\\n\\t}\\n\\tlogger.Info(\\"recorded user updated event\\", zap.String(\\"user_id\\", event.UserID))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:41:28","name":"RecordUserUpdated","node_type":"function"},{"code":"func (c *EventConsumer) handleProfileCreated(ctx context.Context, event kafka.Event) error {\\n\\tlogger.Debug(\\"received profile.created event\\", zap.String(\\"event_id\\", event.ID))\\n\\n\\tvar profileEvent model.ProfileCreatedEvent\\n\\tif err := json.Unmarshal(event.Data, &profileEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal profile created payload\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tif profileEvent.CreatedAt.IsZero() {\\n\\t\\tprofileEvent.CreatedAt = time.Now().UTC()\\n\\t}\\n\\treturn c.analyticsService.RecordProfileCreated(ctx, &profileEvent)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:134:25","name":"handleProfileCreated","node_type":"function"},{"code":"func (s *AnalyticsService) RecordProfileCreated(ctx context.Context, event *model.ProfileCreatedEvent) error {\\n\\tanalyticsEvent := &model.AnalyticsEvent{\\n\\t\\tEventType: model.EventTypeProfileCreated,\\n\\t\\tEntityID:  event.ProfileID,\\n\\t\\tUserID:    event.UserID,\\n\\t\\tMetadata:  repository.ToMetadata(event),\\n\\t\\tCreatedAt: event.CreatedAt,\\n\\t}\\n\\tif err := s.repo.RecordEvent(ctx, analyticsEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to record profile created event\\", zap.Error(err), zap.String(\\"profile_id\\", event.ProfileID))\\n\\t\\treturn err\\n\\t}\\n\\tlogger.Info(\\"recorded profile created event\\", zap.String(\\"profile_id\\", event.ProfileID))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:58:28","name":"RecordProfileCreated","node_type":"function"},{"code":"func (c *EventConsumer) handleProfileUpdated(ctx context.Context, event kafka.Event) error {\\n\\tlogger.Debug(\\"received profile.updated event\\", zap.String(\\"event_id\\", event.ID))\\n\\n\\tvar profileEvent model.ProfileUpdatedEvent\\n\\tif err := json.Unmarshal(event.Data, &profileEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal profile updated payload\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tif profileEvent.UpdatedAt.IsZero() {\\n\\t\\tprofileEvent.UpdatedAt = time.Now().UTC()\\n\\t}\\n\\treturn c.analyticsService.RecordProfileUpdated(ctx, &profileEvent)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:148:25","name":"handleProfileUpdated","node_type":"function"},{"code":"func (s *AnalyticsService) RecordProfileUpdated(ctx context.Context, event *model.ProfileUpdatedEvent) error {\\n\\tanalyticsEvent := &model.AnalyticsEvent{\\n\\t\\tEventType: model.EventTypeProfileUpdated,\\n\\t\\tEntityID:  event.ProfileID,\\n\\t\\tUserID:    event.UserID,\\n\\t\\tMetadata:  repository.ToMetadata(event),\\n\\t\\tCreatedAt: event.UpdatedAt,\\n\\t}\\n\\tif err := s.repo.RecordEvent(ctx, analyticsEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to record profile updated event\\", zap.Error(err), zap.String(\\"profile_id\\", event.ProfileID))\\n\\t\\treturn err\\n\\t}\\n\\tlogger.Info(\\"recorded profile updated event\\", zap.String(\\"profile_id\\", event.ProfileID))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:75:28","name":"RecordProfileUpdated","node_type":"function"},{"code":"func (c *EventConsumer) handleProfileDeleted(ctx context.Context, event kafka.Event) error {\\n\\tlogger.Debug(\\"received profile.deleted event\\", zap.String(\\"event_id\\", event.ID))\\n\\n\\tvar profileEvent model.ProfileDeletedEvent\\n\\tif err := json.Unmarshal(event.Data, &profileEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal profile deleted payload\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tif profileEvent.DeletedAt.IsZero() {\\n\\t\\tprofileEvent.DeletedAt = time.Now().UTC()\\n\\t}\\n\\treturn c.analyticsService.RecordProfileDeleted(ctx, &profileEvent)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:162:25","name":"handleProfileDeleted","node_type":"function"},{"code":"func (s *AnalyticsService) RecordProfileDeleted(ctx context.Context, event *model.ProfileDeletedEvent) error {\\n\\tanalyticsEvent := &model.AnalyticsEvent{\\n\\t\\tEventType: model.EventTypeProfileDeleted,\\n\\t\\tEntityID:  event.ProfileID,\\n\\t\\tUserID:    event.UserID,\\n\\t\\tMetadata:  repository.ToMetadata(event),\\n\\t\\tCreatedAt: event.DeletedAt,\\n\\t}\\n\\tif err := s.repo.RecordEvent(ctx, analyticsEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to record profile deleted event\\", zap.Error(err), zap.String(\\"profile_id\\", event.ProfileID))\\n\\t\\treturn err\\n\\t}\\n\\tlogger.Info(\\"recorded profile deleted event\\", zap.String(\\"profile_id\\", event.ProfileID))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:92:28","name":"RecordProfileDeleted","node_type":"function"},{"code":"func (c *EventConsumer) handleSwipeCreated(ctx context.Context, event kafka.Event) error {\\n\\tlogger.Debug(\\"received swipe.created event\\", zap.String(\\"event_id\\", event.ID))\\n\\n\\tvar swipeEvent model.SwipeCreatedEvent\\n\\tif err := json.Unmarshal(event.Data, &swipeEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal swipe created payload\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tif swipeEvent.CreatedAt.IsZero() {\\n\\t\\tswipeEvent.CreatedAt = time.Now().UTC()\\n\\t}\\n\\treturn c.analyticsService.RecordSwipe(ctx, &swipeEvent)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:176:25","name":"handleSwipeCreated","node_type":"function"},{"code":"func (s *AnalyticsService) RecordSwipe(ctx context.Context, event *model.SwipeCreatedEvent) error {\\n\\teventType := model.EventTypeSwipeLeft\\n\\tif event.Direction == \\"right\\" {\\n\\t\\teventType = model.EventTypeSwipeRight\\n\\t}\\n\\n\\tanalyticsEvent := &model.AnalyticsEvent{\\n\\t\\tEventType: eventType,\\n\\t\\tEntityID:  event.SwiperID + \\":\\" + event.SwipedID,\\n\\t\\tUserID:    \\"\\", // We don't have user ID directly, just profile IDs\\n\\t\\tMetadata:  repository.ToMetadata(event),\\n\\t\\tCreatedAt: event.CreatedAt,\\n\\t}\\n\\tif err := s.repo.RecordEvent(ctx, analyticsEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to record swipe event\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tlogger.Info(\\"recorded swipe event\\", zap.String(\\"direction\\", event.Direction))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:109:28","name":"RecordSwipe","node_type":"function"},{"code":"func (c *EventConsumer) handleMatchCreated(ctx context.Context, event kafka.Event) error {\\n\\tlogger.Debug(\\"received match.created event\\", zap.String(\\"event_id\\", event.ID))\\n\\n\\tvar matchEvent model.MatchCreatedEvent\\n\\tif err := json.Unmarshal(event.Data, &matchEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal match created payload\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tif matchEvent.CreatedAt.IsZero() {\\n\\t\\tmatchEvent.CreatedAt = time.Now().UTC()\\n\\t}\\n\\treturn c.analyticsService.RecordMatchCreated(ctx, &matchEvent)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:190:25","name":"handleMatchCreated","node_type":"function"},{"code":"func (s *AnalyticsService) RecordMatchCreated(ctx context.Context, event *model.MatchCreatedEvent) error {\\n\\tanalyticsEvent := &model.AnalyticsEvent{\\n\\t\\tEventType: model.EventTypeMatchCreated,\\n\\t\\tEntityID:  event.MatchID,\\n\\t\\tUserID:    event.User1ID,\\n\\t\\tMetadata:  repository.ToMetadata(event),\\n\\t\\tCreatedAt: event.CreatedAt,\\n\\t}\\n\\tif err := s.repo.RecordEvent(ctx, analyticsEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to record match created event\\", zap.Error(err), zap.String(\\"match_id\\", event.MatchID))\\n\\t\\treturn err\\n\\t}\\n\\tlogger.Info(\\"recorded match created event\\", zap.String(\\"match_id\\", event.MatchID))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:131:28","name":"RecordMatchCreated","node_type":"function"},{"code":"func (c *EventConsumer) handleMatchDeleted(ctx context.Context, event kafka.Event) error {\\n\\tlogger.Debug(\\"received match.deleted event\\", zap.String(\\"event_id\\", event.ID))\\n\\n\\tvar matchEvent model.MatchDeletedEvent\\n\\tif err := json.Unmarshal(event.Data, &matchEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal match deleted payload\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tif matchEvent.DeletedAt.IsZero() {\\n\\t\\tmatchEvent.DeletedAt = time.Now().UTC()\\n\\t}\\n\\treturn c.analyticsService.RecordMatchDeleted(ctx, &matchEvent)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:204:25","name":"handleMatchDeleted","node_type":"function"},{"code":"func (s *AnalyticsService) RecordMatchDeleted(ctx context.Context, event *model.MatchDeletedEvent) error {\\n\\tanalyticsEvent := &model.AnalyticsEvent{\\n\\t\\tEventType: model.EventTypeMatchDeleted,\\n\\t\\tEntityID:  event.MatchID,\\n\\t\\tUserID:    \\"\\",\\n\\t\\tMetadata:  repository.ToMetadata(event),\\n\\t\\tCreatedAt: event.DeletedAt,\\n\\t}\\n\\tif err := s.repo.RecordEvent(ctx, analyticsEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to record match deleted event\\", zap.Error(err), zap.String(\\"match_id\\", event.MatchID))\\n\\t\\treturn err\\n\\t}\\n\\tlogger.Info(\\"recorded match deleted event\\", zap.String(\\"match_id\\", event.MatchID))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:148:28","name":"RecordMatchDeleted","node_type":"function"},{"code":"func (c *EventConsumer) handleMediaUploaded(ctx context.Context, event kafka.Event) error {\\n\\tlogger.Debug(\\"received media.uploaded event\\", zap.String(\\"event_id\\", event.ID))\\n\\n\\tvar mediaEvent model.MediaUploadedEvent\\n\\tif err := json.Unmarshal(event.Data, &mediaEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal media uploaded payload\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tif mediaEvent.UploadedAt.IsZero() {\\n\\t\\tmediaEvent.UploadedAt = time.Now().UTC()\\n\\t}\\n\\treturn c.analyticsService.RecordMediaUploaded(ctx, &mediaEvent)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:218:25","name":"handleMediaUploaded","node_type":"function"},{"code":"func (s *AnalyticsService) RecordMediaUploaded(ctx context.Context, event *model.MediaUploadedEvent) error {\\n\\tanalyticsEvent := &model.AnalyticsEvent{\\n\\t\\tEventType: model.EventTypeMediaUploaded,\\n\\t\\tEntityID:  event.MediaID,\\n\\t\\tUserID:    event.UserID,\\n\\t\\tMetadata:  repository.ToMetadata(event),\\n\\t\\tCreatedAt: event.UploadedAt,\\n\\t}\\n\\tif err := s.repo.RecordEvent(ctx, analyticsEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to record media uploaded event\\", zap.Error(err), zap.String(\\"media_id\\", event.MediaID))\\n\\t\\treturn err\\n\\t}\\n\\tlogger.Info(\\"recorded media uploaded event\\", zap.String(\\"media_id\\", event.MediaID))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:165:28","name":"RecordMediaUploaded","node_type":"function"},{"code":"func (c *EventConsumer) handleMediaDeleted(ctx context.Context, event kafka.Event) error {\\n\\tlogger.Debug(\\"received media.deleted event\\", zap.String(\\"event_id\\", event.ID))\\n\\n\\tvar mediaEvent model.MediaDeletedEvent\\n\\tif err := json.Unmarshal(event.Data, &mediaEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal media deleted payload\\", zap.Error(err))\\n\\t\\treturn err\\n\\t}\\n\\tif mediaEvent.DeletedAt.IsZero() {\\n\\t\\tmediaEvent.DeletedAt = time.Now().UTC()\\n\\t}\\n\\treturn c.analyticsService.RecordMediaDeleted(ctx, &mediaEvent)\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:232:25","name":"handleMediaDeleted","node_type":"function"},{"code":"func (s *AnalyticsService) RecordMediaDeleted(ctx context.Context, event *model.MediaDeletedEvent) error {\\n\\tanalyticsEvent := &model.AnalyticsEvent{\\n\\t\\tEventType: model.EventTypeMediaDeleted,\\n\\t\\tEntityID:  event.MediaID,\\n\\t\\tUserID:    event.UserID,\\n\\t\\tMetadata:  repository.ToMetadata(event),\\n\\t\\tCreatedAt: event.DeletedAt,\\n\\t}\\n\\tif err := s.repo.RecordEvent(ctx, analyticsEvent); err != nil {\\n\\t\\tlogger.Error(\\"failed to record media deleted event\\", zap.Error(err), zap.String(\\"media_id\\", event.MediaID))\\n\\t\\treturn err\\n\\t}\\n\\tlogger.Info(\\"recorded media deleted event\\", zap.String(\\"media_id\\", event.MediaID))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:182:28","name":"RecordMediaDeleted","node_type":"function"}]`),b=JSON.parse('[{"column":29,"line":64,"source":"/home/evan/Code/rinder/services/analytics/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:19:6","val":1},{"column":25,"line":67,"source":"/home/evan/Code/rinder/services/analytics/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:24:31","val":1},{"column":32,"line":40,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:24:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:24:31","val":1},{"column":29,"line":73,"source":"/home/evan/Code/rinder/services/analytics/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:19:6","val":1},{"column":14,"line":76,"source":"/home/evan/Code/rinder/services/analytics/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:21:6","val":1},{"column":3,"line":80,"source":"/home/evan/Code/rinder/services/analytics/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","val":1},{"column":29,"line":29,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:40:19","val":1},{"column":17,"line":42,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:40:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:40:19","val":1},{"column":45,"line":32,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","val":1},{"column":17,"line":54,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","val":1},{"column":34,"line":58,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:199:28","val":1},{"column":15,"line":199,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:199:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:137:31","val":1},{"column":29,"line":149,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:137:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:137:31","val":1},{"column":31,"line":199,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:199:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:199:28","val":1},{"column":17,"line":60,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","val":1},{"column":13,"line":64,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19","val":1},{"column":51,"line":33,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","val":1},{"column":17,"line":70,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","val":1},{"column":34,"line":82,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:204:28","val":1},{"column":15,"line":206,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:204:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:91:31","val":1},{"column":32,"line":114,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:91:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:91:31","val":1},{"column":44,"line":114,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:91:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:91:31","val":1},{"column":55,"line":114,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:91:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:91:31","val":1},{"column":29,"line":206,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:204:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:204:28","val":1},{"column":17,"line":84,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","val":1},{"column":13,"line":88,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19","val":1},{"column":53,"line":34,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","val":1},{"column":17,"line":94,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","val":1},{"column":35,"line":98,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:211:28","val":1},{"column":15,"line":211,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:211:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:65:31","val":1},{"column":32,"line":71,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:65:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:65:31","val":1},{"column":30,"line":211,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:211:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:211:28","val":1},{"column":17,"line":100,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","val":1},{"column":13,"line":104,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19","val":1},{"column":53,"line":35,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","val":1},{"column":17,"line":110,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","val":1},{"column":35,"line":122,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:216:28","val":1},{"column":15,"line":219,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:216:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:170:31","val":1},{"column":32,"line":176,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:170:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:170:31","val":1},{"column":44,"line":176,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:170:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:170:31","val":1},{"column":31,"line":219,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:216:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:216:28","val":1},{"column":36,"line":219,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:216:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:216:28","val":1},{"column":17,"line":124,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","val":1},{"column":13,"line":128,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19","val":1},{"column":47,"line":36,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","val":1},{"column":17,"line":134,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","val":1},{"column":17,"line":143,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","val":1},{"column":35,"line":155,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:224:28","val":1},{"column":15,"line":227,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:224:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:196:31","val":1},{"column":32,"line":203,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:196:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:196:31","val":1},{"column":44,"line":203,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:196:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:196:31","val":1},{"column":55,"line":203,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:196:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:196:31","val":1},{"column":31,"line":227,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:224:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:224:28","val":1},{"column":36,"line":227,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:224:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:224:28","val":1},{"column":47,"line":227,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:224:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:224:28","val":1},{"column":17,"line":157,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","val":1},{"column":13,"line":161,"source":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","target":"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19","val":1},{"column":27,"line":88,"source":"/home/evan/Code/rinder/services/analytics/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:24:6","val":1},{"column":18,"line":90,"source":"/home/evan/Code/rinder/services/analytics/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:33:25","val":1},{"column":4,"line":56,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:33:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","val":1},{"column":53,"line":83,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:106:25","val":1},{"column":27,"line":116,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:106:25","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:24:28","val":1},{"column":24,"line":28,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:24:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":27,"line":223,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":35,"line":28,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:24:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:24:28","val":1},{"column":18,"line":31,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:24:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":29,"line":54,"source":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":30,"line":31,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:24:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:24:28","val":1},{"column":45,"line":116,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:106:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:106:25","val":1},{"column":53,"line":85,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:120:25","val":1},{"column":27,"line":130,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:120:25","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:41:28","val":1},{"column":24,"line":45,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:41:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":35,"line":45,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:41:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:41:28","val":1},{"column":18,"line":48,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:41:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":30,"line":48,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:41:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:41:28","val":1},{"column":45,"line":130,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:120:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:120:25","val":1},{"column":56,"line":87,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:134:25","val":1},{"column":27,"line":144,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:134:25","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:58:28","val":1},{"column":24,"line":62,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:58:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":35,"line":62,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:58:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:58:28","val":1},{"column":18,"line":65,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:58:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":30,"line":65,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:58:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:58:28","val":1},{"column":48,"line":144,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:134:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:134:25","val":1},{"column":56,"line":89,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:148:25","val":1},{"column":27,"line":158,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:148:25","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:75:28","val":1},{"column":24,"line":79,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:75:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":35,"line":79,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:75:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:75:28","val":1},{"column":18,"line":82,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:75:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":30,"line":82,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:75:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:75:28","val":1},{"column":48,"line":158,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:148:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:148:25","val":1},{"column":56,"line":91,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:162:25","val":1},{"column":27,"line":172,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:162:25","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:92:28","val":1},{"column":24,"line":96,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:92:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":35,"line":96,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:92:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:92:28","val":1},{"column":18,"line":99,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:92:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":30,"line":99,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:92:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:92:28","val":1},{"column":48,"line":172,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:162:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:162:25","val":1},{"column":54,"line":93,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:176:25","val":1},{"column":27,"line":186,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:176:25","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:109:28","val":1},{"column":24,"line":118,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:109:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":35,"line":118,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:109:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:109:28","val":1},{"column":18,"line":121,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:109:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":30,"line":121,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:109:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:109:28","val":1},{"column":39,"line":186,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:176:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:176:25","val":1},{"column":54,"line":95,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:190:25","val":1},{"column":27,"line":200,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:190:25","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:131:28","val":1},{"column":24,"line":135,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:131:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":35,"line":135,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:131:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:131:28","val":1},{"column":18,"line":138,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:131:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":30,"line":138,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:131:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:131:28","val":1},{"column":46,"line":200,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:190:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:190:25","val":1},{"column":54,"line":97,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:204:25","val":1},{"column":27,"line":214,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:204:25","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:148:28","val":1},{"column":24,"line":152,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:148:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":35,"line":152,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:148:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:148:28","val":1},{"column":18,"line":155,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:148:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":30,"line":155,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:148:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:148:28","val":1},{"column":46,"line":214,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:204:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:204:25","val":1},{"column":55,"line":99,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:218:25","val":1},{"column":27,"line":228,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:218:25","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:165:28","val":1},{"column":24,"line":169,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:165:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":35,"line":169,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:165:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:165:28","val":1},{"column":18,"line":172,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:165:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":30,"line":172,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:165:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:165:28","val":1},{"column":47,"line":228,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:218:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:218:25","val":1},{"column":54,"line":101,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:232:25","val":1},{"column":27,"line":242,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:232:25","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:182:28","val":1},{"column":24,"line":186,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:182:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6","val":1},{"column":35,"line":186,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:182:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:182:28","val":1},{"column":18,"line":189,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:182:28","target":"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31","val":1},{"column":30,"line":189,"source":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:182:28","target":"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:182:28","val":1},{"column":46,"line":242,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:232:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:232:25","val":1},{"column":24,"line":61,"source":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:33:25","target":"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:33:25","val":1}]'),ur={nodes:T,links:b},hr=Object.freeze(Object.defineProperty({__proto__:null,default:ur,links:b,nodes:T},Symbol.toStringTag,{value:"Module"})),pr=[{id:"/home/evan/Code/rinder/services/analytics/cmd/main.go:24:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:19:6",name:"NewAnalyticsRepository",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:24:31",name:"CreateSchema",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:19:6",name:"NewAnalyticsService",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:21:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:28:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:40:19",name:"healthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:53:19",name:"getOverallStats",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:199:28",name:"GetOverallStats",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:137:31",name:"GetOverallStats",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:69:19",name:"getDailyStats",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:204:28",name:"GetDailyStats",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:91:31",name:"GetDailyStats",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:93:19",name:"getEventCounts",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:211:28",name:"GetEventCounts",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:65:31",name:"GetEventCounts",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:109:19",name:"getRecentEvents",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:216:28",name:"GetRecentEvents",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:170:31",name:"GetRecentEvents",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/handler/handler.go:133:19",name:"getEventsByType",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:224:28",name:"GetEventsByType",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:196:31",name:"GetEventsByType",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:24:6",name:"NewEventConsumer",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:33:25",name:"Start",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:81:25",name:"registerHandlerForTopic",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:106:25",name:"handleUserCreated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:24:28",name:"RecordUserCreated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:223:6",name:"ToMetadata",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/repository/analytics_repository.go:49:31",name:"RecordEvent",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:120:25",name:"handleUserUpdated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:41:28",name:"RecordUserUpdated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:134:25",name:"handleProfileCreated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:58:28",name:"RecordProfileCreated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:148:25",name:"handleProfileUpdated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:75:28",name:"RecordProfileUpdated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:162:25",name:"handleProfileDeleted",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:92:28",name:"RecordProfileDeleted",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:176:25",name:"handleSwipeCreated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:109:28",name:"RecordSwipe",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:190:25",name:"handleMatchCreated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:131:28",name:"RecordMatchCreated",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:204:25",name:"handleMatchDeleted",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:148:28",name:"RecordMatchDeleted",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:218:25",name:"handleMediaUploaded",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:165:28",name:"RecordMediaUploaded",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/consumer/event_consumer.go:232:25",name:"handleMediaDeleted",node_type:"function"},{id:"/home/evan/Code/rinder/services/analytics/internal/service/analytics_service.go:182:28",name:"RecordMediaDeleted",node_type:"function"}],vr=Object.freeze(Object.defineProperty({__proto__:null,default:pr},Symbol.toStringTag,{value:"Module"})),w=11,S="service-matching",E="/home/evan/Code/rinder/services/matching",I="cmd/main.go",P="main",R="github.com/rinder",x=null,D="2026-01-21T10:23:07.436190382Z",N="2026-01-21T10:23:09.09657659Z",H="analyzing-completed",q=JSON.parse(`[{"id":226,"type":"http","method":"DELETE","path":"/api/v1/matches/","source_function_name":"RegisterRoutes","function_name":"handleMatchByID","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","outputs":[{"id":1352,"handler_id":226,"type":"database","label":"DELETE FROM matches WHERE id = $1","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:149:27","function_name":"DeleteMatch","description":"Delete the match row with the given match ID from the matches table.","created_at":"2026-01-30T08:57:33.621448956Z","updated_at":null},{"id":1349,"handler_id":226,"type":"database","label":"SELECT id, user1_id, user2_id, profile1_id, profile2_id, created_at, updated_at FROM matches WHERE id = $1","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:66:27","function_name":"GetMatchByID","description":"Lookup the match row by match ID to verify existence and retrieve user/profile IDs.","created_at":"2026-01-30T08:57:33.61628306Z","updated_at":null},{"id":1355,"handler_id":226,"type":"event","label":"Publish MatchDeleted event to Kafka (TopicMatchDeleted, EventMatchDeleted)","function_id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:358:27","function_name":"publishUnmatchEvent","description":"After a successful delete, the service publishes an unmatch event containing match ID, user IDs, profile IDs and a timestamp to the configured event producer (Kafka topic TopicMatchDeleted with event type EventMatchDeleted).","created_at":"2026-01-30T08:57:33.62681022Z","updated_at":null},{"id":1356,"handler_id":226,"type":"http_response","label":"HTTP 200 response (Successfully unmatched)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","function_name":"unmatch","description":"On successful deletion and (attempted) event publish, the handler returns an HTTP 200 OK response with a JSON body {\\"message\\": \\"Successfully unmatched\\"} to the client.","created_at":"2026-01-30T08:57:33.629329239Z","updated_at":null},{"id":1348,"handler_id":226,"type":"http_response","label":"HTTP 400 response (Method not allowed)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","function_name":"handleMatchByID","description":"If the HTTP method is not DELETE, the handler returns an HTTP 400 Bad Request (method not allowed) response to the client.","created_at":"2026-01-30T08:57:33.614167962Z","updated_at":null},{"id":1347,"handler_id":226,"type":"http_response","label":"HTTP 401 response (User not authenticated)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","function_name":"handleMatchByID","description":"If the X-User-ID header is missing or empty, the handler returns an HTTP 401 Unauthorized error to the client.","created_at":"2026-01-30T08:57:33.611193146Z","updated_at":null},{"id":1351,"handler_id":226,"type":"http_response","label":"HTTP 403 response (Not authorized to unmatch)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","function_name":"unmatch","description":"If the match exists but the requesting user is neither user1 nor user2 on the match, the service returns an HTTP 403 Forbidden response to the client.","created_at":"2026-01-30T08:57:33.619892727Z","updated_at":null},{"id":1353,"handler_id":226,"type":"http_response","label":"HTTP 404 response (Match not found) - delete affected 0 rows","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","function_name":"unmatch","description":"If the DELETE query reports 0 rows affected, the service treats this as the match not existing and returns HTTP 404 Not Found to the client.","created_at":"2026-01-30T08:57:33.623485187Z","updated_at":null},{"id":1350,"handler_id":226,"type":"http_response","label":"HTTP 404 response (Match not found) - match missing","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","function_name":"unmatch","description":"If the match repository returns no row for the given match ID, the service returns an HTTP 404 Not Found response to the client.","created_at":"2026-01-30T08:57:33.618245406Z","updated_at":null},{"id":1346,"handler_id":226,"type":"http_response","label":"HTTP 404 response (Match not found) - path invalid","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","function_name":"handleMatchByID","description":"If the request path after /api/v1/matches/ is empty or contains additional slashes, the handler returns an HTTP 404 Not Found error to the client.","created_at":"2026-01-30T08:57:33.595963702Z","updated_at":null},{"id":1354,"handler_id":226,"type":"http_response","label":"HTTP 500 response (Failed to unmatch)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","function_name":"unmatch","description":"If repository operations (SELECT or DELETE) or other server-side errors occur that are not specifically classified as 'not found' or 'not authorized', the handler returns HTTP 500 Internal Server Error to the client.","created_at":"2026-01-30T08:57:33.625199579Z","updated_at":null}],"created_at":"2026-01-30T08:56:32.866578142Z","updated_at":null},{"id":225,"type":"http","method":"GET","path":"/api/v1/matches","source_function_name":"RegisterRoutes","function_name":"handleMatches","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","outputs":[{"id":1338,"handler_id":225,"type":"database","label":"SELECT id, user1_id, user2_id, profile1_id, profile2_id, created_at, updated_at FROM matches WHERE user1_id = $1 OR user2_id = $1 ORDER BY created_at DESC","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:94:27","function_name":"GetMatchesByUserID","description":"Query executed to retrieve all match records for the given user ID (user appears as user1 or user2). This is performed by MatchRepository.GetMatchesByUserID via r.db.Query(query, userID).","created_at":"2026-01-30T08:57:15.566280102Z","updated_at":null},{"id":1340,"handler_id":225,"type":"http","label":"HTTP GET /api/v1/profiles/{profileID}","function_id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","function_name":"getProfileInfo","description":"For each match record, the service issues an HTTP GET request to the profiles service to fetch profile details for the matched profile ID (s.profileClient.Get(ctx, fmt.Sprintf(\\"/api/v1/profiles/%s\\", profileID), nil)). This request is performed once per match (i.e., may be multiple such calls depending on number of matches).","created_at":"2026-01-30T08:57:15.570358395Z","updated_at":null},{"id":1344,"handler_id":225,"type":"http_response","label":"HTTP 200 JSON response (OK with matches array)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","function_name":"handleMatches","description":"On success, the handler returns an HTTP 200 response containing the JSON array of match responses (each includes matched user info and matched timestamp). If there are no matches, an empty array is returned.","created_at":"2026-01-30T08:57:15.575474824Z","updated_at":null},{"id":1334,"handler_id":225,"type":"http_response","label":"HTTP 400 JSON response (Method not allowed)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","function_name":"handleMatches","description":"If the incoming request method is not GET, the handler returns an HTTP error response (bad request) to the client.","created_at":"2026-01-30T08:57:15.546654681Z","updated_at":null},{"id":1336,"handler_id":225,"type":"http_response","label":"HTTP 401 JSON response (User not authenticated)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","function_name":"handleMatches","description":"If the X-User-ID header is missing, the handler returns an HTTP unauthorized error response to the client.","created_at":"2026-01-30T08:57:15.562742605Z","updated_at":null},{"id":1342,"handler_id":225,"type":"http_response","label":"HTTP 500 JSON response (Failed to get matches)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","function_name":"handleMatches","description":"If retrieving matches from the repository returns an error, the handler returns an HTTP internal server error response to the client.","created_at":"2026-01-30T08:57:15.572890884Z","updated_at":null}],"created_at":"2026-01-30T08:56:32.865285607Z","updated_at":null},{"id":224,"type":"http","method":"GET","path":"/api/v1/swipe/queue","source_function_name":"RegisterRoutes","function_name":"GetSwipeQueue","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","outputs":[{"id":1335,"handler_id":224,"type":"database","label":"REDIS SCAN keys pattern \\"swipe:{userID}:*\\"","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","function_name":"GetSwipedProfiles","description":"Scans Redis keys to find owner IDs that the given user has already swiped on (pattern: swipe:{swiper}:{owner}).","created_at":"2026-01-30T08:57:15.546982179Z","updated_at":null},{"id":1337,"handler_id":224,"type":"http","label":"HTTP GET /api/v1/profiles?exclude_user={userID}&limit={limit}","function_id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","function_name":"fetchSwipeQueue","description":"An HTTP GET request is made to the profile service to fetch candidate profiles (query params exclude_user and limit).","created_at":"2026-01-30T08:57:15.564502963Z","updated_at":null},{"id":1339,"handler_id":224,"type":"http_response","label":"HTTP 200 JSON response (swipe queue)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","function_name":"GetSwipeQueue","description":"On success the handler returns an HTTP 200 response containing the list of swipe queue profiles as JSON.","created_at":"2026-01-30T08:57:15.568364397Z","updated_at":null},{"id":1341,"handler_id":224,"type":"http_response","label":"HTTP 400 Bad Request (Method not allowed)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","function_name":"GetSwipeQueue","description":"If the incoming request method is not GET, the handler returns an HTTP 400 Bad Request response.","created_at":"2026-01-30T08:57:15.571686817Z","updated_at":null},{"id":1343,"handler_id":224,"type":"http_response","label":"HTTP 401 Unauthorized (User not authenticated)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","function_name":"GetSwipeQueue","description":"If the X-User-ID header is missing, the handler returns an HTTP 401 Unauthorized response.","created_at":"2026-01-30T08:57:15.574236399Z","updated_at":null},{"id":1345,"handler_id":224,"type":"http_response","label":"HTTP 500 Internal Server Error (Failed to get swipe queue)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","function_name":"GetSwipeQueue","description":"If fetching the swipe queue fails (for example the profile service call fails or unmarshalling fails), the handler returns an HTTP 500 Internal Server Error response.","created_at":"2026-01-30T08:57:15.576620559Z","updated_at":null}],"created_at":"2026-01-30T08:56:32.864076997Z","updated_at":null},{"id":222,"type":"http","method":"GET","path":"/health","source_function_name":"RegisterRoutes","function_name":"Health","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","outputs":[{"id":1333,"handler_id":222,"type":"http_response","label":"HTTP 200 JSON response","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","function_name":"Health","description":"An HTTP 200 response is written to the client with a JSON body: {\\"status\\":\\"healthy\\",\\"service\\":\\"matching\\"}.","created_at":"2026-01-30T08:56:48.521761456Z","updated_at":null}],"created_at":"2026-01-30T08:56:32.859541007Z","updated_at":null},{"id":223,"type":"http","method":"POST","path":"/api/v1/swipe","source_function_name":"RegisterRoutes","function_name":"Swipe","source_function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","outputs":[{"id":1375,"handler_id":223,"type":"database","label":"INSERT INTO matches (...) RETURNING ...","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:23:27","function_name":"CreateMatch","description":"When creating a new match, insert a row into the matches table and return the created row (INSERT ... RETURNING).","created_at":"2026-01-30T08:57:45.485355467Z","updated_at":null},{"id":1371,"handler_id":223,"type":"database","label":"INSERT INTO swipes (id, swiper_id, profile_id, owner_id, direction, created_at) ... ON CONFLICT (swiper_id, profile_id) DO UPDATE ...","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:182:27","function_name":"RecordSwipeInDB","description":"Attempt to record the swipe into PostgreSQL for history/analytics (INSERT ... ON CONFLICT DO UPDATE). This is attempted for every swipe but failure does not abort the overall operation.","created_at":"2026-01-30T08:57:45.478502047Z","updated_at":null},{"id":1373,"handler_id":223,"type":"database","label":"SELECT EXISTS(...) FROM matches WHERE (user1_id = $1 AND user2_id = $2) OR (user1_id = $2 AND user2_id = $1)","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","function_name":"MatchExists","description":"If a mutual like is detected, check in PostgreSQL whether a match already exists between the two users (boolean EXISTS query).","created_at":"2026-01-30T08:57:45.481734106Z","updated_at":null},{"id":1376,"handler_id":223,"type":"event","label":"Publish Kafka event to TopicMatchCreated (EventMatchCreated)","function_id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:341:27","function_name":"publishMatchEvent","description":"When a match is created, publish a match-created event to Kafka on the TopicMatchCreated with the match payload (MatchEvent).","created_at":"2026-01-30T08:57:45.487033631Z","updated_at":null},{"id":1377,"handler_id":223,"type":"event","label":"Publish Kafka event to TopicSwipeCreated (EventSwipeLeft or EventSwipeRight)","function_id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:319:27","function_name":"publishSwipeEvent","description":"After processing any swipe, publish a swipe-created event to Kafka on the TopicSwipeCreated with the swipe payload (SwipeEvent). The event type is EventSwipeRight for likes or EventSwipeLeft for left swipes.","created_at":"2026-01-30T08:57:45.488472971Z","updated_at":null},{"id":1374,"handler_id":223,"type":"http","label":"HTTP GET /api/v1/profiles/user/{userID}","function_id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","function_name":"getSwiperProfile","description":"If creating a match, the service calls the profile service to fetch the swiper's profile(s) via an HTTP GET to /api/v1/profiles/user/{userID} to obtain a profile ID for the match.","created_at":"2026-01-30T08:57:45.483777903Z","updated_at":null},{"id":1366,"handler_id":223,"type":"http_response","label":"HTTP 201 Created (SwipeResponse returned)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","function_name":"Swipe","description":"On success the handler returns an HTTP 201 Created response to the client containing the SwipeResponse (swipe object and match info if any).","created_at":"2026-01-30T08:57:45.473465066Z","updated_at":null},{"id":1362,"handler_id":223,"type":"http_response","label":"HTTP 400 Bad Request (Direction must be 'right' or 'left')","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","function_name":"Swipe","description":"If the parsed request's Direction is not 'right' or 'left', the handler returns a 400 Bad Request response to the client.","created_at":"2026-01-30T08:57:45.46721224Z","updated_at":null},{"id":1359,"handler_id":223,"type":"http_response","label":"HTTP 400 Bad Request (Invalid request body)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","function_name":"Swipe","description":"If the request body cannot be decoded as the expected JSON, the handler returns a 400 Bad Request response to the client.","created_at":"2026-01-30T08:57:45.46285512Z","updated_at":null},{"id":1357,"handler_id":223,"type":"http_response","label":"HTTP 400 Bad Request (Method not allowed)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","function_name":"Swipe","description":"If the incoming HTTP method is not POST, the handler returns a 400 Bad Request response to the client.","created_at":"2026-01-30T08:57:45.444385075Z","updated_at":null},{"id":1361,"handler_id":223,"type":"http_response","label":"HTTP 400 Bad Request (Owner ID is required)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","function_name":"Swipe","description":"If the parsed request has an empty OwnerID, the handler returns a 400 Bad Request response to the client.","created_at":"2026-01-30T08:57:45.465872502Z","updated_at":null},{"id":1360,"handler_id":223,"type":"http_response","label":"HTTP 400 Bad Request (Profile ID is required)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","function_name":"Swipe","description":"If the parsed request has an empty ProfileID, the handler returns a 400 Bad Request response to the client.","created_at":"2026-01-30T08:57:45.464467359Z","updated_at":null},{"id":1358,"handler_id":223,"type":"http_response","label":"HTTP 401 Unauthorized (User not authenticated)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","function_name":"Swipe","description":"If the X-User-ID header is missing, the handler returns a 401 Unauthorized response to the client.","created_at":"2026-01-30T08:57:45.460439449Z","updated_at":null},{"id":1364,"handler_id":223,"type":"http_response","label":"HTTP 409 Conflict (already swiped on this profile)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","function_name":"Swipe","description":"If the service reports that the user has already swiped on this profile, the handler returns a 409 Conflict response to the client.","created_at":"2026-01-30T08:57:45.47052544Z","updated_at":null},{"id":1365,"handler_id":223,"type":"http_response","label":"HTTP 500 Internal Server Error (Failed to process swipe)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","function_name":"Swipe","description":"If an unexpected error occurs while processing the swipe, the handler returns a 500 Internal Server Error response to the client.","created_at":"2026-01-30T08:57:45.472272667Z","updated_at":null},{"id":1370,"handler_id":223,"type":"other","label":"Redis EXPIRE likes:<ownerID> 30d","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","function_name":"RecordSwipe","description":"If the swipe is a right like, set/reset the expiry on the likes set (likes:<ownerID>) to 30 days in Redis. This is conditional on direction == 'right'.","created_at":"2026-01-30T08:57:45.477512361Z","updated_at":null},{"id":1372,"handler_id":223,"type":"other","label":"Redis GET swipe:<likerID>:<likedID> (HasLiked)","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","function_name":"HasLiked","description":"When processing a right-swipe, check whether the other user has already liked this user by reading swipe:<likerID>:<likedID> from Redis (used to detect mutual like).","created_at":"2026-01-30T08:57:45.479865822Z","updated_at":null},{"id":1367,"handler_id":223,"type":"other","label":"Redis GET swipe:<swiperID>:<ownerID>","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","function_name":"GetSwipe","description":"Check whether a swipe already exists by fetching the key swipe:<swiperID>:<ownerID> from Redis.","created_at":"2026-01-30T08:57:45.474385364Z","updated_at":null},{"id":1369,"handler_id":223,"type":"other","label":"Redis SADD likes:<ownerID> <- swiperID","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","function_name":"RecordSwipe","description":"If the swipe direction is 'right' (a like), add the swiperID to the likes set for the owner (likes:<ownerID>) in Redis. This is conditional on direction == 'right'.","created_at":"2026-01-30T08:57:45.476404463Z","updated_at":null},{"id":1368,"handler_id":223,"type":"other","label":"Redis SET swipe:<swiperID>:<ownerID> = <direction> EX 30d","function_id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","function_name":"RecordSwipe","description":"Record the swipe in Redis with a 30-day expiry (key swipe:<swiperID>:<ownerID> set to 'right' or 'left'). This is performed for every swipe.","created_at":"2026-01-30T08:57:45.475353266Z","updated_at":null},{"id":1363,"handler_id":223,"type":"other","label":"internal validation: cannot swipe on your own profile (error returned)","function_id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","function_name":"Swipe","description":"If the service detects the swiper is the owner (swiperID == ownerID), it returns an error which the handler turns into a 400 Bad Request response to the client.","created_at":"2026-01-30T08:57:45.468728313Z","updated_at":null}],"created_at":"2026-01-30T08:56:32.862487013Z","updated_at":null}]`),mr={id:w,name:S,git_repo_url:E,entrypoint_path:I,entrypoint_function:P,git_org_url:R,git_commit:x,created_at:D,updated_at:N,status:H,handlers:q},_r=Object.freeze(Object.defineProperty({__proto__:null,created_at:D,default:mr,entrypoint_function:P,entrypoint_path:I,git_commit:x,git_org_url:R,git_repo_url:E,handlers:q,id:w,name:S,status:H,updated_at:N},Symbol.toStringTag,{value:"Module"})),k=JSON.parse('[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"matching\\", 8083)\\n\\tkafkaCfg := config.NewKafkaConfig(\\"matching-service\\")\\n\\n\\t// Database config\\n\\tdbHost := config.GetEnv(\\"DB_HOST\\", \\"localhost\\")\\n\\tdbPort := config.GetEnv(\\"DB_PORT\\", \\"5433\\")\\n\\tdbUser := config.GetEnv(\\"DB_USER\\", \\"rinder\\")\\n\\tdbPassword := config.GetEnv(\\"DB_PASSWORD\\", \\"rinder123\\")\\n\\tdbName := config.GetEnv(\\"DB_NAME\\", \\"rinder_matching\\")\\n\\n\\t// Redis config\\n\\tredisHost := config.GetEnv(\\"REDIS_HOST\\", \\"localhost\\")\\n\\tredisPort := config.GetEnv(\\"REDIS_PORT\\", \\"6379\\")\\n\\n\\t// Profile service URL\\n\\tprofileServiceURL := config.GetEnv(\\"PROFILE_SERVICE_URL\\", \\"http://localhost:8082\\")\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting matching service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t)\\n\\n\\t// Connect to PostgreSQL\\n\\tdsn := fmt.Sprintf(\\"host=%s port=%s user=%s password=%s dbname=%s sslmode=disable\\",\\n\\t\\tdbHost, dbPort, dbUser, dbPassword, dbName)\\n\\n\\tdb, err := sql.Open(\\"postgres\\", dsn)\\n\\tif err != nil {\\n\\t\\tlogger.Fatal(\\"failed to connect to database\\", zap.Error(err))\\n\\t}\\n\\tdefer db.Close()\\n\\n\\t// Verify connection\\n\\tif err := db.Ping(); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to ping database\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"connected to PostgreSQL\\")\\n\\n\\t// Run migrations\\n\\tif err := runMigrations(db); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to run migrations\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"database migrations complete\\")\\n\\n\\t// Connect to Redis\\n\\tredisClient := redis.NewClient(&redis.Options{\\n\\t\\tAddr:     fmt.Sprintf(\\"%s:%s\\", redisHost, redisPort),\\n\\t\\tPassword: \\"\\",\\n\\t\\tDB:       0,\\n\\t})\\n\\n\\t// Verify Redis connection\\n\\tctx := context.Background()\\n\\tif err := redisClient.Ping(ctx).Err(); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to connect to Redis\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"connected to Redis\\")\\n\\tdefer redisClient.Close()\\n\\n\\t// Initialize Kafka producer\\n\\tproducer := kafka.NewProducer(kafkaCfg.Brokers, cfg.Name)\\n\\tdefer producer.Close()\\n\\n\\t// Initialize repositories\\n\\tswipeRepo := repository.NewSwipeRepository(redisClient)\\n\\tmatchRepo := repository.NewMatchRepository(db)\\n\\n\\t// Initialize service\\n\\tmatchingService := service.NewMatchingService(swipeRepo, matchRepo, producer, profileServiceURL)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(matchingService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  15 * time.Second,\\n\\t\\tWriteTimeout: 15 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server in goroutine\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"matching service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Graceful shutdown\\n\\tshutdownCtx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer cancel()\\n\\n\\tif err := server.Shutdown(shutdownCtx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server stopped\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","name":"ROOT","node_type":"function"},{"code":"func runMigrations(db *sql.DB) error {\\n\\tmigrations := []string{\\n\\t\\t`CREATE TABLE IF NOT EXISTS matches (\\n\\t\\t\\tid VARCHAR(36) PRIMARY KEY,\\n\\t\\t\\tuser1_id VARCHAR(36) NOT NULL,\\n\\t\\t\\tuser2_id VARCHAR(36) NOT NULL,\\n\\t\\t\\tprofile1_id VARCHAR(36),\\n\\t\\t\\tprofile2_id VARCHAR(36),\\n\\t\\t\\tcreated_at TIMESTAMP NOT NULL DEFAULT NOW(),\\n\\t\\t\\tupdated_at TIMESTAMP NOT NULL DEFAULT NOW(),\\n\\t\\t\\tUNIQUE(user1_id, user2_id)\\n\\t\\t)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_matches_user1 ON matches(user1_id)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_matches_user2 ON matches(user2_id)`,\\n\\t\\t`CREATE TABLE IF NOT EXISTS swipes (\\n\\t\\t\\tid VARCHAR(36) PRIMARY KEY,\\n\\t\\t\\tswiper_id VARCHAR(36) NOT NULL,\\n\\t\\t\\tprofile_id VARCHAR(36) NOT NULL,\\n\\t\\t\\towner_id VARCHAR(36) NOT NULL,\\n\\t\\t\\tdirection VARCHAR(10) NOT NULL,\\n\\t\\t\\tcreated_at TIMESTAMP NOT NULL DEFAULT NOW(),\\n\\t\\t\\tUNIQUE(swiper_id, profile_id)\\n\\t\\t)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_swipes_swiper ON swipes(swiper_id)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_swipes_owner ON swipes(owner_id)`,\\n\\t}\\n\\n\\tfor _, migration := range migrations {\\n\\t\\tif _, err := db.Exec(migration); err != nil {\\n\\t\\t\\treturn fmt.Errorf(\\"migration failed: %w\\", err)\\n\\t\\t}\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/cmd/main.go:146:6","name":"runMigrations","node_type":"function"},{"code":"func NewSwipeRepository(client *redis.Client) *SwipeRepository {\\n\\treturn &SwipeRepository{client: client}\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:17:6","name":"NewSwipeRepository","node_type":"function"},{"code":"func NewMatchRepository(db *sql.DB) *MatchRepository {\\n\\treturn &MatchRepository{db: db}\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:18:6","name":"NewMatchRepository","node_type":"function"},{"code":"func NewMatchingService(\\n\\tswipeRepo *repository.SwipeRepository,\\n\\tmatchRepo *repository.MatchRepository,\\n\\tproducer *kafka.Producer,\\n\\tprofileServiceURL string,\\n) *MatchingService {\\n\\treturn &MatchingService{\\n\\t\\tswipeRepo:     swipeRepo,\\n\\t\\tmatchRepo:     matchRepo,\\n\\t\\tproducer:      producer,\\n\\t\\tprofileClient: httpclient.NewClient(profileServiceURL, \\"profile-service\\", 10*time.Second),\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:27:6","name":"NewMatchingService","node_type":"function"},{"code":"func NewHandler(matchingService *service.MatchingService) *Handler {\\n\\treturn &Handler{\\n\\t\\tmatchingService: matchingService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:21:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\tmux.HandleFunc(\\"/health\\", h.Health)\\n\\tmux.HandleFunc(\\"/api/v1/swipe\\", h.Swipe)\\n\\tmux.HandleFunc(\\"/api/v1/swipe/queue\\", h.GetSwipeQueue)\\n\\tmux.HandleFunc(\\"/api/v1/matches\\", h.handleMatches)\\n\\tmux.HandleFunc(\\"/api/v1/matches/\\", h.handleMatchByID)\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) Health(w http.ResponseWriter, r *http.Request) {\\n\\tresponse.JSON(w, http.StatusOK, map[string]string{\\n\\t\\t\\"status\\":  \\"healthy\\",\\n\\t\\t\\"service\\": \\"matching\\",\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","name":"Health","node_type":"function"},{"code":"func (h *Handler) Swipe(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Get user ID from header (set by gateway)\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"User not authenticated\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Parse request\\n\\tvar req SwipeRequestWithOwner\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Invalid request body\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Validate\\n\\tif req.ProfileID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Profile ID is required\\"))\\n\\t\\treturn\\n\\t}\\n\\tif req.OwnerID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Owner ID is required\\"))\\n\\t\\treturn\\n\\t}\\n\\tif req.Direction != model.SwipeRight && req.Direction != model.SwipeLeft {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Direction must be \'right\' or \'left\'\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Process swipe\\n\\tresult, err := h.matchingService.Swipe(r.Context(), userID, req.ProfileID, req.OwnerID, req.Direction)\\n\\tif err != nil {\\n\\t\\tif strings.Contains(err.Error(), \\"cannot swipe on your own\\") {\\n\\t\\t\\tresponse.Error(w, errors.BadRequest(err.Error()))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tif strings.Contains(err.Error(), \\"already swiped\\") {\\n\\t\\t\\tresponse.Error(w, errors.Conflict(err.Error()))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to process swipe\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.Created(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","name":"Swipe","node_type":"function"},{"code":"func (s *MatchingService) Swipe(ctx context.Context, swiperID, profileID, ownerID string, direction model.SwipeDirection) (*model.SwipeResponse, error) {\\n\\t// Don\'t allow users to swipe on their own profiles\\n\\tif swiperID == ownerID {\\n\\t\\treturn nil, fmt.Errorf(\\"cannot swipe on your own profile\\")\\n\\t}\\n\\n\\t// Check if already swiped\\n\\texistingSwipe, err := s.swipeRepo.GetSwipe(ctx, swiperID, ownerID)\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to check existing swipe: %w\\", err)\\n\\t}\\n\\tif existingSwipe != \\"\\" {\\n\\t\\treturn nil, fmt.Errorf(\\"already swiped on this profile\\")\\n\\t}\\n\\n\\t// Record swipe in Redis (fast)\\n\\terr = s.swipeRepo.RecordSwipe(ctx, swiperID, ownerID, string(direction))\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to record swipe: %w\\", err)\\n\\t}\\n\\n\\t// Create swipe object\\n\\tswipe := &model.Swipe{\\n\\t\\tID:        uuid.New().String(),\\n\\t\\tSwiperID:  swiperID,\\n\\t\\tProfileID: profileID,\\n\\t\\tOwnerID:   ownerID,\\n\\t\\tDirection: direction,\\n\\t\\tCreatedAt: time.Now(),\\n\\t}\\n\\n\\t// Also record in PostgreSQL for history/analytics\\n\\terr = s.matchRepo.RecordSwipeInDB(swipe)\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"failed to record swipe in DB\\", zap.Error(err))\\n\\t\\t// Don\'t fail the swipe if DB recording fails\\n\\t}\\n\\n\\tresponse := &model.SwipeResponse{\\n\\t\\tSwipe:   swipe,\\n\\t\\tIsMatch: false,\\n\\t}\\n\\n\\t// If it\'s a like, check for mutual match\\n\\tif direction == model.SwipeRight {\\n\\t\\t// Check if the other user has already liked this user\\n\\t\\tisMutual, err := s.swipeRepo.CheckMutualLike(ctx, swiperID, ownerID)\\n\\t\\tif err != nil {\\n\\t\\t\\tlogger.Error(\\"failed to check mutual like\\", zap.Error(err))\\n\\t\\t}\\n\\n\\t\\tif isMutual {\\n\\t\\t\\t// Check if match already exists\\n\\t\\t\\texists, err := s.matchRepo.MatchExists(swiperID, ownerID)\\n\\t\\t\\tif err != nil {\\n\\t\\t\\t\\tlogger.Error(\\"failed to check match exists\\", zap.Error(err))\\n\\t\\t\\t}\\n\\n\\t\\t\\tif !exists {\\n\\t\\t\\t\\t// Get the profile that the other user liked (swiper\'s profile)\\n\\t\\t\\t\\tswiperProfileID, err := s.getSwiperProfile(ctx, swiperID)\\n\\t\\t\\t\\tif err != nil {\\n\\t\\t\\t\\t\\tlogger.Error(\\"failed to get swiper profile\\", zap.Error(err))\\n\\t\\t\\t\\t\\tswiperProfileID = \\"\\" // Continue without profile ID\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t// Create match!\\n\\t\\t\\t\\tmatch, err := s.matchRepo.CreateMatch(swiperID, ownerID, swiperProfileID, profileID)\\n\\t\\t\\t\\tif err != nil {\\n\\t\\t\\t\\t\\treturn nil, fmt.Errorf(\\"failed to create match: %w\\", err)\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tresponse.IsMatch = true\\n\\t\\t\\t\\tresponse.Match = match\\n\\n\\t\\t\\t\\t// Publish match event\\n\\t\\t\\t\\ts.publishMatchEvent(ctx, match)\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\n\\t// Publish swipe event\\n\\ts.publishSwipeEvent(ctx, swipe)\\n\\n\\treturn response, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","name":"Swipe","node_type":"function"},{"code":"func (r *SwipeRepository) GetSwipe(ctx context.Context, swiperID, ownerID string) (string, error) {\\n\\tkey := fmt.Sprintf(\\"swipe:%s:%s\\", swiperID, ownerID)\\n\\n\\tdirection, err := r.client.Get(ctx, key).Result()\\n\\tif err == redis.Nil {\\n\\t\\treturn \\"\\", nil // No swipe found\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn \\"\\", fmt.Errorf(\\"failed to get swipe: %w\\", err)\\n\\t}\\n\\n\\treturn direction, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","name":"GetSwipe","node_type":"function"},{"code":"func (r *SwipeRepository) RecordSwipe(ctx context.Context, swiperID, ownerID, direction string) error {\\n\\tkey := fmt.Sprintf(\\"swipe:%s:%s\\", swiperID, ownerID)\\n\\n\\t// Store swipe with 30-day expiry\\n\\terr := r.client.Set(ctx, key, direction, 30*24*time.Hour).Err()\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to record swipe: %w\\", err)\\n\\t}\\n\\n\\t// If it\'s a right swipe (like), add to the likes set\\n\\tif direction == \\"right\\" {\\n\\t\\tlikesKey := fmt.Sprintf(\\"likes:%s\\", ownerID)\\n\\t\\terr = r.client.SAdd(ctx, likesKey, swiperID).Err()\\n\\t\\tif err != nil {\\n\\t\\t\\treturn fmt.Errorf(\\"failed to add to likes set: %w\\", err)\\n\\t\\t}\\n\\t\\t// Set expiry on likes set\\n\\t\\tr.client.Expire(ctx, likesKey, 30*24*time.Hour)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","name":"RecordSwipe","node_type":"function"},{"code":"func (r *MatchRepository) RecordSwipeInDB(swipe *model.Swipe) error {\\n\\tquery := `\\n\\t\\tINSERT INTO swipes (id, swiper_id, profile_id, owner_id, direction, created_at)\\n\\t\\tVALUES ($1, $2, $3, $4, $5, $6)\\n\\t\\tON CONFLICT (swiper_id, profile_id) DO UPDATE SET direction = $4, created_at = $6\\n\\t`\\n\\n\\t_, err := r.db.Exec(\\n\\t\\tquery,\\n\\t\\tswipe.ID,\\n\\t\\tswipe.SwiperID,\\n\\t\\tswipe.ProfileID,\\n\\t\\tswipe.OwnerID,\\n\\t\\tswipe.Direction,\\n\\t\\tswipe.CreatedAt,\\n\\t)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to record swipe in DB: %w\\", err)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:182:27","name":"RecordSwipeInDB","node_type":"function"},{"code":"func (r *SwipeRepository) CheckMutualLike(ctx context.Context, user1ID, user2ID string) (bool, error) {\\n\\t// Check if user2 has already liked user1\\n\\tliked, err := r.HasLiked(ctx, user2ID, user1ID)\\n\\tif err != nil {\\n\\t\\treturn false, err\\n\\t}\\n\\treturn liked, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","name":"CheckMutualLike","node_type":"function"},{"code":"func (r *SwipeRepository) HasLiked(ctx context.Context, likerID, likedID string) (bool, error) {\\n\\tkey := fmt.Sprintf(\\"swipe:%s:%s\\", likerID, likedID)\\n\\n\\tdirection, err := r.client.Get(ctx, key).Result()\\n\\tif err == redis.Nil {\\n\\t\\treturn false, nil\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn false, fmt.Errorf(\\"failed to check like: %w\\", err)\\n\\t}\\n\\n\\treturn direction == \\"right\\", nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","name":"HasLiked","node_type":"function"},{"code":"func (r *MatchRepository) MatchExists(user1ID, user2ID string) (bool, error) {\\n\\tquery := `\\n\\t\\tSELECT EXISTS(\\n\\t\\t\\tSELECT 1 FROM matches\\n\\t\\t\\tWHERE (user1_id = $1 AND user2_id = $2)\\n\\t\\t\\t   OR (user1_id = $2 AND user2_id = $1)\\n\\t\\t)\\n\\t`\\n\\n\\tvar exists bool\\n\\terr := r.db.QueryRow(query, user1ID, user2ID).Scan(&exists)\\n\\tif err != nil {\\n\\t\\treturn false, fmt.Errorf(\\"failed to check match exists: %w\\", err)\\n\\t}\\n\\n\\treturn exists, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","name":"MatchExists","node_type":"function"},{"code":"func (s *MatchingService) getSwiperProfile(ctx context.Context, userID string) (string, error) {\\n\\t// Call profile service to get user\'s profiles\\n\\tresp, err := s.profileClient.Get(ctx, fmt.Sprintf(\\"/api/v1/profiles/user/%s\\", userID), nil)\\n\\tif err != nil {\\n\\t\\treturn \\"\\", err\\n\\t}\\n\\n\\tvar result struct {\\n\\t\\tSuccess bool `json:\\"success\\"`\\n\\t\\tData    []struct {\\n\\t\\t\\tID string `json:\\"id\\"`\\n\\t\\t} `json:\\"data\\"`\\n\\t}\\n\\tif err := json.Unmarshal(resp.Body, &result); err != nil {\\n\\t\\treturn \\"\\", err\\n\\t}\\n\\n\\tif !result.Success || len(result.Data) == 0 {\\n\\t\\treturn \\"\\", fmt.Errorf(\\"no profiles found\\")\\n\\t}\\n\\n\\treturn result.Data[0].ID, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","name":"getSwiperProfile","node_type":"function"},{"code":"func (r *MatchRepository) CreateMatch(user1ID, user2ID, profile1ID, profile2ID string) (*model.Match, error) {\\n\\tmatch := &model.Match{\\n\\t\\tID:         uuid.New().String(),\\n\\t\\tUser1ID:    user1ID,\\n\\t\\tUser2ID:    user2ID,\\n\\t\\tProfile1ID: profile1ID,\\n\\t\\tProfile2ID: profile2ID,\\n\\t\\tCreatedAt:  time.Now(),\\n\\t\\tUpdatedAt:  time.Now(),\\n\\t}\\n\\n\\tquery := `\\n\\t\\tINSERT INTO matches (id, user1_id, user2_id, profile1_id, profile2_id, created_at, updated_at)\\n\\t\\tVALUES ($1, $2, $3, $4, $5, $6, $7)\\n\\t\\tRETURNING id, user1_id, user2_id, profile1_id, profile2_id, created_at, updated_at\\n\\t`\\n\\n\\terr := r.db.QueryRow(\\n\\t\\tquery,\\n\\t\\tmatch.ID,\\n\\t\\tmatch.User1ID,\\n\\t\\tmatch.User2ID,\\n\\t\\tmatch.Profile1ID,\\n\\t\\tmatch.Profile2ID,\\n\\t\\tmatch.CreatedAt,\\n\\t\\tmatch.UpdatedAt,\\n\\t).Scan(\\n\\t\\t&match.ID,\\n\\t\\t&match.User1ID,\\n\\t\\t&match.User2ID,\\n\\t\\t&match.Profile1ID,\\n\\t\\t&match.Profile2ID,\\n\\t\\t&match.CreatedAt,\\n\\t\\t&match.UpdatedAt,\\n\\t)\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to create match: %w\\", err)\\n\\t}\\n\\n\\treturn match, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:23:27","name":"CreateMatch","node_type":"function"},{"code":"func (s *MatchingService) publishMatchEvent(ctx context.Context, match *model.Match) {\\n\\tevent := model.MatchEvent{\\n\\t\\tEventType:  kafka.EventMatchCreated,\\n\\t\\tMatchID:    match.ID,\\n\\t\\tUser1ID:    match.User1ID,\\n\\t\\tUser2ID:    match.User2ID,\\n\\t\\tProfile1ID: match.Profile1ID,\\n\\t\\tProfile2ID: match.Profile2ID,\\n\\t\\tTimestamp:  match.CreatedAt.Format(time.RFC3339),\\n\\t}\\n\\n\\tif err := s.producer.Publish(ctx, kafka.TopicMatchCreated, kafka.EventMatchCreated, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish match event\\", zap.Error(err))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:341:27","name":"publishMatchEvent","node_type":"function"},{"code":"func (s *MatchingService) publishSwipeEvent(ctx context.Context, swipe *model.Swipe) {\\n\\teventType := kafka.EventSwipeRight\\n\\tif swipe.Direction == model.SwipeLeft {\\n\\t\\teventType = kafka.EventSwipeLeft\\n\\t}\\n\\n\\tevent := model.SwipeEvent{\\n\\t\\tEventType: eventType,\\n\\t\\tSwipeID:   swipe.ID,\\n\\t\\tSwiperID:  swipe.SwiperID,\\n\\t\\tProfileID: swipe.ProfileID,\\n\\t\\tOwnerID:   swipe.OwnerID,\\n\\t\\tDirection: string(swipe.Direction),\\n\\t\\tTimestamp: swipe.CreatedAt.Format(time.RFC3339),\\n\\t}\\n\\n\\tif err := s.producer.Publish(ctx, kafka.TopicSwipeCreated, eventType, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish swipe event\\", zap.Error(err))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:319:27","name":"publishSwipeEvent","node_type":"function"},{"code":"func (h *Handler) GetSwipeQueue(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Get user ID from header\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"User not authenticated\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Parse limit\\n\\tlimitStr := r.URL.Query().Get(\\"limit\\")\\n\\tlimit := 10\\n\\tif limitStr != \\"\\" {\\n\\t\\tif l, err := strconv.Atoi(limitStr); err == nil && l > 0 && l <= 50 {\\n\\t\\t\\tlimit = l\\n\\t\\t}\\n\\t}\\n\\n\\t// Get queue\\n\\tprofiles, err := h.matchingService.GetSwipeQueue(r.Context(), userID, limit)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to get swipe queue\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tif profiles == nil {\\n\\t\\tprofiles = []*model.SwipeQueueProfile{}\\n\\t}\\n\\n\\tresponse.OK(w, profiles)\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","name":"GetSwipeQueue","node_type":"function"},{"code":"func (s *MatchingService) GetSwipeQueue(ctx context.Context, userID string, limit int) ([]*model.SwipeQueueProfile, error) {\\n\\t// Get IDs of users already swiped on\\n\\tswipedIDs, err := s.swipeRepo.GetSwipedProfiles(ctx, userID)\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"failed to get swiped profiles\\", zap.Error(err))\\n\\t\\tswipedIDs = []string{}\\n\\t}\\n\\n\\t// Fetch profiles from profile service, excluding swiped ones\\n\\tprofiles, err := s.fetchSwipeQueue(ctx, userID, swipedIDs, limit)\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to fetch swipe queue: %w\\", err)\\n\\t}\\n\\n\\treturn profiles, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","name":"GetSwipeQueue","node_type":"function"},{"code":"func (r *SwipeRepository) GetSwipedProfiles(ctx context.Context, userID string) ([]string, error) {\\n\\tpattern := fmt.Sprintf(\\"swipe:%s:*\\", userID)\\n\\n\\tvar swipedIDs []string\\n\\titer := r.client.Scan(ctx, 0, pattern, 0).Iterator()\\n\\tfor iter.Next(ctx) {\\n\\t\\tkey := iter.Val()\\n\\t\\t// Extract owner ID from key pattern \\"swipe:{swiper}:{owner}\\"\\n\\t\\t// Key format: swipe:userID:ownerID\\n\\t\\tif len(key) > len(fmt.Sprintf(\\"swipe:%s:\\", userID)) {\\n\\t\\t\\townerID := key[len(fmt.Sprintf(\\"swipe:%s:\\", userID)):]\\n\\t\\t\\tswipedIDs = append(swipedIDs, ownerID)\\n\\t\\t}\\n\\t}\\n\\tif err := iter.Err(); err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to scan swiped profiles: %w\\", err)\\n\\t}\\n\\n\\treturn swipedIDs, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","name":"GetSwipedProfiles","node_type":"function"},{"code":"func (s *MatchingService) fetchSwipeQueue(ctx context.Context, userID string, excludeOwnerIDs []string, limit int) ([]*model.SwipeQueueProfile, error) {\\n\\t// Build query params\\n\\tpath := fmt.Sprintf(\\"/api/v1/profiles?exclude_user=%s&limit=%d\\", userID, limit)\\n\\n\\tresp, err := s.profileClient.Get(ctx, path, nil)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tvar result struct {\\n\\t\\tSuccess bool                       `json:\\"success\\"`\\n\\t\\tData    []*model.SwipeQueueProfile `json:\\"data\\"`\\n\\t}\\n\\tif err := json.Unmarshal(resp.Body, &result); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tif !result.Success {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get profiles\\")\\n\\t}\\n\\n\\t// Filter out already swiped profiles\\n\\texcludeSet := make(map[string]bool)\\n\\tfor _, id := range excludeOwnerIDs {\\n\\t\\texcludeSet[id] = true\\n\\t}\\n\\n\\tvar filtered []*model.SwipeQueueProfile\\n\\tfor _, p := range result.Data {\\n\\t\\tif !excludeSet[p.OwnerID] {\\n\\t\\t\\tfiltered = append(filtered, p)\\n\\t\\t}\\n\\t}\\n\\n\\treturn filtered, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","name":"fetchSwipeQueue","node_type":"function"},{"code":"func (h *Handler) handleMatches(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Get user ID from header\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"User not authenticated\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Get matches\\n\\tmatches, err := h.matchingService.GetMatchesWithProfiles(r.Context(), userID)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to get matches\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tif matches == nil {\\n\\t\\tmatches = []*model.MatchResponse{}\\n\\t}\\n\\n\\tresponse.OK(w, matches)\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","name":"handleMatches","node_type":"function"},{"code":"func (s *MatchingService) GetMatchesWithProfiles(ctx context.Context, userID string) ([]*model.MatchResponse, error) {\\n\\tmatches, err := s.matchRepo.GetMatchesByUserID(userID)\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get matches: %w\\", err)\\n\\t}\\n\\n\\tvar responses []*model.MatchResponse\\n\\tfor _, match := range matches {\\n\\t\\t// Determine the other user\\n\\t\\totherUserID := match.User2ID\\n\\t\\totherProfileID := match.Profile2ID\\n\\t\\tif match.User1ID != userID {\\n\\t\\t\\totherUserID = match.User1ID\\n\\t\\t\\totherProfileID = match.Profile1ID\\n\\t\\t}\\n\\n\\t\\t// Fetch profile info\\n\\t\\tprofile, err := s.getProfileInfo(ctx, otherProfileID)\\n\\t\\tif err != nil {\\n\\t\\t\\tlogger.Warn(\\"failed to get profile info\\", zap.String(\\"profile_id\\", otherProfileID), zap.Error(err))\\n\\t\\t\\tprofile = &model.UserInfo{\\n\\t\\t\\t\\tUserID:    otherUserID,\\n\\t\\t\\t\\tProfileID: otherProfileID,\\n\\t\\t\\t\\tName:      \\"Unknown\\",\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tresponses = append(responses, &model.MatchResponse{\\n\\t\\t\\tID:          match.ID,\\n\\t\\t\\tMatchedUser: profile,\\n\\t\\t\\tMatchedAt:   match.CreatedAt,\\n\\t\\t})\\n\\t}\\n\\n\\treturn responses, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","name":"GetMatchesWithProfiles","node_type":"function"},{"code":"func (r *MatchRepository) GetMatchesByUserID(userID string) ([]*model.Match, error) {\\n\\tquery := `\\n\\t\\tSELECT id, user1_id, user2_id, profile1_id, profile2_id, created_at, updated_at\\n\\t\\tFROM matches\\n\\t\\tWHERE user1_id = $1 OR user2_id = $1\\n\\t\\tORDER BY created_at DESC\\n\\t`\\n\\n\\trows, err := r.db.Query(query, userID)\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get matches: %w\\", err)\\n\\t}\\n\\tdefer rows.Close()\\n\\n\\tvar matches []*model.Match\\n\\tfor rows.Next() {\\n\\t\\tmatch := &model.Match{}\\n\\t\\terr := rows.Scan(\\n\\t\\t\\t&match.ID,\\n\\t\\t\\t&match.User1ID,\\n\\t\\t\\t&match.User2ID,\\n\\t\\t\\t&match.Profile1ID,\\n\\t\\t\\t&match.Profile2ID,\\n\\t\\t\\t&match.CreatedAt,\\n\\t\\t\\t&match.UpdatedAt,\\n\\t\\t)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn nil, fmt.Errorf(\\"failed to scan match: %w\\", err)\\n\\t\\t}\\n\\t\\tmatches = append(matches, match)\\n\\t}\\n\\n\\treturn matches, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:94:27","name":"GetMatchesByUserID","node_type":"function"},{"code":"func (s *MatchingService) getProfileInfo(ctx context.Context, profileID string) (*model.UserInfo, error) {\\n\\tresp, err := s.profileClient.Get(ctx, fmt.Sprintf(\\"/api/v1/profiles/%s\\", profileID), nil)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tvar result struct {\\n\\t\\tSuccess bool `json:\\"success\\"`\\n\\t\\tData    struct {\\n\\t\\t\\tID     string `json:\\"id\\"`\\n\\t\\t\\tUserID string `json:\\"user_id\\"`\\n\\t\\t\\tName   string `json:\\"name\\"`\\n\\t\\t\\tBreed  string `json:\\"breed\\"`\\n\\t\\t\\tAge    int    `json:\\"age\\"`\\n\\t\\t} `json:\\"data\\"`\\n\\t}\\n\\tif err := json.Unmarshal(resp.Body, &result); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tif !result.Success {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get profile\\")\\n\\t}\\n\\n\\treturn &model.UserInfo{\\n\\t\\tUserID:    result.Data.UserID,\\n\\t\\tProfileID: result.Data.ID,\\n\\t\\tName:      result.Data.Name,\\n\\t\\tBreed:     result.Data.Breed,\\n\\t\\tAge:       result.Data.Age,\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","name":"getProfileInfo","node_type":"function"},{"code":"func (h *Handler) handleMatchByID(w http.ResponseWriter, r *http.Request) {\\n\\t// Extract match ID from path\\n\\tpath := strings.TrimPrefix(r.URL.Path, \\"/api/v1/matches/\\")\\n\\tif path == \\"\\" || strings.Contains(path, \\"/\\") {\\n\\t\\tresponse.Error(w, errors.NotFound(\\"Match not found\\"))\\n\\t\\treturn\\n\\t}\\n\\tmatchID := path\\n\\n\\t// Get user ID from header\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"User not authenticated\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodDelete:\\n\\t\\th.unmatch(w, r, userID, matchID)\\n\\tdefault:\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Method not allowed\\"))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","name":"handleMatchByID","node_type":"function"},{"code":"func (h *Handler) unmatch(w http.ResponseWriter, r *http.Request, userID, matchID string) {\\n\\terr := h.matchingService.Unmatch(r.Context(), userID, matchID)\\n\\tif err != nil {\\n\\t\\tif strings.Contains(err.Error(), \\"not found\\") {\\n\\t\\t\\tresponse.Error(w, errors.NotFound(\\"Match not found\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tif strings.Contains(err.Error(), \\"not authorized\\") {\\n\\t\\t\\tresponse.Error(w, errors.Forbidden(\\"Not authorized to unmatch\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to unmatch\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, map[string]string{\\"message\\": \\"Successfully unmatched\\"})\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","name":"unmatch","node_type":"function"},{"code":"func (s *MatchingService) Unmatch(ctx context.Context, userID, matchID string) error {\\n\\t// Verify the match exists and involves this user\\n\\tmatch, err := s.matchRepo.GetMatchByID(matchID)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to get match: %w\\", err)\\n\\t}\\n\\tif match == nil {\\n\\t\\treturn fmt.Errorf(\\"match not found\\")\\n\\t}\\n\\n\\tif match.User1ID != userID && match.User2ID != userID {\\n\\t\\treturn fmt.Errorf(\\"not authorized to unmatch\\")\\n\\t}\\n\\n\\t// Delete the match\\n\\terr = s.matchRepo.DeleteMatch(matchID)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to delete match: %w\\", err)\\n\\t}\\n\\n\\t// Publish unmatch event\\n\\ts.publishUnmatchEvent(ctx, match)\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","name":"Unmatch","node_type":"function"},{"code":"func (r *MatchRepository) GetMatchByID(id string) (*model.Match, error) {\\n\\tquery := `\\n\\t\\tSELECT id, user1_id, user2_id, profile1_id, profile2_id, created_at, updated_at\\n\\t\\tFROM matches\\n\\t\\tWHERE id = $1\\n\\t`\\n\\n\\tmatch := &model.Match{}\\n\\terr := r.db.QueryRow(query, id).Scan(\\n\\t\\t&match.ID,\\n\\t\\t&match.User1ID,\\n\\t\\t&match.User2ID,\\n\\t\\t&match.Profile1ID,\\n\\t\\t&match.Profile2ID,\\n\\t\\t&match.CreatedAt,\\n\\t\\t&match.UpdatedAt,\\n\\t)\\n\\tif err == sql.ErrNoRows {\\n\\t\\treturn nil, nil\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get match: %w\\", err)\\n\\t}\\n\\n\\treturn match, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:66:27","name":"GetMatchByID","node_type":"function"},{"code":"func (r *MatchRepository) DeleteMatch(matchID string) error {\\n\\tquery := `DELETE FROM matches WHERE id = $1`\\n\\n\\tresult, err := r.db.Exec(query, matchID)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to delete match: %w\\", err)\\n\\t}\\n\\n\\trows, _ := result.RowsAffected()\\n\\tif rows == 0 {\\n\\t\\treturn fmt.Errorf(\\"match not found\\")\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:149:27","name":"DeleteMatch","node_type":"function"},{"code":"func (s *MatchingService) publishUnmatchEvent(ctx context.Context, match *model.Match) {\\n\\tevent := model.MatchEvent{\\n\\t\\tEventType:  kafka.EventMatchDeleted,\\n\\t\\tMatchID:    match.ID,\\n\\t\\tUser1ID:    match.User1ID,\\n\\t\\tUser2ID:    match.User2ID,\\n\\t\\tProfile1ID: match.Profile1ID,\\n\\t\\tProfile2ID: match.Profile2ID,\\n\\t\\tTimestamp:  time.Now().Format(time.RFC3339),\\n\\t}\\n\\n\\tif err := s.producer.Publish(ctx, kafka.TopicMatchDeleted, kafka.EventMatchDeleted, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish unmatch event\\", zap.Error(err))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:358:27","name":"publishUnmatchEvent","node_type":"function"}]'),U=JSON.parse('[{"column":11,"line":67,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/cmd/main.go:146:6","val":1},{"column":25,"line":92,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:17:6","val":1},{"column":25,"line":93,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:18:6","val":1},{"column":28,"line":96,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:27:6","val":1},{"column":14,"line":99,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:21:6","val":1},{"column":3,"line":103,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","val":1},{"column":29,"line":28,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","val":1},{"column":15,"line":37,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","val":1},{"column":35,"line":29,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":53,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":60,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":67,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":73,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":77,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":81,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":34,"line":86,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":35,"line":48,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","val":1},{"column":35,"line":50,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","val":1},{"column":45,"line":50,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","val":1},{"column":32,"line":52,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","val":1},{"column":44,"line":48,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":49,"line":48,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":59,"line":48,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":19,"line":57,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":35,"line":26,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":45,"line":26,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":21,"line":29,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":31,"line":29,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":38,"line":36,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":22,"line":37,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":37,"line":37,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":18,"line":42,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":31,"line":57,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":36,"line":57,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":46,"line":57,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":62,"line":57,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":19,"line":73,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:182:27","val":1},{"column":31,"line":87,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","val":1},{"column":17,"line":81,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","val":1},{"column":35,"line":65,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","val":1},{"column":44,"line":65,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","val":1},{"column":32,"line":67,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","val":1},{"column":26,"line":81,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","val":1},{"column":31,"line":81,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","val":1},{"column":40,"line":81,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","val":1},{"column":47,"line":87,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":52,"line":87,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":62,"line":87,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":30,"line":94,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","val":1},{"column":29,"line":139,"source":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","val":1},{"column":38,"line":139,"source":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","val":1},{"column":42,"line":94,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":52,"line":94,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":30,"line":101,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","val":1},{"column":34,"line":223,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","val":1},{"column":79,"line":223,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","val":1},{"column":47,"line":101,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":52,"line":101,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":30,"line":108,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:23:27","val":1},{"column":42,"line":108,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":52,"line":108,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":78,"line":108,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":6,"line":117,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:341:27","val":1},{"column":30,"line":351,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:341:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:341:27","val":1},{"column":24,"line":117,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":3,"line":123,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:319:27","val":1},{"column":30,"line":334,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:319:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:319:27","val":1},{"column":21,"line":123,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":18,"line":89,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":18,"line":93,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":96,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":18,"line":100,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":41,"line":30,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","val":1},{"column":17,"line":106,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","val":1},{"column":17,"line":113,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","val":1},{"column":36,"line":127,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":31,"line":205,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":38,"line":102,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":23,"line":105,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":15,"line":106,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":45,"line":110,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":47,"line":111,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":49,"line":205,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":54,"line":205,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":20,"line":212,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","val":1},{"column":66,"line":282,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","val":1},{"column":74,"line":282,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","val":1},{"column":34,"line":284,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","val":1},{"column":36,"line":212,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":41,"line":212,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":60,"line":212,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":17,"line":129,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","val":1},{"column":13,"line":137,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","val":1},{"column":37,"line":31,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","val":1},{"column":17,"line":143,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","val":1},{"column":17,"line":150,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","val":1},{"column":35,"line":155,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","val":1},{"column":29,"line":139,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:94:27","val":1},{"column":32,"line":101,"source":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:94:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:94:27","val":1},{"column":48,"line":139,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","val":1},{"column":20,"line":155,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","val":1},{"column":34,"line":247,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","val":1},{"column":74,"line":247,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","val":1},{"column":35,"line":155,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","val":1},{"column":17,"line":157,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","val":1},{"column":13,"line":165,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","val":1},{"column":38,"line":32,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1},{"column":17,"line":173,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1},{"column":17,"line":181,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1},{"column":4,"line":187,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":26,"line":195,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","val":1},{"column":27,"line":178,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:66:27","val":1},{"column":29,"line":73,"source":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:66:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:66:27","val":1},{"column":40,"line":178,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","val":1},{"column":19,"line":191,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:149:27","val":1},{"column":33,"line":151,"source":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:149:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:149:27","val":1},{"column":31,"line":191,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","val":1},{"column":3,"line":197,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:358:27","val":1},{"column":30,"line":368,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:358:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:358:27","val":1},{"column":23,"line":197,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","val":1},{"column":47,"line":195,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":55,"line":195,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":18,"line":198,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":18,"line":202,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":17,"line":205,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":13,"line":209,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":12,"line":187,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1},{"column":15,"line":187,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1},{"column":17,"line":189,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1}]'),fr={nodes:k,links:U},gr=Object.freeze(Object.defineProperty({__proto__:null,default:fr,links:U,nodes:k},Symbol.toStringTag,{value:"Module"})),yr=[{id:"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/cmd/main.go:146:6",name:"runMigrations",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:17:6",name:"NewSwipeRepository",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:18:6",name:"NewMatchRepository",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:27:6",name:"NewMatchingService",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:21:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19",name:"Health",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19",name:"Swipe",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27",name:"Swipe",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27",name:"GetSwipe",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27",name:"RecordSwipe",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:182:27",name:"RecordSwipeInDB",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27",name:"CheckMutualLike",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27",name:"HasLiked",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27",name:"MatchExists",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27",name:"getSwiperProfile",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:23:27",name:"CreateMatch",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:341:27",name:"publishMatchEvent",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:319:27",name:"publishSwipeEvent",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19",name:"GetSwipeQueue",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27",name:"GetSwipeQueue",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27",name:"GetSwipedProfiles",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27",name:"fetchSwipeQueue",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19",name:"handleMatches",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27",name:"GetMatchesWithProfiles",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:94:27",name:"GetMatchesByUserID",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27",name:"getProfileInfo",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19",name:"handleMatchByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19",name:"unmatch",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27",name:"Unmatch",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:66:27",name:"GetMatchByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:149:27",name:"DeleteMatch",node_type:"function"},{id:"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:358:27",name:"publishUnmatchEvent",node_type:"function"}],Cr=Object.freeze(Object.defineProperty({__proto__:null,default:yr},Symbol.toStringTag,{value:"Module"})),M=12,O="service-media",A="/home/evan/Code/rinder/services/media",Z="cmd/main.go",G="main",B="github.com/rinder",L=null,z="2026-01-21T10:23:37.3516147Z",W="2026-01-21T10:23:38.920708626Z",F="analyzing-completed",$=JSON.parse(`[{"id":263,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:38:19","outputs":[{"id":1595,"handler_id":263,"type":"http_response","label":"HTTP 200 JSON response","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:38:19","function_name":"healthCheck","description":"The handler returns an HTTP 200 response with Content-Type 'application/json' and body '{\\"success\\":true,\\"data\\":{\\"status\\":\\"healthy\\",\\"service\\":\\"media\\"}}'.","created_at":"2026-01-30T10:25:33.644234796Z","updated_at":null}],"created_at":"2026-01-30T10:25:14.928088789Z","updated_at":null},{"id":269,"type":"http","method":"DELETE","path":"/api/v1/media/","source_function_name":"RegisterRoutes","function_name":"handleMediaByID","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","outputs":[{"id":1794,"handler_id":269,"type":"database","label":"BEGIN TRANSACTION (BeginTx) for SetPrimary","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"Start a database transaction before unsetting and setting primary flags for media (part of SetPrimary).","created_at":"2026-01-30T10:26:29.779348468Z","updated_at":null},{"id":1797,"handler_id":269,"type":"database","label":"COMMIT TRANSACTION (tx.Commit) for SetPrimary","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"Commit the transaction after updating primary flags (SetPrimary completes with a commit).","created_at":"2026-01-30T10:26:29.782276762Z","updated_at":null},{"id":1792,"handler_id":269,"type":"database","label":"DELETE FROM media WHERE id = $1","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:150:27","function_name":"Delete","description":"Delete the media record from the database for the given media ID.","created_at":"2026-01-30T10:26:29.776062909Z","updated_at":null},{"id":1779,"handler_id":269,"type":"database","label":"SELECT FROM media WHERE id = $1","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:86:27","function_name":"GetByID","description":"Retrieve a media record by ID from the database (used by GET /api/v1/media/{id} and by DELETE to fetch the media to be deleted).","created_at":"2026-01-30T10:26:29.761844593Z","updated_at":null},{"id":1793,"handler_id":269,"type":"database","label":"SELECT FROM media WHERE profile_id = $1 ORDER BY sort_order ASC","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:114:27","function_name":"GetByProfileID","description":"When a primary media item is deleted, retrieve the list of media for that profile to choose a new primary.","created_at":"2026-01-30T10:26:29.778292329Z","updated_at":null},{"id":1795,"handler_id":269,"type":"database","label":"UPDATE media SET is_primary = FALSE, updated_at = NOW() WHERE profile_id = $1","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"Unset all primary flags for the profile as the first step in SetPrimary.","created_at":"2026-01-30T10:26:29.780342912Z","updated_at":null},{"id":1796,"handler_id":269,"type":"database","label":"UPDATE media SET is_primary = TRUE, updated_at = NOW() WHERE id = $1 AND profile_id = $2","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"Set the chosen media record as the new primary within the same transaction (SetPrimary).","created_at":"2026-01-30T10:26:29.781368081Z","updated_at":null},{"id":1798,"handler_id":269,"type":"event","label":"Publish media.deleted event to Kafka (PublishWithKey)","function_id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:344:24","function_name":"publishMediaDeletedEvent","description":"After successful deletion (and any primacy adjustments), the service publishes a media.deleted event to Kafka with the media ID as key.","created_at":"2026-01-30T10:26:29.783170637Z","updated_at":null},{"id":1791,"handler_id":269,"type":"http","label":"DELETE object from object storage (Minio RemoveObject)","function_id":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","function_name":"Delete","description":"If the media URL contains an object name, the storage client attempts to delete the object from Minio (s.client.RemoveObject). This network call removes the stored file.","created_at":"2026-01-30T10:26:29.773370631Z","updated_at":null},{"id":1787,"handler_id":269,"type":"http","label":"HTTP GET to profile service: GET /api/v1/profiles/{profileID}","function_id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","function_name":"getProfileInfo","description":"To verify profile ownership before deleting media, the service issues an HTTP GET request to the profiles service endpoint for the media's profile.","created_at":"2026-01-30T10:26:29.769233491Z","updated_at":null},{"id":1781,"handler_id":269,"type":"http_response","label":"HTTP 200 response (response.OK) with media payload","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","function_name":"getMedia","description":"For a successful GET, the media record is returned to the client (response.OK writes the HTTP success response).","created_at":"2026-01-30T10:26:29.76355936Z","updated_at":null},{"id":1799,"handler_id":269,"type":"http_response","label":"HTTP 204 No Content response (response.NoContent)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","function_name":"deleteMedia","description":"After a successful DELETE operation, the handler returns an HTTP 204 No Content response to the client.","created_at":"2026-01-30T10:26:29.784225579Z","updated_at":null},{"id":1775,"handler_id":269,"type":"http_response","label":"HTTP 400 Bad Request response (media ID is required)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","function_name":"handleMediaByID","description":"If the media ID is missing from the request path, an HTTP 400 error response is returned to the client via response.Error.","created_at":"2026-01-30T10:26:29.744340055Z","updated_at":null},{"id":1777,"handler_id":269,"type":"http_response","label":"HTTP 400 Bad Request response (method not allowed)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","function_name":"handleMediaByID","description":"If the HTTP method is not GET or DELETE, an HTTP 400 error response is returned to the client via response.Error.","created_at":"2026-01-30T10:26:29.759539651Z","updated_at":null},{"id":1785,"handler_id":269,"type":"http_response","label":"HTTP 401 Unauthorized response","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","function_name":"deleteMedia","description":"If the X-User-ID header is missing for a DELETE request, an HTTP 401 Unauthorized response is returned to the client via response.Error.","created_at":"2026-01-30T10:26:29.76732628Z","updated_at":null},{"id":1783,"handler_id":269,"type":"http_response","label":"HTTP error response (response.Error) for Get failure","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","function_name":"getMedia","description":"If the service/repository returns an error while handling GET, an HTTP error response is returned to the client via response.Error.","created_at":"2026-01-30T10:26:29.765263253Z","updated_at":null},{"id":1789,"handler_id":269,"type":"http_response","label":"HTTP error response (response.Error) for delete failure (forbidden/not found/etc.)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","function_name":"deleteMedia","description":"If the Delete service returns an error (e.g. profile not found, forbidden, or other errors), the handler returns an HTTP error response to the client via response.Error.","created_at":"2026-01-30T10:26:29.771264901Z","updated_at":null}],"created_at":"2026-01-30T10:25:14.951515389Z","updated_at":null},{"id":267,"type":"http","method":"GET","path":"/api/v1/media/","source_function_name":"RegisterRoutes","function_name":"handleMediaByID","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","outputs":[],"created_at":"2026-01-30T10:25:14.948553933Z","updated_at":null},{"id":271,"type":"http","method":"GET","path":"/api/v1/media/profile/","source_function_name":"RegisterRoutes","function_name":"handleMediaByProfile","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","outputs":[{"id":1622,"handler_id":271,"type":"database","label":"SELECT id, profile_id, user_id, type, filename, content_type, size, url, thumbnail_url, is_primary, sort_order, created_at, updated_at FROM media WHERE profile_id = $1 ORDER BY sort_order ASC","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:114:27","function_name":"GetByProfileID","description":"The repository executes a SQL query against the configured database to fetch all media rows for the given profile_id (QueryContext). This is the database call that returns 0..N media rows.","created_at":"2026-01-30T10:25:58.834410606Z","updated_at":null},{"id":1624,"handler_id":271,"type":"http_response","label":"HTTP 200 JSON response with media list (response.OK)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","function_name":"handleMediaByProfile","description":"On success, the handler returns an HTTP 200 response containing the media list as JSON. If the repository returned nil, an empty JSON array is returned instead of null.","created_at":"2026-01-30T10:25:58.837320459Z","updated_at":null},{"id":1620,"handler_id":271,"type":"http_response","label":"HTTP 400 error response (method not allowed)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","function_name":"handleMediaByProfile","description":"If the incoming request method is not GET, the handler returns an HTTP error response (bad request / method not allowed) to the client via response.Error.","created_at":"2026-01-30T10:25:58.81850197Z","updated_at":null},{"id":1621,"handler_id":271,"type":"http_response","label":"HTTP 400 error response (profile ID is required)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","function_name":"handleMediaByProfile","description":"If the profile ID cannot be extracted from the request path (empty), the handler returns an HTTP error response (bad request) to the client via response.Error.","created_at":"2026-01-30T10:25:58.832315319Z","updated_at":null},{"id":1623,"handler_id":271,"type":"http_response","label":"HTTP error response (propagated from service/repository)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","function_name":"handleMediaByProfile","description":"If the mediaService or repository returns an error (for example a database query error), the handler returns an HTTP error response to the client via response.Error, propagating that error.","created_at":"2026-01-30T10:25:58.836088577Z","updated_at":null}],"created_at":"2026-01-30T10:25:14.954628012Z","updated_at":null},{"id":265,"type":"http","method":"POST","path":"/api/v1/media","source_function_name":"RegisterRoutes","function_name":"handleMedia","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","outputs":[{"id":1759,"handler_id":265,"type":"database","label":"INSERT INTO media (...) VALUES (...)","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:53:27","function_name":"Create","description":"Create a new media row in the database (inserting id, profile_id, user_id, filename, content_type, size, url, is_primary, sort_order, timestamps, etc.).","created_at":"2026-01-30T10:26:25.354277955Z","updated_at":null},{"id":1758,"handler_id":265,"type":"database","label":"SELECT COALESCE(MAX(sort_order), -1) FROM media WHERE profile_id = $1","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:53:27","function_name":"Create","description":"Query the current maximum sort_order for the profile to determine the new media sort_order.","created_at":"2026-01-30T10:26:25.352960425Z","updated_at":null},{"id":1756,"handler_id":265,"type":"database","label":"SELECT COUNT(*) FROM media WHERE profile_id = $1","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:222:27","function_name":"CountByProfileID","description":"Count how many media rows exist for the profile to enforce per-profile photo limits.","created_at":"2026-01-30T10:26:25.350339448Z","updated_at":null},{"id":1760,"handler_id":265,"type":"database","label":"UPDATE media SET is_primary = FALSE, updated_at = NOW() WHERE profile_id = $1","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"When marking a media item as primary and there are existing photos, unset the is_primary flag on all other media for the profile (part of SetPrimary transaction).","created_at":"2026-01-30T10:26:25.355494629Z","updated_at":null},{"id":1761,"handler_id":265,"type":"database","label":"UPDATE media SET is_primary = TRUE, updated_at = NOW() WHERE id = $1 AND profile_id = $2","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"Set the newly uploaded media row as the primary photo for the profile (part of SetPrimary transaction).","created_at":"2026-01-30T10:26:25.357007801Z","updated_at":null},{"id":1762,"handler_id":265,"type":"event","label":"Publish to Kafka topic (media.uploaded) with key = media.ID","function_id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:327:24","function_name":"publishMediaUploadedEvent","description":"The service publishes a MediaUploaded event to the Kafka topic (topic: kafka.TopicMediaUploaded) containing media metadata (media ID, profile ID, user ID, type, URL, content type, size, timestamp).","created_at":"2026-01-30T10:26:25.358475303Z","updated_at":null},{"id":1755,"handler_id":265,"type":"http","label":"GET /api/v1/profiles/{profile_id}","function_id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","function_name":"getProfileInfo","description":"The media service calls the profile service to fetch profile info (to verify existence and ownership).","created_at":"2026-01-30T10:26:25.348920834Z","updated_at":null},{"id":1754,"handler_id":265,"type":"http","label":"GET /api/v1/users/{user_id}","function_id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:266:24","function_name":"getUserInfo","description":"The media service calls the user service to fetch/verify user info for the provided user ID.","created_at":"2026-01-30T10:26:25.347784709Z","updated_at":null},{"id":1757,"handler_id":265,"type":"http","label":"PutObject to MinIO (upload object)","function_id":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","function_name":"Upload","description":"The storage layer uploads the file stream to MinIO (PutObject), storing the file and returning a public URL.","created_at":"2026-01-30T10:26:25.351644752Z","updated_at":null},{"id":1764,"handler_id":265,"type":"http","label":"RemoveObject from MinIO (delete object)  cleanup on DB create failure","function_id":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","function_name":"Delete","description":"If media record creation in the database fails after the file was uploaded, the service attempts to delete the uploaded object from MinIO (cleanup). This occurs conditionally when Create(...) returns an error.","created_at":"2026-01-30T10:26:25.362692892Z","updated_at":null},{"id":1763,"handler_id":265,"type":"http_response","label":"HTTP 201 Created (media)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","function_name":"uploadMedia","description":"On successful upload and record creation, the handler returns an HTTP 201 Created response to the client with the media object.","created_at":"2026-01-30T10:26:25.360040604Z","updated_at":null},{"id":1751,"handler_id":265,"type":"http_response","label":"HTTP 400 Bad Request (failed to parse multipart form)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","function_name":"uploadMedia","description":"If parsing the multipart form fails, the handler returns an HTTP Bad Request response to the client.","created_at":"2026-01-30T10:26:25.344498793Z","updated_at":null},{"id":1753,"handler_id":265,"type":"http_response","label":"HTTP 400 Bad Request (file is required)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","function_name":"uploadMedia","description":"If the uploaded file part is missing or cannot be read, the handler returns an HTTP Bad Request response to the client.","created_at":"2026-01-30T10:26:25.346720919Z","updated_at":null},{"id":1749,"handler_id":265,"type":"http_response","label":"HTTP 400 Bad Request (method not allowed)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","function_name":"handleMedia","description":"If the request method is not POST, the handler returns an HTTP error response (Bad Request / method not allowed) to the client.","created_at":"2026-01-30T10:26:25.340739584Z","updated_at":null},{"id":1752,"handler_id":265,"type":"http_response","label":"HTTP 400 Bad Request (profile_id is required)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","function_name":"uploadMedia","description":"If the form value \`profile_id\` is missing, the handler returns an HTTP Bad Request response to the client.","created_at":"2026-01-30T10:26:25.345651473Z","updated_at":null},{"id":1750,"handler_id":265,"type":"http_response","label":"HTTP 401 Unauthorized (missing X-User-ID)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","function_name":"uploadMedia","description":"If the X-User-ID header is missing from the request, the handler returns an HTTP Unauthorized response to the client.","created_at":"2026-01-30T10:26:25.342972872Z","updated_at":null},{"id":1765,"handler_id":265,"type":"http_response","label":"HTTP error response forwarded to client when mediaService.Upload fails","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","function_name":"uploadMedia","description":"If mediaService.Upload returns an error (various possible HTTP-status-mapped errors such as 400/401/403/404/500), uploadMedia forwards an HTTP error response to the client. (The exact status depends on the error returned by the service.)","created_at":"2026-01-30T10:26:25.36519838Z","updated_at":null}],"created_at":"2026-01-30T10:25:14.94197405Z","updated_at":null},{"id":273,"type":"http","method":"POST","path":"/api/v1/media/primary/","source_function_name":"RegisterRoutes","function_name":"handlePrimary","source_function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","outputs":[{"id":1828,"handler_id":273,"type":"database","label":"BEGIN TRANSACTION","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"A database transaction is started before modifying media rows.","created_at":"2026-01-30T10:26:39.460931067Z","updated_at":null},{"id":1832,"handler_id":273,"type":"database","label":"COMMIT TRANSACTION","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"If updates succeed, the transaction is committed to persist the changes to the database.","created_at":"2026-01-30T10:26:39.467030937Z","updated_at":null},{"id":1831,"handler_id":273,"type":"database","label":"ROLLBACK TRANSACTION (possible)","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"If an error occurs before commit, the deferred rollback will be executed on the transaction (possible DB rollback).","created_at":"2026-01-30T10:26:39.464848644Z","updated_at":null},{"id":1829,"handler_id":273,"type":"database","label":"UPDATE media SET is_primary = FALSE, updated_at = NOW() WHERE profile_id = $1","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"Within the transaction, all media rows for the profile have their is_primary flag unset.","created_at":"2026-01-30T10:26:39.462254885Z","updated_at":null},{"id":1830,"handler_id":273,"type":"database","label":"UPDATE media SET is_primary = TRUE, updated_at = NOW() WHERE id = $1 AND profile_id = $2","function_id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","function_name":"SetPrimary","description":"Within the transaction, the requested media row is updated to set is_primary = TRUE for the given media ID and profile ID.","created_at":"2026-01-30T10:26:39.463583126Z","updated_at":null},{"id":1825,"handler_id":273,"type":"http","label":"HTTP GET /api/v1/profiles/{profileID}","function_id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","function_name":"getProfileInfo","description":"The service calls the profile service to fetch profile info for the given profile ID via profileClient.Get.","created_at":"2026-01-30T10:26:39.456533039Z","updated_at":null},{"id":1834,"handler_id":273,"type":"http_response","label":"HTTP 200 OK (primary photo updated)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","function_name":"handlePrimary","description":"On successful completion (profile verified and DB transaction committed), the handler returns an HTTP 200 JSON response with a success message to the client.","created_at":"2026-01-30T10:26:39.470121582Z","updated_at":null},{"id":1823,"handler_id":273,"type":"http_response","label":"HTTP 400 Bad Request (invalid request body)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","function_name":"handlePrimary","description":"If the request body cannot be decoded as the expected JSON, the handler returns an HTTP 400 error response to the client.","created_at":"2026-01-30T10:26:39.452990464Z","updated_at":null},{"id":1824,"handler_id":273,"type":"http_response","label":"HTTP 400 Bad Request (media_id is required)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","function_name":"handlePrimary","description":"If the decoded request is missing media_id, the handler returns an HTTP 400 error response to the client.","created_at":"2026-01-30T10:26:39.455068937Z","updated_at":null},{"id":1820,"handler_id":273,"type":"http_response","label":"HTTP 400 Bad Request (method not allowed)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","function_name":"handlePrimary","description":"If the request method is not POST, the handler returns an HTTP 400 error response to the client.","created_at":"2026-01-30T10:26:39.434512382Z","updated_at":null},{"id":1822,"handler_id":273,"type":"http_response","label":"HTTP 400 Bad Request (profile ID is required)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","function_name":"handlePrimary","description":"If the profile ID cannot be extracted from the request path, the handler returns an HTTP 400 error response to the client.","created_at":"2026-01-30T10:26:39.450836668Z","updated_at":null},{"id":1821,"handler_id":273,"type":"http_response","label":"HTTP 401 Unauthorized (authentication required)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","function_name":"handlePrimary","description":"If the X-User-ID header is missing, the handler returns an HTTP 401 error response to the client.","created_at":"2026-01-30T10:26:39.446895428Z","updated_at":null},{"id":1827,"handler_id":273,"type":"http_response","label":"HTTP 403 Forbidden (you do not own this profile)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","function_name":"handlePrimary","description":"If the profile's user ID does not match the request's user ID, the service returns a Forbidden error which the handler sends as an HTTP 403 response to the client.","created_at":"2026-01-30T10:26:39.459436736Z","updated_at":null},{"id":1833,"handler_id":273,"type":"http_response","label":"HTTP 404 Not Found (media not found)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","function_name":"handlePrimary","description":"If the UPDATE that sets the new primary affects 0 rows, the repository returns NotFound and the handler sends an HTTP 404 response to the client.","created_at":"2026-01-30T10:26:39.468589112Z","updated_at":null},{"id":1826,"handler_id":273,"type":"http_response","label":"HTTP 404 Not Found (profile not found)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","function_name":"handlePrimary","description":"If the profile service response is not successful, the service returns a NotFound error which the handler sends as an HTTP 404 response to the client.","created_at":"2026-01-30T10:26:39.457858428Z","updated_at":null},{"id":1835,"handler_id":273,"type":"http_response","label":"HTTP 500 Internal Server Error (various internal failures)","function_id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","function_name":"handlePrimary","description":"Various internal failures (e.g., failing to start transaction, failing SQL execution, JSON decode errors from profile response decoding, or other wrapped internal errors) result in an error returned up to the handler which sends an HTTP 500 response to the client.","created_at":"2026-01-30T10:26:39.471560236Z","updated_at":null}],"created_at":"2026-01-30T10:25:14.95758343Z","updated_at":null}]`),Tr={id:M,name:O,git_repo_url:A,entrypoint_path:Z,entrypoint_function:G,git_org_url:B,git_commit:L,created_at:z,updated_at:W,status:F,handlers:$},br=Object.freeze(Object.defineProperty({__proto__:null,created_at:z,default:Tr,entrypoint_function:G,entrypoint_path:Z,git_commit:L,git_org_url:B,git_repo_url:A,handlers:$,id:M,name:O,status:F,updated_at:W},Symbol.toStringTag,{value:"Module"})),j=JSON.parse('[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"media\\", 8086)\\n\\tkafkaCfg := config.NewKafkaConfig(\\"media-service\\")\\n\\n\\t// Database configuration (postgres-media container uses port 5434)\\n\\tdbCfg := config.DatabaseConfig{\\n\\t\\tHost:     config.GetEnv(\\"MEDIA_DB_HOST\\", \\"localhost\\"),\\n\\t\\tPort:     config.GetEnvInt(\\"MEDIA_DB_PORT\\", 5434),\\n\\t\\tUser:     config.GetEnv(\\"MEDIA_DB_USER\\", \\"rinder\\"),\\n\\t\\tPassword: config.GetEnv(\\"MEDIA_DB_PASSWORD\\", \\"rinder123\\"),\\n\\t\\tDatabase: config.GetEnv(\\"MEDIA_DB_NAME\\", \\"rinder_media\\"),\\n\\t\\tSSLMode:  config.GetEnv(\\"MEDIA_DB_SSLMODE\\", \\"disable\\"),\\n\\t}\\n\\n\\t// MinIO configuration\\n\\tminioEndpoint := config.GetEnv(\\"MINIO_ENDPOINT\\", \\"localhost:9000\\")\\n\\tminioAccessKey := config.GetEnv(\\"MINIO_ACCESS_KEY\\", \\"rinder\\")\\n\\tminioSecretKey := config.GetEnv(\\"MINIO_SECRET_KEY\\", \\"rinder123\\")\\n\\tminioBucket := config.GetEnv(\\"MINIO_BUCKET\\", \\"service-media\\")\\n\\tminioPublicURL := config.GetEnv(\\"MINIO_PUBLIC_URL\\", \\"http://localhost:9000\\")\\n\\n\\t// Service URLs for cross-service calls\\n\\tprofileServiceURL := config.GetEnv(\\"PROFILE_SERVICE_URL\\", \\"http://localhost:8082\\")\\n\\tuserServiceURL := config.GetEnv(\\"USER_SERVICE_URL\\", \\"http://localhost:8081\\")\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting media service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t)\\n\\n\\t// Connect to PostgreSQL\\n\\tdsn := fmt.Sprintf(\\"host=%s port=%d user=%s password=%s dbname=%s sslmode=%s\\",\\n\\t\\tdbCfg.Host, dbCfg.Port, dbCfg.User, dbCfg.Password, dbCfg.Database, dbCfg.SSLMode)\\n\\n\\tdb, err := sql.Open(\\"postgres\\", dsn)\\n\\tif err != nil {\\n\\t\\tlogger.Fatal(\\"failed to connect to postgres\\", zap.Error(err))\\n\\t}\\n\\tdefer db.Close()\\n\\n\\tif err = db.Ping(); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to ping postgres\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"connected to postgres database\\")\\n\\n\\t// Initialize MinIO storage\\n\\tminioStorage, err := storage.NewMinioStorage(storage.MinioConfig{\\n\\t\\tEndpoint:        minioEndpoint,\\n\\t\\tAccessKeyID:     minioAccessKey,\\n\\t\\tSecretAccessKey: minioSecretKey,\\n\\t\\tUseSSL:          false,\\n\\t\\tBucketName:      minioBucket,\\n\\t\\tPublicURL:       minioPublicURL,\\n\\t})\\n\\tif err != nil {\\n\\t\\tlogger.Fatal(\\"failed to initialize minio storage\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"connected to minio storage\\", zap.String(\\"bucket\\", minioBucket))\\n\\n\\t// Initialize Kafka producer\\n\\tproducer := kafka.NewProducer(kafkaCfg.Brokers, cfg.Name)\\n\\tdefer producer.Close()\\n\\n\\t// Initialize repository\\n\\tmediaRepo := repository.NewMediaRepository(db)\\n\\n\\t// Run migrations\\n\\tif err := mediaRepo.CreateSchema(context.Background()); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to run database migrations\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"database migrations completed\\")\\n\\n\\t// Initialize service with cross-service clients\\n\\tmediaService := service.NewMediaService(\\n\\t\\tmediaRepo,\\n\\t\\tminioStorage,\\n\\t\\tproducer,\\n\\t\\tprofileServiceURL,\\n\\t\\tuserServiceURL,\\n\\t)\\n\\tlogger.Info(\\"media service initialized with cross-service clients\\",\\n\\t\\tzap.String(\\"profile_service\\", profileServiceURL),\\n\\t\\tzap.String(\\"user_service\\", userServiceURL),\\n\\t)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(mediaService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  30 * time.Second, // Longer timeout for uploads\\n\\t\\tWriteTimeout: 30 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"media service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt signal\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Graceful shutdown\\n\\tctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer cancel()\\n\\n\\tif err := server.Shutdown(ctx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server exited properly\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/cmd/main.go:25:1","name":"ROOT","node_type":"function"},{"code":"func NewMinioStorage(cfg MinioConfig) (*MinioStorage, error) {\\n\\tclient, err := minio.New(cfg.Endpoint, &minio.Options{\\n\\t\\tCreds:  credentials.NewStaticV4(cfg.AccessKeyID, cfg.SecretAccessKey, \\"\\"),\\n\\t\\tSecure: cfg.UseSSL,\\n\\t})\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to create minio client: %w\\", err)\\n\\t}\\n\\n\\tstorage := &MinioStorage{\\n\\t\\tclient:     client,\\n\\t\\tbucketName: cfg.BucketName,\\n\\t\\tpublicURL:  cfg.PublicURL,\\n\\t}\\n\\n\\t// Ensure bucket exists\\n\\tif err := storage.ensureBucket(context.Background()); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\treturn storage, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:33:6","name":"NewMinioStorage","node_type":"function"},{"code":"func (s *MinioStorage) ensureBucket(ctx context.Context) error {\\n\\texists, err := s.client.BucketExists(ctx, s.bucketName)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to check bucket existence: %w\\", err)\\n\\t}\\n\\n\\tif !exists {\\n\\t\\terr = s.client.MakeBucket(ctx, s.bucketName, minio.MakeBucketOptions{})\\n\\t\\tif err != nil {\\n\\t\\t\\treturn fmt.Errorf(\\"failed to create bucket: %w\\", err)\\n\\t\\t}\\n\\t\\tlogger.Info(\\"created minio bucket\\", zap.String(\\"bucket\\", s.bucketName))\\n\\n\\t\\t// Set bucket policy to allow public read access\\n\\t\\tpolicy := fmt.Sprintf(`{\\n\\t\\t\\t\\"Version\\": \\"2012-10-17\\",\\n\\t\\t\\t\\"Statement\\": [\\n\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\"Effect\\": \\"Allow\\",\\n\\t\\t\\t\\t\\t\\"Principal\\": {\\"AWS\\": [\\"*\\"]},\\n\\t\\t\\t\\t\\t\\"Action\\": [\\"s3:GetObject\\"],\\n\\t\\t\\t\\t\\t\\"Resource\\": [\\"arn:aws:s3:::%s/*\\"]\\n\\t\\t\\t\\t}\\n\\t\\t\\t]\\n\\t\\t}`, s.bucketName)\\n\\n\\t\\terr = s.client.SetBucketPolicy(ctx, s.bucketName, policy)\\n\\t\\tif err != nil {\\n\\t\\t\\tlogger.Warn(\\"failed to set bucket policy\\", zap.Error(err))\\n\\t\\t}\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:57:24","name":"ensureBucket","node_type":"function"},{"code":"func NewMediaRepository(db *sql.DB) *MediaRepository {\\n\\treturn &MediaRepository{db: db}\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:19:6","name":"NewMediaRepository","node_type":"function"},{"code":"func (r *MediaRepository) CreateSchema(ctx context.Context) error {\\n\\tquery := `\\n\\tCREATE TABLE IF NOT EXISTS media (\\n\\t\\tid UUID PRIMARY KEY,\\n\\t\\tprofile_id UUID NOT NULL,\\n\\t\\tuser_id UUID NOT NULL,\\n\\t\\ttype VARCHAR(20) NOT NULL DEFAULT \'image\',\\n\\t\\tfilename VARCHAR(255) NOT NULL,\\n\\t\\tcontent_type VARCHAR(100) NOT NULL,\\n\\t\\tsize BIGINT NOT NULL,\\n\\t\\turl TEXT NOT NULL,\\n\\t\\tthumbnail_url TEXT,\\n\\t\\tis_primary BOOLEAN NOT NULL DEFAULT FALSE,\\n\\t\\tsort_order INT NOT NULL DEFAULT 0,\\n\\t\\tcreated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n\\t\\tupdated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()\\n\\t);\\n\\n\\tCREATE INDEX IF NOT EXISTS idx_media_profile_id ON media(profile_id);\\n\\tCREATE INDEX IF NOT EXISTS idx_media_user_id ON media(user_id);\\n\\t`\\n\\t_, err := r.db.ExecContext(ctx, query)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to create media table\\", 500)\\n\\t}\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:24:27","name":"CreateSchema","node_type":"function"},{"code":"func NewMediaService(\\n\\tmediaRepo *repository.MediaRepository,\\n\\tstorage *storage.MinioStorage,\\n\\tproducer *kafka.Producer,\\n\\tprofileServiceURL string,\\n\\tuserServiceURL string,\\n) *MediaService {\\n\\treturn &MediaService{\\n\\t\\tmediaRepo:     mediaRepo,\\n\\t\\tstorage:       storage,\\n\\t\\tproducer:      producer,\\n\\t\\tprofileClient: httpclient.NewClient(profileServiceURL, \\"profile-service\\", 10*time.Second),\\n\\t\\tuserClient:    httpclient.NewClient(userServiceURL, \\"user-service\\", 10*time.Second),\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:44:6","name":"NewMediaService","node_type":"function"},{"code":"func NewHandler(mediaService *service.MediaService) *Handler {\\n\\treturn &Handler{\\n\\t\\tmediaService: mediaService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:20:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\t// Health check\\n\\tmux.HandleFunc(\\"/health\\", h.healthCheck)\\n\\n\\t// Media routes\\n\\tmux.HandleFunc(\\"/api/v1/media\\", h.handleMedia)\\n\\tmux.HandleFunc(\\"/api/v1/media/\\", h.handleMediaByID)\\n\\tmux.HandleFunc(\\"/api/v1/media/profile/\\", h.handleMediaByProfile)\\n\\tmux.HandleFunc(\\"/api/v1/media/primary/\\", h.handlePrimary)\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) healthCheck(w http.ResponseWriter, r *http.Request) {\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tw.Write([]byte(`{\\"success\\":true,\\"data\\":{\\"status\\":\\"healthy\\",\\"service\\":\\"media\\"}}`))\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:38:19","name":"healthCheck","node_type":"function"},{"code":"func (h *Handler) handleMedia(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\th.uploadMedia(w, r)\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","name":"handleMedia","node_type":"function"},{"code":"func (h *Handler) uploadMedia(w http.ResponseWriter, r *http.Request) {\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"authentication required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Parse multipart form (max 12MB to account for form overhead)\\n\\tif err := r.ParseMultipartForm(12 << 20); err != nil {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"failed to parse form: \\"+err.Error()))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Get profile ID\\n\\tprofileID := r.FormValue(\\"profile_id\\")\\n\\tif profileID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"profile_id is required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Get is_primary flag\\n\\tisPrimary := r.FormValue(\\"is_primary\\") == \\"true\\"\\n\\n\\t// Get the file\\n\\tfile, header, err := r.FormFile(\\"file\\")\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"file is required\\"))\\n\\t\\treturn\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// Upload\\n\\tmedia, err := h.mediaService.Upload(\\n\\t\\tr.Context(),\\n\\t\\tuserID,\\n\\t\\tprofileID,\\n\\t\\theader.Filename,\\n\\t\\theader.Header.Get(\\"Content-Type\\"),\\n\\t\\theader.Size,\\n\\t\\tfile,\\n\\t\\tisPrimary,\\n\\t)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.Created(w, media)\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","name":"uploadMedia","node_type":"function"},{"code":"func (s *MediaService) Upload(\\n\\tctx context.Context,\\n\\tuserID string,\\n\\tprofileID string,\\n\\tfilename string,\\n\\tcontentType string,\\n\\tsize int64,\\n\\treader io.Reader,\\n\\tisPrimary bool,\\n) (*model.Media, error) {\\n\\t// Validate content type\\n\\tif !allowedContentTypes[contentType] {\\n\\t\\treturn nil, errors.BadRequest(\\"invalid file type. Allowed: JPEG, PNG, GIF, WebP\\")\\n\\t}\\n\\n\\t// Validate file size\\n\\tif size > maxFileSize {\\n\\t\\treturn nil, errors.BadRequest(\\"file too large. Maximum size is 10MB\\")\\n\\t}\\n\\n\\t// =====================================================\\n\\t// CROSS-SERVICE CALL #1: Verify user is active\\n\\t// =====================================================\\n\\tuserInfo, err := s.getUserInfo(ctx, userID)\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"failed to verify user\\", zap.String(\\"user_id\\", userID), zap.Error(err))\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeUnauthorized, \\"failed to verify user\\", 401)\\n\\t}\\n\\tif !userInfo.IsActive {\\n\\t\\treturn nil, errors.Forbidden(\\"user account is not active\\")\\n\\t}\\n\\tlogger.Debug(\\"user verified for media upload\\",\\n\\t\\tzap.String(\\"user_id\\", userID),\\n\\t\\tzap.String(\\"email\\", userInfo.Email),\\n\\t)\\n\\n\\t// =====================================================\\n\\t// CROSS-SERVICE CALL #2: Verify profile exists and belongs to user\\n\\t// =====================================================\\n\\tprofileInfo, err := s.getProfileInfo(ctx, profileID)\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"failed to verify profile\\", zap.String(\\"profile_id\\", profileID), zap.Error(err))\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeNotFound, \\"profile not found\\", 404)\\n\\t}\\n\\tif profileInfo.UserID != userID {\\n\\t\\tlogger.Warn(\\"profile ownership mismatch\\",\\n\\t\\t\\tzap.String(\\"profile_id\\", profileID),\\n\\t\\t\\tzap.String(\\"profile_owner\\", profileInfo.UserID),\\n\\t\\t\\tzap.String(\\"requesting_user\\", userID),\\n\\t\\t)\\n\\t\\treturn nil, errors.Forbidden(\\"you do not own this profile\\")\\n\\t}\\n\\tlogger.Debug(\\"profile ownership verified\\",\\n\\t\\tzap.String(\\"profile_id\\", profileID),\\n\\t\\tzap.String(\\"profile_name\\", profileInfo.Name),\\n\\t)\\n\\n\\t// Check photo limit\\n\\tcount, err := s.mediaRepo.CountByProfileID(ctx, profileID)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\tif count >= maxPhotosPerProfile {\\n\\t\\treturn nil, errors.BadRequest(fmt.Sprintf(\\"maximum %d photos per profile\\", maxPhotosPerProfile))\\n\\t}\\n\\n\\t// Generate unique filename\\n\\text := filepath.Ext(filename)\\n\\tobjectName := fmt.Sprintf(\\"profiles/%s/%s%s\\", profileID, uuid.New().String(), ext)\\n\\n\\t// Upload to MinIO\\n\\turl, err := s.storage.Upload(ctx, objectName, reader, size, contentType)\\n\\tif err != nil {\\n\\t\\tlogger.Error(\\"failed to upload to storage\\", zap.Error(err))\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to upload file\\", 500)\\n\\t}\\n\\n\\t// If this is the first photo or marked as primary, set it as primary\\n\\tif count == 0 {\\n\\t\\tisPrimary = true\\n\\t}\\n\\n\\t// Create media record\\n\\tmedia := &model.Media{\\n\\t\\tProfileID:   profileID,\\n\\t\\tUserID:      userID,\\n\\t\\tType:        model.MediaTypeImage,\\n\\t\\tFilename:    filename,\\n\\t\\tContentType: contentType,\\n\\t\\tSize:        size,\\n\\t\\tURL:         url,\\n\\t\\tIsPrimary:   isPrimary,\\n\\t}\\n\\n\\tif err := s.mediaRepo.Create(ctx, media); err != nil {\\n\\t\\t// Try to clean up the uploaded file\\n\\t\\t_ = s.storage.Delete(ctx, objectName)\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// If marked as primary, update other photos\\n\\tif isPrimary && count > 0 {\\n\\t\\tif err := s.mediaRepo.SetPrimary(ctx, profileID, media.ID); err != nil {\\n\\t\\t\\tlogger.Warn(\\"failed to set primary photo\\", zap.Error(err))\\n\\t\\t}\\n\\t}\\n\\n\\t// Publish event\\n\\ts.publishMediaUploadedEvent(ctx, media)\\n\\n\\tlogger.Info(\\"media uploaded successfully\\",\\n\\t\\tzap.String(\\"media_id\\", media.ID),\\n\\t\\tzap.String(\\"profile_id\\", profileID),\\n\\t\\tzap.String(\\"user_id\\", userID),\\n\\t)\\n\\n\\treturn media, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24","name":"Upload","node_type":"function"},{"code":"func (s *MediaService) getUserInfo(ctx context.Context, userID string) (*model.UserInfo, error) {\\n\\tresp, err := s.userClient.Get(ctx, fmt.Sprintf(\\"/api/v1/users/%s\\", userID), nil)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tif !resp.IsSuccess() {\\n\\t\\treturn nil, errors.NotFound(\\"user not found\\")\\n\\t}\\n\\n\\tvar result struct {\\n\\t\\tData struct {\\n\\t\\t\\tID       string `json:\\"id\\"`\\n\\t\\t\\tEmail    string `json:\\"email\\"`\\n\\t\\t\\tIsActive bool   `json:\\"is_active\\"`\\n\\t\\t} `json:\\"data\\"`\\n\\t}\\n\\tif err := resp.DecodeJSON(&result); err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to decode user response\\", 500)\\n\\t}\\n\\n\\treturn &model.UserInfo{\\n\\t\\tID:       result.Data.ID,\\n\\t\\tEmail:    result.Data.Email,\\n\\t\\tIsActive: result.Data.IsActive,\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:266:24","name":"getUserInfo","node_type":"function"},{"code":"func (s *MediaService) getProfileInfo(ctx context.Context, profileID string) (*model.ProfileInfo, error) {\\n\\tresp, err := s.profileClient.Get(ctx, fmt.Sprintf(\\"/api/v1/profiles/%s\\", profileID), nil)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tif !resp.IsSuccess() {\\n\\t\\treturn nil, errors.NotFound(\\"profile not found\\")\\n\\t}\\n\\n\\tvar result struct {\\n\\t\\tData struct {\\n\\t\\t\\tID     string `json:\\"id\\"`\\n\\t\\t\\tUserID string `json:\\"user_id\\"`\\n\\t\\t\\tName   string `json:\\"name\\"`\\n\\t\\t} `json:\\"data\\"`\\n\\t}\\n\\tif err := resp.DecodeJSON(&result); err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to decode profile response\\", 500)\\n\\t}\\n\\n\\treturn &model.ProfileInfo{\\n\\t\\tID:     result.Data.ID,\\n\\t\\tUserID: result.Data.UserID,\\n\\t\\tName:   result.Data.Name,\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","name":"getProfileInfo","node_type":"function"},{"code":"func (r *MediaRepository) CountByProfileID(ctx context.Context, profileID string) (int, error) {\\n\\tvar count int\\n\\terr := r.db.QueryRowContext(ctx, \\"SELECT COUNT(*) FROM media WHERE profile_id = $1\\", profileID).Scan(&count)\\n\\tif err != nil {\\n\\t\\treturn 0, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to count media\\", 500)\\n\\t}\\n\\treturn count, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:222:27","name":"CountByProfileID","node_type":"function"},{"code":"func (s *MinioStorage) Upload(ctx context.Context, objectName string, reader io.Reader, size int64, contentType string) (string, error) {\\n\\t_, err := s.client.PutObject(ctx, s.bucketName, objectName, reader, size, minio.PutObjectOptions{\\n\\t\\tContentType: contentType,\\n\\t})\\n\\tif err != nil {\\n\\t\\treturn \\"\\", fmt.Errorf(\\"failed to upload file: %w\\", err)\\n\\t}\\n\\n\\turl := s.GetPublicURL(objectName)\\n\\tlogger.Debug(\\"uploaded file to minio\\",\\n\\t\\tzap.String(\\"object\\", objectName),\\n\\t\\tzap.String(\\"url\\", url),\\n\\t\\tzap.Int64(\\"size\\", size),\\n\\t)\\n\\n\\treturn url, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","name":"Upload","node_type":"function"},{"code":"func (s *MinioStorage) GetPublicURL(objectName string) string {\\n\\tif s.publicURL != \\"\\" {\\n\\t\\treturn fmt.Sprintf(\\"%s/%s/%s\\", s.publicURL, s.bucketName, objectName)\\n\\t}\\n\\treturn fmt.Sprintf(\\"http://%s/%s/%s\\", s.client.EndpointURL().Host, s.bucketName, objectName)\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:123:24","name":"GetPublicURL","node_type":"function"},{"code":"func (r *MediaRepository) Create(ctx context.Context, media *model.Media) error {\\n\\tmedia.ID = uuid.New().String()\\n\\tmedia.CreatedAt = time.Now().UTC()\\n\\tmedia.UpdatedAt = media.CreatedAt\\n\\n\\t// Get max sort order for this profile\\n\\tvar maxSortOrder int\\n\\terr := r.db.QueryRowContext(ctx,\\n\\t\\t\\"SELECT COALESCE(MAX(sort_order), -1) FROM media WHERE profile_id = $1\\",\\n\\t\\tmedia.ProfileID,\\n\\t).Scan(&maxSortOrder)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get max sort order\\", 500)\\n\\t}\\n\\tmedia.SortOrder = maxSortOrder + 1\\n\\n\\tquery := `\\n\\tINSERT INTO media (id, profile_id, user_id, type, filename, content_type, size, url, thumbnail_url, is_primary, sort_order, created_at, updated_at)\\n\\tVALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13)\\n\\t`\\n\\t_, err = r.db.ExecContext(ctx, query,\\n\\t\\tmedia.ID, media.ProfileID, media.UserID, media.Type, media.Filename,\\n\\t\\tmedia.ContentType, media.Size, media.URL, media.ThumbnailURL,\\n\\t\\tmedia.IsPrimary, media.SortOrder, media.CreatedAt, media.UpdatedAt,\\n\\t)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to create media\\", 500)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:53:27","name":"Create","node_type":"function"},{"code":"func (s *MinioStorage) Delete(ctx context.Context, objectName string) error {\\n\\terr := s.client.RemoveObject(ctx, s.bucketName, objectName, minio.RemoveObjectOptions{})\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to delete file: %w\\", err)\\n\\t}\\n\\n\\tlogger.Debug(\\"deleted file from minio\\", zap.String(\\"object\\", objectName))\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","name":"Delete","node_type":"function"},{"code":"func (r *MediaRepository) SetPrimary(ctx context.Context, profileID, mediaID string) error {\\n\\ttx, err := r.db.BeginTx(ctx, nil)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to start transaction\\", 500)\\n\\t}\\n\\tdefer tx.Rollback()\\n\\n\\t// Unset all primary for this profile\\n\\t_, err = tx.ExecContext(ctx, \\"UPDATE media SET is_primary = FALSE, updated_at = NOW() WHERE profile_id = $1\\", profileID)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to unset primary\\", 500)\\n\\t}\\n\\n\\t// Set the new primary\\n\\tresult, err := tx.ExecContext(ctx, \\"UPDATE media SET is_primary = TRUE, updated_at = NOW() WHERE id = $1 AND profile_id = $2\\", mediaID, profileID)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to set primary\\", 500)\\n\\t}\\n\\n\\trowsAffected, _ := result.RowsAffected()\\n\\tif rowsAffected == 0 {\\n\\t\\treturn errors.NotFound(\\"media not found\\")\\n\\t}\\n\\n\\treturn tx.Commit()\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","name":"SetPrimary","node_type":"function"},{"code":"func (s *MediaService) publishMediaUploadedEvent(ctx context.Context, media *model.Media) {\\n\\tevent := model.MediaEvent{\\n\\t\\tMediaID:     media.ID,\\n\\t\\tProfileID:   media.ProfileID,\\n\\t\\tUserID:      media.UserID,\\n\\t\\tType:        media.Type,\\n\\t\\tURL:         media.URL,\\n\\t\\tContentType: media.ContentType,\\n\\t\\tSize:        media.Size,\\n\\t\\tTimestamp:   time.Now(),\\n\\t}\\n\\n\\tif err := s.producer.PublishWithKey(ctx, kafka.TopicMediaUploaded, media.ID, \\"media.uploaded\\", event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish media uploaded event\\", zap.Error(err))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:327:24","name":"publishMediaUploadedEvent","node_type":"function"},{"code":"func (h *Handler) handleMediaByID(w http.ResponseWriter, r *http.Request) {\\n\\t// Extract media ID from path\\n\\tpath := strings.TrimPrefix(r.URL.Path, \\"/api/v1/media/\\")\\n\\n\\t// Check if this is a profile or primary route\\n\\tif strings.HasPrefix(path, \\"profile/\\") || strings.HasPrefix(path, \\"primary/\\") {\\n\\t\\treturn // Let other handlers handle these\\n\\t}\\n\\n\\tmediaID := strings.TrimSuffix(path, \\"/\\")\\n\\tif mediaID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"media ID is required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\th.getMedia(w, r, mediaID)\\n\\tcase http.MethodDelete:\\n\\t\\th.deleteMedia(w, r, mediaID)\\n\\tdefault:\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","name":"handleMediaByID","node_type":"function"},{"code":"func (h *Handler) getMedia(w http.ResponseWriter, r *http.Request, mediaID string) {\\n\\tmedia, err := h.mediaService.GetByID(r.Context(), mediaID)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, media)\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","name":"getMedia","node_type":"function"},{"code":"func (s *MediaService) GetByID(ctx context.Context, id string) (*model.Media, error) {\\n\\treturn s.mediaRepo.GetByID(ctx, id)\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:181:24","name":"GetByID","node_type":"function"},{"code":"func (r *MediaRepository) GetByID(ctx context.Context, id string) (*model.Media, error) {\\n\\tquery := `\\n\\tSELECT id, profile_id, user_id, type, filename, content_type, size, url, thumbnail_url, is_primary, sort_order, created_at, updated_at\\n\\tFROM media WHERE id = $1\\n\\t`\\n\\tvar media model.Media\\n\\tvar thumbnailURL sql.NullString\\n\\n\\terr := r.db.QueryRowContext(ctx, query, id).Scan(\\n\\t\\t&media.ID, &media.ProfileID, &media.UserID, &media.Type, &media.Filename,\\n\\t\\t&media.ContentType, &media.Size, &media.URL, &thumbnailURL,\\n\\t\\t&media.IsPrimary, &media.SortOrder, &media.CreatedAt, &media.UpdatedAt,\\n\\t)\\n\\tif err == sql.ErrNoRows {\\n\\t\\treturn nil, errors.NotFound(\\"media not found\\")\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get media\\", 500)\\n\\t}\\n\\n\\tif thumbnailURL.Valid {\\n\\t\\tmedia.ThumbnailURL = thumbnailURL.String\\n\\t}\\n\\n\\treturn &media, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:86:27","name":"GetByID","node_type":"function"},{"code":"func (h *Handler) deleteMedia(w http.ResponseWriter, r *http.Request, mediaID string) {\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"authentication required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tif err := h.mediaService.Delete(r.Context(), userID, mediaID); err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.NoContent(w)\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","name":"deleteMedia","node_type":"function"},{"code":"func (s *MediaService) Delete(ctx context.Context, userID, mediaID string) error {\\n\\t// Get the media record\\n\\tmedia, err := s.mediaRepo.GetByID(ctx, mediaID)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\n\\t// =====================================================\\n\\t// CROSS-SERVICE CALL #3: Verify profile ownership before delete\\n\\t// =====================================================\\n\\tprofileInfo, err := s.getProfileInfo(ctx, media.ProfileID)\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"failed to verify profile for delete\\", zap.String(\\"profile_id\\", media.ProfileID), zap.Error(err))\\n\\t\\treturn errors.Wrap(err, errors.CodeNotFound, \\"profile not found\\", 404)\\n\\t}\\n\\tif profileInfo.UserID != userID {\\n\\t\\treturn errors.Forbidden(\\"you do not own this media\\")\\n\\t}\\n\\n\\t// Extract object name from URL\\n\\tobjectName := s.extractObjectName(media.URL)\\n\\tif objectName != \\"\\" {\\n\\t\\tif err := s.storage.Delete(ctx, objectName); err != nil {\\n\\t\\t\\tlogger.Warn(\\"failed to delete from storage\\", zap.Error(err), zap.String(\\"object\\", objectName))\\n\\t\\t}\\n\\t}\\n\\n\\t// Delete from database\\n\\tif err := s.mediaRepo.Delete(ctx, mediaID); err != nil {\\n\\t\\treturn err\\n\\t}\\n\\n\\t// If this was the primary photo, set another as primary\\n\\tif media.IsPrimary {\\n\\t\\tmediaList, _ := s.mediaRepo.GetByProfileID(ctx, media.ProfileID)\\n\\t\\tif len(mediaList) > 0 {\\n\\t\\t\\t_ = s.mediaRepo.SetPrimary(ctx, media.ProfileID, mediaList[0].ID)\\n\\t\\t}\\n\\t}\\n\\n\\t// Publish event\\n\\ts.publishMediaDeletedEvent(ctx, media)\\n\\n\\tlogger.Info(\\"media deleted successfully\\",\\n\\t\\tzap.String(\\"media_id\\", mediaID),\\n\\t\\tzap.String(\\"profile_id\\", media.ProfileID),\\n\\t)\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","name":"Delete","node_type":"function"},{"code":"func (s *MediaService) extractObjectName(url string) string {\\n\\t// URL format: http://host:port/bucket/object-name\\n\\tparts := strings.Split(url, \\"/\\")\\n\\tif len(parts) >= 5 {\\n\\t\\treturn strings.Join(parts[4:], \\"/\\")\\n\\t}\\n\\treturn \\"\\"\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:362:24","name":"extractObjectName","node_type":"function"},{"code":"func (r *MediaRepository) Delete(ctx context.Context, id string) error {\\n\\tresult, err := r.db.ExecContext(ctx, \\"DELETE FROM media WHERE id = $1\\", id)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to delete media\\", 500)\\n\\t}\\n\\n\\trowsAffected, _ := result.RowsAffected()\\n\\tif rowsAffected == 0 {\\n\\t\\treturn errors.NotFound(\\"media not found\\")\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:150:27","name":"Delete","node_type":"function"},{"code":"func (r *MediaRepository) GetByProfileID(ctx context.Context, profileID string) ([]*model.Media, error) {\\n\\tquery := `\\n\\tSELECT id, profile_id, user_id, type, filename, content_type, size, url, thumbnail_url, is_primary, sort_order, created_at, updated_at\\n\\tFROM media WHERE profile_id = $1\\n\\tORDER BY sort_order ASC\\n\\t`\\n\\trows, err := r.db.QueryContext(ctx, query, profileID)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get media\\", 500)\\n\\t}\\n\\tdefer rows.Close()\\n\\n\\tvar mediaList []*model.Media\\n\\tfor rows.Next() {\\n\\t\\tvar media model.Media\\n\\t\\tvar thumbnailURL sql.NullString\\n\\n\\t\\tif err := rows.Scan(\\n\\t\\t\\t&media.ID, &media.ProfileID, &media.UserID, &media.Type, &media.Filename,\\n\\t\\t\\t&media.ContentType, &media.Size, &media.URL, &thumbnailURL,\\n\\t\\t\\t&media.IsPrimary, &media.SortOrder, &media.CreatedAt, &media.UpdatedAt,\\n\\t\\t); err != nil {\\n\\t\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to scan media\\", 500)\\n\\t\\t}\\n\\n\\t\\tif thumbnailURL.Valid {\\n\\t\\t\\tmedia.ThumbnailURL = thumbnailURL.String\\n\\t\\t}\\n\\n\\t\\tmediaList = append(mediaList, &media)\\n\\t}\\n\\n\\treturn mediaList, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:114:27","name":"GetByProfileID","node_type":"function"},{"code":"func (s *MediaService) publishMediaDeletedEvent(ctx context.Context, media *model.Media) {\\n\\tevent := model.MediaEvent{\\n\\t\\tMediaID:     media.ID,\\n\\t\\tProfileID:   media.ProfileID,\\n\\t\\tUserID:      media.UserID,\\n\\t\\tType:        media.Type,\\n\\t\\tURL:         media.URL,\\n\\t\\tContentType: media.ContentType,\\n\\t\\tSize:        media.Size,\\n\\t\\tTimestamp:   time.Now(),\\n\\t}\\n\\n\\tif err := s.producer.PublishWithKey(ctx, kafka.TopicMediaDeleted, media.ID, \\"media.deleted\\", event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish media deleted event\\", zap.Error(err))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:344:24","name":"publishMediaDeletedEvent","node_type":"function"},{"code":"func (h *Handler) handleMediaByProfile(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Extract profile ID from path\\n\\tprofileID := strings.TrimPrefix(r.URL.Path, \\"/api/v1/media/profile/\\")\\n\\tprofileID = strings.TrimSuffix(profileID, \\"/\\")\\n\\tif profileID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"profile ID is required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tmediaList, err := h.mediaService.GetByProfileID(r.Context(), profileID)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\t// Return empty array instead of null\\n\\tif mediaList == nil {\\n\\t\\tmediaList = []*model.Media{}\\n\\t}\\n\\n\\tresponse.OK(w, mediaList)\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","name":"handleMediaByProfile","node_type":"function"},{"code":"func (s *MediaService) GetByProfileID(ctx context.Context, profileID string) ([]*model.Media, error) {\\n\\treturn s.mediaRepo.GetByProfileID(ctx, profileID)\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:186:24","name":"GetByProfileID","node_type":"function"},{"code":"func (h *Handler) handlePrimary(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"authentication required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Extract profile ID from path\\n\\tprofileID := strings.TrimPrefix(r.URL.Path, \\"/api/v1/media/primary/\\")\\n\\tprofileID = strings.TrimSuffix(profileID, \\"/\\")\\n\\tif profileID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"profile ID is required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.SetPrimaryRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"invalid request body\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tif req.MediaID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"media_id is required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tif err := h.mediaService.SetPrimary(r.Context(), userID, profileID, req.MediaID); err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, map[string]string{\\"message\\": \\"primary photo updated\\"})\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","name":"handlePrimary","node_type":"function"},{"code":"func (s *MediaService) SetPrimary(ctx context.Context, userID, profileID, mediaID string) error {\\n\\t// Verify ownership\\n\\tprofileInfo, err := s.getProfileInfo(ctx, profileID)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tif profileInfo.UserID != userID {\\n\\t\\treturn errors.Forbidden(\\"you do not own this profile\\")\\n\\t}\\n\\n\\treturn s.mediaRepo.SetPrimary(ctx, profileID, mediaID)\\n}","external":"false","id":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","name":"SetPrimary","node_type":"function"}]'),J=JSON.parse('[{"column":30,"line":73,"source":"/home/evan/Code/rinder/services/media/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:33:6","val":1},{"column":19,"line":48,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:33:6","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:57:24","val":1},{"column":38,"line":57,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:57:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:57:24","val":1},{"column":28,"line":63,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:57:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:57:24","val":1},{"column":33,"line":82,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:57:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:57:24","val":1},{"column":25,"line":91,"source":"/home/evan/Code/rinder/services/media/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:19:6","val":1},{"column":21,"line":94,"source":"/home/evan/Code/rinder/services/media/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:24:27","val":1},{"column":28,"line":44,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:24:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:24:27","val":1},{"column":25,"line":100,"source":"/home/evan/Code/rinder/services/media/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:44:6","val":1},{"column":14,"line":113,"source":"/home/evan/Code/rinder/services/media/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:20:6","val":1},{"column":3,"line":117,"source":"/home/evan/Code/rinder/services/media/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","val":1},{"column":29,"line":28,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:38:19","val":1},{"column":35,"line":31,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","val":1},{"column":17,"line":46,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","val":1},{"column":3,"line":50,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","val":1},{"column":17,"line":57,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","val":1},{"column":17,"line":63,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","val":1},{"column":17,"line":70,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","val":1},{"column":17,"line":80,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","val":1},{"column":30,"line":86,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24","val":1},{"column":20,"line":83,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:266:24","val":1},{"column":31,"line":266,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:266:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:266:24","val":1},{"column":68,"line":266,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:266:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:266:24","val":1},{"column":23,"line":99,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","val":1},{"column":34,"line":295,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","val":1},{"column":74,"line":295,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","val":1},{"column":27,"line":118,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:222:27","val":1},{"column":29,"line":223,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:222:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:222:27","val":1},{"column":86,"line":223,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:222:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:222:27","val":1},{"column":23,"line":131,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","val":1},{"column":30,"line":93,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","val":1},{"column":49,"line":93,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","val":1},{"column":61,"line":93,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","val":1},{"column":69,"line":93,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","val":1},{"column":10,"line":100,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:123:24","val":1},{"column":60,"line":124,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:123:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:123:24","val":1},{"column":82,"line":126,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:123:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:123:24","val":1},{"column":23,"line":100,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","val":1},{"column":23,"line":102,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","val":1},{"column":20,"line":104,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24","val":1},{"column":23,"line":154,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:53:27","val":1},{"column":29,"line":59,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:53:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:53:27","val":1},{"column":27,"line":72,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:53:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:53:27","val":1},{"column":16,"line":156,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","val":1},{"column":30,"line":112,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","val":1},{"column":49,"line":112,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","val":1},{"column":62,"line":117,"source":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","val":1},{"column":24,"line":162,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","val":1},{"column":25,"line":165,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","val":1},{"column":25,"line":172,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","val":1},{"column":111,"line":172,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","val":1},{"column":31,"line":178,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","val":1},{"column":128,"line":178,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","val":1},{"column":137,"line":178,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","val":1},{"column":3,"line":168,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:327:24","val":1},{"column":37,"line":338,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:327:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:327:24","val":1},{"column":17,"line":97,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","val":1},{"column":18,"line":101,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19","val":1},{"column":15,"line":50,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","val":1},{"column":18,"line":50,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19","val":1},{"column":36,"line":32,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","val":1},{"column":17,"line":116,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","val":1},{"column":4,"line":122,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","val":1},{"column":30,"line":132,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:181:24","val":1},{"column":20,"line":181,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:181:24","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:86:27","val":1},{"column":29,"line":93,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:86:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:86:27","val":1},{"column":41,"line":93,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:86:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:86:27","val":1},{"column":28,"line":181,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:181:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:181:24","val":1},{"column":33,"line":181,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:181:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:181:24","val":1},{"column":51,"line":132,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","val":1},{"column":17,"line":134,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","val":1},{"column":13,"line":138,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19","val":1},{"column":13,"line":122,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","val":1},{"column":16,"line":122,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","val":1},{"column":4,"line":124,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","val":1},{"column":17,"line":145,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","val":1},{"column":26,"line":149,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":27,"line":192,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:86:27","val":1},{"column":35,"line":192,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":40,"line":192,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":23,"line":200,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","val":1},{"column":38,"line":200,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":17,"line":210,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:362:24","val":1},{"column":24,"line":363,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:362:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:362:24","val":1},{"column":22,"line":212,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24","val":1},{"column":29,"line":212,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":23,"line":218,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:150:27","val":1},{"column":33,"line":150,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:150:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:150:27","val":1},{"column":73,"line":150,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:150:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:150:27","val":1},{"column":30,"line":218,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":35,"line":218,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":30,"line":224,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:114:27","val":1},{"column":32,"line":119,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:114:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:114:27","val":1},{"column":44,"line":119,"source":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:114:27","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:114:27","val":1},{"column":45,"line":224,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":19,"line":226,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","val":1},{"column":30,"line":226,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":3,"line":231,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:344:24","val":1},{"column":37,"line":355,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:344:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:344:24","val":1},{"column":28,"line":231,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":25,"line":234,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24","val":1},{"column":54,"line":149,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","val":1},{"column":17,"line":150,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","val":1},{"column":20,"line":154,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19","val":1},{"column":16,"line":124,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","val":1},{"column":19,"line":124,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","val":1},{"column":17,"line":126,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19","val":1},{"column":44,"line":33,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","val":1},{"column":17,"line":160,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","val":1},{"column":17,"line":168,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","val":1},{"column":34,"line":172,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:186:24","val":1},{"column":20,"line":186,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:186:24","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:114:27","val":1},{"column":35,"line":186,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:186:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:186:24","val":1},{"column":40,"line":186,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:186:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:186:24","val":1},{"column":17,"line":174,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","val":1},{"column":13,"line":183,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19","val":1},{"column":44,"line":34,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","val":1},{"column":17,"line":189,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","val":1},{"column":17,"line":195,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","val":1},{"column":17,"line":203,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","val":1},{"column":17,"line":209,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","val":1},{"column":17,"line":214,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","val":1},{"column":26,"line":218,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","val":1},{"column":23,"line":244,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24","val":1},{"column":38,"line":244,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","val":1},{"column":43,"line":244,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","val":1},{"column":20,"line":252,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","target":"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27","val":1},{"column":31,"line":252,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","val":1},{"column":36,"line":252,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","val":1},{"column":47,"line":252,"source":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","target":"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24","val":1},{"column":17,"line":219,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","val":1},{"column":13,"line":223,"source":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","target":"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19","val":1}]'),wr={nodes:j,links:J},Sr=Object.freeze(Object.defineProperty({__proto__:null,default:wr,links:J,nodes:j},Symbol.toStringTag,{value:"Module"})),Er=[{id:"/home/evan/Code/rinder/services/media/cmd/main.go:25:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/storage/minio.go:33:6",name:"NewMinioStorage",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/storage/minio.go:57:24",name:"ensureBucket",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:19:6",name:"NewMediaRepository",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:24:27",name:"CreateSchema",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:44:6",name:"NewMediaService",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/handler/handler.go:20:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/handler/handler.go:27:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/handler/handler.go:38:19",name:"healthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/handler/handler.go:45:19",name:"handleMedia",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/handler/handler.go:55:19",name:"uploadMedia",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:61:24",name:"Upload",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:266:24",name:"getUserInfo",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:295:24",name:"getProfileInfo",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:222:27",name:"CountByProfileID",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/storage/minio.go:93:24",name:"Upload",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/storage/minio.go:123:24",name:"GetPublicURL",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:53:27",name:"Create",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/storage/minio.go:112:24",name:"Delete",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:165:27",name:"SetPrimary",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:327:24",name:"publishMediaUploadedEvent",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/handler/handler.go:106:19",name:"handleMediaByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/handler/handler.go:132:19",name:"getMedia",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:181:24",name:"GetByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:86:27",name:"GetByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/handler/handler.go:143:19",name:"deleteMedia",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:191:24",name:"Delete",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:362:24",name:"extractObjectName",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:150:27",name:"Delete",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/repository/media_repository.go:114:27",name:"GetByProfileID",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:344:24",name:"publishMediaDeletedEvent",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/handler/handler.go:159:19",name:"handleMediaByProfile",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:186:24",name:"GetByProfileID",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/handler/handler.go:188:19",name:"handlePrimary",node_type:"function"},{id:"/home/evan/Code/rinder/services/media/internal/service/media_service.go:243:24",name:"SetPrimary",node_type:"function"}],Ir=Object.freeze(Object.defineProperty({__proto__:null,default:Er},Symbol.toStringTag,{value:"Module"})),K=13,V="service-notification",Y="/home/evan/Code/rinder/services/notification",Q="cmd/main.go",X="main",ee="github.com/rinder",ne=null,re="2026-01-21T10:24:04.941535279Z",te="2026-01-21T10:24:08.646485275Z",ie="analyzing-completed",ae=JSON.parse(`[{"id":334,"type":"http","method":"ANY","path":"/api/v1/notifications","source_function_name":"RegisterRoutes","function_name":"handleNotifications","source_function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","outputs":[{"id":1965,"handler_id":334,"type":"database","label":"INSERT INTO notifications (...) VALUES (...)","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:24:34","function_name":"Create","description":"Create a new notification row in the notifications table when preference checks allow creation.","created_at":"2026-01-30T10:33:18.542805334Z","updated_at":null},{"id":1964,"handler_id":334,"type":"database","label":"SELECT FROM notification_preferences WHERE user_id = $1","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34","function_name":"GetPreferences","description":"When creating a notification, the service queries the notification_preferences table to load the user's notification preferences.","created_at":"2026-01-30T10:33:18.541590179Z","updated_at":null},{"id":1960,"handler_id":334,"type":"database","label":"SELECT FROM notifications WHERE user_id = $1 ORDER BY created_at DESC LIMIT $2 OFFSET $3","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:96:34","function_name":"GetByUserID","description":"Fetch notifications for a given user (Get notifications list used by GET /api/v1/notifications).","created_at":"2026-01-30T10:33:18.535977019Z","updated_at":null},{"id":1966,"handler_id":334,"type":"database","label":"SELECT FROM push_tokens WHERE user_id = $1","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:314:34","function_name":"GetPushTokens","description":"When push notifications are enabled, the service queries push_tokens to retrieve the user's push tokens.","created_at":"2026-01-30T10:33:18.544826526Z","updated_at":null},{"id":1967,"handler_id":334,"type":"database","label":"UPDATE notifications SET status = $1, updated_at = $2 WHERE id = $3","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:194:34","function_name":"UpdateStatus","description":"After attempting to send push notifications (or regardless), the notification's status is updated to 'sent' in the notifications table.","created_at":"2026-01-30T10:33:18.546193965Z","updated_at":null},{"id":1962,"handler_id":334,"type":"http_response","label":"HTTP 200 OK (response.OK - notifications JSON)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","function_name":"getNotifications","description":"On success, GET /api/v1/notifications returns a 200 HTTP response with the notifications (JSON array) to the client.","created_at":"2026-01-30T10:33:18.538804613Z","updated_at":null},{"id":1969,"handler_id":334,"type":"http_response","label":"HTTP 201 Created (response.Created - created notification JSON or null)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","function_name":"createNotification","description":"On success (or when the service returns nil without error because the user disabled that notification type), POST /api/v1/notifications returns a 201 HTTP response with the created notification (or null) to the client.","created_at":"2026-01-30T10:33:18.548668036Z","updated_at":null},{"id":1963,"handler_id":334,"type":"http_response","label":"HTTP 400 Bad Request (response.Error - Invalid request body or missing required fields)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","function_name":"createNotification","description":"For POST /api/v1/notifications, if the request body is invalid JSON or required fields (user_id, type, title) are missing, a 400 HTTP response is returned to the client.","created_at":"2026-01-30T10:33:18.540063899Z","updated_at":null},{"id":1958,"handler_id":334,"type":"http_response","label":"HTTP 400 Bad Request (response.Error - Method not allowed)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","function_name":"handleNotifications","description":"If the request method is not GET or POST, the handler returns a 400 HTTP response to the client.","created_at":"2026-01-30T10:33:18.53144639Z","updated_at":null},{"id":1959,"handler_id":334,"type":"http_response","label":"HTTP 401 Unauthorized (response.Error - User not authenticated)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","function_name":"getNotifications","description":"For GET /api/v1/notifications, if the X-User-ID header is missing the handler returns a 401 HTTP response to the client.","created_at":"2026-01-30T10:33:18.534423062Z","updated_at":null},{"id":1957,"handler_id":334,"type":"http_response","label":"HTTP 404 Not Found (response.Error - Not found)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","function_name":"handleNotifications","description":"If the request path is not exactly /api/v1/notifications, the handler returns a 404 HTTP response to the client.","created_at":"2026-01-30T10:33:18.518493325Z","updated_at":null},{"id":1968,"handler_id":334,"type":"http_response","label":"HTTP 500 Internal Server Error (response.Error - Failed to create notification)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","function_name":"createNotification","description":"If the service reports an error while creating the notification (repository errors etc.), the POST handler returns a 500 HTTP response to the client.","created_at":"2026-01-30T10:33:18.547421543Z","updated_at":null},{"id":1961,"handler_id":334,"type":"http_response","label":"HTTP 500 Internal Server Error (response.Error - Failed to get notifications)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","function_name":"getNotifications","description":"If fetching notifications from the repository returns an error, a 500 HTTP response is returned to the client for GET /api/v1/notifications.","created_at":"2026-01-30T10:33:18.537321481Z","updated_at":null}],"created_at":"2026-01-30T10:32:15.257178547Z","updated_at":null},{"id":335,"type":"http","method":"ANY","path":"/api/v1/notifications/","source_function_name":"RegisterRoutes","function_name":"handleNotificationByID","source_function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","outputs":[{"id":1934,"handler_id":335,"type":"database","label":"SELECT id, user_id, type, title, body, data, status, read_at, created_at, updated_at FROM notifications WHERE id = $1","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:57:34","function_name":"GetByID","description":"Repository queries the notifications table to retrieve the notification by ID to verify existence and ownership.","created_at":"2026-01-30T10:33:09.624883939Z","updated_at":null},{"id":1937,"handler_id":335,"type":"database","label":"UPDATE notifications SET status = 'read', read_at = $1, updated_at = $1 WHERE id = $2","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:160:34","function_name":"MarkAsRead","description":"Repository executes an UPDATE to mark the notification as read (sets status and timestamps).","created_at":"2026-01-30T10:33:09.62953816Z","updated_at":null},{"id":1939,"handler_id":335,"type":"http_response","label":"HTTP 200 OK response (Marked as read)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","function_name":"markAsRead","description":"When the notification is successfully verified and updated to 'read', the handler returns an HTTP 200 OK response with JSON {\\"message\\": \\"Marked as read\\"}.","created_at":"2026-01-30T10:33:09.633560112Z","updated_at":null},{"id":1933,"handler_id":335,"type":"http_response","label":"HTTP 400 Bad Request response (Method not allowed)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","function_name":"handleNotificationByID","description":"If the HTTP method is not PATCH, the handler returns a 400 Bad Request response indicating the method is not allowed.","created_at":"2026-01-30T10:33:09.623037184Z","updated_at":null},{"id":1932,"handler_id":335,"type":"http_response","label":"HTTP 401 Unauthorized response (User not authenticated)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","function_name":"handleNotificationByID","description":"If the X-User-ID header is missing from the request, the handler returns a 401 Unauthorized response to the client.","created_at":"2026-01-30T10:33:09.619706117Z","updated_at":null},{"id":1936,"handler_id":335,"type":"http_response","label":"HTTP 403 Forbidden response (Not authorized)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","function_name":"markAsRead","description":"If the notification exists but its user_id differs from the X-User-ID header (ownership mismatch), the handler returns a 403 Forbidden response to the client.","created_at":"2026-01-30T10:33:09.62814552Z","updated_at":null},{"id":1935,"handler_id":335,"type":"http_response","label":"HTTP 404 Not Found response (Notification not found - DB returned no rows)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","function_name":"markAsRead","description":"If the repository reports the notification does not exist (no rows), the handler returns a 404 Not Found response to the client.","created_at":"2026-01-30T10:33:09.626355706Z","updated_at":null},{"id":1931,"handler_id":335,"type":"http_response","label":"HTTP 404 Not Found response (Notification not found - invalid path)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","function_name":"handleNotificationByID","description":"If the request path does not contain a single notification ID (empty or contains '/'), the handler returns a 404 Not Found response to the client.","created_at":"2026-01-30T10:33:09.606664101Z","updated_at":null},{"id":1938,"handler_id":335,"type":"http_response","label":"HTTP 500 Internal Server Error response (Failed to mark as read)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","function_name":"markAsRead","description":"If an unexpected error occurs while retrieving the notification or updating it (database error or other internal error), the handler returns a 500 Internal Server Error response to the client.","created_at":"2026-01-30T10:33:09.630907489Z","updated_at":null}],"created_at":"2026-01-30T10:32:15.259260487Z","updated_at":null},{"id":336,"type":"http","method":"ANY","path":"/api/v1/notifications/count","source_function_name":"RegisterRoutes","function_name":"GetUnreadCount","source_function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","outputs":[{"id":1897,"handler_id":336,"type":"database","label":"SELECT COUNT(*) FROM notifications WHERE user_id = $1 AND status != 'read'","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:144:34","function_name":"GetUnreadCount","description":"A SQL query is executed against the service database to count notifications for the given user that are not marked 'read'.","created_at":"2026-01-30T10:32:46.775423983Z","updated_at":null},{"id":1898,"handler_id":336,"type":"http_response","label":"HTTP 200 JSON response with {\\"count\\": <int>}","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","function_name":"GetUnreadCount","description":"On success the handler returns an HTTP 200 response to the client with a JSON body containing the unread notification count.","created_at":"2026-01-30T10:32:46.790338348Z","updated_at":null},{"id":1899,"handler_id":336,"type":"http_response","label":"HTTP 400 Bad Request response (Method not allowed)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","function_name":"GetUnreadCount","description":"If the incoming request method is not GET the handler returns an HTTP error response indicating a bad request / method not allowed.","created_at":"2026-01-30T10:32:46.792434141Z","updated_at":null},{"id":1900,"handler_id":336,"type":"http_response","label":"HTTP 401 Unauthorized response (User not authenticated)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","function_name":"GetUnreadCount","description":"If the X-User-ID header is missing the handler returns an HTTP unauthorized response to the client.","created_at":"2026-01-30T10:32:46.794552555Z","updated_at":null},{"id":1901,"handler_id":336,"type":"http_response","label":"HTTP 500 Internal Server Error response (Failed to get unread count)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","function_name":"GetUnreadCount","description":"If retrieving the unread count from the repository fails, the handler returns an HTTP 500 Internal Server Error response to the client.","created_at":"2026-01-30T10:32:46.795498137Z","updated_at":null}],"created_at":"2026-01-30T10:32:15.260400058Z","updated_at":null},{"id":338,"type":"http","method":"ANY","path":"/api/v1/notifications/preferences","source_function_name":"RegisterRoutes","function_name":"handlePreferences","source_function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","outputs":[{"id":1925,"handler_id":338,"type":"database","label":"INSERT INTO notification_preferences ... ON CONFLICT (user_id) DO UPDATE","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:257:34","function_name":"SavePreferences","description":"When saving updated preferences (PUT), the repository executes an INSERT ... ON CONFLICT DO UPDATE statement (Exec) to insert or update the notification_preferences row for the user.","created_at":"2026-01-30T10:33:02.123079912Z","updated_at":null},{"id":1924,"handler_id":338,"type":"database","label":"SELECT FROM notification_preferences WHERE user_id = $1","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34","function_name":"GetPreferences","description":"When retrieving preferences (both GET and as part of UpdatePreferences), the repository executes a SELECT query against the notification_preferences table to fetch the row for the given user_id. If no row is found (sql.ErrNoRows), default preferences are returned without further DB writes.","created_at":"2026-01-30T10:33:02.1219536Z","updated_at":null},{"id":1922,"handler_id":338,"type":"http_response","label":"HTTP 200 OK (GET preferences)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","function_name":"handlePreferences","description":"On a successful GET, the handler returns an HTTP 200 response with the NotificationPreference payload to the client.","created_at":"2026-01-30T10:33:02.11996384Z","updated_at":null},{"id":1923,"handler_id":338,"type":"http_response","label":"HTTP 200 OK (PUT updated preferences)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","function_name":"handlePreferences","description":"On a successful PUT, after updating and saving preferences, the handler returns an HTTP 200 response with the updated NotificationPreference payload to the client.","created_at":"2026-01-30T10:33:02.120985498Z","updated_at":null},{"id":1918,"handler_id":338,"type":"http_response","label":"HTTP error response (Bad Request - invalid JSON body)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","function_name":"handlePreferences","description":"For PUT requests, if the request body cannot be decoded as JSON into the UpdatePreferencesRequest, the handler returns a 400 Bad Request response to the client.","created_at":"2026-01-30T10:33:02.110134486Z","updated_at":null},{"id":1919,"handler_id":338,"type":"http_response","label":"HTTP error response (Bad Request - method not allowed)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","function_name":"handlePreferences","description":"If the HTTP method is not GET or PUT, the handler returns a 400 Bad Request (method not allowed) response to the client.","created_at":"2026-01-30T10:33:02.112982106Z","updated_at":null},{"id":1920,"handler_id":338,"type":"http_response","label":"HTTP error response (Internal Server Error on GetPreferences)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","function_name":"handlePreferences","description":"If the NotificationService.GetPreferences call returns an error while handling a GET request, the handler returns an internal server error response to the client.","created_at":"2026-01-30T10:33:02.115082583Z","updated_at":null},{"id":1921,"handler_id":338,"type":"http_response","label":"HTTP error response (Internal Server Error on UpdatePreferences)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","function_name":"handlePreferences","description":"If the NotificationService.UpdatePreferences call returns an error while handling a PUT request, the handler returns an internal server error response to the client.","created_at":"2026-01-30T10:33:02.11874697Z","updated_at":null},{"id":1917,"handler_id":338,"type":"http_response","label":"HTTP error response (Unauthorized)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","function_name":"handlePreferences","description":"If the X-User-ID header is missing, the handler returns an unauthorized error response to the client.","created_at":"2026-01-30T10:33:02.096610708Z","updated_at":null}],"created_at":"2026-01-30T10:32:15.263229906Z","updated_at":null},{"id":339,"type":"http","method":"ANY","path":"/api/v1/notifications/push-token","source_function_name":"RegisterRoutes","function_name":"handlePushToken","source_function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","outputs":[{"id":1953,"handler_id":339,"type":"database","label":"DELETE FROM push_tokens WHERE user_id = $1 AND platform = $2","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:348:34","function_name":"DeletePushToken","description":"When unregistering a push token (DELETE) and a platform is provided, a DELETE is executed to remove the push token row for the given user and platform.","created_at":"2026-01-30T10:33:15.649734886Z","updated_at":null},{"id":1949,"handler_id":339,"type":"database","label":"INSERT INTO push_tokens ... ON CONFLICT (user_id, platform) DO UPDATE SET token = $3, updated_at = $6","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:295:34","function_name":"SavePushToken","description":"When registering a push token (POST) and validation passes, an INSERT is executed to save the push token. If a row for (user_id, platform) already exists, the token and updated_at are updated instead.","created_at":"2026-01-30T10:33:15.644388786Z","updated_at":null},{"id":1955,"handler_id":339,"type":"http_response","label":"HTTP 200 OK (Push token deleted)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","function_name":"handlePushToken","description":"On successful completion of UnregisterPushToken (i.e. the token row was deleted), the handler returns an HTTP 200 OK response with a JSON message {\\"message\\": \\"Push token deleted\\"}.","created_at":"2026-01-30T10:33:15.652579275Z","updated_at":null},{"id":1951,"handler_id":339,"type":"http_response","label":"HTTP 200 OK (Push token registered)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","function_name":"handlePushToken","description":"On successful completion of RegisterPushToken (i.e. the token was saved/updated successfully), the handler returns an HTTP 200 OK response with a JSON message {\\"message\\": \\"Push token registered\\"}.","created_at":"2026-01-30T10:33:15.647228144Z","updated_at":null},{"id":1956,"handler_id":339,"type":"http_response","label":"HTTP 400 Bad Request (Method not allowed)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","function_name":"handlePushToken","description":"If the request method is not POST or DELETE, the handler returns an HTTP 400 Bad Request response indicating the method is not allowed.","created_at":"2026-01-30T10:33:15.653837232Z","updated_at":null},{"id":1948,"handler_id":339,"type":"http_response","label":"HTTP 400 Bad Request (invalid JSON body)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","function_name":"handlePushToken","description":"For POST requests, if the request body cannot be JSON-decoded into model.RegisterTokenRequest, the handler returns an HTTP 400 Bad Request response to the client.","created_at":"2026-01-30T10:33:15.642374778Z","updated_at":null},{"id":1952,"handler_id":339,"type":"http_response","label":"HTTP 400 Bad Request (platform required)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","function_name":"handlePushToken","description":"For DELETE requests, if the 'platform' query parameter is missing, the handler returns an HTTP 400 Bad Request response to the client.","created_at":"2026-01-30T10:33:15.6484684Z","updated_at":null},{"id":1947,"handler_id":339,"type":"http_response","label":"HTTP 401 Unauthorized","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","function_name":"handlePushToken","description":"If the X-User-ID header is missing, the handler returns an HTTP 401 Unauthorized response to the client and stops processing.","created_at":"2026-01-30T10:33:15.628275352Z","updated_at":null},{"id":1950,"handler_id":339,"type":"http_response","label":"HTTP 500 Internal Server Error (register failed)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","function_name":"handlePushToken","description":"If RegisterPushToken returns an error (for example validation failed or the database Exec failed), the handler returns an HTTP 500 Internal Server Error response to the client.","created_at":"2026-01-30T10:33:15.645879987Z","updated_at":null},{"id":1954,"handler_id":339,"type":"http_response","label":"HTTP 500 Internal Server Error (unregister failed)","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","function_name":"handlePushToken","description":"If UnregisterPushToken returns an error (for example the database Exec failed), the handler returns an HTTP 500 Internal Server Error response to the client.","created_at":"2026-01-30T10:33:15.651266322Z","updated_at":null}],"created_at":"2026-01-30T10:32:15.265936077Z","updated_at":null},{"id":337,"type":"http","method":"ANY","path":"/api/v1/notifications/read-all","source_function_name":"RegisterRoutes","function_name":"MarkAllAsRead","source_function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","outputs":[{"id":1904,"handler_id":337,"type":"database","label":"UPDATE notifications SET status = 'read', read_at = $1, updated_at = $1 WHERE user_id = $2 AND status != 'read'","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:177:34","function_name":"MarkAllAsRead","description":"The repository executes an UPDATE statement marking all notifications for the given user_id that are not already 'read' as 'read', setting read_at and updated_at to the current time.","created_at":"2026-01-30T10:32:53.947640322Z","updated_at":null},{"id":1906,"handler_id":337,"type":"http_response","label":"HTTP 200 OK JSON response","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","function_name":"MarkAllAsRead","description":"On success (notifications marked as read), the handler returns an HTTP 200 OK response with a JSON body {\\"message\\": \\"All notifications marked as read\\"}.","created_at":"2026-01-30T10:32:53.950318897Z","updated_at":null},{"id":1902,"handler_id":337,"type":"http_response","label":"HTTP 400 Bad Request response","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","function_name":"MarkAllAsRead","description":"If the incoming HTTP request method is not POST, the handler returns an HTTP 400 Bad Request response to the client.","created_at":"2026-01-30T10:32:53.941791797Z","updated_at":null},{"id":1903,"handler_id":337,"type":"http_response","label":"HTTP 401 Unauthorized response","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","function_name":"MarkAllAsRead","description":"If the X-User-ID header is missing, the handler returns an HTTP 401 Unauthorized response to the client.","created_at":"2026-01-30T10:32:53.945994591Z","updated_at":null},{"id":1905,"handler_id":337,"type":"http_response","label":"HTTP 500 Internal Server Error response","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","function_name":"MarkAllAsRead","description":"If the repository returns an error when updating notifications, the handler returns an HTTP 500 Internal Server Error response to the client.","created_at":"2026-01-30T10:32:53.949167122Z","updated_at":null}],"created_at":"2026-01-30T10:32:15.261354221Z","updated_at":null},{"id":333,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"Health","source_function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:39:19","outputs":[{"id":1895,"handler_id":333,"type":"http_response","label":"HTTP 200 JSON response {\\"status\\":\\"healthy\\",\\"service\\":\\"notification\\"}","function_id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:39:19","function_name":"Health","description":"The Health handler writes an HTTP 200 response with a JSON body indicating the service is healthy.","created_at":"2026-01-30T10:32:30.389810772Z","updated_at":null}],"created_at":"2026-01-30T10:32:15.243826413Z","updated_at":null},{"id":340,"type":"kafka","method":"","path":"match.created","source_function_name":"NewMatchConsumer","function_name":"handleMatchCreated","source_function_id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:24:6","function_id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","outputs":[{"id":1910,"handler_id":340,"type":"database","label":"INSERT INTO notifications (...) VALUES (...)","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:24:34","function_name":"Create","description":"Insert a new notification row for user1 into the notifications table.","created_at":"2026-01-30T10:32:58.981201805Z","updated_at":null},{"id":1914,"handler_id":340,"type":"database","label":"INSERT INTO notifications (...) VALUES (...)","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:24:34","function_name":"Create","description":"Insert a new notification row for user2 into the notifications table.","created_at":"2026-01-30T10:32:58.986228541Z","updated_at":null},{"id":1909,"handler_id":340,"type":"database","label":"SELECT FROM notification_preferences WHERE user_id = $1","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34","function_name":"GetPreferences","description":"Query the notification_preferences table to get user1's notification preferences.","created_at":"2026-01-30T10:32:58.979338882Z","updated_at":null},{"id":1913,"handler_id":340,"type":"database","label":"SELECT FROM notification_preferences WHERE user_id = $1","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34","function_name":"GetPreferences","description":"Query the notification_preferences table to get user2's notification preferences.","created_at":"2026-01-30T10:32:58.984901322Z","updated_at":null},{"id":1911,"handler_id":340,"type":"database","label":"SELECT FROM push_tokens WHERE user_id = $1","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:314:34","function_name":"GetPushTokens","description":"Query the push_tokens table to retrieve user1's push tokens (only executed if push notifications are enabled for user1).","created_at":"2026-01-30T10:32:58.982486219Z","updated_at":null},{"id":1915,"handler_id":340,"type":"database","label":"SELECT FROM push_tokens WHERE user_id = $1","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:314:34","function_name":"GetPushTokens","description":"Query the push_tokens table to retrieve user2's push tokens (only executed if push notifications are enabled for user2).","created_at":"2026-01-30T10:32:58.9876095Z","updated_at":null},{"id":1912,"handler_id":340,"type":"database","label":"UPDATE notifications SET status = $1, updated_at = $2 WHERE id = $3","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:194:34","function_name":"UpdateStatus","description":"Update the notification row status to 'sent' for the notification created for user1.","created_at":"2026-01-30T10:32:58.983695596Z","updated_at":null},{"id":1916,"handler_id":340,"type":"database","label":"UPDATE notifications SET status = $1, updated_at = $2 WHERE id = $3","function_id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:194:34","function_name":"UpdateStatus","description":"Update the notification row status to 'sent' for the notification created for user2.","created_at":"2026-01-30T10:32:58.988875607Z","updated_at":null},{"id":1907,"handler_id":340,"type":"http","label":"HTTP GET /api/v1/users/{user1_id}","function_id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","function_name":"getUserName","description":"An HTTP GET request is made to the user service to fetch user1's data (used to obtain the first name for a personalized notification).","created_at":"2026-01-30T10:32:58.963347113Z","updated_at":null},{"id":1908,"handler_id":340,"type":"http","label":"HTTP GET /api/v1/users/{user2_id}","function_id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","function_name":"getUserName","description":"An HTTP GET request is made to the user service to fetch user2's data (used to obtain the first name for a personalized notification).","created_at":"2026-01-30T10:32:58.975448353Z","updated_at":null}],"created_at":"2026-01-30T10:32:15.269337851Z","updated_at":null}]`),Pr={id:K,name:V,git_repo_url:Y,entrypoint_path:Q,entrypoint_function:X,git_org_url:ee,git_commit:ne,created_at:re,updated_at:te,status:ie,handlers:ae},Rr=Object.freeze(Object.defineProperty({__proto__:null,created_at:re,default:Pr,entrypoint_function:X,entrypoint_path:Q,git_commit:ne,git_org_url:ee,git_repo_url:Y,handlers:ae,id:K,name:V,status:ie,updated_at:te},Symbol.toStringTag,{value:"Module"})),oe=JSON.parse('[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"notification\\", 8084)\\n\\tkafkaCfg := config.NewKafkaConfig(\\"notification-service\\")\\n\\n\\t// Database config\\n\\tdbHost := config.GetEnv(\\"DB_HOST\\", \\"localhost\\")\\n\\tdbPort := config.GetEnv(\\"DB_PORT\\", \\"5435\\")\\n\\tdbUser := config.GetEnv(\\"DB_USER\\", \\"rinder\\")\\n\\tdbPassword := config.GetEnv(\\"DB_PASSWORD\\", \\"rinder123\\")\\n\\tdbName := config.GetEnv(\\"DB_NAME\\", \\"rinder_notifications\\")\\n\\n\\t// User service URL (for getting user names)\\n\\tuserServiceURL := config.GetEnv(\\"USER_SERVICE_URL\\", \\"http://localhost:8081\\")\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting notification service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t)\\n\\n\\t// Connect to PostgreSQL\\n\\tdsn := fmt.Sprintf(\\"host=%s port=%s user=%s password=%s dbname=%s sslmode=disable\\",\\n\\t\\tdbHost, dbPort, dbUser, dbPassword, dbName)\\n\\n\\tdb, err := sql.Open(\\"postgres\\", dsn)\\n\\tif err != nil {\\n\\t\\tlogger.Fatal(\\"failed to connect to database\\", zap.Error(err))\\n\\t}\\n\\tdefer db.Close()\\n\\n\\t// Verify connection\\n\\tif err := db.Ping(); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to ping database\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"connected to PostgreSQL\\")\\n\\n\\t// Run migrations\\n\\tif err := runMigrations(db); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to run migrations\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"database migrations complete\\")\\n\\n\\t// Initialize repository and service\\n\\tnotificationRepo := repository.NewNotificationRepository(db)\\n\\tnotificationService := service.NewNotificationService(notificationRepo)\\n\\n\\t// Initialize Kafka consumer\\n\\tmatchConsumer := consumer.NewMatchConsumer(kafkaCfg.Brokers, notificationService, userServiceURL)\\n\\n\\t// Start consumer\\n\\tctx, cancel := context.WithCancel(context.Background())\\n\\tmatchConsumer.Start(ctx)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(notificationService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  15 * time.Second,\\n\\t\\tWriteTimeout: 15 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server in goroutine\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"notification service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Stop consumer\\n\\tcancel()\\n\\tmatchConsumer.Stop()\\n\\n\\t// Graceful shutdown\\n\\tshutdownCtx, shutdownCancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer shutdownCancel()\\n\\n\\tif err := server.Shutdown(shutdownCtx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server stopped\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/cmd/main.go:24:1","name":"ROOT","node_type":"function"},{"code":"func runMigrations(db *sql.DB) error {\\n\\tmigrations := []string{\\n\\t\\t`CREATE TABLE IF NOT EXISTS notifications (\\n\\t\\t\\tid VARCHAR(36) PRIMARY KEY,\\n\\t\\t\\tuser_id VARCHAR(36) NOT NULL,\\n\\t\\t\\ttype VARCHAR(50) NOT NULL,\\n\\t\\t\\ttitle VARCHAR(255) NOT NULL,\\n\\t\\t\\tbody TEXT,\\n\\t\\t\\tdata JSONB,\\n\\t\\t\\tstatus VARCHAR(20) NOT NULL DEFAULT \'pending\',\\n\\t\\t\\tread_at TIMESTAMP,\\n\\t\\t\\tcreated_at TIMESTAMP NOT NULL DEFAULT NOW(),\\n\\t\\t\\tupdated_at TIMESTAMP NOT NULL DEFAULT NOW()\\n\\t\\t)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_notifications_user_id ON notifications(user_id)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_notifications_status ON notifications(status)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_notifications_created_at ON notifications(created_at)`,\\n\\t\\t`CREATE TABLE IF NOT EXISTS notification_preferences (\\n\\t\\t\\tuser_id VARCHAR(36) PRIMARY KEY,\\n\\t\\t\\tpush_enabled BOOLEAN NOT NULL DEFAULT true,\\n\\t\\t\\temail_enabled BOOLEAN NOT NULL DEFAULT true,\\n\\t\\t\\tmatch_notify BOOLEAN NOT NULL DEFAULT true,\\n\\t\\t\\tmessage_notify BOOLEAN NOT NULL DEFAULT true,\\n\\t\\t\\tlike_notify BOOLEAN NOT NULL DEFAULT true,\\n\\t\\t\\tcreated_at TIMESTAMP NOT NULL DEFAULT NOW(),\\n\\t\\t\\tupdated_at TIMESTAMP NOT NULL DEFAULT NOW()\\n\\t\\t)`,\\n\\t\\t`CREATE TABLE IF NOT EXISTS push_tokens (\\n\\t\\t\\tid VARCHAR(36) PRIMARY KEY,\\n\\t\\t\\tuser_id VARCHAR(36) NOT NULL,\\n\\t\\t\\ttoken TEXT NOT NULL,\\n\\t\\t\\tplatform VARCHAR(20) NOT NULL,\\n\\t\\t\\tcreated_at TIMESTAMP NOT NULL DEFAULT NOW(),\\n\\t\\t\\tupdated_at TIMESTAMP NOT NULL DEFAULT NOW(),\\n\\t\\t\\tUNIQUE(user_id, platform)\\n\\t\\t)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_push_tokens_user_id ON push_tokens(user_id)`,\\n\\t}\\n\\n\\tfor _, migration := range migrations {\\n\\t\\tif _, err := db.Exec(migration); err != nil {\\n\\t\\t\\treturn fmt.Errorf(\\"migration failed: %w\\", err)\\n\\t\\t}\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/cmd/main.go:130:6","name":"runMigrations","node_type":"function"},{"code":"func NewNotificationRepository(db *sql.DB) *NotificationRepository {\\n\\treturn &NotificationRepository{db: db}\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:19:6","name":"NewNotificationRepository","node_type":"function"},{"code":"func NewNotificationService(repo *repository.NotificationRepository) *NotificationService {\\n\\treturn &NotificationService{repo: repo}\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:18:6","name":"NewNotificationService","node_type":"function"},{"code":"func NewMatchConsumer(\\n\\tbrokers []string,\\n\\tnotificationService *service.NotificationService,\\n\\tuserServiceURL string,\\n) *MatchConsumer {\\n\\tconsumer := kafka.NewConsumer(brokers, \\"notification-service\\", []string{kafka.TopicMatchCreated})\\n\\n\\tmc := &MatchConsumer{\\n\\t\\tconsumer:            consumer,\\n\\t\\tnotificationService: notificationService,\\n\\t\\tuserClient:          httpclient.NewClient(userServiceURL, \\"user-service\\", 10*time.Second),\\n\\t}\\n\\n\\t// Register handler for match created events\\n\\tconsumer.RegisterHandler(kafka.EventMatchCreated, mc.handleMatchCreated)\\n\\n\\treturn mc\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:24:6","name":"NewMatchConsumer","node_type":"function"},{"code":"func (c *MatchConsumer) handleMatchCreated(ctx context.Context, event kafka.Event) error {\\n\\tvar matchData struct {\\n\\t\\tMatchID    string `json:\\"match_id\\"`\\n\\t\\tUser1ID    string `json:\\"user1_id\\"`\\n\\t\\tUser2ID    string `json:\\"user2_id\\"`\\n\\t\\tProfile1ID string `json:\\"profile1_id\\"`\\n\\t\\tProfile2ID string `json:\\"profile2_id\\"`\\n\\t\\tTimestamp  string `json:\\"timestamp\\"`\\n\\t}\\n\\n\\tif err := json.Unmarshal(event.Data, &matchData); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal match data\\", zap.Error(err))\\n\\t\\treturn nil // Don\'t retry malformed messages\\n\\t}\\n\\n\\tlogger.Info(\\"received match event\\",\\n\\t\\tzap.String(\\"match_id\\", matchData.MatchID),\\n\\t\\tzap.String(\\"user1_id\\", matchData.User1ID),\\n\\t\\tzap.String(\\"user2_id\\", matchData.User2ID),\\n\\t)\\n\\n\\t// Get user names for personalized notifications\\n\\tuser1Name := c.getUserName(ctx, matchData.User1ID)\\n\\tuser2Name := c.getUserName(ctx, matchData.User2ID)\\n\\n\\t// Send notification to User1\\n\\t_, err := c.notificationService.CreateMatchNotification(matchData.User1ID, matchData.MatchID, user2Name)\\n\\tif err != nil {\\n\\t\\tlogger.Error(\\"failed to create notification for user1\\", zap.String(\\"user_id\\", matchData.User1ID), zap.Error(err))\\n\\t}\\n\\n\\t// Send notification to User2\\n\\t_, err = c.notificationService.CreateMatchNotification(matchData.User2ID, matchData.MatchID, user1Name)\\n\\tif err != nil {\\n\\t\\tlogger.Error(\\"failed to create notification for user2\\", zap.String(\\"user_id\\", matchData.User2ID), zap.Error(err))\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","name":"handleMatchCreated","node_type":"function"},{"code":"func (c *MatchConsumer) getUserName(ctx context.Context, userID string) string {\\n\\tresp, err := c.userClient.Get(ctx, fmt.Sprintf(\\"/api/v1/users/%s\\", userID), nil)\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"failed to get user name\\", zap.String(\\"user_id\\", userID), zap.Error(err))\\n\\t\\treturn \\"Someone\\"\\n\\t}\\n\\n\\tvar result struct {\\n\\t\\tSuccess bool `json:\\"success\\"`\\n\\t\\tData    struct {\\n\\t\\t\\tFirstName string `json:\\"first_name\\"`\\n\\t\\t} `json:\\"data\\"`\\n\\t}\\n\\tif err := json.Unmarshal(resp.Body, &result); err != nil || !result.Success {\\n\\t\\treturn \\"Someone\\"\\n\\t}\\n\\n\\tif result.Data.FirstName != \\"\\" {\\n\\t\\treturn result.Data.FirstName\\n\\t}\\n\\treturn \\"Someone\\"\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","name":"getUserName","node_type":"function"},{"code":"func (s *NotificationService) CreateMatchNotification(userID, matchID, otherUserName string) (*model.Notification, error) {\\n\\treturn s.CreateNotification(&model.CreateNotificationRequest{\\n\\t\\tUserID: userID,\\n\\t\\tType:   model.NotificationTypeMatch,\\n\\t\\tTitle:  \\"It\'s a Match! \\",\\n\\t\\tBody:   fmt.Sprintf(\\"You and %s\'s dogs have liked each other!\\", otherUserName),\\n\\t\\tData: map[string]string{\\n\\t\\t\\t\\"match_id\\": matchID,\\n\\t\\t\\t\\"action\\":   \\"view_match\\",\\n\\t\\t},\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:232:31","name":"CreateMatchNotification","node_type":"function"},{"code":"func (s *NotificationService) CreateNotification(req *model.CreateNotificationRequest) (*model.Notification, error) {\\n\\t// Get user preferences\\n\\tprefs, err := s.repo.GetPreferences(req.UserID)\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"failed to get preferences\\", zap.String(\\"user_id\\", req.UserID), zap.Error(err))\\n\\t\\t// Continue with defaults\\n\\t\\tprefs = &model.NotificationPreference{\\n\\t\\t\\tPushEnabled:   true,\\n\\t\\t\\tMatchNotify:   true,\\n\\t\\t\\tMessageNotify: true,\\n\\t\\t\\tLikeNotify:    true,\\n\\t\\t}\\n\\t}\\n\\n\\t// Check if user wants this type of notification\\n\\tswitch req.Type {\\n\\tcase model.NotificationTypeMatch:\\n\\t\\tif !prefs.MatchNotify {\\n\\t\\t\\tlogger.Info(\\"user has disabled match notifications\\", zap.String(\\"user_id\\", req.UserID))\\n\\t\\t\\treturn nil, nil\\n\\t\\t}\\n\\tcase model.NotificationTypeMessage:\\n\\t\\tif !prefs.MessageNotify {\\n\\t\\t\\tlogger.Info(\\"user has disabled message notifications\\", zap.String(\\"user_id\\", req.UserID))\\n\\t\\t\\treturn nil, nil\\n\\t\\t}\\n\\tcase model.NotificationTypeLike:\\n\\t\\tif !prefs.LikeNotify {\\n\\t\\t\\tlogger.Info(\\"user has disabled like notifications\\", zap.String(\\"user_id\\", req.UserID))\\n\\t\\t\\treturn nil, nil\\n\\t\\t}\\n\\t}\\n\\n\\t// Create notification\\n\\tnotification := &model.Notification{\\n\\t\\tUserID: req.UserID,\\n\\t\\tType:   req.Type,\\n\\t\\tTitle:  req.Title,\\n\\t\\tBody:   req.Body,\\n\\t\\tData:   req.Data,\\n\\t}\\n\\n\\tif err := s.repo.Create(notification); err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to create notification: %w\\", err)\\n\\t}\\n\\n\\t// Send push notification if enabled\\n\\tif prefs.PushEnabled {\\n\\t\\tif err := s.sendPushNotification(notification); err != nil {\\n\\t\\t\\tlogger.Warn(\\"failed to send push notification\\", zap.Error(err))\\n\\t\\t\\t// Don\'t fail the request, just log\\n\\t\\t}\\n\\t}\\n\\n\\t// Mark as sent\\n\\ts.repo.UpdateStatus(notification.ID, model.NotificationStatusSent)\\n\\tnotification.Status = model.NotificationStatusSent\\n\\n\\treturn notification, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:23:31","name":"CreateNotification","node_type":"function"},{"code":"func (r *NotificationRepository) GetPreferences(userID string) (*model.NotificationPreference, error) {\\n\\tquery := `\\n\\t\\tSELECT user_id, push_enabled, email_enabled, match_notify, message_notify, like_notify, created_at, updated_at\\n\\t\\tFROM notification_preferences\\n\\t\\tWHERE user_id = $1\\n\\t`\\n\\n\\tpref := &model.NotificationPreference{}\\n\\terr := r.db.QueryRow(query, userID).Scan(\\n\\t\\t&pref.UserID,\\n\\t\\t&pref.PushEnabled,\\n\\t\\t&pref.EmailEnabled,\\n\\t\\t&pref.MatchNotify,\\n\\t\\t&pref.MessageNotify,\\n\\t\\t&pref.LikeNotify,\\n\\t\\t&pref.CreatedAt,\\n\\t\\t&pref.UpdatedAt,\\n\\t)\\n\\tif err == sql.ErrNoRows {\\n\\t\\t// Return default preferences\\n\\t\\treturn &model.NotificationPreference{\\n\\t\\t\\tUserID:        userID,\\n\\t\\t\\tPushEnabled:   true,\\n\\t\\t\\tEmailEnabled:  true,\\n\\t\\t\\tMatchNotify:   true,\\n\\t\\t\\tMessageNotify: true,\\n\\t\\t\\tLikeNotify:    true,\\n\\t\\t}, nil\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get preferences: %w\\", err)\\n\\t}\\n\\n\\treturn pref, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34","name":"GetPreferences","node_type":"function"},{"code":"func (r *NotificationRepository) Create(notification *model.Notification) error {\\n\\tnotification.ID = uuid.New().String()\\n\\tnotification.Status = model.NotificationStatusPending\\n\\tnotification.CreatedAt = time.Now()\\n\\tnotification.UpdatedAt = time.Now()\\n\\n\\tdataJSON, _ := json.Marshal(notification.Data)\\n\\n\\tquery := `\\n\\t\\tINSERT INTO notifications (id, user_id, type, title, body, data, status, created_at, updated_at)\\n\\t\\tVALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)\\n\\t`\\n\\n\\t_, err := r.db.Exec(\\n\\t\\tquery,\\n\\t\\tnotification.ID,\\n\\t\\tnotification.UserID,\\n\\t\\tnotification.Type,\\n\\t\\tnotification.Title,\\n\\t\\tnotification.Body,\\n\\t\\tdataJSON,\\n\\t\\tnotification.Status,\\n\\t\\tnotification.CreatedAt,\\n\\t\\tnotification.UpdatedAt,\\n\\t)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to create notification: %w\\", err)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:24:34","name":"Create","node_type":"function"},{"code":"func (s *NotificationService) sendPushNotification(notification *model.Notification) error {\\n\\t// Get user\'s push tokens\\n\\ttokens, err := s.repo.GetPushTokens(notification.UserID)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to get push tokens: %w\\", err)\\n\\t}\\n\\n\\tif len(tokens) == 0 {\\n\\t\\tlogger.Debug(\\"no push tokens for user\\", zap.String(\\"user_id\\", notification.UserID))\\n\\t\\treturn nil\\n\\t}\\n\\n\\t// In a real implementation, this would send to FCM/APNS\\n\\t// For now, just log\\n\\tfor _, token := range tokens {\\n\\t\\tlogger.Info(\\"would send push notification\\",\\n\\t\\t\\tzap.String(\\"user_id\\", notification.UserID),\\n\\t\\t\\tzap.String(\\"platform\\", token.Platform),\\n\\t\\t\\tzap.String(\\"title\\", notification.Title),\\n\\t\\t)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:206:31","name":"sendPushNotification","node_type":"function"},{"code":"func (r *NotificationRepository) GetPushTokens(userID string) ([]*model.PushToken, error) {\\n\\tquery := `\\n\\t\\tSELECT id, user_id, token, platform, created_at, updated_at\\n\\t\\tFROM push_tokens\\n\\t\\tWHERE user_id = $1\\n\\t`\\n\\n\\trows, err := r.db.Query(query, userID)\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get push tokens: %w\\", err)\\n\\t}\\n\\tdefer rows.Close()\\n\\n\\tvar tokens []*model.PushToken\\n\\tfor rows.Next() {\\n\\t\\ttoken := &model.PushToken{}\\n\\t\\terr := rows.Scan(\\n\\t\\t\\t&token.ID,\\n\\t\\t\\t&token.UserID,\\n\\t\\t\\t&token.Token,\\n\\t\\t\\t&token.Platform,\\n\\t\\t\\t&token.CreatedAt,\\n\\t\\t\\t&token.UpdatedAt,\\n\\t\\t)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn nil, fmt.Errorf(\\"failed to scan push token: %w\\", err)\\n\\t\\t}\\n\\t\\ttokens = append(tokens, token)\\n\\t}\\n\\n\\treturn tokens, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:314:34","name":"GetPushTokens","node_type":"function"},{"code":"func (r *NotificationRepository) UpdateStatus(id string, status model.NotificationStatus) error {\\n\\tquery := `\\n\\t\\tUPDATE notifications\\n\\t\\tSET status = $1, updated_at = $2\\n\\t\\tWHERE id = $3\\n\\t`\\n\\n\\t_, err := r.db.Exec(query, status, time.Now(), id)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to update status: %w\\", err)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:194:34","name":"UpdateStatus","node_type":"function"},{"code":"func (c *MatchConsumer) Start(ctx context.Context) {\\n\\tlogger.Info(\\"starting match consumer\\")\\n\\tgo func() {\\n\\t\\tif err := c.consumer.Start(ctx); err != nil {\\n\\t\\t\\tlogger.Error(\\"consumer stopped with error\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:44:25","name":"Start","node_type":"function"},{"code":"func NewHandler(notificationService *service.NotificationService) *Handler {\\n\\treturn &Handler{\\n\\t\\tnotificationService: notificationService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:21:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\tmux.HandleFunc(\\"/health\\", h.Health)\\n\\tmux.HandleFunc(\\"/api/v1/notifications\\", h.handleNotifications)\\n\\tmux.HandleFunc(\\"/api/v1/notifications/\\", h.handleNotificationByID)\\n\\tmux.HandleFunc(\\"/api/v1/notifications/count\\", h.GetUnreadCount)\\n\\tmux.HandleFunc(\\"/api/v1/notifications/read-all\\", h.MarkAllAsRead)\\n\\tmux.HandleFunc(\\"/api/v1/notifications/preferences\\", h.handlePreferences)\\n\\tmux.HandleFunc(\\"/api/v1/notifications/push-token\\", h.handlePushToken)\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) Health(w http.ResponseWriter, r *http.Request) {\\n\\tresponse.JSON(w, http.StatusOK, map[string]string{\\n\\t\\t\\"status\\":  \\"healthy\\",\\n\\t\\t\\"service\\": \\"notification\\",\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:39:19","name":"Health","node_type":"function"},{"code":"func (h *Handler) handleNotifications(w http.ResponseWriter, r *http.Request) {\\n\\t// Exact path match only\\n\\tif r.URL.Path != \\"/api/v1/notifications\\" {\\n\\t\\tresponse.Error(w, errors.NotFound(\\"Not found\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\th.getNotifications(w, r)\\n\\tcase http.MethodPost:\\n\\t\\th.createNotification(w, r)\\n\\tdefault:\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Method not allowed\\"))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","name":"handleNotifications","node_type":"function"},{"code":"func (h *Handler) getNotifications(w http.ResponseWriter, r *http.Request) {\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"User not authenticated\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Parse query params\\n\\tlimitStr := r.URL.Query().Get(\\"limit\\")\\n\\toffsetStr := r.URL.Query().Get(\\"offset\\")\\n\\n\\tlimit := 20\\n\\toffset := 0\\n\\n\\tif limitStr != \\"\\" {\\n\\t\\tif l, err := strconv.Atoi(limitStr); err == nil {\\n\\t\\t\\tlimit = l\\n\\t\\t}\\n\\t}\\n\\tif offsetStr != \\"\\" {\\n\\t\\tif o, err := strconv.Atoi(offsetStr); err == nil {\\n\\t\\t\\toffset = o\\n\\t\\t}\\n\\t}\\n\\n\\tnotifications, err := h.notificationService.GetNotifications(userID, limit, offset)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to get notifications\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tif notifications == nil {\\n\\t\\tnotifications = []*model.Notification{}\\n\\t}\\n\\n\\tresponse.OK(w, notifications)\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","name":"getNotifications","node_type":"function"},{"code":"func (s *NotificationService) GetNotifications(userID string, limit, offset int) ([]*model.Notification, error) {\\n\\tif limit <= 0 || limit > 100 {\\n\\t\\tlimit = 20\\n\\t}\\n\\tif offset < 0 {\\n\\t\\toffset = 0\\n\\t}\\n\\n\\tnotifications, err := s.repo.GetByUserID(userID, limit, offset)\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get notifications: %w\\", err)\\n\\t}\\n\\n\\treturn notifications, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:85:31","name":"GetNotifications","node_type":"function"},{"code":"func (r *NotificationRepository) GetByUserID(userID string, limit, offset int) ([]*model.Notification, error) {\\n\\tquery := `\\n\\t\\tSELECT id, user_id, type, title, body, data, status, read_at, created_at, updated_at\\n\\t\\tFROM notifications\\n\\t\\tWHERE user_id = $1\\n\\t\\tORDER BY created_at DESC\\n\\t\\tLIMIT $2 OFFSET $3\\n\\t`\\n\\n\\trows, err := r.db.Query(query, userID, limit, offset)\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get notifications: %w\\", err)\\n\\t}\\n\\tdefer rows.Close()\\n\\n\\tvar notifications []*model.Notification\\n\\tfor rows.Next() {\\n\\t\\tnotification := &model.Notification{}\\n\\t\\tvar dataJSON []byte\\n\\t\\tvar readAt sql.NullTime\\n\\n\\t\\terr := rows.Scan(\\n\\t\\t\\t&notification.ID,\\n\\t\\t\\t&notification.UserID,\\n\\t\\t\\t&notification.Type,\\n\\t\\t\\t&notification.Title,\\n\\t\\t\\t&notification.Body,\\n\\t\\t\\t&dataJSON,\\n\\t\\t\\t&notification.Status,\\n\\t\\t\\t&readAt,\\n\\t\\t\\t&notification.CreatedAt,\\n\\t\\t\\t&notification.UpdatedAt,\\n\\t\\t)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn nil, fmt.Errorf(\\"failed to scan notification: %w\\", err)\\n\\t\\t}\\n\\n\\t\\tif readAt.Valid {\\n\\t\\t\\tnotification.ReadAt = &readAt.Time\\n\\t\\t}\\n\\t\\tjson.Unmarshal(dataJSON, &notification.Data)\\n\\t\\tnotifications = append(notifications, notification)\\n\\t}\\n\\n\\treturn notifications, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:96:34","name":"GetByUserID","node_type":"function"},{"code":"func (h *Handler) createNotification(w http.ResponseWriter, r *http.Request) {\\n\\tvar req model.CreateNotificationRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Invalid request body\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tif req.UserID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"User ID is required\\"))\\n\\t\\treturn\\n\\t}\\n\\tif req.Type == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Type is required\\"))\\n\\t\\treturn\\n\\t}\\n\\tif req.Title == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Title is required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tnotification, err := h.notificationService.CreateNotification(&req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to create notification\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.Created(w, notification)\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","name":"createNotification","node_type":"function"},{"code":"func (h *Handler) handleNotificationByID(w http.ResponseWriter, r *http.Request) {\\n\\t// Extract notification ID from path\\n\\tpath := strings.TrimPrefix(r.URL.Path, \\"/api/v1/notifications/\\")\\n\\tif path == \\"\\" || strings.Contains(path, \\"/\\") {\\n\\t\\tresponse.Error(w, errors.NotFound(\\"Notification not found\\"))\\n\\t\\treturn\\n\\t}\\n\\tnotificationID := path\\n\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"User not authenticated\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodPatch:\\n\\t\\th.markAsRead(w, r, userID, notificationID)\\n\\tdefault:\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Method not allowed\\"))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","name":"handleNotificationByID","node_type":"function"},{"code":"func (h *Handler) markAsRead(w http.ResponseWriter, r *http.Request, userID, notificationID string) {\\n\\terr := h.notificationService.MarkAsRead(userID, notificationID)\\n\\tif err != nil {\\n\\t\\tif strings.Contains(err.Error(), \\"not found\\") {\\n\\t\\t\\tresponse.Error(w, errors.NotFound(\\"Notification not found\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tif strings.Contains(err.Error(), \\"not authorized\\") {\\n\\t\\t\\tresponse.Error(w, errors.Forbidden(\\"Not authorized\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to mark as read\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, map[string]string{\\"message\\": \\"Marked as read\\"})\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","name":"markAsRead","node_type":"function"},{"code":"func (s *NotificationService) MarkAsRead(userID, notificationID string) error {\\n\\t// Verify ownership\\n\\tnotification, err := s.repo.GetByID(notificationID)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to get notification: %w\\", err)\\n\\t}\\n\\tif notification == nil {\\n\\t\\treturn fmt.Errorf(\\"notification not found\\")\\n\\t}\\n\\tif notification.UserID != userID {\\n\\t\\treturn fmt.Errorf(\\"not authorized\\")\\n\\t}\\n\\n\\tif err := s.repo.MarkAsRead(notificationID); err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to mark as read: %w\\", err)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:111:31","name":"MarkAsRead","node_type":"function"},{"code":"func (r *NotificationRepository) GetByID(id string) (*model.Notification, error) {\\n\\tquery := `\\n\\t\\tSELECT id, user_id, type, title, body, data, status, read_at, created_at, updated_at\\n\\t\\tFROM notifications\\n\\t\\tWHERE id = $1\\n\\t`\\n\\n\\tnotification := &model.Notification{}\\n\\tvar dataJSON []byte\\n\\tvar readAt sql.NullTime\\n\\n\\terr := r.db.QueryRow(query, id).Scan(\\n\\t\\t&notification.ID,\\n\\t\\t&notification.UserID,\\n\\t\\t&notification.Type,\\n\\t\\t&notification.Title,\\n\\t\\t&notification.Body,\\n\\t\\t&dataJSON,\\n\\t\\t&notification.Status,\\n\\t\\t&readAt,\\n\\t\\t&notification.CreatedAt,\\n\\t\\t&notification.UpdatedAt,\\n\\t)\\n\\tif err == sql.ErrNoRows {\\n\\t\\treturn nil, nil\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get notification: %w\\", err)\\n\\t}\\n\\n\\tif readAt.Valid {\\n\\t\\tnotification.ReadAt = &readAt.Time\\n\\t}\\n\\tjson.Unmarshal(dataJSON, &notification.Data)\\n\\n\\treturn notification, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:57:34","name":"GetByID","node_type":"function"},{"code":"func (r *NotificationRepository) MarkAsRead(id string) error {\\n\\tquery := `\\n\\t\\tUPDATE notifications\\n\\t\\tSET status = \'read\', read_at = $1, updated_at = $1\\n\\t\\tWHERE id = $2\\n\\t`\\n\\n\\tnow := time.Now()\\n\\t_, err := r.db.Exec(query, now, id)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to mark notification as read: %w\\", err)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:160:34","name":"MarkAsRead","node_type":"function"},{"code":"func (h *Handler) GetUnreadCount(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"User not authenticated\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tcount, err := h.notificationService.GetUnreadCount(userID)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to get unread count\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, map[string]int{\\"count\\": count})\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","name":"GetUnreadCount","node_type":"function"},{"code":"func (s *NotificationService) GetUnreadCount(userID string) (int, error) {\\n\\tcount, err := s.repo.GetUnreadCount(userID)\\n\\tif err != nil {\\n\\t\\treturn 0, fmt.Errorf(\\"failed to get unread count: %w\\", err)\\n\\t}\\n\\treturn count, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:102:31","name":"GetUnreadCount","node_type":"function"},{"code":"func (r *NotificationRepository) GetUnreadCount(userID string) (int, error) {\\n\\tquery := `\\n\\t\\tSELECT COUNT(*) FROM notifications\\n\\t\\tWHERE user_id = $1 AND status != \'read\'\\n\\t`\\n\\n\\tvar count int\\n\\terr := r.db.QueryRow(query, userID).Scan(&count)\\n\\tif err != nil {\\n\\t\\treturn 0, fmt.Errorf(\\"failed to get unread count: %w\\", err)\\n\\t}\\n\\n\\treturn count, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:144:34","name":"GetUnreadCount","node_type":"function"},{"code":"func (h *Handler) MarkAllAsRead(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"User not authenticated\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\terr := h.notificationService.MarkAllAsRead(userID)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to mark all as read\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, map[string]string{\\"message\\": \\"All notifications marked as read\\"})\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","name":"MarkAllAsRead","node_type":"function"},{"code":"func (s *NotificationService) MarkAllAsRead(userID string) error {\\n\\tif err := s.repo.MarkAllAsRead(userID); err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to mark all as read: %w\\", err)\\n\\t}\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:132:31","name":"MarkAllAsRead","node_type":"function"},{"code":"func (r *NotificationRepository) MarkAllAsRead(userID string) error {\\n\\tquery := `\\n\\t\\tUPDATE notifications\\n\\t\\tSET status = \'read\', read_at = $1, updated_at = $1\\n\\t\\tWHERE user_id = $2 AND status != \'read\'\\n\\t`\\n\\n\\tnow := time.Now()\\n\\t_, err := r.db.Exec(query, now, userID)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to mark all as read: %w\\", err)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:177:34","name":"MarkAllAsRead","node_type":"function"},{"code":"func (h *Handler) handlePreferences(w http.ResponseWriter, r *http.Request) {\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"User not authenticated\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\tprefs, err := h.notificationService.GetPreferences(userID)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to get preferences\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, prefs)\\n\\n\\tcase http.MethodPut:\\n\\t\\tvar req model.UpdatePreferencesRequest\\n\\t\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\t\\tresponse.Error(w, errors.BadRequest(\\"Invalid request body\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tprefs, err := h.notificationService.UpdatePreferences(userID, &req)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to update preferences\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, prefs)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Method not allowed\\"))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","name":"handlePreferences","node_type":"function"},{"code":"func (s *NotificationService) GetPreferences(userID string) (*model.NotificationPreference, error) {\\n\\tprefs, err := s.repo.GetPreferences(userID)\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get preferences: %w\\", err)\\n\\t}\\n\\treturn prefs, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:140:31","name":"GetPreferences","node_type":"function"},{"code":"func (s *NotificationService) UpdatePreferences(userID string, req *model.UpdatePreferencesRequest) (*model.NotificationPreference, error) {\\n\\t// Get existing preferences\\n\\tprefs, err := s.repo.GetPreferences(userID)\\n\\tif err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to get preferences: %w\\", err)\\n\\t}\\n\\n\\t// Update fields if provided\\n\\tif req.PushEnabled != nil {\\n\\t\\tprefs.PushEnabled = *req.PushEnabled\\n\\t}\\n\\tif req.EmailEnabled != nil {\\n\\t\\tprefs.EmailEnabled = *req.EmailEnabled\\n\\t}\\n\\tif req.MatchNotify != nil {\\n\\t\\tprefs.MatchNotify = *req.MatchNotify\\n\\t}\\n\\tif req.MessageNotify != nil {\\n\\t\\tprefs.MessageNotify = *req.MessageNotify\\n\\t}\\n\\tif req.LikeNotify != nil {\\n\\t\\tprefs.LikeNotify = *req.LikeNotify\\n\\t}\\n\\n\\t// Save\\n\\tif err := s.repo.SavePreferences(prefs); err != nil {\\n\\t\\treturn nil, fmt.Errorf(\\"failed to save preferences: %w\\", err)\\n\\t}\\n\\n\\treturn prefs, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:149:31","name":"UpdatePreferences","node_type":"function"},{"code":"func (r *NotificationRepository) SavePreferences(pref *model.NotificationPreference) error {\\n\\tquery := `\\n\\t\\tINSERT INTO notification_preferences (user_id, push_enabled, email_enabled, match_notify, message_notify, like_notify, created_at, updated_at)\\n\\t\\tVALUES ($1, $2, $3, $4, $5, $6, $7, $8)\\n\\t\\tON CONFLICT (user_id) DO UPDATE SET\\n\\t\\t\\tpush_enabled = $2,\\n\\t\\t\\temail_enabled = $3,\\n\\t\\t\\tmatch_notify = $4,\\n\\t\\t\\tmessage_notify = $5,\\n\\t\\t\\tlike_notify = $6,\\n\\t\\t\\tupdated_at = $8\\n\\t`\\n\\n\\tnow := time.Now()\\n\\tif pref.CreatedAt.IsZero() {\\n\\t\\tpref.CreatedAt = now\\n\\t}\\n\\tpref.UpdatedAt = now\\n\\n\\t_, err := r.db.Exec(\\n\\t\\tquery,\\n\\t\\tpref.UserID,\\n\\t\\tpref.PushEnabled,\\n\\t\\tpref.EmailEnabled,\\n\\t\\tpref.MatchNotify,\\n\\t\\tpref.MessageNotify,\\n\\t\\tpref.LikeNotify,\\n\\t\\tpref.CreatedAt,\\n\\t\\tpref.UpdatedAt,\\n\\t)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to save preferences: %w\\", err)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:257:34","name":"SavePreferences","node_type":"function"},{"code":"func (h *Handler) handlePushToken(w http.ResponseWriter, r *http.Request) {\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"User not authenticated\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodPost:\\n\\t\\tvar req model.RegisterTokenRequest\\n\\t\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\t\\tresponse.Error(w, errors.BadRequest(\\"Invalid request body\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\terr := h.notificationService.RegisterPushToken(userID, &req)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to register push token\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, map[string]string{\\"message\\": \\"Push token registered\\"})\\n\\n\\tcase http.MethodDelete:\\n\\t\\tplatform := r.URL.Query().Get(\\"platform\\")\\n\\t\\tif platform == \\"\\" {\\n\\t\\t\\tresponse.Error(w, errors.BadRequest(\\"Platform is required\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\terr := h.notificationService.UnregisterPushToken(userID, platform)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, errors.InternalServerError(\\"Failed to delete push token\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, map[string]string{\\"message\\": \\"Push token deleted\\"})\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"Method not allowed\\"))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","name":"handlePushToken","node_type":"function"},{"code":"func (s *NotificationService) RegisterPushToken(userID string, req *model.RegisterTokenRequest) error {\\n\\tif req.Token == \\"\\" {\\n\\t\\treturn fmt.Errorf(\\"token is required\\")\\n\\t}\\n\\tif req.Platform == \\"\\" {\\n\\t\\treturn fmt.Errorf(\\"platform is required\\")\\n\\t}\\n\\n\\tif err := s.repo.SavePushToken(userID, req.Token, req.Platform); err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to save push token: %w\\", err)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:182:31","name":"RegisterPushToken","node_type":"function"},{"code":"func (r *NotificationRepository) SavePushToken(userID, token, platform string) error {\\n\\tquery := `\\n\\t\\tINSERT INTO push_tokens (id, user_id, token, platform, created_at, updated_at)\\n\\t\\tVALUES ($1, $2, $3, $4, $5, $6)\\n\\t\\tON CONFLICT (user_id, platform) DO UPDATE SET\\n\\t\\t\\ttoken = $3,\\n\\t\\t\\tupdated_at = $6\\n\\t`\\n\\n\\tnow := time.Now()\\n\\t_, err := r.db.Exec(query, uuid.New().String(), userID, token, platform, now, now)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to save push token: %w\\", err)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:295:34","name":"SavePushToken","node_type":"function"},{"code":"func (s *NotificationService) UnregisterPushToken(userID, platform string) error {\\n\\tif err := s.repo.DeletePushToken(userID, platform); err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to delete push token: %w\\", err)\\n\\t}\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:198:31","name":"UnregisterPushToken","node_type":"function"},{"code":"func (r *NotificationRepository) DeletePushToken(userID, platform string) error {\\n\\tquery := `DELETE FROM push_tokens WHERE user_id = $1 AND platform = $2`\\n\\t_, err := r.db.Exec(query, userID, platform)\\n\\tif err != nil {\\n\\t\\treturn fmt.Errorf(\\"failed to delete push token: %w\\", err)\\n\\t}\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:348:34","name":"DeletePushToken","node_type":"function"},{"code":"func (c *MatchConsumer) Stop() {\\n\\tif err := c.consumer.Close(); err != nil {\\n\\t\\tlogger.Error(\\"failed to close consumer\\", zap.Error(err))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:54:25","name":"Stop","node_type":"function"}]'),se=JSON.parse('[{"column":11,"line":62,"source":"/home/evan/Code/rinder/services/notification/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/notification/cmd/main.go:130:6","val":1},{"column":32,"line":68,"source":"/home/evan/Code/rinder/services/notification/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:19:6","val":1},{"column":32,"line":69,"source":"/home/evan/Code/rinder/services/notification/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:18:6","val":1},{"column":27,"line":72,"source":"/home/evan/Code/rinder/services/notification/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:24:6","val":1},{"column":54,"line":37,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:24:6","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","val":1},{"column":16,"line":82,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","val":1},{"column":31,"line":102,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","val":1},{"column":68,"line":102,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","val":1},{"column":63,"line":104,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","val":1},{"column":28,"line":82,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","val":1},{"column":16,"line":83,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25","val":1},{"column":28,"line":83,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","val":1},{"column":33,"line":86,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:232:31","val":1},{"column":10,"line":232,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:232:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:23:31","val":1},{"column":22,"line":24,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:23:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34","val":1},{"column":29,"line":227,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34","val":1},{"column":18,"line":64,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:23:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:24:34","val":1},{"column":14,"line":70,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:23:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:206:31","val":1},{"column":23,"line":207,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:206:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:314:34","val":1},{"column":32,"line":320,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:314:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:314:34","val":1},{"column":8,"line":77,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:23:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:194:34","val":1},{"column":28,"line":200,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:194:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:194:34","val":1},{"column":48,"line":200,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:194:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:194:34","val":1},{"column":66,"line":236,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:232:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:232:31","val":1},{"column":32,"line":92,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:232:31","val":1},{"column":15,"line":76,"source":"/home/evan/Code/rinder/services/notification/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:44:25","val":1},{"column":29,"line":46,"source":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:44:25","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:44:25","val":1},{"column":14,"line":79,"source":"/home/evan/Code/rinder/services/notification/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:21:6","val":1},{"column":3,"line":83,"source":"/home/evan/Code/rinder/services/notification/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","val":1},{"column":29,"line":28,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:39:19","val":1},{"column":15,"line":39,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:39:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:39:19","val":1},{"column":43,"line":29,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","val":1},{"column":17,"line":49,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","val":1},{"column":4,"line":55,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","val":1},{"column":17,"line":67,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","val":1},{"column":45,"line":89,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:85:31","val":1},{"column":30,"line":92,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:85:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:96:34","val":1},{"column":32,"line":104,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:96:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:96:34","val":1},{"column":40,"line":104,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:96:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:96:34","val":1},{"column":47,"line":104,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:96:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:96:34","val":1},{"column":42,"line":92,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:85:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:85:31","val":1},{"column":50,"line":92,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:85:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:85:31","val":1},{"column":57,"line":92,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:85:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:85:31","val":1},{"column":17,"line":91,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","val":1},{"column":13,"line":99,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19","val":1},{"column":21,"line":55,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","val":1},{"column":24,"line":55,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","val":1},{"column":4,"line":57,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","val":1},{"column":17,"line":106,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","val":1},{"column":17,"line":111,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","val":1},{"column":17,"line":115,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","val":1},{"column":17,"line":119,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","val":1},{"column":44,"line":123,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:23:31","val":1},{"column":17,"line":125,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","val":1},{"column":18,"line":129,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19","val":1},{"column":23,"line":57,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","val":1},{"column":26,"line":57,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","val":1},{"column":17,"line":59,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19","val":1},{"column":44,"line":30,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","val":1},{"column":17,"line":137,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","val":1},{"column":17,"line":144,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","val":1},{"column":4,"line":150,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","val":1},{"column":30,"line":158,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:111:31","val":1},{"column":29,"line":112,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:111:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:57:34","val":1},{"column":29,"line":67,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:57:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:57:34","val":1},{"column":37,"line":112,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:111:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:111:31","val":1},{"column":18,"line":123,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:111:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:160:34","val":1},{"column":33,"line":167,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:160:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:160:34","val":1},{"column":29,"line":123,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:111:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:111:31","val":1},{"column":41,"line":158,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","val":1},{"column":49,"line":158,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","val":1},{"column":18,"line":161,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","val":1},{"column":18,"line":165,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","val":1},{"column":17,"line":168,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","val":1},{"column":13,"line":172,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19","val":1},{"column":15,"line":150,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","val":1},{"column":18,"line":150,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","val":1},{"column":17,"line":152,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19","val":1},{"column":49,"line":31,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","val":1},{"column":17,"line":178,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","val":1},{"column":17,"line":184,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","val":1},{"column":37,"line":188,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:102:31","val":1},{"column":22,"line":102,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:102:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:144:34","val":1},{"column":29,"line":150,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:144:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:144:34","val":1},{"column":37,"line":102,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:102:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:102:31","val":1},{"column":17,"line":190,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","val":1},{"column":13,"line":194,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19","val":1},{"column":52,"line":32,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","val":1},{"column":17,"line":200,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","val":1},{"column":17,"line":206,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","val":1},{"column":30,"line":210,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:132:31","val":1},{"column":18,"line":132,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:132:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:177:34","val":1},{"column":33,"line":184,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:177:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:177:34","val":1},{"column":32,"line":132,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:132:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:132:31","val":1},{"column":17,"line":212,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","val":1},{"column":13,"line":216,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19","val":1},{"column":55,"line":33,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","val":1},{"column":17,"line":223,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","val":1},{"column":38,"line":229,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:140:31","val":1},{"column":22,"line":140,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:140:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34","val":1},{"column":37,"line":140,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:140:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:140:31","val":1},{"column":18,"line":231,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","val":1},{"column":14,"line":234,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","val":1},{"column":18,"line":239,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","val":1},{"column":38,"line":243,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:149:31","val":1},{"column":22,"line":150,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:149:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34","val":1},{"column":37,"line":150,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:149:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:149:31","val":1},{"column":18,"line":173,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:149:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:257:34","val":1},{"column":18,"line":245,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","val":1},{"column":14,"line":248,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","val":1},{"column":17,"line":251,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19","val":1},{"column":54,"line":34,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","val":1},{"column":17,"line":259,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","val":1},{"column":18,"line":267,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","val":1},{"column":31,"line":271,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:182:31","val":1},{"column":18,"line":189,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:182:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:295:34","val":1},{"column":49,"line":304,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:295:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:295:34","val":1},{"column":57,"line":304,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:295:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:295:34","val":1},{"column":64,"line":304,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:295:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:295:34","val":1},{"column":32,"line":189,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:182:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:182:31","val":1},{"column":18,"line":273,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","val":1},{"column":14,"line":276,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","val":1},{"column":18,"line":281,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","val":1},{"column":31,"line":285,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:198:31","val":1},{"column":18,"line":198,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:198:31","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:348:34","val":1},{"column":28,"line":349,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:348:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:348:34","val":1},{"column":36,"line":349,"source":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:348:34","target":"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:348:34","val":1},{"column":34,"line":198,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:198:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:198:31","val":1},{"column":42,"line":198,"source":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:198:31","target":"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:198:31","val":1},{"column":18,"line":287,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","val":1},{"column":14,"line":290,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","val":1},{"column":17,"line":293,"source":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","target":"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19","val":1},{"column":15,"line":116,"source":"/home/evan/Code/rinder/services/notification/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:54:25","val":1}]'),xr={nodes:oe,links:se},Dr=Object.freeze(Object.defineProperty({__proto__:null,default:xr,links:se,nodes:oe},Symbol.toStringTag,{value:"Module"})),Nr=[{id:"/home/evan/Code/rinder/services/notification/cmd/main.go:24:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/cmd/main.go:130:6",name:"runMigrations",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:19:6",name:"NewNotificationRepository",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:18:6",name:"NewNotificationService",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:24:6",name:"NewMatchConsumer",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:61:25",name:"handleMatchCreated",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:102:25",name:"getUserName",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:232:31",name:"CreateMatchNotification",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:23:31",name:"CreateNotification",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:220:34",name:"GetPreferences",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:24:34",name:"Create",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:206:31",name:"sendPushNotification",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:314:34",name:"GetPushTokens",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:194:34",name:"UpdateStatus",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:44:25",name:"Start",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:21:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:28:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:39:19",name:"Health",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:47:19",name:"handleNotifications",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:65:19",name:"getNotifications",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:85:31",name:"GetNotifications",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:96:34",name:"GetByUserID",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:104:19",name:"createNotification",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:134:19",name:"handleNotificationByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:158:19",name:"markAsRead",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:111:31",name:"MarkAsRead",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:57:34",name:"GetByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:160:34",name:"MarkAsRead",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:177:19",name:"GetUnreadCount",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:102:31",name:"GetUnreadCount",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:144:34",name:"GetUnreadCount",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:199:19",name:"MarkAllAsRead",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:132:31",name:"MarkAllAsRead",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:177:34",name:"MarkAllAsRead",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:221:19",name:"handlePreferences",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:140:31",name:"GetPreferences",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:149:31",name:"UpdatePreferences",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:257:34",name:"SavePreferences",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/handler/handler.go:257:19",name:"handlePushToken",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:182:31",name:"RegisterPushToken",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:295:34",name:"SavePushToken",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/service/notification_service.go:198:31",name:"UnregisterPushToken",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/repository/notification_repository.go:348:34",name:"DeletePushToken",node_type:"function"},{id:"/home/evan/Code/rinder/services/notification/internal/consumer/match_consumer.go:54:25",name:"Stop",node_type:"function"}],Hr=Object.freeze(Object.defineProperty({__proto__:null,default:Nr},Symbol.toStringTag,{value:"Module"})),de=14,le="service-profile",ce="/home/evan/Code/rinder/services/profile",ue="cmd/main.go",he="main",pe="github.com/rinder",ve=null,me="2026-01-21T10:24:35.990340355Z",_e="2026-01-21T10:24:38.621573077Z",fe="analyzing-completed",ge=JSON.parse(`[{"id":342,"type":"http","method":"ANY","path":"/api/v1/profiles","source_function_name":"RegisterRoutes","function_name":"profiles","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","outputs":[{"id":1979,"handler_id":342,"type":"database","label":"COUNT documents in profiles collection (list total)","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","function_name":"List","description":"When listing profiles, the repository counts total matching profiles by executing CountDocuments with the assembled query (includes filters such as is_active, breed, gender, size, age range, user filters).","created_at":"2026-01-30T10:33:27.627593838Z","updated_at":null},{"id":1975,"handler_id":342,"type":"database","label":"COUNT documents in profiles collection filtered by user_id","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:197:29","function_name":"CountByUserID","description":"Counts how many profiles exist for a given user (used to enforce per-user profile limits). Executes a CountDocuments against the MongoDB profiles collection with filter {\\"user_id\\": userID}.","created_at":"2026-01-30T10:33:27.622342675Z","updated_at":null},{"id":1976,"handler_id":342,"type":"database","label":"COUNT documents in profiles collection filtered by user_id and name","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:206:29","function_name":"ExistsByUserIDAndName","description":"Checks whether a profile with the same name already exists for the user. Executes a CountDocuments against the MongoDB profiles collection with filter {\\"user_id\\": userID, \\"name\\": name}.","created_at":"2026-01-30T10:33:27.623598024Z","updated_at":null},{"id":1980,"handler_id":342,"type":"database","label":"FIND documents in profiles collection with query and pagination","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","function_name":"List","description":"Retrieves a page of profile documents matching the filter by executing Find on the MongoDB profiles collection with query, limit, skip (offset) and sort options; the cursor results are then decoded into profiles.","created_at":"2026-01-30T10:33:27.62891984Z","updated_at":null},{"id":1977,"handler_id":342,"type":"database","label":"INSERT document into profiles collection","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:56:29","function_name":"Create","description":"Inserts the newly created profile document into the MongoDB profiles collection via InsertOne.","created_at":"2026-01-30T10:33:27.624957853Z","updated_at":null},{"id":1978,"handler_id":342,"type":"event","label":"Publish profile created event to Kafka (TopicProfileCreated)","function_id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","function_name":"CreateProfile","description":"After creating a profile, the service publishes a ProfileCreatedEvent to Kafka using the profile ID as the key and the configured profile-created topic/event type.","created_at":"2026-01-30T10:33:27.626249427Z","updated_at":null},{"id":1981,"handler_id":342,"type":"http_response","label":"HTTP 200 JSON response (profiles list with pagination metadata)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:190:19","function_name":"listProfiles","description":"On successful retrieval of profiles, the handler returns an HTTP 200 response with the list of profiles and pagination metadata in JSON format.","created_at":"2026-01-30T10:33:27.630472494Z","updated_at":null},{"id":1974,"handler_id":342,"type":"http_response","label":"HTTP 201 Created (profile JSON)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","function_name":"createProfile","description":"On successful profile creation, the handler returns an HTTP 201 Created response with the created profile payload to the client.","created_at":"2026-01-30T10:33:27.620921381Z","updated_at":null},{"id":1972,"handler_id":342,"type":"http_response","label":"HTTP 400 Bad Request response (invalid request body)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","function_name":"createProfile","description":"If the request body for profile creation cannot be decoded as JSON, the createProfile handler returns an HTTP 400 error to the client.","created_at":"2026-01-30T10:33:27.617420219Z","updated_at":null},{"id":1970,"handler_id":342,"type":"http_response","label":"HTTP 400 Bad Request response (method not allowed)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","function_name":"profiles","description":"If the incoming HTTP method is not GET or POST, the handler returns an HTTP error response indicating the method is not allowed (bad request).","created_at":"2026-01-30T10:33:27.601248081Z","updated_at":null},{"id":1971,"handler_id":342,"type":"http_response","label":"HTTP 401 Unauthorized response (authentication required)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","function_name":"profiles","description":"For POST requests without the X-User-ID header, the handler returns an HTTP unauthorized error response to the client.","created_at":"2026-01-30T10:33:27.613693483Z","updated_at":null},{"id":1973,"handler_id":342,"type":"http_response","label":"HTTP error response (service error forwarded)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","function_name":"createProfile","description":"If profileService.CreateProfile returns an error during creation, createProfile forwards that error as an HTTP error response to the client.","created_at":"2026-01-30T10:33:27.619447036Z","updated_at":null},{"id":1982,"handler_id":342,"type":"http_response","label":"HTTP error response (service error forwarded) when listing","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:190:19","function_name":"listProfiles","description":"If profileService.ListProfiles (or the repository list call) returns an error, listProfiles forwards that as an HTTP error response to the client.","created_at":"2026-01-30T10:33:27.631850344Z","updated_at":null}],"created_at":"2026-01-30T10:32:26.004444544Z","updated_at":null},{"id":345,"type":"http","method":"ANY","path":"/api/v1/profiles/","source_function_name":"RegisterRoutes","function_name":"profileByID","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","outputs":[{"id":1989,"handler_id":345,"type":"database","label":"MongoDB CountDocuments({user_id: userID, name: name})","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:206:29","function_name":"ExistsByUserIDAndName","description":"Check existence of a profile with the same user_id and name (used to detect duplicate names during UpdateProfile).","created_at":"2026-01-30T10:33:42.706572319Z","updated_at":null},{"id":1994,"handler_id":345,"type":"database","label":"MongoDB DeleteOne({_id: id})","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:113:29","function_name":"Delete","description":"Delete the profile document from MongoDB (performed by ProfileRepository.Delete during DeleteProfile).","created_at":"2026-01-30T10:33:42.712419852Z","updated_at":null},{"id":1983,"handler_id":345,"type":"database","label":"MongoDB FindOne({_id: id})","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:68:29","function_name":"GetByID","description":"Retrieve a profile document by its ID from the MongoDB profiles collection (used by ProfileRepository.GetByID).","created_at":"2026-01-30T10:33:42.685736205Z","updated_at":null},{"id":1990,"handler_id":345,"type":"database","label":"MongoDB ReplaceOne({_id: profile.ID}, profile)","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:97:29","function_name":"Update","description":"Replace the profile document in MongoDB with the updated profile (update operation during UpdateProfile).","created_at":"2026-01-30T10:33:42.707672842Z","updated_at":null},{"id":1995,"handler_id":345,"type":"event","label":"Publish profile deleted event to Kafka (topic: TopicProfileDeleted)","function_id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","function_name":"DeleteProfile","description":"Asynchronously publish a ProfileDeletedEvent to Kafka with the profile ID as key (attempted after a successful profile deletion).","created_at":"2026-01-30T10:33:42.714335085Z","updated_at":null},{"id":1991,"handler_id":345,"type":"event","label":"Publish profile updated event to Kafka (topic: TopicProfileUpdated)","function_id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","function_name":"UpdateProfile","description":"Asynchronously publish a ProfileUpdatedEvent to Kafka with the profile ID as key (attempted after a successful profile update).","created_at":"2026-01-30T10:33:42.708762478Z","updated_at":null},{"id":1984,"handler_id":345,"type":"http","label":"GET /api/v1/media/profile/{profileID}","function_id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:291:26","function_name":"fetchProfilePhotos","description":"Outbound HTTP request to the Media Service to fetch photos for the profile (performed by the media client in fetchProfilePhotos).","created_at":"2026-01-30T10:33:42.698574721Z","updated_at":null},{"id":1985,"handler_id":345,"type":"http_response","label":"HTTP 200 JSON response (OK) with profile","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","function_name":"profileByID","description":"Successful GET /api/v1/profiles/{id} returns the profile (including optional photos) to the client.","created_at":"2026-01-30T10:33:42.701518792Z","updated_at":null},{"id":1992,"handler_id":345,"type":"http_response","label":"HTTP 200 JSON response (OK) with updated profile","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","function_name":"updateProfile","description":"On successful PUT update, the updated profile is returned to the client.","created_at":"2026-01-30T10:33:42.709848115Z","updated_at":null},{"id":1996,"handler_id":345,"type":"http_response","label":"HTTP 204 No Content response on DELETE success","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","function_name":"deleteProfile","description":"On successful DELETE, the handler returns an HTTP 204 No Content response to the client.","created_at":"2026-01-30T10:33:42.715979727Z","updated_at":null},{"id":1988,"handler_id":345,"type":"http_response","label":"HTTP 400 Bad Request (invalid JSON body) on PUT","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","function_name":"updateProfile","description":"If the request body for PUT cannot be decoded into the update request, a Bad Request HTTP response is returned.","created_at":"2026-01-30T10:33:42.705567279Z","updated_at":null},{"id":1987,"handler_id":345,"type":"http_response","label":"HTTP 401 Unauthorized response (missing X-User-ID) for PUT/DELETE","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","function_name":"profileByID","description":"If the X-User-ID header is missing for PUT or DELETE requests, the handler returns an Unauthorized HTTP response to the client.","created_at":"2026-01-30T10:33:42.704385828Z","updated_at":null},{"id":1997,"handler_id":345,"type":"http_response","label":"HTTP error response (response.Error) for DeleteProfile errors","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","function_name":"deleteProfile","description":"If DeleteProfile fails (ownership check, DB error, etc.), an appropriate error HTTP response is returned to the client.","created_at":"2026-01-30T10:33:42.71755489Z","updated_at":null},{"id":1986,"handler_id":345,"type":"http_response","label":"HTTP error response (response.Error) for GET errors","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","function_name":"profileByID","description":"If retrieving the profile fails (e.g. not found or internal error), an error HTTP response is returned to the client.","created_at":"2026-01-30T10:33:42.703011331Z","updated_at":null},{"id":1993,"handler_id":345,"type":"http_response","label":"HTTP error response (response.Error) for UpdateProfile errors","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","function_name":"updateProfile","description":"If UpdateProfile fails (ownership check, validation, DB error, etc.), an appropriate error HTTP response is returned to the client.","created_at":"2026-01-30T10:33:42.710947328Z","updated_at":null}],"created_at":"2026-01-30T10:32:26.010595066Z","updated_at":null},{"id":343,"type":"http","method":"ANY","path":"/api/v1/profiles/me","source_function_name":"RegisterRoutes","function_name":"myProfiles","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","outputs":[{"id":1942,"handler_id":343,"type":"database","label":"MongoDB Find on profiles collection with filter {user_id: userID}","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","function_name":"GetByUserID","description":"The repository issues a MongoDB Find(ctx, bson.M{\\"user_id\\": userID}) against the profiles collection to locate documents for the given user_id.","created_at":"2026-01-30T10:33:09.708305008Z","updated_at":null},{"id":1944,"handler_id":343,"type":"database","label":"MongoDB cursor Close (deferred)","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","function_name":"GetByUserID","description":"The repository defers cursor.Close(ctx) to release server-side cursor resources once processing is complete.","created_at":"2026-01-30T10:33:09.710278745Z","updated_at":null},{"id":1943,"handler_id":343,"type":"database","label":"MongoDB cursor.All to read and decode all profiles","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","function_name":"GetByUserID","description":"The MongoDB cursor's All(ctx, &profiles) is used to fetch all returned documents and decode them into the profiles slice (reads documents from the database/driver).","created_at":"2026-01-30T10:33:09.70931099Z","updated_at":null},{"id":1946,"handler_id":343,"type":"http_response","label":"HTTP 200 OK JSON response with profiles (response.OK)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","function_name":"myProfiles","description":"On success, the handler returns an HTTP 200 response containing the retrieved profiles payload to the client via response.OK.","created_at":"2026-01-30T10:33:09.711979081Z","updated_at":null},{"id":1941,"handler_id":343,"type":"http_response","label":"HTTP 400 Bad Request response (method not allowed)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","function_name":"myProfiles","description":"If the request method is not GET, the handler returns an HTTP 400 Bad Request response to the client via response.Error(errors.BadRequest).","created_at":"2026-01-30T10:33:09.70708443Z","updated_at":null},{"id":1940,"handler_id":343,"type":"http_response","label":"HTTP 401 Unauthorized response","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","function_name":"myProfiles","description":"If the X-User-ID header is missing, the handler returns an HTTP 401 Unauthorized error response to the client via response.Error(errors.Unauthorized).","created_at":"2026-01-30T10:33:09.704753122Z","updated_at":null},{"id":1945,"handler_id":343,"type":"http_response","label":"HTTP error response (response.Error with service error)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","function_name":"myProfiles","description":"If profileService.GetUserProfiles (or underlying repository calls) returns an error, the handler forwards an error response to the client via response.Error; the exact HTTP status/body depends on the error wrapped/returned.","created_at":"2026-01-30T10:33:09.711136556Z","updated_at":null}],"created_at":"2026-01-30T10:32:26.006624071Z","updated_at":null},{"id":344,"type":"http","method":"ANY","path":"/api/v1/profiles/user/","source_function_name":"RegisterRoutes","function_name":"profilesByUserID","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","outputs":[{"id":1928,"handler_id":344,"type":"database","label":"MongoDB Find on profiles collection (filter: {\\"user_id\\": <userID>})","function_id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","function_name":"GetByUserID","description":"The repository issues a MongoDB collection.Find(ctx, bson.M{\\"user_id\\": userID}) to retrieve documents for the given user ID; a cursor is returned and its results are decoded into a slice of profiles.","created_at":"2026-01-30T10:33:02.85633985Z","updated_at":null},{"id":1930,"handler_id":344,"type":"http_response","label":"HTTP 200 JSON response with profiles","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","function_name":"profilesByUserID","description":"On success, the handler writes an HTTP 200 OK response to the client containing the JSON-encoded list of profiles returned from the repository.","created_at":"2026-01-30T10:33:02.858924691Z","updated_at":null},{"id":1926,"handler_id":344,"type":"http_response","label":"HTTP 400 error response (method not allowed)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","function_name":"profilesByUserID","description":"If the incoming request method is not GET, the handler writes an HTTP error response (Bad Request / method not allowed) to the client.","created_at":"2026-01-30T10:33:02.851898962Z","updated_at":null},{"id":1927,"handler_id":344,"type":"http_response","label":"HTTP 400 error response (user ID is required)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","function_name":"profilesByUserID","description":"If the user ID path segment is empty, the handler writes an HTTP error response (Bad Request / user ID required) to the client.","created_at":"2026-01-30T10:33:02.85466075Z","updated_at":null},{"id":1929,"handler_id":344,"type":"http_response","label":"HTTP error response (propagated repository/service error)","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","function_name":"profilesByUserID","description":"If the profile repository/service returns an error (for example, if the MongoDB Find or decode fails), the handler writes an error HTTP response to the client (the repository wraps the error as an internal server error; the handler passes that error to the response helper).","created_at":"2026-01-30T10:33:02.857646531Z","updated_at":null}],"created_at":"2026-01-30T10:32:26.008677053Z","updated_at":null},{"id":341,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:39:19","outputs":[{"id":1896,"handler_id":341,"type":"http_response","label":"HTTP 200 JSON response","function_id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:39:19","function_name":"healthCheck","description":"An HTTP response is returned to the client with status code 200, Content-Type set to application/json, and the JSON body {\\"status\\":\\"healthy\\",\\"service\\":\\"profile\\"}.","created_at":"2026-01-30T10:32:46.387940493Z","updated_at":null}],"created_at":"2026-01-30T10:32:25.990264495Z","updated_at":null},{"id":346,"type":"kafka","method":"","path":"user.created","source_function_name":"NewUserEventConsumer","function_name":"handleUserCreated","source_function_id":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:28:6","function_id":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:51:29","outputs":[],"created_at":"2026-01-30T10:32:26.012300933Z","updated_at":null}]`),qr={id:de,name:le,git_repo_url:ce,entrypoint_path:ue,entrypoint_function:he,git_org_url:pe,git_commit:ve,created_at:me,updated_at:_e,status:fe,handlers:ge},kr=Object.freeze(Object.defineProperty({__proto__:null,created_at:me,default:qr,entrypoint_function:he,entrypoint_path:ue,git_commit:ve,git_org_url:pe,git_repo_url:ce,handlers:ge,id:de,name:le,status:fe,updated_at:_e},Symbol.toStringTag,{value:"Module"})),ye=JSON.parse(`[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"profile\\", 8082)\\n\\tkafkaCfg := config.NewKafkaConfig(\\"profile-service\\")\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting profile service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t)\\n\\n\\t// Connect to MongoDB\\n\\tmongoURI := config.GetEnv(\\"MONGO_URI\\", \\"mongodb://rinder:rinder123@localhost:27017\\")\\n\\tmongoDatabase := config.GetEnv(\\"MONGO_DATABASE\\", \\"rinder_profiles\\")\\n\\n\\tctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\\n\\tdefer cancel()\\n\\n\\tclientOpts := options.Client().ApplyURI(mongoURI)\\n\\tmongoClient, err := mongo.Connect(ctx, clientOpts)\\n\\tif err != nil {\\n\\t\\tlogger.Fatal(\\"failed to connect to MongoDB\\", zap.Error(err))\\n\\t}\\n\\tdefer mongoClient.Disconnect(context.Background())\\n\\n\\t// Ping MongoDB\\n\\tif err := mongoClient.Ping(ctx, nil); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to ping MongoDB\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"connected to MongoDB\\")\\n\\n\\tdb := mongoClient.Database(mongoDatabase)\\n\\n\\t// Initialize Kafka producer\\n\\tproducer := kafka.NewProducer(kafkaCfg.Brokers, cfg.Name)\\n\\tdefer producer.Close()\\n\\n\\t// Initialize repository\\n\\tprofileRepo := repository.NewProfileRepository(db)\\n\\n\\t// Create indexes\\n\\tif err := profileRepo.CreateIndexes(context.Background()); err != nil {\\n\\t\\tlogger.Error(\\"failed to create indexes\\", zap.Error(err))\\n\\t}\\n\\n\\t// Cross-service URL for Media Service\\n\\tmediaServiceURL := config.GetEnv(\\"MEDIA_SERVICE_URL\\", \\"http://localhost:8086\\")\\n\\n\\t// Initialize service with cross-service client\\n\\tprofileService := service.NewProfileService(profileRepo, producer, mediaServiceURL)\\n\\tlogger.Info(\\"profile service initialized with cross-service client\\",\\n\\t\\tzap.String(\\"media_service\\", mediaServiceURL),\\n\\t)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(profileService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware (CORS is handled by the gateway)\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Start Kafka consumer for user events\\n\\tkafkaConsumer := consumer.NewUserEventConsumer(kafkaCfg.Brokers, kafkaCfg.GroupID, profileService)\\n\\tconsumerCtx, consumerCancel := context.WithCancel(context.Background())\\n\\tgo kafkaConsumer.Start(consumerCtx)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  15 * time.Second,\\n\\t\\tWriteTimeout: 15 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"profile service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt signal\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Stop consumer\\n\\tconsumerCancel()\\n\\n\\t// Graceful shutdown\\n\\tshutdownCtx, shutdownCancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer shutdownCancel()\\n\\n\\tif err := server.Shutdown(shutdownCtx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server exited properly\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/cmd/main.go:25:1","name":"ROOT","node_type":"function"},{"code":"func NewProfileRepository(db *mongo.Database) *ProfileRepository {\\n\\treturn &ProfileRepository{\\n\\t\\tcollection: db.Collection(\\"profiles\\"),\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:20:6","name":"NewProfileRepository","node_type":"function"},{"code":"func (r *ProfileRepository) CreateIndexes(ctx context.Context) error {\\n\\tindexes := []mongo.IndexModel{\\n\\t\\t{\\n\\t\\t\\tKeys:    bson.D{{Key: \\"user_id\\", Value: 1}},\\n\\t\\t\\tOptions: options.Index().SetBackground(true),\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tKeys:    bson.D{{Key: \\"breed\\", Value: 1}},\\n\\t\\t\\tOptions: options.Index().SetBackground(true),\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tKeys:    bson.D{{Key: \\"is_active\\", Value: 1}},\\n\\t\\t\\tOptions: options.Index().SetBackground(true),\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tKeys:    bson.D{{Key: \\"location\\", Value: \\"2dsphere\\"}},\\n\\t\\t\\tOptions: options.Index().SetBackground(true).SetSparse(true),\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tKeys:    bson.D{{Key: \\"created_at\\", Value: -1}},\\n\\t\\t\\tOptions: options.Index().SetBackground(true),\\n\\t\\t},\\n\\t}\\n\\n\\t_, err := r.collection.Indexes().CreateMany(ctx, indexes)\\n\\treturn err\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:27:29","name":"CreateIndexes","node_type":"function"},{"code":"func NewProfileService(repo *repository.ProfileRepository, producer *kafka.Producer, mediaServiceURL string) *ProfileService {\\n\\tvar mediaClient *httpclient.Client\\n\\tif mediaServiceURL != \\"\\" {\\n\\t\\tmediaClient = httpclient.NewClient(mediaServiceURL, \\"media-service\\", 5*time.Second)\\n\\t}\\n\\treturn &ProfileService{\\n\\t\\trepo:        repo,\\n\\t\\tproducer:    producer,\\n\\t\\tmediaClient: mediaClient,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:28:6","name":"NewProfileService","node_type":"function"},{"code":"func NewHandler(profileService *service.ProfileService) *Handler {\\n\\treturn &Handler{\\n\\t\\tprofileService: profileService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:21:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\t// Health check\\n\\tmux.HandleFunc(\\"/health\\", h.healthCheck)\\n\\n\\t// Profile routes (these expect X-User-ID header from gateway)\\n\\tmux.HandleFunc(\\"/api/v1/profiles\\", h.profiles)\\n\\tmux.HandleFunc(\\"/api/v1/profiles/me\\", h.myProfiles)\\n\\tmux.HandleFunc(\\"/api/v1/profiles/user/\\", h.profilesByUserID)\\n\\tmux.HandleFunc(\\"/api/v1/profiles/\\", h.profileByID)\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) healthCheck(w http.ResponseWriter, r *http.Request) {\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tw.Write([]byte(\`{\\"status\\":\\"healthy\\",\\"service\\":\\"profile\\"}\`))\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:39:19","name":"healthCheck","node_type":"function"},{"code":"func (h *Handler) profiles(w http.ResponseWriter, r *http.Request) {\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodPost:\\n\\t\\tif userID == \\"\\" {\\n\\t\\t\\tresponse.Error(w, errors.Unauthorized(\\"authentication required\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\th.createProfile(w, r, userID)\\n\\n\\tcase http.MethodGet:\\n\\t\\th.listProfiles(w, r)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","name":"profiles","node_type":"function"},{"code":"func (h *Handler) createProfile(w http.ResponseWriter, r *http.Request, userID string) {\\n\\tvar req model.CreateProfileRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"invalid request body\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tprofile, err := h.profileService.CreateProfile(r.Context(), userID, &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.Created(w, profile)\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","name":"createProfile","node_type":"function"},{"code":"func (s *ProfileService) CreateProfile(ctx context.Context, userID string, req *model.CreateProfileRequest) (*model.Profile, error) {\\n\\t// Validate request\\n\\tif err := s.validateCreateRequest(req); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Check profile limit per user\\n\\tcount, err := s.repo.CountByUserID(ctx, userID)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\tif count >= maxProfilesPerUser {\\n\\t\\treturn nil, errors.BadRequest(\\"maximum number of profiles reached\\")\\n\\t}\\n\\n\\t// Check for duplicate name for this user\\n\\texists, err := s.repo.ExistsByUserIDAndName(ctx, userID, req.Name)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\tif exists {\\n\\t\\treturn nil, errors.Conflict(\\"you already have a dog with this name\\")\\n\\t}\\n\\n\\t// Create profile\\n\\tnow := time.Now()\\n\\tprofile := &model.Profile{\\n\\t\\tID:           uuid.New().String(),\\n\\t\\tUserID:       userID,\\n\\t\\tName:         req.Name,\\n\\t\\tBreed:        req.Breed,\\n\\t\\tAge:          req.Age,\\n\\t\\tGender:       req.Gender,\\n\\t\\tSize:         req.Size,\\n\\t\\tBio:          req.Bio,\\n\\t\\tPersonality:  req.Personality,\\n\\t\\tInterests:    req.Interests,\\n\\t\\tIsNeutered:   req.IsNeutered,\\n\\t\\tIsVaccinated: req.IsVaccinated,\\n\\t\\tIsActive:     true,\\n\\t\\tCreatedAt:    now,\\n\\t\\tUpdatedAt:    now,\\n\\t}\\n\\n\\t// Set location if provided\\n\\tif req.Latitude != nil && req.Longitude != nil {\\n\\t\\tprofile.Location = &model.Location{\\n\\t\\t\\tType:        \\"Point\\",\\n\\t\\t\\tCoordinates: []float64{*req.Longitude, *req.Latitude},\\n\\t\\t\\tCity:        req.City,\\n\\t\\t\\tCountry:     req.Country,\\n\\t\\t}\\n\\t}\\n\\n\\tif err := s.repo.Create(ctx, profile); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Publish profile created event\\n\\tevent := model.ProfileCreatedEvent{\\n\\t\\tProfileID: profile.ID,\\n\\t\\tUserID:    profile.UserID,\\n\\t\\tName:      profile.Name,\\n\\t\\tBreed:     profile.Breed,\\n\\t\\tCreatedAt: profile.CreatedAt,\\n\\t}\\n\\tif err := s.producer.PublishWithKey(ctx, kafka.TopicProfileCreated, profile.ID, kafka.EventProfileCreated, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish profile created event\\", zap.Error(err))\\n\\t}\\n\\n\\treturn profile, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","name":"CreateProfile","node_type":"function"},{"code":"func (s *ProfileService) validateCreateRequest(req *model.CreateProfileRequest) error {\\n\\tif req.Name == \\"\\" {\\n\\t\\treturn errors.ValidationError(\\"name is required\\")\\n\\t}\\n\\tif len(req.Name) > 50 {\\n\\t\\treturn errors.ValidationError(\\"name must be less than 50 characters\\")\\n\\t}\\n\\tif req.Breed == \\"\\" {\\n\\t\\treturn errors.ValidationError(\\"breed is required\\")\\n\\t}\\n\\tif req.Age < 0 || req.Age > 30 {\\n\\t\\treturn errors.ValidationError(\\"age must be between 0 and 30\\")\\n\\t}\\n\\tif req.Gender != model.DogGenderMale && req.Gender != model.DogGenderFemale {\\n\\t\\treturn errors.ValidationError(\\"gender must be 'male' or 'female'\\")\\n\\t}\\n\\tif req.Size != model.DogSizeSmall && req.Size != model.DogSizeMedium && req.Size != model.DogSizeLarge && req.Size != model.DogSizeGiant {\\n\\t\\treturn errors.ValidationError(\\"size must be 'small', 'medium', 'large', or 'giant'\\")\\n\\t}\\n\\tif len(req.Bio) > 500 {\\n\\t\\treturn errors.ValidationError(\\"bio must be less than 500 characters\\")\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:342:26","name":"validateCreateRequest","node_type":"function"},{"code":"func (r *ProfileRepository) CountByUserID(ctx context.Context, userID string) (int64, error) {\\n\\tcount, err := r.collection.CountDocuments(ctx, bson.M{\\"user_id\\": userID})\\n\\tif err != nil {\\n\\t\\treturn 0, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to count profiles\\", 500)\\n\\t}\\n\\treturn count, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:197:29","name":"CountByUserID","node_type":"function"},{"code":"func (r *ProfileRepository) ExistsByUserIDAndName(ctx context.Context, userID, name string) (bool, error) {\\n\\tcount, err := r.collection.CountDocuments(ctx, bson.M{\\n\\t\\t\\"user_id\\": userID,\\n\\t\\t\\"name\\":    name,\\n\\t})\\n\\tif err != nil {\\n\\t\\treturn false, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to check profile existence\\", 500)\\n\\t}\\n\\treturn count > 0, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:206:29","name":"ExistsByUserIDAndName","node_type":"function"},{"code":"func (r *ProfileRepository) Create(ctx context.Context, profile *model.Profile) error {\\n\\t_, err := r.collection.InsertOne(ctx, profile)\\n\\tif err != nil {\\n\\t\\tif mongo.IsDuplicateKeyError(err) {\\n\\t\\t\\treturn errors.Conflict(\\"profile already exists\\")\\n\\t\\t}\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to create profile\\", 500)\\n\\t}\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:56:29","name":"Create","node_type":"function"},{"code":"func (h *Handler) listProfiles(w http.ResponseWriter, r *http.Request) {\\n\\tfilter := &model.ListProfilesFilter{}\\n\\n\\t// Parse query parameters\\n\\tquery := r.URL.Query()\\n\\n\\tif breed := query.Get(\\"breed\\"); breed != \\"\\" {\\n\\t\\tfilter.Breed = breed\\n\\t}\\n\\tif gender := query.Get(\\"gender\\"); gender != \\"\\" {\\n\\t\\tfilter.Gender = model.DogGender(gender)\\n\\t}\\n\\tif size := query.Get(\\"size\\"); size != \\"\\" {\\n\\t\\tfilter.Size = model.DogSize(size)\\n\\t}\\n\\tif excludeUser := query.Get(\\"exclude_user\\"); excludeUser != \\"\\" {\\n\\t\\tfilter.ExcludeUserID = excludeUser\\n\\t}\\n\\tif minAge := query.Get(\\"min_age\\"); minAge != \\"\\" {\\n\\t\\tif age, err := strconv.Atoi(minAge); err == nil {\\n\\t\\t\\tfilter.MinAge = age\\n\\t\\t}\\n\\t}\\n\\tif maxAge := query.Get(\\"max_age\\"); maxAge != \\"\\" {\\n\\t\\tif age, err := strconv.Atoi(maxAge); err == nil {\\n\\t\\t\\tfilter.MaxAge = age\\n\\t\\t}\\n\\t}\\n\\tif limit := query.Get(\\"limit\\"); limit != \\"\\" {\\n\\t\\tif l, err := strconv.Atoi(limit); err == nil {\\n\\t\\t\\tfilter.Limit = l\\n\\t\\t}\\n\\t}\\n\\tif offset := query.Get(\\"offset\\"); offset != \\"\\" {\\n\\t\\tif o, err := strconv.Atoi(offset); err == nil {\\n\\t\\t\\tfilter.Offset = o\\n\\t\\t}\\n\\t}\\n\\n\\tprofiles, total, err := h.profileService.ListProfiles(r.Context(), filter)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\t// Calculate pagination metadata\\n\\tlimit := filter.Limit\\n\\tif limit <= 0 {\\n\\t\\tlimit = 20\\n\\t}\\n\\ttotalPages := int(total) / limit\\n\\tif int(total)%limit > 0 {\\n\\t\\ttotalPages++\\n\\t}\\n\\n\\tresponse.JSONWithMeta(w, http.StatusOK, profiles, &response.Meta{\\n\\t\\tPage:       (filter.Offset / limit) + 1,\\n\\t\\tPerPage:    limit,\\n\\t\\tTotal:      total,\\n\\t\\tTotalPages: totalPages,\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:190:19","name":"listProfiles","node_type":"function"},{"code":"func (s *ProfileService) ListProfiles(ctx context.Context, filter *model.ListProfilesFilter) ([]*model.Profile, int64, error) {\\n\\treturn s.repo.List(ctx, filter)\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:271:26","name":"ListProfiles","node_type":"function"},{"code":"func (r *ProfileRepository) List(ctx context.Context, filter *model.ListProfilesFilter) ([]*model.Profile, int64, error) {\\n\\tquery := bson.M{\\"is_active\\": true}\\n\\n\\tif filter.UserID != \\"\\" {\\n\\t\\tquery[\\"user_id\\"] = filter.UserID\\n\\t}\\n\\tif filter.ExcludeUserID != \\"\\" {\\n\\t\\tquery[\\"user_id\\"] = bson.M{\\"$ne\\": filter.ExcludeUserID}\\n\\t}\\n\\tif filter.Breed != \\"\\" {\\n\\t\\tquery[\\"breed\\"] = bson.M{\\"$regex\\": filter.Breed, \\"$options\\": \\"i\\"}\\n\\t}\\n\\tif filter.Gender != \\"\\" {\\n\\t\\tquery[\\"gender\\"] = filter.Gender\\n\\t}\\n\\tif filter.Size != \\"\\" {\\n\\t\\tquery[\\"size\\"] = filter.Size\\n\\t}\\n\\tif filter.MinAge > 0 || filter.MaxAge > 0 {\\n\\t\\tageQuery := bson.M{}\\n\\t\\tif filter.MinAge > 0 {\\n\\t\\t\\tageQuery[\\"$gte\\"] = filter.MinAge\\n\\t\\t}\\n\\t\\tif filter.MaxAge > 0 {\\n\\t\\t\\tageQuery[\\"$lte\\"] = filter.MaxAge\\n\\t\\t}\\n\\t\\tquery[\\"age\\"] = ageQuery\\n\\t}\\n\\n\\t// Get total count\\n\\ttotal, err := r.collection.CountDocuments(ctx, query)\\n\\tif err != nil {\\n\\t\\treturn nil, 0, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to count profiles\\", 500)\\n\\t}\\n\\n\\t// Set defaults\\n\\tlimit := filter.Limit\\n\\tif limit <= 0 {\\n\\t\\tlimit = 20\\n\\t}\\n\\tif limit > 100 {\\n\\t\\tlimit = 100\\n\\t}\\n\\n\\toffset := filter.Offset\\n\\tif offset < 0 {\\n\\t\\toffset = 0\\n\\t}\\n\\n\\t// Find profiles\\n\\topts := options.Find().\\n\\t\\tSetLimit(int64(limit)).\\n\\t\\tSetSkip(int64(offset)).\\n\\t\\tSetSort(bson.D{{Key: \\"created_at\\", Value: -1}})\\n\\n\\tcursor, err := r.collection.Find(ctx, query, opts)\\n\\tif err != nil {\\n\\t\\treturn nil, 0, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to find profiles\\", 500)\\n\\t}\\n\\tdefer cursor.Close(ctx)\\n\\n\\tvar profiles []*model.Profile\\n\\tif err := cursor.All(ctx, &profiles); err != nil {\\n\\t\\treturn nil, 0, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to decode profiles\\", 500)\\n\\t}\\n\\n\\treturn profiles, total, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","name":"List","node_type":"function"},{"code":"func (h *Handler) myProfiles(w http.ResponseWriter, r *http.Request) {\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.Unauthorized(\\"authentication required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tprofiles, err := h.profileService.GetUserProfiles(r.Context(), userID)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, profiles)\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","name":"myProfiles","node_type":"function"},{"code":"func (s *ProfileService) GetUserProfiles(ctx context.Context, userID string) ([]*model.Profile, error) {\\n\\treturn s.repo.GetByUserID(ctx, userID)\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:139:26","name":"GetUserProfiles","node_type":"function"},{"code":"func (r *ProfileRepository) GetByUserID(ctx context.Context, userID string) ([]*model.Profile, error) {\\n\\tcursor, err := r.collection.Find(ctx, bson.M{\\"user_id\\": userID})\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get profiles\\", 500)\\n\\t}\\n\\tdefer cursor.Close(ctx)\\n\\n\\tvar profiles []*model.Profile\\n\\tif err := cursor.All(ctx, &profiles); err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to decode profiles\\", 500)\\n\\t}\\n\\n\\treturn profiles, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","name":"GetByUserID","node_type":"function"},{"code":"func (h *Handler) profilesByUserID(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Extract user ID from path /api/v1/profiles/user/{userID}\\n\\tpath := strings.TrimPrefix(r.URL.Path, \\"/api/v1/profiles/user/\\")\\n\\tuserID := strings.TrimSuffix(path, \\"/\\")\\n\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"user ID is required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tprofiles, err := h.profileService.GetUserProfiles(r.Context(), userID)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, profiles)\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","name":"profilesByUserID","node_type":"function"},{"code":"func (h *Handler) profileByID(w http.ResponseWriter, r *http.Request) {\\n\\t// Extract profile ID from path /api/v1/profiles/{id}\\n\\tpath := strings.TrimPrefix(r.URL.Path, \\"/api/v1/profiles/\\")\\n\\tprofileID := strings.TrimSuffix(path, \\"/\\")\\n\\n\\tif profileID == \\"\\" || profileID == \\"me\\" {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"profile ID is required\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\tprofile, err := h.profileService.GetProfile(r.Context(), profileID)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, profile)\\n\\n\\tcase http.MethodPut:\\n\\t\\tif userID == \\"\\" {\\n\\t\\t\\tresponse.Error(w, errors.Unauthorized(\\"authentication required\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\th.updateProfile(w, r, profileID, userID)\\n\\n\\tcase http.MethodDelete:\\n\\t\\tif userID == \\"\\" {\\n\\t\\t\\tresponse.Error(w, errors.Unauthorized(\\"authentication required\\"))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\th.deleteProfile(w, r, profileID, userID)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"method not allowed\\"))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","name":"profileByID","node_type":"function"},{"code":"func (s *ProfileService) GetProfile(ctx context.Context, id string) (*model.Profile, error) {\\n\\tprofile, err := s.repo.GetByID(ctx, id)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// =====================================================\\n\\t// CROSS-SERVICE CALL: Fetch photos from Media Service\\n\\t// =====================================================\\n\\tphotos, err := s.fetchProfilePhotos(ctx, id)\\n\\tif err != nil {\\n\\t\\t// Log error but don't fail - photos are optional\\n\\t\\tlogger.Warn(\\"failed to fetch profile photos\\",\\n\\t\\t\\tzap.String(\\"profile_id\\", id),\\n\\t\\t\\tzap.Error(err),\\n\\t\\t)\\n\\t} else {\\n\\t\\tprofile.Photos = photos\\n\\t}\\n\\n\\treturn profile, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","name":"GetProfile","node_type":"function"},{"code":"func (r *ProfileRepository) GetByID(ctx context.Context, id string) (*model.Profile, error) {\\n\\tvar profile model.Profile\\n\\terr := r.collection.FindOne(ctx, bson.M{\\"_id\\": id}).Decode(&profile)\\n\\tif err == mongo.ErrNoDocuments {\\n\\t\\treturn nil, errors.ProfileNotFound()\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get profile\\", 500)\\n\\t}\\n\\treturn &profile, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:68:29","name":"GetByID","node_type":"function"},{"code":"func (s *ProfileService) fetchProfilePhotos(ctx context.Context, profileID string) ([]*model.Photo, error) {\\n\\tif s.mediaClient == nil {\\n\\t\\treturn nil, nil // Media service not configured\\n\\t}\\n\\n\\tresp, err := s.mediaClient.Get(ctx, fmt.Sprintf(\\"/api/v1/media/profile/%s\\", profileID), nil)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tif !resp.IsSuccess() {\\n\\t\\t// 404 is expected if no photos exist\\n\\t\\tif resp.StatusCode == 404 {\\n\\t\\t\\treturn []*model.Photo{}, nil\\n\\t\\t}\\n\\t\\treturn nil, errors.InternalServerError(\\"failed to fetch photos\\")\\n\\t}\\n\\n\\tvar result struct {\\n\\t\\tData []struct {\\n\\t\\t\\tID           string \`json:\\"id\\"\`\\n\\t\\t\\tURL          string \`json:\\"url\\"\`\\n\\t\\t\\tThumbnailURL string \`json:\\"thumbnail_url\\"\`\\n\\t\\t\\tIsPrimary    bool   \`json:\\"is_primary\\"\`\\n\\t\\t\\tSortOrder    int    \`json:\\"sort_order\\"\`\\n\\t\\t} \`json:\\"data\\"\`\\n\\t}\\n\\tif err := resp.DecodeJSON(&result); err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to decode photos response\\", 500)\\n\\t}\\n\\n\\tphotos := make([]*model.Photo, len(result.Data))\\n\\tfor i, p := range result.Data {\\n\\t\\tphotos[i] = &model.Photo{\\n\\t\\t\\tID:           p.ID,\\n\\t\\t\\tURL:          p.URL,\\n\\t\\t\\tThumbnailURL: p.ThumbnailURL,\\n\\t\\t\\tIsPrimary:    p.IsPrimary,\\n\\t\\t\\tSortOrder:    p.SortOrder,\\n\\t\\t}\\n\\t}\\n\\n\\tlogger.Debug(\\"fetched profile photos\\",\\n\\t\\tzap.String(\\"profile_id\\", profileID),\\n\\t\\tzap.Int(\\"count\\", len(photos)),\\n\\t)\\n\\n\\treturn photos, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:291:26","name":"fetchProfilePhotos","node_type":"function"},{"code":"func (h *Handler) updateProfile(w http.ResponseWriter, r *http.Request, profileID, userID string) {\\n\\tvar req model.UpdateProfileRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, errors.BadRequest(\\"invalid request body\\"))\\n\\t\\treturn\\n\\t}\\n\\n\\tprofile, err := h.profileService.UpdateProfile(r.Context(), profileID, userID, &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, profile)\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","name":"updateProfile","node_type":"function"},{"code":"func (s *ProfileService) UpdateProfile(ctx context.Context, id, userID string, req *model.UpdateProfileRequest) (*model.Profile, error) {\\n\\tprofile, err := s.repo.GetByID(ctx, id)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Verify ownership\\n\\tif profile.UserID != userID {\\n\\t\\treturn nil, errors.Forbidden(\\"you don't own this profile\\")\\n\\t}\\n\\n\\t// Apply updates\\n\\tif req.Name != nil {\\n\\t\\t// Check for duplicate name (excluding current profile)\\n\\t\\texists, err := s.repo.ExistsByUserIDAndName(ctx, userID, *req.Name)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn nil, err\\n\\t\\t}\\n\\t\\tif exists && *req.Name != profile.Name {\\n\\t\\t\\treturn nil, errors.Conflict(\\"you already have a dog with this name\\")\\n\\t\\t}\\n\\t\\tprofile.Name = *req.Name\\n\\t}\\n\\tif req.Breed != nil {\\n\\t\\tprofile.Breed = *req.Breed\\n\\t}\\n\\tif req.Age != nil {\\n\\t\\tif *req.Age < 0 || *req.Age > 30 {\\n\\t\\t\\treturn nil, errors.ValidationError(\\"age must be between 0 and 30\\")\\n\\t\\t}\\n\\t\\tprofile.Age = *req.Age\\n\\t}\\n\\tif req.Gender != nil {\\n\\t\\tprofile.Gender = *req.Gender\\n\\t}\\n\\tif req.Size != nil {\\n\\t\\tprofile.Size = *req.Size\\n\\t}\\n\\tif req.Bio != nil {\\n\\t\\tif len(*req.Bio) > 500 {\\n\\t\\t\\treturn nil, errors.ValidationError(\\"bio must be less than 500 characters\\")\\n\\t\\t}\\n\\t\\tprofile.Bio = *req.Bio\\n\\t}\\n\\tif req.Personality != nil {\\n\\t\\tprofile.Personality = req.Personality\\n\\t}\\n\\tif req.Interests != nil {\\n\\t\\tprofile.Interests = req.Interests\\n\\t}\\n\\tif req.IsNeutered != nil {\\n\\t\\tprofile.IsNeutered = *req.IsNeutered\\n\\t}\\n\\tif req.IsVaccinated != nil {\\n\\t\\tprofile.IsVaccinated = *req.IsVaccinated\\n\\t}\\n\\tif req.IsActive != nil {\\n\\t\\tprofile.IsActive = *req.IsActive\\n\\t}\\n\\n\\t// Update location if provided\\n\\tif req.Latitude != nil && req.Longitude != nil {\\n\\t\\tcity := \\"\\"\\n\\t\\tcountry := \\"\\"\\n\\t\\tif req.City != nil {\\n\\t\\t\\tcity = *req.City\\n\\t\\t}\\n\\t\\tif req.Country != nil {\\n\\t\\t\\tcountry = *req.Country\\n\\t\\t}\\n\\t\\tprofile.Location = &model.Location{\\n\\t\\t\\tType:        \\"Point\\",\\n\\t\\t\\tCoordinates: []float64{*req.Longitude, *req.Latitude},\\n\\t\\t\\tCity:        city,\\n\\t\\t\\tCountry:     country,\\n\\t\\t}\\n\\t}\\n\\n\\tif err := s.repo.Update(ctx, profile); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Publish profile updated event\\n\\tevent := model.ProfileUpdatedEvent{\\n\\t\\tProfileID: profile.ID,\\n\\t\\tUserID:    profile.UserID,\\n\\t\\tName:      profile.Name,\\n\\t\\tBreed:     profile.Breed,\\n\\t\\tUpdatedAt: profile.UpdatedAt,\\n\\t}\\n\\tif err := s.producer.PublishWithKey(ctx, kafka.TopicProfileUpdated, profile.ID, kafka.EventProfileUpdated, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish profile updated event\\", zap.Error(err))\\n\\t}\\n\\n\\treturn profile, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","name":"UpdateProfile","node_type":"function"},{"code":"func (r *ProfileRepository) Update(ctx context.Context, profile *model.Profile) error {\\n\\tprofile.UpdatedAt = time.Now()\\n\\n\\tresult, err := r.collection.ReplaceOne(ctx, bson.M{\\"_id\\": profile.ID}, profile)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to update profile\\", 500)\\n\\t}\\n\\n\\tif result.MatchedCount == 0 {\\n\\t\\treturn errors.ProfileNotFound()\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:97:29","name":"Update","node_type":"function"},{"code":"func (h *Handler) deleteProfile(w http.ResponseWriter, r *http.Request, profileID, userID string) {\\n\\tif err := h.profileService.DeleteProfile(r.Context(), profileID, userID); err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.NoContent(w)\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","name":"deleteProfile","node_type":"function"},{"code":"func (s *ProfileService) DeleteProfile(ctx context.Context, id, userID string) error {\\n\\tprofile, err := s.repo.GetByID(ctx, id)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\n\\t// Verify ownership\\n\\tif profile.UserID != userID {\\n\\t\\treturn errors.Forbidden(\\"you don't own this profile\\")\\n\\t}\\n\\n\\tif err := s.repo.Delete(ctx, id); err != nil {\\n\\t\\treturn err\\n\\t}\\n\\n\\t// Publish profile deleted event\\n\\tevent := model.ProfileDeletedEvent{\\n\\t\\tProfileID: id,\\n\\t\\tUserID:    userID,\\n\\t\\tDeletedAt: time.Now(),\\n\\t}\\n\\tif err := s.producer.PublishWithKey(ctx, kafka.TopicProfileDeleted, id, kafka.EventProfileDeleted, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish profile deleted event\\", zap.Error(err))\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","name":"DeleteProfile","node_type":"function"},{"code":"func (r *ProfileRepository) Delete(ctx context.Context, id string) error {\\n\\tresult, err := r.collection.DeleteOne(ctx, bson.M{\\"_id\\": id})\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to delete profile\\", 500)\\n\\t}\\n\\n\\tif result.DeletedCount == 0 {\\n\\t\\treturn errors.ProfileNotFound()\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:113:29","name":"Delete","node_type":"function"},{"code":"func NewUserEventConsumer(brokers []string, groupID string, profileService *service.ProfileService) *UserEventConsumer {\\n\\tconsumer := kafka.NewConsumer(brokers, groupID, []string{kafka.TopicUserCreated})\\n\\n\\tuec := &UserEventConsumer{\\n\\t\\tconsumer:       consumer,\\n\\t\\tprofileService: profileService,\\n\\t}\\n\\n\\t// Register handlers\\n\\tconsumer.RegisterHandler(kafka.EventUserCreated, uec.handleUserCreated)\\n\\n\\treturn uec\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:28:6","name":"NewUserEventConsumer","node_type":"function"},{"code":"func (c *UserEventConsumer) handleUserCreated(ctx context.Context, event kafka.Event) error {\\n\\tvar data UserCreatedEventData\\n\\tif err := json.Unmarshal(event.Data, &data); err != nil {\\n\\t\\tlogger.Error(\\"failed to unmarshal user created event data\\",\\n\\t\\t\\tzap.Error(err),\\n\\t\\t\\tzap.String(\\"event_id\\", event.ID),\\n\\t\\t)\\n\\t\\treturn err\\n\\t}\\n\\n\\tlogger.Info(\\"received user created event\\",\\n\\t\\tzap.String(\\"user_id\\", data.UserID),\\n\\t\\tzap.String(\\"email\\", data.Email),\\n\\t)\\n\\n\\t// We could create a default profile here, but for now we just log\\n\\t// The user will create their own profile(s)\\n\\treturn c.profileService.CreateDefaultProfile(ctx, data.UserID, data.Email)\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:51:29","name":"handleUserCreated","node_type":"function"},{"code":"func (s *ProfileService) CreateDefaultProfile(ctx context.Context, userID, email string) error {\\n\\t// This is called from the Kafka consumer when a user is created\\n\\t// We don't create a default profile automatically - the user will create their own\\n\\tlogger.Info(\\"user created, ready for profile creation\\",\\n\\t\\tzap.String(\\"user_id\\", userID),\\n\\t\\tzap.String(\\"email\\", email),\\n\\t)\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:276:26","name":"CreateDefaultProfile","node_type":"function"},{"code":"func (c *UserEventConsumer) Start(ctx context.Context) {\\n\\tlogger.Info(\\"starting user event consumer\\")\\n\\tif err := c.consumer.Start(ctx); err != nil {\\n\\t\\tlogger.Error(\\"user event consumer error\\", zap.Error(err))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:43:29","name":"Start","node_type":"function"}]`),Ce=JSON.parse('[{"column":27,"line":63,"source":"/home/evan/Code/rinder/services/profile/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:20:6","val":1},{"column":23,"line":66,"source":"/home/evan/Code/rinder/services/profile/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:27:29","val":1},{"column":45,"line":50,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:27:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:27:29","val":1},{"column":27,"line":74,"source":"/home/evan/Code/rinder/services/profile/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:28:6","val":1},{"column":37,"line":30,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:28:6","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:28:6","val":1},{"column":14,"line":80,"source":"/home/evan/Code/rinder/services/profile/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:21:6","val":1},{"column":3,"line":84,"source":"/home/evan/Code/rinder/services/profile/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","val":1},{"column":29,"line":29,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:39:19","val":1},{"column":38,"line":32,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","val":1},{"column":18,"line":50,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","val":1},{"column":4,"line":53,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","val":1},{"column":17,"line":127,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","val":1},{"column":34,"line":131,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","val":1},{"column":13,"line":42,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:342:26","val":1},{"column":35,"line":42,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","val":1},{"column":22,"line":47,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:197:29","val":1},{"column":43,"line":197,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:197:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:197:29","val":1},{"column":36,"line":47,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","val":1},{"column":41,"line":47,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","val":1},{"column":23,"line":56,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:206:29","val":1},{"column":43,"line":206,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:206:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:206:29","val":1},{"column":45,"line":56,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","val":1},{"column":50,"line":56,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","val":1},{"column":18,"line":94,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:56:29","val":1},{"column":34,"line":56,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:56:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:56:29","val":1},{"column":39,"line":56,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:56:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:56:29","val":1},{"column":25,"line":94,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","val":1},{"column":37,"line":106,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26","val":1},{"column":61,"line":131,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","val":1},{"column":17,"line":133,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","val":1},{"column":18,"line":137,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19","val":1},{"column":18,"line":53,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","val":1},{"column":21,"line":53,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","val":1},{"column":4,"line":56,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:190:19","val":1},{"column":42,"line":228,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:190:19","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:271:26","val":1},{"column":15,"line":271,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:271:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","val":1},{"column":43,"line":156,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","val":1},{"column":34,"line":181,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","val":1},{"column":20,"line":185,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","val":1},{"column":22,"line":188,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29","val":1},{"column":20,"line":271,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:271:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:271:26","val":1},{"column":25,"line":271,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:271:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:271:26","val":1},{"column":17,"line":230,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:190:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:190:19","val":1},{"column":23,"line":244,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:190:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:190:19","val":1},{"column":17,"line":56,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","val":1},{"column":20,"line":56,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","val":1},{"column":17,"line":59,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19","val":1},{"column":41,"line":33,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","val":1},{"column":17,"line":66,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","val":1},{"column":17,"line":71,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","val":1},{"column":35,"line":75,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:139:26","val":1},{"column":15,"line":139,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:139:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","val":1},{"column":34,"line":81,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","val":1},{"column":20,"line":85,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","val":1},{"column":22,"line":88,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29","val":1},{"column":27,"line":139,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:139:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:139:26","val":1},{"column":32,"line":139,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:139:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:139:26","val":1},{"column":17,"line":77,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","val":1},{"column":13,"line":81,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19","val":1},{"column":44,"line":34,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","val":1},{"column":17,"line":167,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","val":1},{"column":17,"line":176,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","val":1},{"column":35,"line":180,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:139:26","val":1},{"column":17,"line":182,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","val":1},{"column":13,"line":186,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19","val":1},{"column":39,"line":35,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":17,"line":90,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":35,"line":98,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","val":1},{"column":24,"line":115,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:68:29","val":1},{"column":29,"line":69,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:68:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:68:29","val":1},{"column":32,"line":115,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","val":1},{"column":37,"line":115,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","val":1},{"column":18,"line":123,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:291:26","val":1},{"column":32,"line":295,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:291:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:291:26","val":1},{"column":77,"line":295,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:291:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:291:26","val":1},{"column":27,"line":333,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:291:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:291:26","val":1},{"column":37,"line":123,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","val":1},{"column":42,"line":123,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","val":1},{"column":28,"line":127,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26","val":1},{"column":18,"line":100,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":14,"line":103,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":18,"line":107,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":4,"line":110,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","val":1},{"column":17,"line":143,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","val":1},{"column":34,"line":147,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","val":1},{"column":24,"line":144,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:68:29","val":1},{"column":32,"line":144,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","val":1},{"column":37,"line":144,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","val":1},{"column":24,"line":157,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:206:29","val":1},{"column":46,"line":157,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","val":1},{"column":51,"line":157,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","val":1},{"column":18,"line":221,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:97:29","val":1},{"column":40,"line":99,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:97:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:97:29","val":1},{"column":72,"line":99,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:97:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:97:29","val":1},{"column":25,"line":221,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","val":1},{"column":37,"line":233,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26","val":1},{"column":61,"line":147,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","val":1},{"column":72,"line":147,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","val":1},{"column":17,"line":149,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","val":1},{"column":13,"line":153,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19","val":1},{"column":18,"line":110,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":21,"line":110,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":18,"line":114,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":4,"line":117,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","val":1},{"column":28,"line":157,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","val":1},{"column":24,"line":242,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:68:29","val":1},{"column":32,"line":242,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","val":1},{"column":37,"line":242,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","val":1},{"column":18,"line":252,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:113:29","val":1},{"column":39,"line":113,"source":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:113:29","target":"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:113:29","val":1},{"column":25,"line":252,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","val":1},{"column":30,"line":252,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","val":1},{"column":37,"line":262,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","val":1},{"column":69,"line":262,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26","val":1},{"column":55,"line":157,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","val":1},{"column":66,"line":157,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","val":1},{"column":17,"line":158,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","val":1},{"column":20,"line":162,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19","val":1},{"column":18,"line":117,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":21,"line":117,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":17,"line":120,"source":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19","val":1},{"column":27,"line":92,"source":"/home/evan/Code/rinder/services/profile/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:28:6","val":1},{"column":31,"line":28,"source":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:28:6","target":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:28:6","val":1},{"column":40,"line":28,"source":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:28:6","target":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:28:6","val":1},{"column":54,"line":36,"source":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:28:6","target":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:51:29","val":1},{"column":25,"line":67,"source":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:51:29","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:276:26","val":1},{"column":24,"line":279,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:276:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:276:26","val":1},{"column":22,"line":280,"source":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:276:26","target":"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:276:26","val":1},{"column":46,"line":67,"source":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:51:29","target":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:51:29","val":1},{"column":18,"line":94,"source":"/home/evan/Code/rinder/services/profile/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:43:29","val":1},{"column":28,"line":44,"source":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:43:29","target":"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:43:29","val":1}]'),Ur={nodes:ye,links:Ce},Mr=Object.freeze(Object.defineProperty({__proto__:null,default:Ur,links:Ce,nodes:ye},Symbol.toStringTag,{value:"Module"})),Or=[{id:"/home/evan/Code/rinder/services/profile/cmd/main.go:25:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:20:6",name:"NewProfileRepository",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:27:29",name:"CreateIndexes",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:28:6",name:"NewProfileService",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:21:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:28:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:39:19",name:"healthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:45:19",name:"profiles",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:125:19",name:"createProfile",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:41:26",name:"CreateProfile",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:342:26",name:"validateCreateRequest",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:197:29",name:"CountByUserID",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:206:29",name:"ExistsByUserIDAndName",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:56:29",name:"Create",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:190:19",name:"listProfiles",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:271:26",name:"ListProfiles",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:127:29",name:"List",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:64:19",name:"myProfiles",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:139:26",name:"GetUserProfiles",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:81:29",name:"GetByUserID",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:166:19",name:"profilesByUserID",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:85:19",name:"profileByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:115:26",name:"GetProfile",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:68:29",name:"GetByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:291:26",name:"fetchProfilePhotos",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:141:19",name:"updateProfile",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:144:26",name:"UpdateProfile",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:97:29",name:"Update",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/handler/handler.go:157:19",name:"deleteProfile",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:242:26",name:"DeleteProfile",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/repository/profile_repository.go:113:29",name:"Delete",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:28:6",name:"NewUserEventConsumer",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:51:29",name:"handleUserCreated",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/service/profile_service.go:276:26",name:"CreateDefaultProfile",node_type:"function"},{id:"/home/evan/Code/rinder/services/profile/internal/consumer/user_consumer.go:43:29",name:"Start",node_type:"function"}],Ar=Object.freeze(Object.defineProperty({__proto__:null,default:Or},Symbol.toStringTag,{value:"Module"})),Te=15,be="service-user",we="/home/evan/Code/rinder/services/user",Se="cmd/main.go",Ee="main",Ie="github.com/rinder",Pe=null,Re="2026-01-21T10:24:51.1652729Z",xe="2026-01-21T10:24:53.618656084Z",De="analyzing-completed",Ne=JSON.parse(`[{"id":291,"type":"http","method":"GET","path":"/api/v1/users/","source_function_name":"RegisterRoutes","function_name":"userByID","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","outputs":[{"id":1648,"handler_id":291,"type":"database","label":"SELECT id, email, password_hash, first_name, last_name, status, created_at, updated_at FROM users WHERE id = $1","function_id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","function_name":"GetByID","description":"When a GET request is received with a non-empty user ID, the repository executes a QueryRowContext with the above SELECT to retrieve the user row by id (parameter: the requested user ID).","created_at":"2026-01-30T10:26:07.368602399Z","updated_at":null},{"id":1651,"handler_id":291,"type":"http_response","label":"HTTP 200 OK with user payload (response.OK)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","function_name":"userByID","description":"If the repository successfully returns the user row, the handler returns an HTTP 200 OK response with the user data (the user object provided to response.OK).","created_at":"2026-01-30T10:26:07.372270646Z","updated_at":null},{"id":1646,"handler_id":291,"type":"http_response","label":"HTTP 400 Bad Request (user ID is required)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","function_name":"userByID","description":"If the path does not contain a user ID (empty path segment after /api/v1/users/), the handler returns an HTTP error response indicating the user ID is required.","created_at":"2026-01-30T10:26:07.351526566Z","updated_at":null},{"id":1649,"handler_id":291,"type":"http_response","label":"HTTP 404 Not Found (user not found)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","function_name":"userByID","description":"If the database query returns no rows for the given id, the repository returns a NotFound error which the handler translates to an HTTP error response indicating the user was not found.","created_at":"2026-01-30T10:26:07.370083815Z","updated_at":null},{"id":1647,"handler_id":291,"type":"http_response","label":"HTTP 405 Method Not Allowed","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","function_name":"userByID","description":"If the incoming request method is not GET, the handler returns an HTTP method-not-allowed error response.","created_at":"2026-01-30T10:26:07.366695693Z","updated_at":null},{"id":1650,"handler_id":291,"type":"http_response","label":"HTTP 500 Internal Server Error (query/other internal error)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","function_name":"userByID","description":"If the database query or repository returns any other (internal) error, the handler returns an HTTP internal-server-error response to the client.","created_at":"2026-01-30T10:26:07.371209228Z","updated_at":null}],"created_at":"2026-01-30T10:25:26.075007333Z","updated_at":null},{"id":289,"type":"http","method":"GET","path":"/api/v1/users/me","source_function_name":"RegisterRoutes","function_name":"me","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","outputs":[{"id":1682,"handler_id":289,"type":"database","label":"SELECT id, email, password_hash, first_name, last_name, status, created_at, updated_at FROM users WHERE id = $1","function_id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","function_name":"GetByID","description":"Query the users table for a user by ID (used by both GetUser and UpdateUser flows). Executed via QueryRowContext and Scan to retrieve a single user record.","created_at":"2026-01-30T10:26:16.190891252Z","updated_at":null},{"id":1685,"handler_id":289,"type":"database","label":"UPDATE users SET first_name = $1, last_name = $2, updated_at = $3 WHERE id = $4","function_id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:111:26","function_name":"Update","description":"Update the user's first_name, last_name and updated_at in the users table. Executed via ExecContext in the Update repository method during the PUT /me flow.","created_at":"2026-01-30T10:26:16.194407014Z","updated_at":null},{"id":1686,"handler_id":289,"type":"event","label":"Publish user updated event to Kafka (PublishWithKey on kafka.TopicUserUpdated, key = user.ID, event = kafka.EventUserUpdated)","function_id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","function_name":"UpdateUser","description":"After a successful user update (PUT /me), the service publishes a UserUpdatedEvent to Kafka using the configured producer.","created_at":"2026-01-30T10:26:16.195393182Z","updated_at":null},{"id":1687,"handler_id":289,"type":"http_response","label":"HTTP 200 OK response (response.OK with updated user)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"When PUT /me succeeds (user updated), the handler returns an HTTP 200 response with the updated user object to the client.","created_at":"2026-01-30T10:26:16.196307319Z","updated_at":null},{"id":1683,"handler_id":289,"type":"http_response","label":"HTTP 200 OK response (response.OK with user)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"When GET /me succeeds, the handler returns an HTTP 200 response with the user object to the client.","created_at":"2026-01-30T10:26:16.192330724Z","updated_at":null},{"id":1681,"handler_id":289,"type":"http_response","label":"HTTP 400 Bad Request response (response.Error for invalid request body)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"When the request is PUT and the request body cannot be decoded as the expected JSON, the handler returns a bad-request error response to the client.","created_at":"2026-01-30T10:26:16.189598337Z","updated_at":null},{"id":1679,"handler_id":289,"type":"http_response","label":"HTTP 401 Unauthorized response (response.Error with unauthorizedError)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"If the X-User-ID header is missing, the handler returns an unauthorized error response to the client and stops processing.","created_at":"2026-01-30T10:26:16.183636932Z","updated_at":null},{"id":1680,"handler_id":289,"type":"http_response","label":"HTTP 405 Method Not Allowed response (response.Error with methodNotAllowedError)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"If the request method is not GET or PUT, the handler returns a method-not-allowed error response to the client.","created_at":"2026-01-30T10:26:16.188172762Z","updated_at":null},{"id":1684,"handler_id":289,"type":"http_response","label":"HTTP error response for NotFound (response.Error with NotFound)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"If the repository returns a NotFound error (no user row) in either GET or PUT flows, the handler returns an appropriate NotFound error HTTP response to the client.","created_at":"2026-01-30T10:26:16.193493962Z","updated_at":null},{"id":1688,"handler_id":289,"type":"http_response","label":"HTTP error response for repository/service errors (response.Error)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"If any repository or service call returns an error (database error, internal error, etc.) during GET or PUT flows, the handler returns an error HTTP response to the client reflecting that error.","created_at":"2026-01-30T10:26:16.197221453Z","updated_at":null}],"created_at":"2026-01-30T10:25:26.073007805Z","updated_at":null},{"id":285,"type":"http","method":"GET","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:40:19","outputs":[{"id":1600,"handler_id":285,"type":"http_response","label":"HTTP 200 JSON response","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:40:19","function_name":"healthCheck","description":"The handler writes an HTTP 200 response with Content-Type 'application/json' and body '{\\"status\\":\\"healthy\\",\\"service\\":\\"user\\"}' to the client.","created_at":"2026-01-30T10:25:38.95436803Z","updated_at":null}],"created_at":"2026-01-30T10:25:26.052036314Z","updated_at":null},{"id":287,"type":"http","method":"POST","path":"/api/v1/auth/login","source_function_name":"RegisterRoutes","function_name":"login","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","outputs":[{"id":1654,"handler_id":287,"type":"database","label":"SELECT id, email, password_hash, first_name, last_name, status, created_at, updated_at FROM users WHERE email = $1","function_id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:81:26","function_name":"GetByEmail","description":"A database query is executed to fetch the user row by email (GetByEmail). This happens during login to retrieve the stored user record and password hash.","created_at":"2026-01-30T10:26:09.894452512Z","updated_at":null},{"id":1658,"handler_id":287,"type":"http_response","label":"HTTP 200 OK JSON response (AuthResponse with access token, refresh token, expires_in and user)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","function_name":"login","description":"On successful authentication (password verified and user active), the service generates access and refresh tokens and the handler returns an HTTP 200 response containing the AuthResponse JSON payload (access token, refresh token, expires_in, and user info).","created_at":"2026-01-30T10:26:09.900121001Z","updated_at":null},{"id":1653,"handler_id":287,"type":"http_response","label":"HTTP 400 Bad Request response (invalid JSON body)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","function_name":"login","description":"If the request body cannot be decoded as the expected LoginRequest JSON, the handler returns an HTTP 400 Bad Request error response.","created_at":"2026-01-30T10:26:09.891375112Z","updated_at":null},{"id":1655,"handler_id":287,"type":"http_response","label":"HTTP 401 Unauthorized response (invalid credentials)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","function_name":"login","description":"If no user is found for the provided email or the password comparison fails, the service returns an invalid credentials error which the handler sends back as an HTTP unauthorized response.","created_at":"2026-01-30T10:26:09.8961419Z","updated_at":null},{"id":1656,"handler_id":287,"type":"http_response","label":"HTTP 403 Forbidden response (user account not active)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","function_name":"login","description":"If the retrieved user's status is not active, the service returns a forbidden error which the handler sends back as an HTTP 403 Forbidden response.","created_at":"2026-01-30T10:26:09.89755021Z","updated_at":null},{"id":1652,"handler_id":287,"type":"http_response","label":"HTTP 405 Method Not Allowed response","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","function_name":"login","description":"If the incoming HTTP request method is not POST, the handler returns an HTTP error response indicating method not allowed.","created_at":"2026-01-30T10:26:09.878168411Z","updated_at":null},{"id":1657,"handler_id":287,"type":"http_response","label":"HTTP 500 Internal Server Error response (database or token generation failure)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","function_name":"login","description":"If an unexpected database error occurs (other than not found), or if token generation fails, the service wraps and returns an internal server error which the handler sends as an HTTP 500 response.","created_at":"2026-01-30T10:26:09.898974984Z","updated_at":null}],"created_at":"2026-01-30T10:25:26.069852388Z","updated_at":null},{"id":288,"type":"http","method":"POST","path":"/api/v1/auth/refresh","source_function_name":"RegisterRoutes","function_name":"refresh","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","outputs":[{"id":1703,"handler_id":288,"type":"database","label":"SELECT id, email, password_hash, first_name, last_name, status, created_at, updated_at FROM users WHERE id = $1","function_id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","function_name":"GetByID","description":"The user record is retrieved from the database by ID (repo.GetByID executes this query using QueryRowContext and Scan).","created_at":"2026-01-30T10:26:19.222049105Z","updated_at":null},{"id":1711,"handler_id":288,"type":"http_response","label":"HTTP 200 JSON response with new access and refresh tokens","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","function_name":"refresh","description":"On success, the handler returns an HTTP 200 response with a JSON body containing accessToken, refreshToken and expiresIn (model.RefreshResponse) via response.OK.","created_at":"2026-01-30T10:26:19.235125441Z","updated_at":null},{"id":1699,"handler_id":288,"type":"http_response","label":"HTTP 400 Bad Request (invalid request body)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","function_name":"refresh","description":"If the request body cannot be decoded as JSON into model.RefreshRequest, the handler returns an HTTP 400 response to the client via response.Error.","created_at":"2026-01-30T10:26:19.214322876Z","updated_at":null},{"id":1697,"handler_id":288,"type":"http_response","label":"HTTP 405 Method Not Allowed","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","function_name":"refresh","description":"If the incoming request method is not POST, the handler returns an HTTP 405 response to the client via response.Error.","created_at":"2026-01-30T10:26:19.198690981Z","updated_at":null},{"id":1709,"handler_id":288,"type":"http_response","label":"HTTP error response (various status codes)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","function_name":"refresh","description":"If userService.RefreshToken returns an error (validation error for missing refresh token, token validation failure, user not found, user not active -> forbidden, or internal errors from token generation or DB), the handler returns an appropriate HTTP error response to the client via response.Error.","created_at":"2026-01-30T10:26:19.232165262Z","updated_at":null},{"id":1705,"handler_id":288,"type":"other","label":"jwtAuth.GenerateAccessToken(user.ID, user.Email, ttl)","function_id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:161:23","function_name":"RefreshToken","description":"A new access token is generated using the injected jwtAuth dependency. If generation fails, an internal error is returned and the handler returns an HTTP error.","created_at":"2026-01-30T10:26:19.22587269Z","updated_at":null},{"id":1707,"handler_id":288,"type":"other","label":"jwtAuth.GenerateRefreshToken(user.ID, user.Email, ttl)","function_id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:161:23","function_name":"RefreshToken","description":"A new refresh token is generated using the injected jwtAuth dependency. If generation fails, an internal error is returned and the handler returns an HTTP error.","created_at":"2026-01-30T10:26:19.229149986Z","updated_at":null},{"id":1701,"handler_id":288,"type":"other","label":"jwtAuth.ValidateToken(refreshToken)","function_id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:161:23","function_name":"RefreshToken","description":"The provided refresh token is validated using the injected jwtAuth dependency (token parsing/verification). If validation fails, an error is returned and the handler ultimately returns an HTTP error.","created_at":"2026-01-30T10:26:19.218468596Z","updated_at":null}],"created_at":"2026-01-30T10:25:26.071798848Z","updated_at":null},{"id":286,"type":"http","method":"POST","path":"/api/v1/auth/signup","source_function_name":"RegisterRoutes","function_name":"signup","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","outputs":[{"id":1693,"handler_id":286,"type":"database","label":"INSERT INTO users (...) VALUES (...)","function_id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:23:26","function_name":"Create","description":"Insert a new user row into the users table (performed via ExecContext).","created_at":"2026-01-30T10:26:17.872793723Z","updated_at":null},{"id":1692,"handler_id":286,"type":"database","label":"SELECT EXISTS(SELECT 1 FROM users WHERE email = $1)","function_id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:164:26","function_name":"ExistsByEmail","description":"Check whether a user with the provided email already exists in the users table (performed via QueryRowContext).","created_at":"2026-01-30T10:26:17.871692019Z","updated_at":null},{"id":1694,"handler_id":286,"type":"event","label":"Publish user created event to Kafka (PublishWithKey to kafka.TopicUserCreated)","function_id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","function_name":"Signup","description":"Asynchronously publish a UserCreatedEvent to Kafka using the user's ID as the message key (attempted after successful user creation). Errors from publishing are logged but do not fail the signup request.","created_at":"2026-01-30T10:26:17.873857397Z","updated_at":null},{"id":1695,"handler_id":286,"type":"http_response","label":"HTTP 201 Created response (response.Created) with AuthResponse payload","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","function_name":"signup","description":"On successful signup (user created, tokens generated), the handler returns an HTTP 201 Created response containing the AuthResponse (access token, refresh token, expires_in, user data).","created_at":"2026-01-30T10:26:17.875012081Z","updated_at":null},{"id":1690,"handler_id":286,"type":"http_response","label":"HTTP 400 Bad Request response (response.Error) for invalid JSON body","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","function_name":"signup","description":"If the request body cannot be decoded as the expected signup JSON, the handler returns an HTTP error response indicating a bad request / invalid request body.","created_at":"2026-01-30T10:26:17.86914358Z","updated_at":null},{"id":1689,"handler_id":286,"type":"http_response","label":"HTTP 405 Method Not Allowed response (response.Error)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","function_name":"signup","description":"If the incoming HTTP request method is not POST, the handler returns an HTTP error response indicating the method is not allowed.","created_at":"2026-01-30T10:26:17.866125646Z","updated_at":null},{"id":1691,"handler_id":286,"type":"http_response","label":"HTTP error response (response.Error) for service-level errors","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","function_name":"signup","description":"If UserService.Signup returns an error (validation errors, user already exists, token generation failure, DB errors, etc.), the handler forwards that error to response.Error which returns an appropriate HTTP error response to the client.","created_at":"2026-01-30T10:26:17.870607429Z","updated_at":null}],"created_at":"2026-01-30T10:25:26.066537619Z","updated_at":null},{"id":290,"type":"http","method":"PUT","path":"/api/v1/users/me","source_function_name":"RegisterRoutes","function_name":"me","source_function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","outputs":[{"id":1780,"handler_id":290,"type":"database","label":"SELECT id, email, password_hash, first_name, last_name, status, created_at, updated_at FROM users WHERE id = $1","function_id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","function_name":"GetByID","description":"Retrieve a user row by ID from the users table (used by GetUser and by UpdateUser to load the existing user).","created_at":"2026-01-30T10:26:29.762841394Z","updated_at":null},{"id":1786,"handler_id":290,"type":"database","label":"UPDATE users SET first_name = $1, last_name = $2, updated_at = $3 WHERE id = $4","function_id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:111:26","function_name":"Update","description":"Update the user's first_name, last_name and updated_at in the users table (performed during PUT /me on successful validation).","created_at":"2026-01-30T10:26:29.768329955Z","updated_at":null},{"id":1788,"handler_id":290,"type":"event","label":"Publish UserUpdatedEvent to Kafka (TopicUserUpdated) with key = user.ID","function_id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","function_name":"UpdateUser","description":"After a successful user update, the service publishes a UserUpdatedEvent to Kafka using producer.PublishWithKey (this is best-effort; failures are logged but do not change the returned response).","created_at":"2026-01-30T10:26:29.770224061Z","updated_at":null},{"id":1790,"handler_id":290,"type":"http_response","label":"HTTP 200 JSON response (updated user)  PUT /me","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"On successful PUT (user fetched, updated in DB, and after attempting to publish event), the handler returns an HTTP 200 response containing the updated user object.","created_at":"2026-01-30T10:26:29.772401225Z","updated_at":null},{"id":1782,"handler_id":290,"type":"http_response","label":"HTTP 200 JSON response (user object)  GET /me","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"On successful GET, the handler returns an HTTP 200 response containing the user object.","created_at":"2026-01-30T10:26:29.764432796Z","updated_at":null},{"id":1778,"handler_id":290,"type":"http_response","label":"HTTP 400 Bad Request response (invalid JSON body)","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"If JSON decoding of the PUT request body fails, the handler returns a bad-request error response to the client.","created_at":"2026-01-30T10:26:29.760673976Z","updated_at":null},{"id":1774,"handler_id":290,"type":"http_response","label":"HTTP 401 Unauthorized response","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"If the X-User-ID header is missing, the handler returns an unauthorized error response to the client.","created_at":"2026-01-30T10:26:29.743863099Z","updated_at":null},{"id":1776,"handler_id":290,"type":"http_response","label":"HTTP 405 Method Not Allowed response","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"If the HTTP method is not GET or PUT, the handler returns a method-not-allowed error response to the client.","created_at":"2026-01-30T10:26:29.75665336Z","updated_at":null},{"id":1784,"handler_id":290,"type":"http_response","label":"HTTP error response (returned to client)  GetUser or UpdateUser failure","function_id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","function_name":"me","description":"If userService.GetUser or userService.UpdateUser returns an error (for example internal error or not-found), the handler forwards an error response to the client via response.Error.","created_at":"2026-01-30T10:26:29.766264515Z","updated_at":null}],"created_at":"2026-01-30T10:25:26.074174223Z","updated_at":null}]`),Zr={id:Te,name:be,git_repo_url:we,entrypoint_path:Se,entrypoint_function:Ee,git_org_url:Ie,git_commit:Pe,created_at:Re,updated_at:xe,status:De,handlers:Ne},Gr=Object.freeze(Object.defineProperty({__proto__:null,created_at:Re,default:Zr,entrypoint_function:Ee,entrypoint_path:Se,git_commit:Pe,git_org_url:Ie,git_repo_url:we,handlers:Ne,id:Te,name:be,status:De,updated_at:xe},Symbol.toStringTag,{value:"Module"})),He=JSON.parse('[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"user\\", 8081)\\n\\t// Override defaults for user service database\\n\\tdbCfg := config.DatabaseConfig{\\n\\t\\tHost:     config.GetEnv(\\"USER_DB_HOST\\", \\"localhost\\"),\\n\\t\\tPort:     config.GetEnvInt(\\"USER_DB_PORT\\", 5432),\\n\\t\\tUser:     config.GetEnv(\\"USER_DB_USER\\", \\"rinder\\"),\\n\\t\\tPassword: config.GetEnv(\\"USER_DB_PASSWORD\\", \\"rinder123\\"),\\n\\t\\tDatabase: config.GetEnv(\\"USER_DB_NAME\\", \\"rinder_users\\"),\\n\\t\\tSSLMode:  config.GetEnv(\\"USER_DB_SSLMODE\\", \\"disable\\"),\\n\\t}\\n\\tkafkaCfg := config.NewKafkaConfig(\\"user-service\\")\\n\\tjwtCfg := config.NewJWTConfig()\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting user service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t)\\n\\n\\t// Connect to database\\n\\tdsn := fmt.Sprintf(\\"host=%s port=%d user=%s password=%s dbname=%s sslmode=%s\\",\\n\\t\\tdbCfg.Host, dbCfg.Port, dbCfg.User, dbCfg.Password, dbCfg.Database, dbCfg.SSLMode)\\n\\n\\tdb, err := sql.Open(\\"postgres\\", dsn)\\n\\tif err != nil {\\n\\t\\tlogger.Fatal(\\"failed to connect to database\\", zap.Error(err))\\n\\t}\\n\\tdefer db.Close()\\n\\n\\t// Configure connection pool\\n\\tdb.SetMaxOpenConns(25)\\n\\tdb.SetMaxIdleConns(25)\\n\\tdb.SetConnMaxLifetime(5 * time.Minute)\\n\\n\\t// Test connection\\n\\tif err := db.Ping(); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to ping database\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"connected to database\\")\\n\\n\\t// Run migrations\\n\\tif err := runMigrations(db); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to run migrations\\", zap.Error(err))\\n\\t}\\n\\n\\t// Initialize Kafka producer\\n\\tproducer := kafka.NewProducer(kafkaCfg.Brokers, cfg.Name)\\n\\tdefer producer.Close()\\n\\n\\t// Initialize repository\\n\\tuserRepo := repository.NewUserRepository(db)\\n\\n\\t// Initialize JWT auth\\n\\tjwtAuth := middleware.NewJWTAuth(jwtCfg.Secret)\\n\\n\\t// Initialize service\\n\\tuserService := service.NewUserService(userRepo, producer, jwtAuth, jwtCfg)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(userService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware (CORS is handled by the gateway)\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  15 * time.Second,\\n\\t\\tWriteTimeout: 15 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"user service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt signal\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Graceful shutdown\\n\\tctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer cancel()\\n\\n\\tif err := server.Shutdown(ctx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server exited properly\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/cmd/main.go:24:1","name":"ROOT","node_type":"function"},{"code":"func runMigrations(db *sql.DB) error {\\n\\tmigrations := []string{\\n\\t\\t`CREATE TABLE IF NOT EXISTS users (\\n\\t\\t\\tid UUID PRIMARY KEY,\\n\\t\\t\\temail VARCHAR(255) UNIQUE NOT NULL,\\n\\t\\t\\tpassword_hash VARCHAR(255) NOT NULL,\\n\\t\\t\\tfirst_name VARCHAR(100),\\n\\t\\t\\tlast_name VARCHAR(100),\\n\\t\\t\\tstatus VARCHAR(20) DEFAULT \'active\',\\n\\t\\t\\tcreated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\\n\\t\\t\\tupdated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\\n\\t\\t)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_users_email ON users(email)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_users_status ON users(status)`,\\n\\t}\\n\\n\\tfor _, migration := range migrations {\\n\\t\\tif _, err := db.Exec(migration); err != nil {\\n\\t\\t\\treturn err\\n\\t\\t}\\n\\t}\\n\\n\\tlogger.Info(\\"database migrations completed\\")\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/cmd/main.go:132:6","name":"runMigrations","node_type":"function"},{"code":"func NewUserRepository(db *sql.DB) *UserRepository {\\n\\treturn &UserRepository{db: db}\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:18:6","name":"NewUserRepository","node_type":"function"},{"code":"func NewUserService(\\n\\trepo *repository.UserRepository,\\n\\tproducer *kafka.Producer,\\n\\tjwtAuth *middleware.JWTAuth,\\n\\tjwtCfg config.JWTConfig,\\n) *UserService {\\n\\treturn &UserService{\\n\\t\\trepo:     repo,\\n\\t\\tproducer: producer,\\n\\t\\tjwtAuth:  jwtAuth,\\n\\t\\tjwtCfg:   jwtCfg,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:30:6","name":"NewUserService","node_type":"function"},{"code":"func NewHandler(userService *service.UserService) *Handler {\\n\\treturn &Handler{\\n\\t\\tuserService: userService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:19:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\t// Health check\\n\\tmux.HandleFunc(\\"/health\\", h.healthCheck)\\n\\n\\t// Auth routes\\n\\tmux.HandleFunc(\\"/api/v1/auth/signup\\", h.signup)\\n\\tmux.HandleFunc(\\"/api/v1/auth/login\\", h.login)\\n\\tmux.HandleFunc(\\"/api/v1/auth/refresh\\", h.refresh)\\n\\n\\t// User routes (these expect X-User-ID header from gateway)\\n\\tmux.HandleFunc(\\"/api/v1/users/me\\", h.me)\\n\\tmux.HandleFunc(\\"/api/v1/users/\\", h.userByID)\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) healthCheck(w http.ResponseWriter, r *http.Request) {\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tw.Write([]byte(`{\\"status\\":\\"healthy\\",\\"service\\":\\"user\\"}`))\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:40:19","name":"healthCheck","node_type":"function"},{"code":"func (h *Handler) signup(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.SignupRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tresult, err := h.userService.Signup(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.Created(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","name":"signup","node_type":"function"},{"code":"func (s *UserService) Signup(ctx context.Context, req *model.SignupRequest) (*model.AuthResponse, error) {\\n\\t// Validate request\\n\\tif err := s.validateSignupRequest(req); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Check if user exists\\n\\texists, err := s.repo.ExistsByEmail(ctx, req.Email)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\tif exists {\\n\\t\\treturn nil, errors.UserExists()\\n\\t}\\n\\n\\t// Hash password\\n\\thashedPassword, err := bcrypt.GenerateFromPassword([]byte(req.Password), bcrypt.DefaultCost)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to hash password\\", 500)\\n\\t}\\n\\n\\t// Create user\\n\\tnow := time.Now()\\n\\tuser := &model.User{\\n\\t\\tID:           uuid.New().String(),\\n\\t\\tEmail:        req.Email,\\n\\t\\tPasswordHash: string(hashedPassword),\\n\\t\\tFirstName:    req.FirstName,\\n\\t\\tLastName:     req.LastName,\\n\\t\\tStatus:       model.UserStatusActive,\\n\\t\\tCreatedAt:    now,\\n\\t\\tUpdatedAt:    now,\\n\\t}\\n\\n\\tif err := s.repo.Create(ctx, user); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Generate tokens\\n\\taccessToken, err := s.jwtAuth.GenerateAccessToken(user.ID, user.Email, s.jwtCfg.AccessTokenTTL)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to generate access token\\", 500)\\n\\t}\\n\\n\\trefreshToken, err := s.jwtAuth.GenerateRefreshToken(user.ID, user.Email, s.jwtCfg.RefreshTokenTTL)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to generate refresh token\\", 500)\\n\\t}\\n\\n\\t// Publish user created event\\n\\tevent := model.UserCreatedEvent{\\n\\t\\tUserID:    user.ID,\\n\\t\\tEmail:     user.Email,\\n\\t\\tFirstName: user.FirstName,\\n\\t\\tLastName:  user.LastName,\\n\\t\\tCreatedAt: user.CreatedAt,\\n\\t}\\n\\tif err := s.producer.PublishWithKey(ctx, kafka.TopicUserCreated, user.ID, kafka.EventUserCreated, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish user created event\\", zap.Error(err))\\n\\t\\t// Don\'t fail the request, just log the error\\n\\t}\\n\\n\\treturn &model.AuthResponse{\\n\\t\\tAccessToken:  accessToken,\\n\\t\\tRefreshToken: refreshToken,\\n\\t\\tExpiresIn:    int64(s.jwtCfg.AccessTokenTTL.Seconds()),\\n\\t\\tUser:         user,\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","name":"Signup","node_type":"function"},{"code":"func (s *UserService) validateSignupRequest(req *model.SignupRequest) error {\\n\\t// Validate email\\n\\tif req.Email == \\"\\" {\\n\\t\\treturn errors.ValidationError(\\"email is required\\")\\n\\t}\\n\\tif _, err := mail.ParseAddress(req.Email); err != nil {\\n\\t\\treturn errors.ValidationError(\\"invalid email format\\")\\n\\t}\\n\\n\\t// Validate password\\n\\tif req.Password == \\"\\" {\\n\\t\\treturn errors.ValidationError(\\"password is required\\")\\n\\t}\\n\\tif len(req.Password) < 8 {\\n\\t\\treturn errors.ValidationError(\\"password must be at least 8 characters\\")\\n\\t}\\n\\tif !hasUpperCase(req.Password) {\\n\\t\\treturn errors.ValidationError(\\"password must contain at least one uppercase letter\\")\\n\\t}\\n\\tif !hasLowerCase(req.Password) {\\n\\t\\treturn errors.ValidationError(\\"password must contain at least one lowercase letter\\")\\n\\t}\\n\\tif !hasDigit(req.Password) {\\n\\t\\treturn errors.ValidationError(\\"password must contain at least one digit\\")\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:239:23","name":"validateSignupRequest","node_type":"function"},{"code":"func hasUpperCase(s string) bool {\\n\\tfor _, r := range s {\\n\\t\\tif unicode.IsUpper(r) {\\n\\t\\t\\treturn true\\n\\t\\t}\\n\\t}\\n\\treturn false\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:268:6","name":"hasUpperCase","node_type":"function"},{"code":"func hasLowerCase(s string) bool {\\n\\tfor _, r := range s {\\n\\t\\tif unicode.IsLower(r) {\\n\\t\\t\\treturn true\\n\\t\\t}\\n\\t}\\n\\treturn false\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:277:6","name":"hasLowerCase","node_type":"function"},{"code":"func hasDigit(s string) bool {\\n\\tfor _, r := range s {\\n\\t\\tif unicode.IsDigit(r) {\\n\\t\\t\\treturn true\\n\\t\\t}\\n\\t}\\n\\treturn false\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:286:6","name":"hasDigit","node_type":"function"},{"code":"func (r *UserRepository) ExistsByEmail(ctx context.Context, email string) (bool, error) {\\n\\tquery := `SELECT EXISTS(SELECT 1 FROM users WHERE email = $1)`\\n\\n\\tvar exists bool\\n\\terr := r.db.QueryRowContext(ctx, query, email).Scan(&exists)\\n\\tif err != nil {\\n\\t\\treturn false, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to check user existence\\", 500)\\n\\t}\\n\\n\\treturn exists, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:164:26","name":"ExistsByEmail","node_type":"function"},{"code":"func (r *UserRepository) Create(ctx context.Context, user *model.User) error {\\n\\tquery := `\\n\\t\\tINSERT INTO users (id, email, password_hash, first_name, last_name, status, created_at, updated_at)\\n\\t\\tVALUES ($1, $2, $3, $4, $5, $6, $7, $8)\\n\\t`\\n\\n\\t_, err := r.db.ExecContext(ctx, query,\\n\\t\\tuser.ID,\\n\\t\\tuser.Email,\\n\\t\\tuser.PasswordHash,\\n\\t\\tuser.FirstName,\\n\\t\\tuser.LastName,\\n\\t\\tuser.Status,\\n\\t\\tuser.CreatedAt,\\n\\t\\tuser.UpdatedAt,\\n\\t)\\n\\n\\tif err != nil {\\n\\t\\tif isUniqueViolation(err) {\\n\\t\\t\\treturn errors.UserExists()\\n\\t\\t}\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to create user\\", 500)\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:23:26","name":"Create","node_type":"function"},{"code":"func isUniqueViolation(err error) bool {\\n\\t// PostgreSQL unique violation error code is 23505\\n\\treturn err != nil && (contains(err.Error(), \\"unique\\") || contains(err.Error(), \\"23505\\"))\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:177:6","name":"isUniqueViolation","node_type":"function"},{"code":"func contains(s, substr string) bool {\\n\\treturn len(s) >= len(substr) && (s == substr || len(s) > 0 && containsRune(s, substr))\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","name":"contains","node_type":"function"},{"code":"func containsRune(s, substr string) bool {\\n\\tfor i := 0; i <= len(s)-len(substr); i++ {\\n\\t\\tif s[i:i+len(substr)] == substr {\\n\\t\\t\\treturn true\\n\\t\\t}\\n\\t}\\n\\treturn false\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:186:6","name":"containsRune","node_type":"function"},{"code":"func (h *Handler) login(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.LoginRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tresult, err := h.userService.Login(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","name":"login","node_type":"function"},{"code":"func (s *UserService) Login(ctx context.Context, req *model.LoginRequest) (*model.AuthResponse, error) {\\n\\t// Validate request\\n\\tif req.Email == \\"\\" || req.Password == \\"\\" {\\n\\t\\treturn nil, errors.ValidationError(\\"email and password are required\\")\\n\\t}\\n\\n\\t// Get user by email\\n\\tuser, err := s.repo.GetByEmail(ctx, req.Email)\\n\\tif err != nil {\\n\\t\\tif appErr, ok := err.(*errors.AppError); ok && appErr.Code == errors.CodeNotFound {\\n\\t\\t\\treturn nil, errors.InvalidCredentials()\\n\\t\\t}\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Check password\\n\\tif err := bcrypt.CompareHashAndPassword([]byte(user.PasswordHash), []byte(req.Password)); err != nil {\\n\\t\\treturn nil, errors.InvalidCredentials()\\n\\t}\\n\\n\\t// Check user status\\n\\tif user.Status != model.UserStatusActive {\\n\\t\\treturn nil, errors.Forbidden(\\"user account is not active\\")\\n\\t}\\n\\n\\t// Generate tokens\\n\\taccessToken, err := s.jwtAuth.GenerateAccessToken(user.ID, user.Email, s.jwtCfg.AccessTokenTTL)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to generate access token\\", 500)\\n\\t}\\n\\n\\trefreshToken, err := s.jwtAuth.GenerateRefreshToken(user.ID, user.Email, s.jwtCfg.RefreshTokenTTL)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to generate refresh token\\", 500)\\n\\t}\\n\\n\\treturn &model.AuthResponse{\\n\\t\\tAccessToken:  accessToken,\\n\\t\\tRefreshToken: refreshToken,\\n\\t\\tExpiresIn:    int64(s.jwtCfg.AccessTokenTTL.Seconds()),\\n\\t\\tUser:         user,\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:116:23","name":"Login","node_type":"function"},{"code":"func (r *UserRepository) GetByEmail(ctx context.Context, email string) (*model.User, error) {\\n\\tquery := `\\n\\t\\tSELECT id, email, password_hash, first_name, last_name, status, created_at, updated_at\\n\\t\\tFROM users\\n\\t\\tWHERE email = $1\\n\\t`\\n\\n\\tuser := &model.User{}\\n\\terr := r.db.QueryRowContext(ctx, query, email).Scan(\\n\\t\\t&user.ID,\\n\\t\\t&user.Email,\\n\\t\\t&user.PasswordHash,\\n\\t\\t&user.FirstName,\\n\\t\\t&user.LastName,\\n\\t\\t&user.Status,\\n\\t\\t&user.CreatedAt,\\n\\t\\t&user.UpdatedAt,\\n\\t)\\n\\n\\tif err == sql.ErrNoRows {\\n\\t\\treturn nil, errors.NotFound(\\"user not found\\")\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get user\\", 500)\\n\\t}\\n\\n\\treturn user, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:81:26","name":"GetByEmail","node_type":"function"},{"code":"func (h *Handler) refresh(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.RefreshRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tresult, err := h.userService.RefreshToken(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","name":"refresh","node_type":"function"},{"code":"func (s *UserService) RefreshToken(ctx context.Context, req *model.RefreshRequest) (*model.RefreshResponse, error) {\\n\\tif req.RefreshToken == \\"\\" {\\n\\t\\treturn nil, errors.ValidationError(\\"refresh token is required\\")\\n\\t}\\n\\n\\t// Validate refresh token\\n\\tclaims, err := s.jwtAuth.ValidateToken(req.RefreshToken)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Check if user still exists and is active\\n\\tuser, err := s.repo.GetByID(ctx, claims.UserID)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tif user.Status != model.UserStatusActive {\\n\\t\\treturn nil, errors.Forbidden(\\"user account is not active\\")\\n\\t}\\n\\n\\t// Generate new tokens\\n\\taccessToken, err := s.jwtAuth.GenerateAccessToken(user.ID, user.Email, s.jwtCfg.AccessTokenTTL)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to generate access token\\", 500)\\n\\t}\\n\\n\\trefreshToken, err := s.jwtAuth.GenerateRefreshToken(user.ID, user.Email, s.jwtCfg.RefreshTokenTTL)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to generate refresh token\\", 500)\\n\\t}\\n\\n\\treturn &model.RefreshResponse{\\n\\t\\tAccessToken:  accessToken,\\n\\t\\tRefreshToken: refreshToken,\\n\\t\\tExpiresIn:    int64(s.jwtCfg.AccessTokenTTL.Seconds()),\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:161:23","name":"RefreshToken","node_type":"function"},{"code":"func (r *UserRepository) GetByID(ctx context.Context, id string) (*model.User, error) {\\n\\tquery := `\\n\\t\\tSELECT id, email, password_hash, first_name, last_name, status, created_at, updated_at\\n\\t\\tFROM users\\n\\t\\tWHERE id = $1\\n\\t`\\n\\n\\tuser := &model.User{}\\n\\terr := r.db.QueryRowContext(ctx, query, id).Scan(\\n\\t\\t&user.ID,\\n\\t\\t&user.Email,\\n\\t\\t&user.PasswordHash,\\n\\t\\t&user.FirstName,\\n\\t\\t&user.LastName,\\n\\t\\t&user.Status,\\n\\t\\t&user.CreatedAt,\\n\\t\\t&user.UpdatedAt,\\n\\t)\\n\\n\\tif err == sql.ErrNoRows {\\n\\t\\treturn nil, errors.NotFound(\\"user not found\\")\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get user\\", 500)\\n\\t}\\n\\n\\treturn user, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","name":"GetByID","node_type":"function"},{"code":"func (h *Handler) me(w http.ResponseWriter, r *http.Request) {\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, &unauthorizedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\tuser, err := h.userService.GetUser(r.Context(), userID)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, user)\\n\\n\\tcase http.MethodPut:\\n\\t\\tvar req model.UpdateUserRequest\\n\\t\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tuser, err := h.userService.UpdateUser(r.Context(), userID, &req)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, user)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","name":"me","node_type":"function"},{"code":"func (s *UserService) GetUser(ctx context.Context, id string) (*model.User, error) {\\n\\treturn s.repo.GetByID(ctx, id)\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:201:23","name":"GetUser","node_type":"function"},{"code":"func (s *UserService) UpdateUser(ctx context.Context, id string, req *model.UpdateUserRequest) (*model.User, error) {\\n\\tuser, err := s.repo.GetByID(ctx, id)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tif req.FirstName != \\"\\" {\\n\\t\\tuser.FirstName = req.FirstName\\n\\t}\\n\\tif req.LastName != \\"\\" {\\n\\t\\tuser.LastName = req.LastName\\n\\t}\\n\\n\\tif err := s.repo.Update(ctx, user); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Publish user updated event\\n\\tevent := model.UserUpdatedEvent{\\n\\t\\tUserID:    user.ID,\\n\\t\\tEmail:     user.Email,\\n\\t\\tFirstName: user.FirstName,\\n\\t\\tLastName:  user.LastName,\\n\\t\\tUpdatedAt: user.UpdatedAt,\\n\\t}\\n\\tif err := s.producer.PublishWithKey(ctx, kafka.TopicUserUpdated, user.ID, kafka.EventUserUpdated, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish user updated event\\", zap.Error(err))\\n\\t}\\n\\n\\treturn user, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","name":"UpdateUser","node_type":"function"},{"code":"func (r *UserRepository) Update(ctx context.Context, user *model.User) error {\\n\\tquery := `\\n\\t\\tUPDATE users\\n\\t\\tSET first_name = $1, last_name = $2, updated_at = $3\\n\\t\\tWHERE id = $4\\n\\t`\\n\\n\\tuser.UpdatedAt = time.Now()\\n\\tresult, err := r.db.ExecContext(ctx, query,\\n\\t\\tuser.FirstName,\\n\\t\\tuser.LastName,\\n\\t\\tuser.UpdatedAt,\\n\\t\\tuser.ID,\\n\\t)\\n\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to update user\\", 500)\\n\\t}\\n\\n\\trowsAffected, err := result.RowsAffected()\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get rows affected\\", 500)\\n\\t}\\n\\n\\tif rowsAffected == 0 {\\n\\t\\treturn errors.NotFound(\\"user not found\\")\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:111:26","name":"Update","node_type":"function"},{"code":"func (h *Handler) userByID(w http.ResponseWriter, r *http.Request) {\\n\\t// Extract user ID from path /api/v1/users/{id}\\n\\tpath := strings.TrimPrefix(r.URL.Path, \\"/api/v1/users/\\")\\n\\tuserID := strings.TrimSuffix(path, \\"/\\")\\n\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"user ID is required\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\tuser, err := h.userService.GetUser(r.Context(), userID)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, user)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","name":"userByID","node_type":"function"}]'),qe=JSON.parse('[{"column":11,"line":67,"source":"/home/evan/Code/rinder/services/user/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/user/cmd/main.go:132:6","val":1},{"column":24,"line":76,"source":"/home/evan/Code/rinder/services/user/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:18:6","val":1},{"column":24,"line":82,"source":"/home/evan/Code/rinder/services/user/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:30:6","val":1},{"column":14,"line":85,"source":"/home/evan/Code/rinder/services/user/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:19:6","val":1},{"column":3,"line":89,"source":"/home/evan/Code/rinder/services/user/cmd/main.go:24:1","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","val":1},{"column":29,"line":27,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:40:19","val":1},{"column":41,"line":30,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","val":1},{"column":17,"line":47,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","val":1},{"column":17,"line":53,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","val":1},{"column":30,"line":57,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","val":1},{"column":13,"line":46,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:239:23","val":1},{"column":5,"line":254,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:239:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:268:6","val":1},{"column":5,"line":257,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:239:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:277:6","val":1},{"column":5,"line":260,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:239:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:286:6","val":1},{"column":35,"line":46,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","val":1},{"column":23,"line":51,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:164:26","val":1},{"column":29,"line":167,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:164:26","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:164:26","val":1},{"column":41,"line":167,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:164:26","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:164:26","val":1},{"column":37,"line":51,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","val":1},{"column":18,"line":78,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:23:26","val":1},{"column":28,"line":28,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:23:26","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:23:26","val":1},{"column":5,"line":40,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:23:26","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:177:6","val":1},{"column":23,"line":178,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:177:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","val":1},{"column":12,"line":182,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","val":1},{"column":22,"line":182,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","val":1},{"column":53,"line":182,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","val":1},{"column":63,"line":182,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:186:6","val":1},{"column":22,"line":186,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:186:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:186:6","val":1},{"column":29,"line":186,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:186:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:186:6","val":1},{"column":15,"line":187,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:186:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:186:6","val":1},{"column":76,"line":182,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","val":1},{"column":79,"line":182,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","val":1},{"column":58,"line":178,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:177:6","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6","val":1},{"column":25,"line":78,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","val":1},{"column":37,"line":101,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23","val":1},{"column":17,"line":59,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","val":1},{"column":18,"line":63,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19","val":1},{"column":40,"line":31,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","val":1},{"column":17,"line":68,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","val":1},{"column":17,"line":74,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","val":1},{"column":30,"line":78,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:116:23","val":1},{"column":21,"line":122,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:116:23","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:81:26","val":1},{"column":29,"line":88,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:81:26","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:81:26","val":1},{"column":41,"line":88,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:81:26","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:81:26","val":1},{"column":32,"line":122,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:116:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:116:23","val":1},{"column":17,"line":80,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","val":1},{"column":13,"line":84,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19","val":1},{"column":42,"line":32,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","val":1},{"column":17,"line":89,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","val":1},{"column":17,"line":95,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","val":1},{"column":30,"line":99,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:161:23","val":1},{"column":21,"line":172,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:161:23","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","val":1},{"column":29,"line":58,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","val":1},{"column":41,"line":58,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","val":1},{"column":29,"line":172,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:161:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:161:23","val":1},{"column":17,"line":101,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","val":1},{"column":13,"line":105,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19","val":1},{"column":38,"line":35,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","val":1},{"column":17,"line":111,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","val":1},{"column":29,"line":117,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:201:23","val":1},{"column":15,"line":201,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:201:23","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","val":1},{"column":23,"line":201,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:201:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:201:23","val":1},{"column":28,"line":201,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:201:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:201:23","val":1},{"column":18,"line":119,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","val":1},{"column":14,"line":122,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","val":1},{"column":18,"line":127,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","val":1},{"column":29,"line":131,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","val":1},{"column":21,"line":206,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26","val":1},{"column":29,"line":206,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","val":1},{"column":34,"line":206,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","val":1},{"column":18,"line":218,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:111:26","val":1},{"column":33,"line":118,"source":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:111:26","target":"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:111:26","val":1},{"column":25,"line":218,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","val":1},{"column":37,"line":230,"source":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23","val":1},{"column":18,"line":133,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","val":1},{"column":14,"line":136,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","val":1},{"column":17,"line":139,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19","val":1},{"column":36,"line":36,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","val":1},{"column":17,"line":149,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","val":1},{"column":29,"line":155,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","target":"/home/evan/Code/rinder/services/user/internal/service/user_service.go:201:23","val":1},{"column":18,"line":157,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","val":1},{"column":14,"line":160,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","val":1},{"column":17,"line":163,"source":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","target":"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19","val":1}]'),Br={nodes:He,links:qe},Lr=Object.freeze(Object.defineProperty({__proto__:null,default:Br,links:qe,nodes:He},Symbol.toStringTag,{value:"Module"})),zr=[{id:"/home/evan/Code/rinder/services/user/cmd/main.go:24:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/cmd/main.go:132:6",name:"runMigrations",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:18:6",name:"NewUserRepository",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/service/user_service.go:30:6",name:"NewUserService",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/handler/handler.go:19:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/handler/handler.go:26:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/handler/handler.go:40:19",name:"healthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/handler/handler.go:46:19",name:"signup",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/service/user_service.go:45:23",name:"Signup",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/service/user_service.go:239:23",name:"validateSignupRequest",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/service/user_service.go:268:6",name:"hasUpperCase",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/service/user_service.go:277:6",name:"hasLowerCase",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/service/user_service.go:286:6",name:"hasDigit",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:164:26",name:"ExistsByEmail",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:23:26",name:"Create",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:177:6",name:"isUniqueViolation",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:182:6",name:"contains",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:186:6",name:"containsRune",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/handler/handler.go:67:19",name:"login",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/service/user_service.go:116:23",name:"Login",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:81:26",name:"GetByEmail",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/handler/handler.go:88:19",name:"refresh",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/service/user_service.go:161:23",name:"RefreshToken",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:51:26",name:"GetByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/handler/handler.go:109:19",name:"me",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/service/user_service.go:201:23",name:"GetUser",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/service/user_service.go:206:23",name:"UpdateUser",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/repository/user_repository.go:111:26",name:"Update",node_type:"function"},{id:"/home/evan/Code/rinder/services/user/internal/handler/handler.go:144:19",name:"userByID",node_type:"function"}],Wr=Object.freeze(Object.defineProperty({__proto__:null,default:zr},Symbol.toStringTag,{value:"Module"})),ke=17,Ue="service-subscription",Me="/home/evan/Code/rinder/services/subscription",Oe="cmd/main.go",Ae="main",Ze="github.com/rinder",Ge=null,Be="2026-01-30T09:38:59.919701614Z",Le="2026-01-30T09:39:02.267044298Z",ze="analyzing-completed",We=JSON.parse(`[{"id":233,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:40:19","outputs":[{"id":1420,"handler_id":233,"type":"http_response","label":"HTTP 200 JSON response","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:40:19","function_name":"healthCheck","description":"Sends an HTTP 200 response to the client with Content-Type: application/json and body '{\\"status\\":\\"healthy\\",\\"service\\":\\"subscription\\"}'.","created_at":"2026-01-30T09:39:53.196034554Z","updated_at":null}],"created_at":"2026-01-30T09:39:41.810061505Z","updated_at":null},{"id":234,"type":"http","method":"GET","path":"/api/v1/plans","source_function_name":"RegisterRoutes","function_name":"listPlans","source_function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19","outputs":[{"id":1424,"handler_id":234,"type":"http_response","label":"HTTP 200 OK response with list of plans","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19","function_name":"listPlans","description":"When the request method is GET, the handler returns an HTTP 200 response containing the static list of subscription plans produced by subscriptionService.GetPlans() (the plans are written to the response by response.OK).","created_at":"2026-01-30T09:40:13.346414152Z","updated_at":null},{"id":1425,"handler_id":234,"type":"http_response","label":"HTTP error response (method not allowed)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19","function_name":"listPlans","description":"When the request method is not GET, the handler returns an error response indicating the method is not allowed (via response.Error and methodNotAllowedError).","created_at":"2026-01-30T09:40:13.363435463Z","updated_at":null}],"created_at":"2026-01-30T09:39:41.827191902Z","updated_at":null},{"id":235,"type":"http","method":"GET","path":"/api/v1/plans/","source_function_name":"RegisterRoutes","function_name":"planByID","source_function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","outputs":[{"id":1423,"handler_id":235,"type":"http_response","label":"HTTP 200 JSON response with plan details","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","function_name":"planByID","description":"When a plan with the requested ID exists, the handler sets Content-Type: application/json, writes HTTP 200 status, and writes the JSON-encoded plan details (the byte slice returned by subscriptionService.GetPlanDetails) to the client.","created_at":"2026-01-30T09:40:05.224626597Z","updated_at":null},{"id":1421,"handler_id":235,"type":"http_response","label":"HTTP 405 Method Not Allowed response","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","function_name":"planByID","description":"If the incoming request method is not GET, the handler returns a method-not-allowed error response to the client via response.Error (i.e. an HTTP error response is written and the request handling terminates).","created_at":"2026-01-30T09:40:05.209602307Z","updated_at":null},{"id":1422,"handler_id":235,"type":"http_response","label":"HTTP error response for plan not found (e.g. 404)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","function_name":"planByID","description":"If subscriptionService.GetPlanDetails(planID) returns a not-found error, the handler calls response.Error to send an error response to the client (an HTTP error response indicating the plan was not found).","created_at":"2026-01-30T09:40:05.221137363Z","updated_at":null}],"created_at":"2026-01-30T09:39:41.829653823Z","updated_at":null},{"id":238,"type":"http","method":"GET","path":"/api/v1/subscriptions/me","source_function_name":"RegisterRoutes","function_name":"mySubscription","source_function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","outputs":[{"id":1428,"handler_id":238,"type":"database","label":"SELECT id, user_id, plan, status, payment_provider, external_id, current_period_start, current_period_end, cancelled_at, created_at, updated_at FROM subscriptions WHERE user_id = $1","function_id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34","function_name":"GetByUserID","description":"On a GET request with X-User-ID present, the repository executes a QueryRowContext against the database to select the subscription row for the given user_id. This query is performed irrespective of whether the row exists; QueryRowContext may return sql.ErrNoRows (mapped to a NotFound error) or another error (mapped to an internal error).","created_at":"2026-01-30T09:40:17.855122541Z","updated_at":null},{"id":1429,"handler_id":238,"type":"http_response","label":"HTTP 200 response with subscription payload","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","function_name":"mySubscription","description":"If the database query successfully returns a subscription row, the handler responds to the client with an OK response containing the subscription object (response.OK called with the subscription). This is the successful GET response path.","created_at":"2026-01-30T09:40:17.857002252Z","updated_at":null},{"id":1431,"handler_id":238,"type":"http_response","label":"HTTP error response: internal server error from database","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","function_name":"mySubscription","description":"If the database QueryRowContext or Scan returns an error other than sql.ErrNoRows, the repository wraps it as an internal server error and returns it. The handler then returns an HTTP error response to the client via response.Error (i.e., an internal server error response).","created_at":"2026-01-30T09:40:17.859710584Z","updated_at":null},{"id":1427,"handler_id":238,"type":"http_response","label":"HTTP error response: method not allowed","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","function_name":"mySubscription","description":"If the incoming request method is not GET, the handler returns an HTTP error response indicating the method is not allowed (response.Error called with methodNotAllowedError). No database query or other external calls are made in this path.","created_at":"2026-01-30T09:40:17.853759065Z","updated_at":null},{"id":1430,"handler_id":238,"type":"http_response","label":"HTTP error response: subscription not found","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","function_name":"mySubscription","description":"If the database QueryRowContext returns sql.ErrNoRows, the repository returns a NotFound error (\\"subscription not found\\"). The handler receives this error and returns an HTTP error response to the client via response.Error (i.e., a not-found error response).","created_at":"2026-01-30T09:40:17.858392337Z","updated_at":null},{"id":1426,"handler_id":238,"type":"http_response","label":"HTTP error response: unauthorized (missing X-User-ID)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","function_name":"mySubscription","description":"If the incoming request does not include the X-User-ID header, the handler returns an HTTP error response indicating the request is unauthorized (response.Error called with unauthorizedError). No database query or other external calls are made in this path.","created_at":"2026-01-30T09:40:17.852049194Z","updated_at":null}],"created_at":"2026-01-30T09:39:41.83439693Z","updated_at":null},{"id":237,"type":"http","method":"GET,PUT,POST","path":"/api/v1/subscriptions/","source_function_name":"RegisterRoutes","function_name":"handleSubscriptionByID","source_function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","outputs":[{"id":1435,"handler_id":237,"type":"database","label":"SELECT FROM subscriptions WHERE id = $1","function_id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34","function_name":"GetByID","description":"Retrieve a subscription by its ID from the subscriptions table (used by GetSubscription and by Update/Cancel flows to fetch existing subscription).","created_at":"2026-01-30T09:40:38.758305924Z","updated_at":null},{"id":1444,"handler_id":237,"type":"database","label":"SELECT FROM subscriptions WHERE id = $1 (cancel flow)","function_id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34","function_name":"GetByID","description":"Cancel flow fetches the subscription by id before applying cancellation (same SELECT used by cancel path).","created_at":"2026-01-30T09:40:38.766831522Z","updated_at":null},{"id":1441,"handler_id":237,"type":"database","label":"SELECT FROM subscriptions WHERE user_id = $1","function_id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34","function_name":"GetByUserID","description":"Retrieve a subscription by user_id from the subscriptions table (used by the /me GET flow).","created_at":"2026-01-30T09:40:38.764026333Z","updated_at":null},{"id":1437,"handler_id":237,"type":"database","label":"UPDATE subscriptions SET ... WHERE id = $1","function_id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","function_name":"Update","description":"Persist subscription updates (plan/status/payment_provider/external_id/current_period_start/current_period_end/cancelled_at/updated_at) to the subscriptions table when UpdateSubscription or CancelSubscription changes a subscription.","created_at":"2026-01-30T09:40:38.760317729Z","updated_at":null},{"id":1445,"handler_id":237,"type":"database","label":"UPDATE subscriptions SET ... WHERE id = $1 (cancel flow)","function_id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","function_name":"Update","description":"When a subscription is cancelled, the repository updates the subscription row (status -> cancelled, cancelled_at set, updated_at updated) in the database.","created_at":"2026-01-30T09:40:38.768166428Z","updated_at":null},{"id":1447,"handler_id":237,"type":"event","label":"Publish notification.send event to notification topic (kafka.TopicNotificationSend, event type \\"notification.send\\")","function_id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","function_name":"sendNotification","description":"On cancellation, a notification request (NotificationRequest) is published to the notification topic with the user ID as the key and event type \\"notification.send\\". The publish call is performed inside sendNotification.","created_at":"2026-01-30T09:40:38.770319727Z","updated_at":null},{"id":1446,"handler_id":237,"type":"event","label":"Publish subscription.cancelled event (kafka.TopicSubscriptionCancelled / kafka.EventSubscriptionCancelled)","function_id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","function_name":"publishSubscriptionEvent","description":"When a subscription is cancelled, a SubscriptionCancelled event is published via the producer with the subscription ID as the key and an event payload (SubscriptionEvent). The publish call is performed by the publishSubscriptionEvent helper.","created_at":"2026-01-30T09:40:38.769217651Z","updated_at":null},{"id":1438,"handler_id":237,"type":"event","label":"Publish subscription.updated event (kafka.TopicSubscriptionUpdated / kafka.EventSubscriptionUpdated)","function_id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","function_name":"publishSubscriptionEvent","description":"When a subscription is updated via PUT, a SubscriptionUpdated event is published to the configured producer with the subscription ID as the key and an event payload (SubscriptionEvent). The publish call is performed by the publishSubscriptionEvent helper.","created_at":"2026-01-30T09:40:38.761292264Z","updated_at":null},{"id":1442,"handler_id":237,"type":"http_response","label":"HTTP 200 response (GET /api/v1/subscriptions/me)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","function_name":"mySubscription","description":"On successful GET to /api/v1/subscriptions/me the handler returns an HTTP 200 response with the subscription payload for the user.","created_at":"2026-01-30T09:40:38.76500894Z","updated_at":null},{"id":1436,"handler_id":237,"type":"http_response","label":"HTTP 200 response (GET subscription by ID)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","function_name":"handleSubscriptionByID","description":"On successful GET /api/v1/subscriptions/{id} the handler returns an HTTP 200 response with the subscription payload.","created_at":"2026-01-30T09:40:38.759317908Z","updated_at":null},{"id":1448,"handler_id":237,"type":"http_response","label":"HTTP 200 response (POST cancel subscription)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","function_name":"cancelSubscription","description":"On successful POST to cancel a subscription the handler returns an HTTP 200 response with the updated (cancelled) subscription payload.","created_at":"2026-01-30T09:40:38.771025962Z","updated_at":null},{"id":1439,"handler_id":237,"type":"http_response","label":"HTTP 200 response (PUT update subscription)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","function_name":"handleSubscriptionByID","description":"On successful PUT /api/v1/subscriptions/{id} (valid body and update applied) the handler returns an HTTP 200 response with the updated subscription payload.","created_at":"2026-01-30T09:40:38.762215995Z","updated_at":null},{"id":1434,"handler_id":237,"type":"http_response","label":"HTTP 400 response (bad request: invalid request body)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","function_name":"handleSubscriptionByID","description":"If a PUT request contains an invalid JSON body, the handler returns an HTTP 400 response to the client.","created_at":"2026-01-30T09:40:38.75699353Z","updated_at":null},{"id":1432,"handler_id":237,"type":"http_response","label":"HTTP 400 response (bad request: subscription ID is required)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","function_name":"handleSubscriptionByID","description":"If the path does not contain a subscription ID, the handler returns an HTTP 400 error response to the client.","created_at":"2026-01-30T09:40:38.74141584Z","updated_at":null},{"id":1440,"handler_id":237,"type":"http_response","label":"HTTP 401 response (unauthorized) - mySubscription","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","function_name":"mySubscription","description":"If the /api/v1/subscriptions/me handler is invoked and X-User-ID header is missing, returns an HTTP 401 response to the client.","created_at":"2026-01-30T09:40:38.763107966Z","updated_at":null},{"id":1443,"handler_id":237,"type":"http_response","label":"HTTP 405 response (method not allowed) - cancelSubscription","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","function_name":"cancelSubscription","description":"If the cancel endpoint is accessed with a non-POST method, the handler returns an HTTP 405 response to the client.","created_at":"2026-01-30T09:40:38.765931772Z","updated_at":null},{"id":1433,"handler_id":237,"type":"http_response","label":"HTTP 405 response (method not allowed) - handleSubscriptionByID","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","function_name":"handleSubscriptionByID","description":"If the request method is not GET or PUT for a subscription-by-id path, the handler returns an HTTP 405 response to the client.","created_at":"2026-01-30T09:40:38.753055472Z","updated_at":null}],"created_at":"2026-01-30T09:39:41.833169727Z","updated_at":null},{"id":236,"type":"http","method":"POST","path":"/api/v1/subscriptions","source_function_name":"RegisterRoutes","function_name":"handleSubscriptions","source_function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","outputs":[{"id":1456,"handler_id":236,"type":"database","label":"INSERT INTO subscriptions (...) VALUES (...)","function_id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:53:34","function_name":"Create","description":"An INSERT is executed to persist the new subscription record into the subscriptions table.","created_at":"2026-01-30T09:40:59.403020377Z","updated_at":null},{"id":1452,"handler_id":236,"type":"database","label":"SELECT FROM subscriptions WHERE user_id = $1","function_id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34","function_name":"GetByUserID","description":"A database SELECT is executed to look up an existing subscription for the given user ID (checks whether user already has a subscription).","created_at":"2026-01-30T09:40:59.395792358Z","updated_at":null},{"id":1457,"handler_id":236,"type":"event","label":"Publish subscription created event to Kafka (PublishWithKey)","function_id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","function_name":"publishSubscriptionEvent","description":"An asynchronous event is published (via the configured producer) with topic and event-type indicating a subscription was created. The call attempts to publish the subscription-created event keyed by subscription ID.","created_at":"2026-01-30T09:40:59.404793271Z","updated_at":null},{"id":1454,"handler_id":236,"type":"http","label":"HTTP POST /api/v1/payments/charge","function_id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:275:31","function_name":"processPayment","description":"An outbound HTTP request is made to the payment service endpoint to charge the initial subscription payment (paymentClient.Post).","created_at":"2026-01-30T09:40:59.39959072Z","updated_at":null},{"id":1458,"handler_id":236,"type":"http_response","label":"HTTP 201 Created response (subscription created)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","function_name":"createSubscription","description":"On successful creation (and successful payment if required), an HTTP 201 Created response is returned to the client with the created subscription payload.","created_at":"2026-01-30T09:40:59.406354511Z","updated_at":null},{"id":1451,"handler_id":236,"type":"http_response","label":"HTTP 400 Bad Request response (invalid request body)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","function_name":"createSubscription","description":"If the request body cannot be decoded as the expected CreateSubscriptionRequest JSON, an HTTP 400 Bad Request response is returned to the client.","created_at":"2026-01-30T09:40:59.393910239Z","updated_at":null},{"id":1450,"handler_id":236,"type":"http_response","label":"HTTP 401 Unauthorized response (missing X-User-ID)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","function_name":"createSubscription","description":"If the X-User-ID header is missing from the request, an HTTP unauthorized error response is returned to the client.","created_at":"2026-01-30T09:40:59.391759579Z","updated_at":null},{"id":1453,"handler_id":236,"type":"http_response","label":"HTTP error response (conflict: user already has a subscription)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","function_name":"createSubscription","description":"If the repository lookup finds an existing subscription for the user, the service returns a conflict error which is sent to the client as an HTTP error response.","created_at":"2026-01-30T09:40:59.397740543Z","updated_at":null},{"id":1459,"handler_id":236,"type":"http_response","label":"HTTP error response (generic service or repository error)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","function_name":"createSubscription","description":"If any other error occurs in CreateSubscription (for example repository Create failure, payment client network error, or unexpected service error), that error is returned and sent to the client as an HTTP error response.","created_at":"2026-01-30T09:40:59.407954761Z","updated_at":null},{"id":1449,"handler_id":236,"type":"http_response","label":"HTTP error response (method not allowed)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","function_name":"handleSubscriptions","description":"If the incoming request method is not POST, an HTTP error response is returned to the client indicating the method is not allowed.","created_at":"2026-01-30T09:40:59.375175307Z","updated_at":null},{"id":1455,"handler_id":236,"type":"http_response","label":"HTTP error response (payment failed or payment service error)","function_id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","function_name":"createSubscription","description":"If the payment request fails or the payment response indicates a failure, the service returns an error which is sent to the client as an HTTP error response.","created_at":"2026-01-30T09:40:59.40138666Z","updated_at":null}],"created_at":"2026-01-30T09:39:41.831682291Z","updated_at":null}]`),Fr={id:ke,name:Ue,git_repo_url:Me,entrypoint_path:Oe,entrypoint_function:Ae,git_org_url:Ze,git_commit:Ge,created_at:Be,updated_at:Le,status:ze,handlers:We},$r=Object.freeze(Object.defineProperty({__proto__:null,created_at:Be,default:Fr,entrypoint_function:Ae,entrypoint_path:Oe,git_commit:Ge,git_org_url:Ze,git_repo_url:Me,handlers:We,id:ke,name:Ue,status:ze,updated_at:Le},Symbol.toStringTag,{value:"Module"})),Fe=JSON.parse('[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"subscription\\", 8090)\\n\\tdbCfg := config.DatabaseConfig{\\n\\t\\tHost:     config.GetEnv(\\"SUBSCRIPTION_DB_HOST\\", \\"localhost\\"),\\n\\t\\tPort:     config.GetEnvInt(\\"SUBSCRIPTION_DB_PORT\\", 5438),\\n\\t\\tUser:     config.GetEnv(\\"SUBSCRIPTION_DB_USER\\", \\"rinder\\"),\\n\\t\\tPassword: config.GetEnv(\\"SUBSCRIPTION_DB_PASSWORD\\", \\"rinder123\\"),\\n\\t\\tDatabase: config.GetEnv(\\"SUBSCRIPTION_DB_NAME\\", \\"rinder_subscriptions\\"),\\n\\t\\tSSLMode:  config.GetEnv(\\"SUBSCRIPTION_DB_SSLMODE\\", \\"disable\\"),\\n\\t}\\n\\tkafkaCfg := config.NewKafkaConfig(\\"subscription-service\\")\\n\\n\\t// Payment gateway URL\\n\\tpaymentGatewayURL := config.GetEnv(\\"PAYMENT_GATEWAY_URL\\", \\"http://localhost:8091\\")\\n\\n\\t// Renewal check interval (default: 1 hour)\\n\\trenewalInterval := config.GetEnvDuration(\\"RENEWAL_CHECK_INTERVAL\\", 1*time.Hour)\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting subscription service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t)\\n\\n\\t// Connect to database\\n\\tdsn := fmt.Sprintf(\\"host=%s port=%d user=%s password=%s dbname=%s sslmode=%s\\",\\n\\t\\tdbCfg.Host, dbCfg.Port, dbCfg.User, dbCfg.Password, dbCfg.Database, dbCfg.SSLMode)\\n\\n\\tdb, err := sql.Open(\\"postgres\\", dsn)\\n\\tif err != nil {\\n\\t\\tlogger.Fatal(\\"failed to connect to database\\", zap.Error(err))\\n\\t}\\n\\tdefer db.Close()\\n\\n\\t// Configure connection pool\\n\\tdb.SetMaxOpenConns(25)\\n\\tdb.SetMaxIdleConns(25)\\n\\tdb.SetConnMaxLifetime(5 * time.Minute)\\n\\n\\t// Test connection\\n\\tif err := db.Ping(); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to ping database\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"connected to database\\")\\n\\n\\t// Initialize Kafka producer\\n\\tproducer := kafka.NewProducer(kafkaCfg.Brokers, cfg.Name)\\n\\tdefer producer.Close()\\n\\n\\t// Initialize repository\\n\\tsubscriptionRepo := repository.NewSubscriptionRepository(db)\\n\\n\\t// Run migrations\\n\\tif err := subscriptionRepo.CreateSchema(context.Background()); err != nil {\\n\\t\\tlogger.Fatal(\\"failed to run migrations\\", zap.Error(err))\\n\\t}\\n\\tlogger.Info(\\"database migrations completed\\")\\n\\n\\t// Initialize service\\n\\tsubscriptionService := service.NewSubscriptionService(subscriptionRepo, producer, paymentGatewayURL)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(subscriptionService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  15 * time.Second,\\n\\t\\tWriteTimeout: 15 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start renewal scheduler\\n\\trenewalScheduler := scheduler.NewRenewalScheduler(subscriptionService, renewalInterval)\\n\\tschedulerCtx, schedulerCancel := context.WithCancel(context.Background())\\n\\tgo renewalScheduler.Start(schedulerCtx)\\n\\n\\t// Start server\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"subscription service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt signal\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Stop scheduler\\n\\tschedulerCancel()\\n\\trenewalScheduler.Stop()\\n\\n\\t// Graceful shutdown\\n\\tctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer cancel()\\n\\n\\tif err := server.Shutdown(ctx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server exited properly\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/cmd/main.go:25:1","name":"ROOT","node_type":"function"},{"code":"func NewSubscriptionRepository(db *sql.DB) *SubscriptionRepository {\\n\\treturn &SubscriptionRepository{db: db}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:18:6","name":"NewSubscriptionRepository","node_type":"function"},{"code":"func (r *SubscriptionRepository) CreateSchema(ctx context.Context) error {\\n\\tmigrations := []string{\\n\\t\\t`CREATE TABLE IF NOT EXISTS subscriptions (\\n\\t\\t\\tid UUID PRIMARY KEY,\\n\\t\\t\\tuser_id UUID NOT NULL,\\n\\t\\t\\tplan VARCHAR(50) NOT NULL,\\n\\t\\t\\tstatus VARCHAR(50) NOT NULL DEFAULT \'active\',\\n\\t\\t\\tpayment_provider VARCHAR(50),\\n\\t\\t\\texternal_id VARCHAR(255),\\n\\t\\t\\tcurrent_period_start TIMESTAMP WITH TIME ZONE NOT NULL,\\n\\t\\t\\tcurrent_period_end TIMESTAMP WITH TIME ZONE NOT NULL,\\n\\t\\t\\tcancelled_at TIMESTAMP WITH TIME ZONE,\\n\\t\\t\\tcreated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\\n\\t\\t\\tupdated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\\n\\t\\t\\tUNIQUE(user_id)\\n\\t\\t)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_subscriptions_user_id ON subscriptions(user_id)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_subscriptions_status ON subscriptions(status)`,\\n\\t\\t`CREATE INDEX IF NOT EXISTS idx_subscriptions_period_end ON subscriptions(current_period_end)`,\\n\\t}\\n\\n\\tfor _, migration := range migrations {\\n\\t\\tif _, err := r.db.ExecContext(ctx, migration); err != nil {\\n\\t\\t\\treturn err\\n\\t\\t}\\n\\t}\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:23:34","name":"CreateSchema","node_type":"function"},{"code":"func NewSubscriptionService(\\n\\trepo *repository.SubscriptionRepository,\\n\\tproducer *kafka.Producer,\\n\\tpaymentGatewayURL string,\\n) *SubscriptionService {\\n\\treturn &SubscriptionService{\\n\\t\\trepo:          repo,\\n\\t\\tproducer:      producer,\\n\\t\\tpaymentClient: httpclient.NewClient(paymentGatewayURL, \\"payment-gateway\\", 30*time.Second),\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:34:6","name":"NewSubscriptionService","node_type":"function"},{"code":"func NewHandler(subscriptionService *service.SubscriptionService) *Handler {\\n\\treturn &Handler{\\n\\t\\tsubscriptionService: subscriptionService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:19:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\t// Health check\\n\\tmux.HandleFunc(\\"/health\\", h.healthCheck)\\n\\n\\t// Plan routes\\n\\tmux.HandleFunc(\\"/api/v1/plans\\", h.listPlans)\\n\\tmux.HandleFunc(\\"/api/v1/plans/\\", h.planByID)\\n\\n\\t// Subscription routes\\n\\tmux.HandleFunc(\\"/api/v1/subscriptions\\", h.handleSubscriptions)\\n\\tmux.HandleFunc(\\"/api/v1/subscriptions/\\", h.handleSubscriptionByID)\\n\\tmux.HandleFunc(\\"/api/v1/subscriptions/me\\", h.mySubscription)\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) healthCheck(w http.ResponseWriter, r *http.Request) {\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tw.Write([]byte(`{\\"status\\":\\"healthy\\",\\"service\\":\\"subscription\\"}`))\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:40:19","name":"healthCheck","node_type":"function"},{"code":"func (h *Handler) listPlans(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tplans := h.subscriptionService.GetPlans()\\n\\tresponse.OK(w, plans)\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19","name":"listPlans","node_type":"function"},{"code":"func (s *SubscriptionService) GetPlans() []model.Plan {\\n\\treturn []model.Plan{\\n\\t\\t{\\n\\t\\t\\tID:          model.PlanFree,\\n\\t\\t\\tName:        \\"Free\\",\\n\\t\\t\\tDescription: \\"Basic features\\",\\n\\t\\t\\tPrice:       0,\\n\\t\\t\\tCurrency:    \\"USD\\",\\n\\t\\t\\tInterval:    \\"monthly\\",\\n\\t\\t\\tFeatures:    []string{\\"Limited swipes\\", \\"Basic matching\\"},\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tID:          model.PlanBasic,\\n\\t\\t\\tName:        \\"Basic\\",\\n\\t\\t\\tDescription: \\"Enhanced features\\",\\n\\t\\t\\tPrice:       9.99,\\n\\t\\t\\tCurrency:    \\"USD\\",\\n\\t\\t\\tInterval:    \\"monthly\\",\\n\\t\\t\\tFeatures:    []string{\\"Unlimited swipes\\", \\"See who likes you\\", \\"1 Boost per month\\"},\\n\\t\\t},\\n\\t\\t{\\n\\t\\t\\tID:          model.PlanPremium,\\n\\t\\t\\tName:        \\"Premium\\",\\n\\t\\t\\tDescription: \\"All features unlocked\\",\\n\\t\\t\\tPrice:       19.99,\\n\\t\\t\\tCurrency:    \\"USD\\",\\n\\t\\t\\tInterval:    \\"monthly\\",\\n\\t\\t\\tFeatures:    []string{\\"Unlimited swipes\\", \\"See who likes you\\", \\"5 Boosts per month\\", \\"Priority matching\\", \\"Read receipts\\"},\\n\\t\\t},\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:346:31","name":"GetPlans","node_type":"function"},{"code":"func (h *Handler) planByID(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tplanID := strings.TrimPrefix(r.URL.Path, \\"/api/v1/plans/\\")\\n\\tplanID = strings.TrimSuffix(planID, \\"/\\")\\n\\n\\tplanDetails, err := h.subscriptionService.GetPlanDetails(planID)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tw.Write(planDetails)\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","name":"planByID","node_type":"function"},{"code":"func (s *SubscriptionService) GetPlanDetails(planID string) ([]byte, error) {\\n\\tplans := s.GetPlans()\\n\\tfor _, plan := range plans {\\n\\t\\tif plan.ID == planID {\\n\\t\\t\\treturn json.Marshal(plan)\\n\\t\\t}\\n\\t}\\n\\treturn nil, errors.NotFound(\\"plan not found\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:379:31","name":"GetPlanDetails","node_type":"function"},{"code":"func (h *Handler) handleSubscriptions(w http.ResponseWriter, r *http.Request) {\\n\\tswitch r.Method {\\n\\tcase http.MethodPost:\\n\\t\\th.createSubscription(w, r)\\n\\tdefault:\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","name":"handleSubscriptions","node_type":"function"},{"code":"func (h *Handler) createSubscription(w http.ResponseWriter, r *http.Request) {\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, &unauthorizedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.CreateSubscriptionRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\treq.UserID = userID\\n\\n\\tsub, err := h.subscriptionService.CreateSubscription(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.Created(w, sub)\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","name":"createSubscription","node_type":"function"},{"code":"func (s *SubscriptionService) CreateSubscription(ctx context.Context, req *model.CreateSubscriptionRequest) (*model.Subscription, error) {\\n\\t// Validate plan\\n\\tif _, ok := planPrices[req.Plan]; !ok {\\n\\t\\treturn nil, errors.ValidationError(\\"invalid plan\\")\\n\\t}\\n\\n\\t// Check if user already has a subscription\\n\\texisting, err := s.repo.GetByUserID(ctx, req.UserID)\\n\\tif err == nil && existing != nil {\\n\\t\\treturn nil, errors.Conflict(\\"user already has a subscription\\")\\n\\t}\\n\\n\\tnow := time.Now()\\n\\tperiodEnd := now.AddDate(0, 1, 0) // 1 month subscription\\n\\n\\tsub := &model.Subscription{\\n\\t\\tID:                 uuid.New().String(),\\n\\t\\tUserID:             req.UserID,\\n\\t\\tPlan:               req.Plan,\\n\\t\\tStatus:             model.SubscriptionStatusActive,\\n\\t\\tPaymentProvider:    req.PaymentProvider,\\n\\t\\tCurrentPeriodStart: now,\\n\\t\\tCurrentPeriodEnd:   periodEnd,\\n\\t\\tCreatedAt:          now,\\n\\t\\tUpdatedAt:          now,\\n\\t}\\n\\n\\t// Process initial payment if not free plan\\n\\tif req.Plan != model.PlanFree {\\n\\t\\tpaymentReq := &model.PaymentRequest{\\n\\t\\t\\tUserID:          req.UserID,\\n\\t\\t\\tSubscriptionID:  sub.ID,\\n\\t\\t\\tAmount:          float64(planPrices[req.Plan]) / 100,\\n\\t\\t\\tCurrency:        \\"USD\\",\\n\\t\\t\\tProvider:        req.PaymentProvider,\\n\\t\\t\\tPaymentMethodID: req.PaymentMethodID,\\n\\t\\t\\tDescription:     fmt.Sprintf(\\"Subscription: %s plan\\", req.Plan),\\n\\t\\t}\\n\\n\\t\\tpaymentResp, err := s.processPayment(ctx, paymentReq)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn nil, err\\n\\t\\t}\\n\\t\\tif !paymentResp.Success {\\n\\t\\t\\treturn nil, errors.PaymentFailed(paymentResp.ErrorMessage)\\n\\t\\t}\\n\\t\\tsub.ExternalID = paymentResp.TransactionID\\n\\t}\\n\\n\\tif err := s.repo.Create(ctx, sub); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Publish subscription created event\\n\\ts.publishSubscriptionEvent(ctx, kafka.TopicSubscriptionCreated, kafka.EventSubscriptionCreated, sub)\\n\\n\\treturn sub, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","name":"CreateSubscription","node_type":"function"},{"code":"func (r *SubscriptionRepository) GetByUserID(ctx context.Context, userID string) (*model.Subscription, error) {\\n\\tquery := `\\n\\t\\tSELECT id, user_id, plan, status, payment_provider, external_id,\\n\\t\\t\\tcurrent_period_start, current_period_end, cancelled_at, created_at, updated_at\\n\\t\\tFROM subscriptions WHERE user_id = $1\\n\\t`\\n\\tsub := &model.Subscription{}\\n\\tvar paymentProvider, externalID sql.NullString\\n\\tvar cancelledAt sql.NullTime\\n\\n\\terr := r.db.QueryRowContext(ctx, query, userID).Scan(\\n\\t\\t&sub.ID, &sub.UserID, &sub.Plan, &sub.Status, &paymentProvider, &externalID,\\n\\t\\t&sub.CurrentPeriodStart, &sub.CurrentPeriodEnd, &cancelledAt, &sub.CreatedAt, &sub.UpdatedAt,\\n\\t)\\n\\tif err == sql.ErrNoRows {\\n\\t\\treturn nil, errors.NotFound(\\"subscription not found\\")\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get subscription\\", 500)\\n\\t}\\n\\n\\tif paymentProvider.Valid {\\n\\t\\tsub.PaymentProvider = paymentProvider.String\\n\\t}\\n\\tif externalID.Valid {\\n\\t\\tsub.ExternalID = externalID.String\\n\\t}\\n\\tif cancelledAt.Valid {\\n\\t\\tsub.CancelledAt = &cancelledAt.Time\\n\\t}\\n\\n\\treturn sub, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34","name":"GetByUserID","node_type":"function"},{"code":"func (s *SubscriptionService) processPayment(ctx context.Context, req *model.PaymentRequest) (*model.PaymentResponse, error) {\\n\\tresp, err := s.paymentClient.Post(ctx, \\"/api/v1/payments/charge\\", req, nil)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to process payment\\", 500)\\n\\t}\\n\\n\\tvar paymentResp model.PaymentResponse\\n\\tif err := resp.DecodeJSON(&paymentResp); err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to decode payment response\\", 500)\\n\\t}\\n\\n\\treturn &paymentResp, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:275:31","name":"processPayment","node_type":"function"},{"code":"func (r *SubscriptionRepository) Create(ctx context.Context, sub *model.Subscription) error {\\n\\tquery := `\\n\\t\\tINSERT INTO subscriptions (id, user_id, plan, status, payment_provider, external_id, \\n\\t\\t\\tcurrent_period_start, current_period_end, created_at, updated_at)\\n\\t\\tVALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)\\n\\t`\\n\\t_, err := r.db.ExecContext(ctx, query,\\n\\t\\tsub.ID, sub.UserID, sub.Plan, sub.Status, sub.PaymentProvider, sub.ExternalID,\\n\\t\\tsub.CurrentPeriodStart, sub.CurrentPeriodEnd, sub.CreatedAt, sub.UpdatedAt,\\n\\t)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to create subscription\\", 500)\\n\\t}\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:53:34","name":"Create","node_type":"function"},{"code":"func (s *SubscriptionService) publishSubscriptionEvent(ctx context.Context, topic, eventType string, sub *model.Subscription) {\\n\\tevent := model.SubscriptionEvent{\\n\\t\\tSubscriptionID: sub.ID,\\n\\t\\tUserID:         sub.UserID,\\n\\t\\tPlan:           sub.Plan,\\n\\t\\tStatus:         sub.Status,\\n\\t\\tTimestamp:      time.Now(),\\n\\t}\\n\\n\\tif err := s.producer.PublishWithKey(ctx, topic, sub.ID, eventType, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish subscription event\\",\\n\\t\\t\\tzap.String(\\"topic\\", topic),\\n\\t\\t\\tzap.String(\\"subscription_id\\", sub.ID),\\n\\t\\t\\tzap.Error(err),\\n\\t\\t)\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","name":"publishSubscriptionEvent","node_type":"function"},{"code":"func (h *Handler) handleSubscriptionByID(w http.ResponseWriter, r *http.Request) {\\n\\t// Handle /api/v1/subscriptions/me separately\\n\\tif strings.HasSuffix(r.URL.Path, \\"/me\\") || strings.Contains(r.URL.Path, \\"/me/\\") {\\n\\t\\th.mySubscription(w, r)\\n\\t\\treturn\\n\\t}\\n\\n\\t// Extract subscription ID from path\\n\\tpath := strings.TrimPrefix(r.URL.Path, \\"/api/v1/subscriptions/\\")\\n\\tparts := strings.Split(path, \\"/\\")\\n\\tsubscriptionID := parts[0]\\n\\n\\tif subscriptionID == \\"\\" {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"subscription ID is required\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\t// Check for cancel action\\n\\tif len(parts) > 1 && parts[1] == \\"cancel\\" {\\n\\t\\th.cancelSubscription(w, r, subscriptionID)\\n\\t\\treturn\\n\\t}\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\tsub, err := h.subscriptionService.GetSubscription(r.Context(), subscriptionID)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, sub)\\n\\n\\tcase http.MethodPut:\\n\\t\\tvar req model.UpdateSubscriptionRequest\\n\\t\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tsub, err := h.subscriptionService.UpdateSubscription(r.Context(), subscriptionID, &req)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, sub)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","name":"handleSubscriptionByID","node_type":"function"},{"code":"func (h *Handler) mySubscription(w http.ResponseWriter, r *http.Request) {\\n\\tuserID := r.Header.Get(\\"X-User-ID\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, &unauthorizedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\tsub, err := h.subscriptionService.GetSubscriptionByUserID(r.Context(), userID)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, sub)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","name":"mySubscription","node_type":"function"},{"code":"func (s *SubscriptionService) GetSubscriptionByUserID(ctx context.Context, userID string) (*model.Subscription, error) {\\n\\treturn s.repo.GetByUserID(ctx, userID)\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:112:31","name":"GetSubscriptionByUserID","node_type":"function"},{"code":"func (h *Handler) cancelSubscription(w http.ResponseWriter, r *http.Request, subscriptionID string) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.CancelSubscriptionRequest\\n\\tif r.Body != nil && r.ContentLength > 0 {\\n\\t\\tjson.NewDecoder(r.Body).Decode(&req)\\n\\t}\\n\\n\\tsub, err := h.subscriptionService.CancelSubscription(r.Context(), subscriptionID, &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, sub)\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","name":"cancelSubscription","node_type":"function"},{"code":"func (s *SubscriptionService) CancelSubscription(ctx context.Context, id string, req *model.CancelSubscriptionRequest) (*model.Subscription, error) {\\n\\tsub, err := s.repo.GetByID(ctx, id)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tnow := time.Now()\\n\\tsub.Status = model.SubscriptionStatusCancelled\\n\\tsub.CancelledAt = &now\\n\\n\\tif err := s.repo.Update(ctx, sub); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Publish subscription cancelled event\\n\\ts.publishSubscriptionEvent(ctx, kafka.TopicSubscriptionCancelled, kafka.EventSubscriptionCancelled, sub)\\n\\n\\t// Send cancellation notification\\n\\ts.sendNotification(ctx, sub.UserID, \\"subscription_cancelled\\", \\"Subscription Cancelled\\", \\n\\t\\t\\"Your subscription has been cancelled. You can continue using premium features until the end of your billing period.\\")\\n\\n\\treturn sub, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","name":"CancelSubscription","node_type":"function"},{"code":"func (r *SubscriptionRepository) GetByID(ctx context.Context, id string) (*model.Subscription, error) {\\n\\tquery := `\\n\\t\\tSELECT id, user_id, plan, status, payment_provider, external_id,\\n\\t\\t\\tcurrent_period_start, current_period_end, cancelled_at, created_at, updated_at\\n\\t\\tFROM subscriptions WHERE id = $1\\n\\t`\\n\\tsub := &model.Subscription{}\\n\\tvar paymentProvider, externalID sql.NullString\\n\\tvar cancelledAt sql.NullTime\\n\\n\\terr := r.db.QueryRowContext(ctx, query, id).Scan(\\n\\t\\t&sub.ID, &sub.UserID, &sub.Plan, &sub.Status, &paymentProvider, &externalID,\\n\\t\\t&sub.CurrentPeriodStart, &sub.CurrentPeriodEnd, &cancelledAt, &sub.CreatedAt, &sub.UpdatedAt,\\n\\t)\\n\\tif err == sql.ErrNoRows {\\n\\t\\treturn nil, errors.NotFound(\\"subscription not found\\")\\n\\t}\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get subscription\\", 500)\\n\\t}\\n\\n\\tif paymentProvider.Valid {\\n\\t\\tsub.PaymentProvider = paymentProvider.String\\n\\t}\\n\\tif externalID.Valid {\\n\\t\\tsub.ExternalID = externalID.String\\n\\t}\\n\\tif cancelledAt.Valid {\\n\\t\\tsub.CancelledAt = &cancelledAt.Time\\n\\t}\\n\\n\\treturn sub, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34","name":"GetByID","node_type":"function"},{"code":"func (r *SubscriptionRepository) Update(ctx context.Context, sub *model.Subscription) error {\\n\\tquery := `\\n\\t\\tUPDATE subscriptions SET\\n\\t\\t\\tplan = $2, status = $3, payment_provider = $4, external_id = $5,\\n\\t\\t\\tcurrent_period_start = $6, current_period_end = $7, cancelled_at = $8, updated_at = $9\\n\\t\\tWHERE id = $1\\n\\t`\\n\\tsub.UpdatedAt = time.Now()\\n\\t_, err := r.db.ExecContext(ctx, query,\\n\\t\\tsub.ID, sub.Plan, sub.Status, sub.PaymentProvider, sub.ExternalID,\\n\\t\\tsub.CurrentPeriodStart, sub.CurrentPeriodEnd, sub.CancelledAt, sub.UpdatedAt,\\n\\t)\\n\\tif err != nil {\\n\\t\\treturn errors.Wrap(err, errors.CodeInternalServerError, \\"failed to update subscription\\", 500)\\n\\t}\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","name":"Update","node_type":"function"},{"code":"func (s *SubscriptionService) sendNotification(ctx context.Context, userID, notifType, title, message string) {\\n\\tnotif := model.NotificationRequest{\\n\\t\\tUserID:  userID,\\n\\t\\tType:    notifType,\\n\\t\\tTitle:   title,\\n\\t\\tMessage: message,\\n\\t}\\n\\n\\tif err := s.producer.PublishWithKey(ctx, kafka.TopicNotificationSend, userID, \\"notification.send\\", notif); err != nil {\\n\\t\\tlogger.Error(\\"failed to send notification\\",\\n\\t\\t\\tzap.String(\\"user_id\\", userID),\\n\\t\\t\\tzap.String(\\"type\\", notifType),\\n\\t\\t\\tzap.Error(err),\\n\\t\\t)\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","name":"sendNotification","node_type":"function"},{"code":"func (s *SubscriptionService) GetSubscription(ctx context.Context, id string) (*model.Subscription, error) {\\n\\treturn s.repo.GetByID(ctx, id)\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:107:31","name":"GetSubscription","node_type":"function"},{"code":"func (s *SubscriptionService) UpdateSubscription(ctx context.Context, id string, req *model.UpdateSubscriptionRequest) (*model.Subscription, error) {\\n\\tsub, err := s.repo.GetByID(ctx, id)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tif req.Plan != \\"\\" {\\n\\t\\tif _, ok := planPrices[req.Plan]; !ok {\\n\\t\\t\\treturn nil, errors.ValidationError(\\"invalid plan\\")\\n\\t\\t}\\n\\t\\tsub.Plan = req.Plan\\n\\t}\\n\\n\\tif err := s.repo.Update(ctx, sub); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// Publish subscription updated event\\n\\ts.publishSubscriptionEvent(ctx, kafka.TopicSubscriptionUpdated, kafka.EventSubscriptionUpdated, sub)\\n\\n\\treturn sub, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","name":"UpdateSubscription","node_type":"function"},{"code":"func NewRenewalScheduler(subscriptionService *service.SubscriptionService, interval time.Duration) *RenewalScheduler {\\n\\treturn &RenewalScheduler{\\n\\t\\tsubscriptionService: subscriptionService,\\n\\t\\tinterval:            interval,\\n\\t\\tstopCh:              make(chan struct{}),\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:20:6","name":"NewRenewalScheduler","node_type":"function"},{"code":"func (s *RenewalScheduler) Start(ctx context.Context) {\\n\\tlogger.Info(\\"starting renewal scheduler\\", zap.Duration(\\"interval\\", s.interval))\\n\\n\\tticker := time.NewTicker(s.interval)\\n\\tdefer ticker.Stop()\\n\\n\\t// Run immediately on start\\n\\ts.runRenewalCheck(ctx)\\n\\n\\tfor {\\n\\t\\tselect {\\n\\t\\tcase <-ticker.C:\\n\\t\\t\\ts.runRenewalCheck(ctx)\\n\\t\\tcase <-s.stopCh:\\n\\t\\t\\tlogger.Info(\\"renewal scheduler stopped\\")\\n\\t\\t\\treturn\\n\\t\\tcase <-ctx.Done():\\n\\t\\t\\tlogger.Info(\\"renewal scheduler context cancelled\\")\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:29:28","name":"Start","node_type":"function"},{"code":"func (s *RenewalScheduler) runRenewalCheck(ctx context.Context) {\\n\\tlogger.Info(\\"running subscription renewal check\\")\\n\\tstart := time.Now()\\n\\n\\tif err := s.subscriptionService.ProcessExpiredSubscriptions(ctx); err != nil {\\n\\t\\tlogger.Error(\\"failed to process expired subscriptions\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"subscription renewal check completed\\",\\n\\t\\tzap.Duration(\\"duration\\", time.Since(start)),\\n\\t)\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:58:28","name":"runRenewalCheck","node_type":"function"},{"code":"func (s *SubscriptionService) ProcessExpiredSubscriptions(ctx context.Context) error {\\n\\tlogger.Info(\\"processing expired subscriptions\\")\\n\\n\\texpiredSubs, err := s.repo.GetExpiredSubscriptions(ctx, time.Now())\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\n\\tlogger.Info(\\"found expired subscriptions\\", zap.Int(\\"count\\", len(expiredSubs)))\\n\\n\\tfor _, sub := range expiredSubs {\\n\\t\\tif err := s.renewSubscription(ctx, sub); err != nil {\\n\\t\\t\\tlogger.Error(\\"failed to renew subscription\\",\\n\\t\\t\\t\\tzap.String(\\"subscription_id\\", sub.ID),\\n\\t\\t\\t\\tzap.String(\\"user_id\\", sub.UserID),\\n\\t\\t\\t\\tzap.Error(err),\\n\\t\\t\\t)\\n\\t\\t}\\n\\t}\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:166:31","name":"ProcessExpiredSubscriptions","node_type":"function"},{"code":"func (r *SubscriptionRepository) GetExpiredSubscriptions(ctx context.Context, before time.Time) ([]*model.Subscription, error) {\\n\\tquery := `\\n\\t\\tSELECT id, user_id, plan, status, payment_provider, external_id,\\n\\t\\t\\tcurrent_period_start, current_period_end, cancelled_at, created_at, updated_at\\n\\t\\tFROM subscriptions \\n\\t\\tWHERE status = \'active\' AND current_period_end <= $1\\n\\t\\tORDER BY current_period_end ASC\\n\\t\\tLIMIT 100\\n\\t`\\n\\trows, err := r.db.QueryContext(ctx, query, before)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to query expired subscriptions\\", 500)\\n\\t}\\n\\tdefer rows.Close()\\n\\n\\tvar subscriptions []*model.Subscription\\n\\tfor rows.Next() {\\n\\t\\tsub := &model.Subscription{}\\n\\t\\tvar paymentProvider, externalID sql.NullString\\n\\t\\tvar cancelledAt sql.NullTime\\n\\n\\t\\terr := rows.Scan(\\n\\t\\t\\t&sub.ID, &sub.UserID, &sub.Plan, &sub.Status, &paymentProvider, &externalID,\\n\\t\\t\\t&sub.CurrentPeriodStart, &sub.CurrentPeriodEnd, &cancelledAt, &sub.CreatedAt, &sub.UpdatedAt,\\n\\t\\t)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to scan subscription\\", 500)\\n\\t\\t}\\n\\n\\t\\tif paymentProvider.Valid {\\n\\t\\t\\tsub.PaymentProvider = paymentProvider.String\\n\\t\\t}\\n\\t\\tif externalID.Valid {\\n\\t\\t\\tsub.ExternalID = externalID.String\\n\\t\\t}\\n\\t\\tif cancelledAt.Valid {\\n\\t\\t\\tsub.CancelledAt = &cancelledAt.Time\\n\\t\\t}\\n\\n\\t\\tsubscriptions = append(subscriptions, sub)\\n\\t}\\n\\n\\treturn subscriptions, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:159:34","name":"GetExpiredSubscriptions","node_type":"function"},{"code":"func (s *SubscriptionService) renewSubscription(ctx context.Context, sub *model.Subscription) error {\\n\\tlogger.Info(\\"renewing subscription\\",\\n\\t\\tzap.String(\\"subscription_id\\", sub.ID),\\n\\t\\tzap.String(\\"user_id\\", sub.UserID),\\n\\t\\tzap.String(\\"plan\\", sub.Plan),\\n\\t)\\n\\n\\t// Skip free plans - just extend the period\\n\\tif sub.Plan == model.PlanFree {\\n\\t\\tsub.CurrentPeriodStart = time.Now()\\n\\t\\tsub.CurrentPeriodEnd = time.Now().AddDate(0, 1, 0)\\n\\t\\treturn s.repo.Update(ctx, sub)\\n\\t}\\n\\n\\t// Process payment\\n\\tpaymentReq := &model.PaymentRequest{\\n\\t\\tUserID:         sub.UserID,\\n\\t\\tSubscriptionID: sub.ID,\\n\\t\\tAmount:         float64(planPrices[sub.Plan]) / 100,\\n\\t\\tCurrency:       \\"USD\\",\\n\\t\\tProvider:       sub.PaymentProvider,\\n\\t\\tDescription:    fmt.Sprintf(\\"Subscription renewal: %s plan\\", sub.Plan),\\n\\t\\tMetadata: map[string]string{\\n\\t\\t\\t\\"subscription_id\\": sub.ID,\\n\\t\\t\\t\\"renewal\\":         \\"true\\",\\n\\t\\t},\\n\\t}\\n\\n\\tpaymentResp, err := s.processPayment(ctx, paymentReq)\\n\\tif err != nil {\\n\\t\\t// Mark subscription as past due\\n\\t\\tsub.Status = model.SubscriptionStatusPastDue\\n\\t\\ts.repo.Update(ctx, sub)\\n\\n\\t\\t// Send payment failure notification\\n\\t\\ts.sendNotification(ctx, sub.UserID, \\"payment_failed\\", \\"Payment Failed\\",\\n\\t\\t\\t\\"We couldn\'t process your subscription payment. Please update your payment method to continue your subscription.\\")\\n\\n\\t\\t// Publish payment failed event\\n\\t\\ts.publishPaymentFailedEvent(ctx, sub, err.Error())\\n\\n\\t\\treturn err\\n\\t}\\n\\n\\tif !paymentResp.Success {\\n\\t\\t// Mark subscription as past due\\n\\t\\tsub.Status = model.SubscriptionStatusPastDue\\n\\t\\ts.repo.Update(ctx, sub)\\n\\n\\t\\t// Send payment failure notification\\n\\t\\ts.sendNotification(ctx, sub.UserID, \\"payment_failed\\", \\"Payment Failed\\",\\n\\t\\t\\tfmt.Sprintf(\\"We couldn\'t process your subscription payment: %s\\", paymentResp.ErrorMessage))\\n\\n\\t\\t// Publish payment failed event\\n\\t\\ts.publishPaymentFailedEvent(ctx, sub, paymentResp.ErrorMessage)\\n\\n\\t\\treturn errors.PaymentFailed(paymentResp.ErrorMessage)\\n\\t}\\n\\n\\t// Payment successful - extend subscription\\n\\tsub.CurrentPeriodStart = time.Now()\\n\\tsub.CurrentPeriodEnd = time.Now().AddDate(0, 1, 0)\\n\\tsub.Status = model.SubscriptionStatusActive\\n\\tsub.ExternalID = paymentResp.TransactionID\\n\\n\\tif err := s.repo.Update(ctx, sub); err != nil {\\n\\t\\treturn err\\n\\t}\\n\\n\\t// Send renewal success notification\\n\\ts.sendNotification(ctx, sub.UserID, \\"subscription_renewed\\", \\"Subscription Renewed\\",\\n\\t\\tfmt.Sprintf(\\"Your %s subscription has been renewed successfully. Thank you for being a premium member!\\", sub.Plan))\\n\\n\\t// Publish subscription renewed event\\n\\ts.publishSubscriptionEvent(ctx, kafka.TopicSubscriptionRenewed, kafka.EventSubscriptionRenewed, sub)\\n\\n\\tlogger.Info(\\"subscription renewed successfully\\",\\n\\t\\tzap.String(\\"subscription_id\\", sub.ID),\\n\\t\\tzap.String(\\"user_id\\", sub.UserID),\\n\\t)\\n\\n\\treturn nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","name":"renewSubscription","node_type":"function"},{"code":"func (s *SubscriptionService) publishPaymentFailedEvent(ctx context.Context, sub *model.Subscription, errorMsg string) {\\n\\tevent := model.PaymentFailedEvent{\\n\\t\\tSubscriptionID: sub.ID,\\n\\t\\tUserID:         sub.UserID,\\n\\t\\tAmount:         float64(planPrices[sub.Plan]) / 100,\\n\\t\\tCurrency:       \\"USD\\",\\n\\t\\tErrorMessage:   errorMsg,\\n\\t\\tTimestamp:      time.Now(),\\n\\t}\\n\\n\\tif err := s.producer.PublishWithKey(ctx, kafka.TopicPaymentFailed, sub.ID, kafka.EventPaymentFailed, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish payment failed event\\",\\n\\t\\t\\tzap.String(\\"subscription_id\\", sub.ID),\\n\\t\\t\\tzap.Error(err),\\n\\t\\t)\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:327:31","name":"publishPaymentFailedEvent","node_type":"function"},{"code":"func (s *RenewalScheduler) Stop() {\\n\\tclose(s.stopCh)\\n}","external":"false","id":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:53:28","name":"Stop","node_type":"function"}]'),$e=JSON.parse('[{"column":32,"line":76,"source":"/home/evan/Code/rinder/services/subscription/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:18:6","val":1},{"column":28,"line":79,"source":"/home/evan/Code/rinder/services/subscription/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:23:34","val":1},{"column":32,"line":44,"source":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:23:34","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:23:34","val":1},{"column":32,"line":85,"source":"/home/evan/Code/rinder/services/subscription/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:34:6","val":1},{"column":14,"line":88,"source":"/home/evan/Code/rinder/services/subscription/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:19:6","val":1},{"column":3,"line":92,"source":"/home/evan/Code/rinder/services/subscription/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","val":1},{"column":29,"line":27,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:40:19","val":1},{"column":35,"line":30,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19","val":1},{"column":17,"line":47,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19","val":1},{"column":32,"line":51,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:346:31","val":1},{"column":13,"line":52,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19","val":1},{"column":36,"line":31,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","val":1},{"column":17,"line":57,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","val":1},{"column":43,"line":64,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:379:31","val":1},{"column":12,"line":379,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:379:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:346:31","val":1},{"column":17,"line":66,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19","val":1},{"column":43,"line":34,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","val":1},{"column":4,"line":78,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","val":1},{"column":17,"line":87,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","val":1},{"column":17,"line":93,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","val":1},{"column":35,"line":98,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","val":1},{"column":25,"line":53,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34","val":1},{"column":29,"line":114,"source":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34","val":1},{"column":41,"line":114,"source":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34","val":1},{"column":37,"line":53,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","val":1},{"column":24,"line":85,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:275:31","val":1},{"column":35,"line":275,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:275:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:275:31","val":1},{"column":67,"line":275,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:275:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:275:31","val":1},{"column":39,"line":85,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","val":1},{"column":18,"line":95,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:53:34","val":1},{"column":28,"line":58,"source":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:53:34","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:53:34","val":1},{"column":25,"line":95,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","val":1},{"column":3,"line":100,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","val":1},{"column":37,"line":316,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","val":1},{"column":42,"line":316,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","val":1},{"column":57,"line":316,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","val":1},{"column":23,"line":318,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","val":1},{"column":28,"line":100,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31","val":1},{"column":17,"line":100,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","val":1},{"column":18,"line":104,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19","val":1},{"column":23,"line":78,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","val":1},{"column":26,"line":78,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","val":1},{"column":17,"line":80,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19","val":1},{"column":44,"line":35,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":4,"line":131,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","val":1},{"column":17,"line":110,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","val":1},{"column":36,"line":116,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:112:31","val":1},{"column":15,"line":112,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:112:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34","val":1},{"column":27,"line":112,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:112:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:112:31","val":1},{"column":32,"line":112,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:112:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:112:31","val":1},{"column":18,"line":118,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","val":1},{"column":14,"line":121,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","val":1},{"column":17,"line":124,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","val":1},{"column":19,"line":131,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":22,"line":131,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":17,"line":141,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":4,"line":147,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","val":1},{"column":17,"line":181,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","val":1},{"column":35,"line":190,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","val":1},{"column":20,"line":141,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34","val":1},{"column":29,"line":79,"source":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34","val":1},{"column":41,"line":79,"source":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34","val":1},{"column":28,"line":141,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","val":1},{"column":33,"line":141,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","val":1},{"column":18,"line":150,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","val":1},{"column":28,"line":147,"source":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","val":1},{"column":25,"line":150,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","val":1},{"column":3,"line":155,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","val":1},{"column":28,"line":155,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","val":1},{"column":3,"line":158,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","val":1},{"column":37,"line":297,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","val":1},{"column":71,"line":297,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","val":1},{"column":25,"line":299,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","val":1},{"column":22,"line":300,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","val":1},{"column":20,"line":158,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31","val":1},{"column":67,"line":190,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","val":1},{"column":17,"line":192,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","val":1},{"column":13,"line":196,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19","val":1},{"column":23,"line":147,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":26,"line":147,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":36,"line":153,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:107:31","val":1},{"column":15,"line":107,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:107:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34","val":1},{"column":23,"line":107,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:107:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:107:31","val":1},{"column":28,"line":107,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:107:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:107:31","val":1},{"column":18,"line":155,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":14,"line":158,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":18,"line":163,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":36,"line":167,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","val":1},{"column":20,"line":117,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34","val":1},{"column":28,"line":117,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","val":1},{"column":33,"line":117,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","val":1},{"column":18,"line":129,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","val":1},{"column":25,"line":129,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","val":1},{"column":3,"line":134,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","val":1},{"column":28,"line":134,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31","val":1},{"column":18,"line":169,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":14,"line":172,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":17,"line":175,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19","val":1},{"column":46,"line":36,"source":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19","target":"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19","val":1},{"column":31,"line":109,"source":"/home/evan/Code/rinder/services/subscription/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:20:6","val":1},{"column":21,"line":111,"source":"/home/evan/Code/rinder/services/subscription/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:29:28","val":1},{"column":3,"line":35,"source":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:29:28","target":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:58:28","val":1},{"column":33,"line":61,"source":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:58:28","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:166:31","val":1},{"column":28,"line":168,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:166:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:159:34","val":1},{"column":32,"line":167,"source":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:159:34","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:159:34","val":1},{"column":44,"line":167,"source":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:159:34","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:159:34","val":1},{"column":52,"line":168,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:166:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:166:31","val":1},{"column":14,"line":176,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:166:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":16,"line":200,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","val":1},{"column":23,"line":200,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":28,"line":200,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":23,"line":217,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:275:31","val":1},{"column":38,"line":217,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":9,"line":221,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","val":1},{"column":16,"line":221,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":21,"line":221,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":4,"line":224,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","val":1},{"column":21,"line":224,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":4,"line":228,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:327:31","val":1},{"column":37,"line":336,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:327:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:327:31","val":1},{"column":30,"line":228,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":35,"line":228,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":9,"line":236,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","val":1},{"column":16,"line":236,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":21,"line":236,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":4,"line":239,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","val":1},{"column":21,"line":239,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":4,"line":243,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:327:31","val":1},{"column":30,"line":243,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":35,"line":243,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":18,"line":254,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34","val":1},{"column":25,"line":254,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":30,"line":254,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":3,"line":259,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31","val":1},{"column":20,"line":259,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":3,"line":263,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31","val":1},{"column":28,"line":263,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":97,"line":263,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31","val":1},{"column":32,"line":176,"source":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:166:31","target":"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:166:31","val":1},{"column":61,"line":61,"source":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:58:28","target":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:58:28","val":1},{"column":19,"line":35,"source":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:29:28","target":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:29:28","val":1},{"column":5,"line":40,"source":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:29:28","target":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:58:28","val":1},{"column":21,"line":40,"source":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:29:28","target":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:29:28","val":1},{"column":18,"line":130,"source":"/home/evan/Code/rinder/services/subscription/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:53:28","val":1}]'),jr={nodes:Fe,links:$e},Jr=Object.freeze(Object.defineProperty({__proto__:null,default:jr,links:$e,nodes:Fe},Symbol.toStringTag,{value:"Module"})),Kr=[{id:"/home/evan/Code/rinder/services/subscription/cmd/main.go:25:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:18:6",name:"NewSubscriptionRepository",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:23:34",name:"CreateSchema",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:34:6",name:"NewSubscriptionService",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:19:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:26:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:40:19",name:"healthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:46:19",name:"listPlans",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:346:31",name:"GetPlans",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:56:19",name:"planByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:379:31",name:"GetPlanDetails",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:76:19",name:"handleSubscriptions",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:85:19",name:"createSubscription",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:47:31",name:"CreateSubscription",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:105:34",name:"GetByUserID",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:275:31",name:"processPayment",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:53:34",name:"Create",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:308:31",name:"publishSubscriptionEvent",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:129:19",name:"handleSubscriptionByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:108:19",name:"mySubscription",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:112:31",name:"GetSubscriptionByUserID",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/handler/handler.go:180:19",name:"cancelSubscription",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:141:31",name:"CancelSubscription",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:70:34",name:"GetByID",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:140:34",name:"Update",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:290:31",name:"sendNotification",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:107:31",name:"GetSubscription",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:117:31",name:"UpdateSubscription",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:20:6",name:"NewRenewalScheduler",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:29:28",name:"Start",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:58:28",name:"runRenewalCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:166:31",name:"ProcessExpiredSubscriptions",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/repository/subscription_repository.go:159:34",name:"GetExpiredSubscriptions",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:190:31",name:"renewSubscription",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/service/subscription_service.go:327:31",name:"publishPaymentFailedEvent",node_type:"function"},{id:"/home/evan/Code/rinder/services/subscription/internal/scheduler/renewal_scheduler.go:53:28",name:"Stop",node_type:"function"}],Vr=Object.freeze(Object.defineProperty({__proto__:null,default:Kr},Symbol.toStringTag,{value:"Module"})),je=18,Je="service-payment-gateway",Ke="/home/evan/Code/rinder/services/payment-gateway",Ve="cmd/main.go",Ye="main",Qe="github.com/rinder",Xe=null,en="2026-01-30T09:41:23.225010472Z",nn="2026-01-30T09:41:27.264355061Z",rn="analyzing-completed",tn=JSON.parse(`[{"id":239,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:41:19","outputs":[{"id":1460,"handler_id":239,"type":"http_response","label":"HTTP 200 JSON response with body {\\"status\\":\\"healthy\\",\\"service\\":\\"payment-gateway\\"}","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:41:19","function_name":"healthCheck","description":"The HTTP handler sets Content-Type: application/json, sends HTTP 200 OK, and writes the JSON body indicating the service is healthy.","created_at":"2026-01-30T09:42:18.822153421Z","updated_at":null}],"created_at":"2026-01-30T09:41:57.959066561Z","updated_at":null},{"id":242,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[{"id":1483,"handler_id":242,"type":"http","label":"GET /api/v1/payment-methods?user_id={user_id} to payment provider","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26","function_name":"GetPaymentMethods","description":"When handling a valid GET request, the gateway service forwards the request to the configured payment provider by issuing an HTTP GET to the provider's /api/v1/payment-methods endpoint with the user_id query parameter.","created_at":"2026-01-30T09:42:58.843768738Z","updated_at":null},{"id":1485,"handler_id":242,"type":"http","label":"POST /api/v1/payment-methods to payment provider (body: CreatePaymentMethodRequest)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:152:26","function_name":"CreatePaymentMethod","description":"When handling a valid POST to create a payment method, the gateway service forwards the creation request to the configured payment provider by issuing an HTTP POST to /api/v1/payment-methods with the request body containing the CreatePaymentMethodRequest.","created_at":"2026-01-30T09:42:58.847122439Z","updated_at":null},{"id":1484,"handler_id":242,"type":"http_response","label":"HTTP 200 OK with JSON list of payment methods","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the provider call for GET succeeds and the response is decoded, the handler returns an HTTP 200 response to the client containing the JSON-encoded list of payment methods.","created_at":"2026-01-30T09:42:58.845670936Z","updated_at":null},{"id":1486,"handler_id":242,"type":"http_response","label":"HTTP 201 Created with JSON payment method","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the provider POST returns a successful response and its body decodes to a PaymentMethod, the handler returns an HTTP 201 Created response to the client with the JSON-encoded payment method.","created_at":"2026-01-30T09:42:58.849033068Z","updated_at":null},{"id":1482,"handler_id":242,"type":"http_response","label":"HTTP error response (400 Bad Request) - invalid request body","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"For POST requests, if the request body cannot be decoded into the expected CreatePaymentMethodRequest structure, the handler returns a bad-request HTTP error response to the client.","created_at":"2026-01-30T09:42:58.841665276Z","updated_at":null},{"id":1480,"handler_id":242,"type":"http_response","label":"HTTP error response (400 Bad Request) - user_id is required","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the incoming GET request does not include the required \\"user_id\\" query parameter, the handler returns an HTTP error response to the client indicating a bad request.","created_at":"2026-01-30T09:42:58.826521544Z","updated_at":null},{"id":1481,"handler_id":242,"type":"http_response","label":"HTTP error response (405 Method Not Allowed)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the incoming request uses an HTTP method other than GET or POST, the handler returns a method-not-allowed HTTP error response to the client.","created_at":"2026-01-30T09:42:58.838352359Z","updated_at":null},{"id":1487,"handler_id":242,"type":"http_response","label":"HTTP error response (validation/internal error from gateway service)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the gateway service returns an error (for example: unsupported provider validation error, provider request failure, or response decode failure), the handler returns an error HTTP response to the client reflecting that failure. (The gateway service may return validation errors immediately without making an external provider call.)","created_at":"2026-01-30T09:42:58.850468875Z","updated_at":null}],"created_at":"2026-01-30T09:41:57.980427924Z","updated_at":null},{"id":244,"type":"http","method":"GET","path":"/api/v1/providers","source_function_name":"RegisterRoutes","function_name":"listProviders","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19","outputs":[{"id":1464,"handler_id":244,"type":"http_response","label":"HTTP 200 JSON response with providers list","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19","function_name":"listProviders","description":"When the request method is GET, the handler returns an HTTP 200 response with a JSON body: {\\"providers\\": [...]}. The providers slice is obtained from GatewayService.GetSupportedProviders (which returns model.ProviderStripe, model.ProviderBraintree, model.ProviderWorldpay).","created_at":"2026-01-30T09:42:35.987657991Z","updated_at":null},{"id":1465,"handler_id":244,"type":"http_response","label":"HTTP error response (method not allowed)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19","function_name":"listProviders","description":"When the request method is not GET, the handler calls response.Error with a methodNotAllowedError, resulting in an HTTP error response indicating the request method is not allowed.","created_at":"2026-01-30T09:42:36.001410064Z","updated_at":null}],"created_at":"2026-01-30T09:41:57.984443325Z","updated_at":null},{"id":245,"type":"http","method":"GET","path":"/api/v1/providers/health","source_function_name":"RegisterRoutes","function_name":"providerHealth","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","outputs":[{"id":1461,"handler_id":245,"type":"http","label":"HTTP GET /health to each configured provider","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:200:26","function_name":"CheckProviderHealth","description":"For each provider in s.providerClients the service performs an outbound HTTP GET request to the provider's /health endpoint (client.Get(ctx, \\"/health\\", nil)). The result is used to determine availability and latency.","created_at":"2026-01-30T09:42:25.524162087Z","updated_at":null},{"id":1462,"handler_id":245,"type":"http_response","label":"HTTP 200 JSON response with providers health","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","function_name":"providerHealth","description":"If the incoming request method is GET, the handler returns an HTTP 200 response to the client with a JSON body containing a \\"providers\\" array (the health results returned by CheckProviderHealth).","created_at":"2026-01-30T09:42:25.537981586Z","updated_at":null},{"id":1463,"handler_id":245,"type":"http_response","label":"HTTP error response (method not allowed)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","function_name":"providerHealth","description":"If the incoming request method is not GET, the handler returns an HTTP error response indicating the method is not allowed (via response.Error with methodNotAllowedError).","created_at":"2026-01-30T09:42:25.540211073Z","updated_at":null}],"created_at":"2026-01-30T09:41:57.986220767Z","updated_at":null},{"id":243,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","outputs":[{"id":1491,"handler_id":243,"type":"http","label":"HTTP GET to payment provider: GET /api/v1/payment-methods?user_id={user_id}","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26","function_name":"GetPaymentMethods","description":"When handling a GET request with a supported provider, the gateway service forwards the request to the configured provider client by issuing an HTTP GET to the provider's /api/v1/payment-methods endpoint with the user_id query parameter.","created_at":"2026-01-30T09:42:59.254896279Z","updated_at":null},{"id":1493,"handler_id":243,"type":"http","label":"HTTP POST to payment provider: POST /api/v1/payment-methods","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:152:26","function_name":"CreatePaymentMethod","description":"When handling a POST to create a payment method, the gateway service forwards the request to the configured provider client by issuing an HTTP POST to the provider's /api/v1/payment-methods endpoint with the CreatePaymentMethodRequest as the request body.","created_at":"2026-01-30T09:42:59.257203653Z","updated_at":null},{"id":1492,"handler_id":243,"type":"http_response","label":"HTTP 200 OK JSON response (payment methods)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the provider GET request succeeds and the response is decoded, the handler returns an HTTP 200 response containing the list of payment methods (JSON) to the caller.","created_at":"2026-01-30T09:42:59.256049915Z","updated_at":null},{"id":1495,"handler_id":243,"type":"http_response","label":"HTTP 201 Created JSON response (created payment method)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the provider POST succeeds and the response is decoded into a PaymentMethod, the handler returns an HTTP 201 Created response containing the created payment method (JSON) to the caller.","created_at":"2026-01-30T09:42:59.260126257Z","updated_at":null},{"id":1489,"handler_id":243,"type":"http_response","label":"HTTP 400/validation error response (invalid JSON body)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the POST request body cannot be decoded as JSON into CreatePaymentMethodRequest, the handler returns a client error response (bad request) to the caller.","created_at":"2026-01-30T09:42:59.250136083Z","updated_at":null},{"id":1488,"handler_id":243,"type":"http_response","label":"HTTP 400/validation error response (missing user_id)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the query parameter 'user_id' is empty on a GET request, the handler returns a client error response (bad request) to the caller.","created_at":"2026-01-30T09:42:59.237370475Z","updated_at":null},{"id":1490,"handler_id":243,"type":"http_response","label":"HTTP 405 Method Not Allowed response","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the incoming HTTP method is not GET or POST, the handler returns a method-not-allowed response to the caller.","created_at":"2026-01-30T09:42:59.25320488Z","updated_at":null},{"id":1494,"handler_id":243,"type":"http_response","label":"HTTP error response when provider returns non-success","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","function_name":"paymentMethods","description":"If the provider POST to create a payment method returns a non-success HTTP response (detected via resp.IsSuccess()), the gateway service returns an error which the handler turns into an HTTP error response to the caller.","created_at":"2026-01-30T09:42:59.258427404Z","updated_at":null}],"created_at":"2026-01-30T09:41:57.982535504Z","updated_at":null},{"id":240,"type":"http","method":"POST","path":"/api/v1/payments/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","outputs":[{"id":1477,"handler_id":240,"type":"event","label":"Publish payment failed event to Kafka (kafka.TopicPaymentFailed, kafka.EventPaymentFailed)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","function_name":"publishPaymentEvent","description":"If the provider response indicates the payment failed (after a successful provider response decode), the service publishes a payment-failed event (with transaction_id, user_id, subscription_id, amount, currency, provider, status, error_message, timestamp) to the failure topic using the producer's PublishWithKey.","created_at":"2026-01-30T09:42:52.801289996Z","updated_at":null},{"id":1476,"handler_id":240,"type":"event","label":"Publish payment succeeded event to Kafka (kafka.TopicPaymentSucceeded, kafka.EventPaymentSucceeded)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","function_name":"publishPaymentEvent","description":"If the provider response indicates the payment succeeded, the service publishes a payment-succeeded event (with transaction_id, user_id, subscription_id, amount, currency, provider, status, error_message, timestamp) to the success topic using the producer's PublishWithKey.","created_at":"2026-01-30T09:42:52.799604305Z","updated_at":null},{"id":1475,"handler_id":240,"type":"http","label":"HTTP POST to payment provider: POST /api/v1/charge","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","function_name":"Charge","description":"The gateway service forwards the charge request to the configured payment provider by issuing an HTTP POST to the provider endpoint /api/v1/charge (provider chosen by req.Provider).","created_at":"2026-01-30T09:42:52.797767512Z","updated_at":null},{"id":1479,"handler_id":240,"type":"http_response","label":"HTTP 200 OK response with ChargeResponse JSON","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","function_name":"charge","description":"If GatewayService.Charge returns a ChargeResponse without error (this includes both successful charges and handled failure responses like 'payment provider unavailable' or 'invalid provider response'), the handler returns an HTTP 200 response with the ChargeResponse JSON body to the client using response.OK.","created_at":"2026-01-30T09:42:52.804452028Z","updated_at":null},{"id":1474,"handler_id":240,"type":"http_response","label":"HTTP 400 Bad Request response (invalid JSON body)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","function_name":"charge","description":"If the request body cannot be decoded as JSON into the charge request model, the handler returns an HTTP bad request error response to the client.","created_at":"2026-01-30T09:42:52.794132217Z","updated_at":null},{"id":1473,"handler_id":240,"type":"http_response","label":"HTTP 405 Method Not Allowed response","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","function_name":"charge","description":"If the incoming request method is not POST, the handler returns an HTTP error response indicating method not allowed to the client.","created_at":"2026-01-30T09:42:52.785205509Z","updated_at":null},{"id":1478,"handler_id":240,"type":"http_response","label":"HTTP error response returned to client (validation or other error from GatewayService.Charge)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","function_name":"charge","description":"If GatewayService.Charge returns an error (for example: unsupported payment provider or invalid amount), the handler returns an HTTP error response to the client using response.Error.","created_at":"2026-01-30T09:42:52.802789675Z","updated_at":null}],"created_at":"2026-01-30T09:41:57.9757475Z","updated_at":null},{"id":241,"type":"http","method":"POST","path":"/api/v1/payments/refund","source_function_name":"RegisterRoutes","function_name":"refund","source_function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","outputs":[{"id":1472,"handler_id":241,"type":"event","label":"Publish refund event to Kafka (TopicPaymentRefunded)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:256:26","function_name":"publishRefundEvent","description":"If the provider indicates the refund succeeded (refundResp.Success == true), the gateway service publishes a refund event via the configured producer using PublishWithKey with topic kafka.TopicPaymentRefunded, the RefundID as the key, and the refund payload (refund_id, transaction_id, amount, provider, reason, status, timestamp).","created_at":"2026-01-30T09:42:47.671485233Z","updated_at":null},{"id":1470,"handler_id":241,"type":"http","label":"POST /api/v1/refund to payment provider","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","function_name":"Refund","description":"The gateway service forwards the refund request to the configured payment provider by issuing an HTTP POST to the provider path /api/v1/refund using the provider client.","created_at":"2026-01-30T09:42:47.6689497Z","updated_at":null},{"id":1471,"handler_id":241,"type":"http_response","label":"HTTP 200 JSON response with RefundResponse","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","function_name":"refund","description":"After processing, the handler returns an HTTP 200 response to the caller with the RefundResponse payload produced by the gateway service (this covers successful provider responses as well as the service-created failure responses when the provider call or response decoding fails).","created_at":"2026-01-30T09:42:47.670268023Z","updated_at":null},{"id":1467,"handler_id":241,"type":"http_response","label":"HTTP 400 Bad Request (invalid request body)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","function_name":"refund","description":"If the request body cannot be decoded as a RefundRequest JSON, the handler returns a 400 bad request error response to the client.","created_at":"2026-01-30T09:42:47.662239574Z","updated_at":null},{"id":1468,"handler_id":241,"type":"http_response","label":"HTTP 400 Bad Request (provider is required)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","function_name":"refund","description":"If the decoded RefundRequest is missing the Provider field, the handler returns a 400 bad request error response to the client.","created_at":"2026-01-30T09:42:47.666504475Z","updated_at":null},{"id":1466,"handler_id":241,"type":"http_response","label":"HTTP 405 Method Not Allowed response","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","function_name":"refund","description":"If the incoming request method is not POST, the handler returns a method-not-allowed error response to the client.","created_at":"2026-01-30T09:42:47.648237738Z","updated_at":null},{"id":1469,"handler_id":241,"type":"http_response","label":"HTTP error response (unsupported payment provider validation error)","function_id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","function_name":"refund","description":"If the gateway service determines the requested payment provider is unsupported, it returns a validation error which the handler writes back to the client as an error HTTP response.","created_at":"2026-01-30T09:42:47.667679797Z","updated_at":null}],"created_at":"2026-01-30T09:41:57.978396785Z","updated_at":null}]`),Yr={id:je,name:Je,git_repo_url:Ke,entrypoint_path:Ve,entrypoint_function:Ye,git_org_url:Qe,git_commit:Xe,created_at:en,updated_at:nn,status:rn,handlers:tn},Qr=Object.freeze(Object.defineProperty({__proto__:null,created_at:en,default:Yr,entrypoint_function:Ye,entrypoint_path:Ve,git_commit:Xe,git_org_url:Qe,git_repo_url:Ke,handlers:tn,id:je,name:Je,status:rn,updated_at:nn},Symbol.toStringTag,{value:"Module"})),an=JSON.parse('[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"payment-gateway\\", 8091)\\n\\tkafkaCfg := config.NewKafkaConfig(\\"payment-gateway-service\\")\\n\\n\\t// Payment provider URLs\\n\\tstripeURL := config.GetEnv(\\"PAYMENT_STRIPE_URL\\", \\"http://localhost:8092\\")\\n\\tbraintreeURL := config.GetEnv(\\"PAYMENT_BRAINTREE_URL\\", \\"http://localhost:8093\\")\\n\\tworldpayURL := config.GetEnv(\\"PAYMENT_WORLDPAY_URL\\", \\"http://localhost:8094\\")\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting payment gateway service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t\\tzap.String(\\"stripe_url\\", stripeURL),\\n\\t\\tzap.String(\\"braintree_url\\", braintreeURL),\\n\\t\\tzap.String(\\"worldpay_url\\", worldpayURL),\\n\\t)\\n\\n\\t// Initialize Kafka producer\\n\\tproducer := kafka.NewProducer(kafkaCfg.Brokers, cfg.Name)\\n\\tdefer producer.Close()\\n\\n\\t// Initialize service\\n\\tgatewayService := service.NewGatewayService(producer, stripeURL, braintreeURL, worldpayURL)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(gatewayService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  30 * time.Second,\\n\\t\\tWriteTimeout: 30 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"payment gateway service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt signal\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Graceful shutdown\\n\\tctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer cancel()\\n\\n\\tif err := server.Shutdown(ctx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server exited properly\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/cmd/main.go:21:1","name":"ROOT","node_type":"function"},{"code":"func NewGatewayService(\\n\\tproducer *kafka.Producer,\\n\\tstripeURL string,\\n\\tbraintreeURL string,\\n\\tworldpayURL string,\\n) *GatewayService {\\n\\tproviderURLs := map[string]string{\\n\\t\\tmodel.ProviderStripe:    stripeURL,\\n\\t\\tmodel.ProviderBraintree: braintreeURL,\\n\\t\\tmodel.ProviderWorldpay:  worldpayURL,\\n\\t}\\n\\n\\tproviderClients := make(map[string]*httpclient.Client)\\n\\tfor provider, url := range providerURLs {\\n\\t\\tproviderClients[provider] = httpclient.NewClient(url, fmt.Sprintf(\\"payment-%s\\", provider), 30*time.Second)\\n\\t}\\n\\n\\treturn &GatewayService{\\n\\t\\tproducer:        producer,\\n\\t\\tproviderClients: providerClients,\\n\\t\\tproviderURLs:    providerURLs,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:25:6","name":"NewGatewayService","node_type":"function"},{"code":"func NewHandler(gatewayService *service.GatewayService) *Handler {\\n\\treturn &Handler{\\n\\t\\tgatewayService: gatewayService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:18:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\t// Health check\\n\\tmux.HandleFunc(\\"/health\\", h.healthCheck)\\n\\n\\t// Payment routes\\n\\tmux.HandleFunc(\\"/api/v1/payments/charge\\", h.charge)\\n\\tmux.HandleFunc(\\"/api/v1/payments/refund\\", h.refund)\\n\\n\\t// Payment method routes\\n\\tmux.HandleFunc(\\"/api/v1/payment-methods\\", h.paymentMethods)\\n\\n\\t// Provider routes\\n\\tmux.HandleFunc(\\"/api/v1/providers\\", h.listProviders)\\n\\tmux.HandleFunc(\\"/api/v1/providers/health\\", h.providerHealth)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) healthCheck(w http.ResponseWriter, r *http.Request) {\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tw.Write([]byte(`{\\"status\\":\\"healthy\\",\\"service\\":\\"payment-gateway\\"}`))\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:41:19","name":"healthCheck","node_type":"function"},{"code":"func (h *Handler) charge(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.ChargeRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\t// Use default provider if not specified\\n\\tif req.Provider == \\"\\" {\\n\\t\\treq.Provider = model.ProviderStripe\\n\\t}\\n\\n\\t// Set default currency\\n\\tif req.Currency == \\"\\" {\\n\\t\\treq.Currency = \\"USD\\"\\n\\t}\\n\\n\\tresult, err := h.gatewayService.Charge(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","name":"charge","node_type":"function"},{"code":"func (s *GatewayService) Charge(ctx context.Context, req *model.ChargeRequest) (*model.ChargeResponse, error) {\\n\\t// Validate provider\\n\\tclient, ok := s.providerClients[req.Provider]\\n\\tif !ok {\\n\\t\\treturn nil, errors.ValidationError(fmt.Sprintf(\\"unsupported payment provider: %s\\", req.Provider))\\n\\t}\\n\\n\\t// Validate amount\\n\\tif req.Amount <= 0 {\\n\\t\\treturn nil, errors.ValidationError(\\"amount must be greater than zero\\")\\n\\t}\\n\\n\\tlogger.Info(\\"processing charge\\",\\n\\t\\tzap.String(\\"provider\\", req.Provider),\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t\\tzap.String(\\"currency\\", req.Currency),\\n\\t\\tzap.String(\\"user_id\\", req.UserID),\\n\\t)\\n\\n\\t// Forward request to provider\\n\\tresp, err := client.Post(ctx, \\"/api/v1/charge\\", req, nil)\\n\\tif err != nil {\\n\\t\\tlogger.Error(\\"failed to call payment provider\\",\\n\\t\\t\\tzap.String(\\"provider\\", req.Provider),\\n\\t\\t\\tzap.Error(err),\\n\\t\\t)\\n\\t\\treturn &model.ChargeResponse{\\n\\t\\t\\tSuccess:      false,\\n\\t\\t\\tStatus:       model.PaymentStatusFailed,\\n\\t\\t\\tErrorMessage: \\"payment provider unavailable\\",\\n\\t\\t}, nil\\n\\t}\\n\\n\\tvar chargeResp model.ChargeResponse\\n\\tif err := resp.DecodeJSON(&chargeResp); err != nil {\\n\\t\\tlogger.Error(\\"failed to decode provider response\\",\\n\\t\\t\\tzap.String(\\"provider\\", req.Provider),\\n\\t\\t\\tzap.Error(err),\\n\\t\\t)\\n\\t\\treturn &model.ChargeResponse{\\n\\t\\t\\tSuccess:      false,\\n\\t\\t\\tStatus:       model.PaymentStatusFailed,\\n\\t\\t\\tErrorMessage: \\"invalid provider response\\",\\n\\t\\t}, nil\\n\\t}\\n\\n\\t// Publish payment event\\n\\tif chargeResp.Success {\\n\\t\\ts.publishPaymentEvent(ctx, kafka.TopicPaymentSucceeded, kafka.EventPaymentSucceeded, req, &chargeResp)\\n\\t} else {\\n\\t\\ts.publishPaymentEvent(ctx, kafka.TopicPaymentFailed, kafka.EventPaymentFailed, req, &chargeResp)\\n\\t}\\n\\n\\treturn &chargeResp, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","name":"Charge","node_type":"function"},{"code":"func (s *GatewayService) publishPaymentEvent(ctx context.Context, topic, eventType string, req *model.ChargeRequest, resp *model.ChargeResponse) {\\n\\tevent := map[string]interface{}{\\n\\t\\t\\"transaction_id\\":  resp.TransactionID,\\n\\t\\t\\"user_id\\":         req.UserID,\\n\\t\\t\\"subscription_id\\": req.SubscriptionID,\\n\\t\\t\\"amount\\":          req.Amount,\\n\\t\\t\\"currency\\":        req.Currency,\\n\\t\\t\\"provider\\":        req.Provider,\\n\\t\\t\\"status\\":          resp.Status,\\n\\t\\t\\"error_message\\":   resp.ErrorMessage,\\n\\t\\t\\"timestamp\\":       time.Now(),\\n\\t}\\n\\n\\tkey := resp.TransactionID\\n\\tif key == \\"\\" {\\n\\t\\tkey = uuid.New().String()\\n\\t}\\n\\n\\tif err := s.producer.PublishWithKey(ctx, topic, key, eventType, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish payment event\\",\\n\\t\\t\\tzap.String(\\"topic\\", topic),\\n\\t\\t\\tzap.Error(err),\\n\\t\\t)\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","name":"publishPaymentEvent","node_type":"function"},{"code":"func (h *Handler) refund(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.RefundRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tif req.Provider == \\"\\" {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"provider is required\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tresult, err := h.gatewayService.Refund(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","name":"refund","node_type":"function"},{"code":"func (s *GatewayService) Refund(ctx context.Context, req *model.RefundRequest) (*model.RefundResponse, error) {\\n\\t// Validate provider\\n\\tclient, ok := s.providerClients[req.Provider]\\n\\tif !ok {\\n\\t\\treturn nil, errors.ValidationError(fmt.Sprintf(\\"unsupported payment provider: %s\\", req.Provider))\\n\\t}\\n\\n\\tlogger.Info(\\"processing refund\\",\\n\\t\\tzap.String(\\"provider\\", req.Provider),\\n\\t\\tzap.String(\\"transaction_id\\", req.TransactionID),\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t)\\n\\n\\t// Forward request to provider\\n\\tresp, err := client.Post(ctx, \\"/api/v1/refund\\", req, nil)\\n\\tif err != nil {\\n\\t\\tlogger.Error(\\"failed to call payment provider for refund\\",\\n\\t\\t\\tzap.String(\\"provider\\", req.Provider),\\n\\t\\t\\tzap.Error(err),\\n\\t\\t)\\n\\t\\treturn &model.RefundResponse{\\n\\t\\t\\tSuccess:      false,\\n\\t\\t\\tStatus:       model.PaymentStatusFailed,\\n\\t\\t\\tErrorMessage: \\"payment provider unavailable\\",\\n\\t\\t}, nil\\n\\t}\\n\\n\\tvar refundResp model.RefundResponse\\n\\tif err := resp.DecodeJSON(&refundResp); err != nil {\\n\\t\\treturn &model.RefundResponse{\\n\\t\\t\\tSuccess:      false,\\n\\t\\t\\tStatus:       model.PaymentStatusFailed,\\n\\t\\t\\tErrorMessage: \\"invalid provider response\\",\\n\\t\\t}, nil\\n\\t}\\n\\n\\t// Publish refund event if successful\\n\\tif refundResp.Success {\\n\\t\\ts.publishRefundEvent(ctx, req, &refundResp)\\n\\t}\\n\\n\\treturn &refundResp, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","name":"Refund","node_type":"function"},{"code":"func (s *GatewayService) publishRefundEvent(ctx context.Context, req *model.RefundRequest, resp *model.RefundResponse) {\\n\\tevent := map[string]interface{}{\\n\\t\\t\\"refund_id\\":      resp.RefundID,\\n\\t\\t\\"transaction_id\\": req.TransactionID,\\n\\t\\t\\"amount\\":         req.Amount,\\n\\t\\t\\"provider\\":       req.Provider,\\n\\t\\t\\"reason\\":         req.Reason,\\n\\t\\t\\"status\\":         resp.Status,\\n\\t\\t\\"timestamp\\":      time.Now(),\\n\\t}\\n\\n\\tif err := s.producer.PublishWithKey(ctx, kafka.TopicPaymentRefunded, resp.RefundID, kafka.EventPaymentRefunded, event); err != nil {\\n\\t\\tlogger.Error(\\"failed to publish refund event\\", zap.Error(err))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:256:26","name":"publishRefundEvent","node_type":"function"},{"code":"func (h *Handler) paymentMethods(w http.ResponseWriter, r *http.Request) {\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\tuserID := r.URL.Query().Get(\\"user_id\\")\\n\\t\\tprovider := r.URL.Query().Get(\\"provider\\")\\n\\n\\t\\tif userID == \\"\\" {\\n\\t\\t\\tresponse.Error(w, &badRequestError{message: \\"user_id is required\\"})\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tif provider == \\"\\" {\\n\\t\\t\\tprovider = model.ProviderStripe\\n\\t\\t}\\n\\n\\t\\tmethods, err := h.gatewayService.GetPaymentMethods(r.Context(), userID, provider)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, methods)\\n\\n\\tcase http.MethodPost:\\n\\t\\tvar req model.CreatePaymentMethodRequest\\n\\t\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tif req.Provider == \\"\\" {\\n\\t\\t\\treq.Provider = model.ProviderStripe\\n\\t\\t}\\n\\n\\t\\tpm, err := h.gatewayService.CreatePaymentMethod(r.Context(), &req)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.Created(w, pm)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","name":"paymentMethods","node_type":"function"},{"code":"func (s *GatewayService) GetPaymentMethods(ctx context.Context, userID string, provider string) ([]*model.PaymentMethod, error) {\\n\\t// Validate provider\\n\\tclient, ok := s.providerClients[provider]\\n\\tif !ok {\\n\\t\\treturn nil, errors.ValidationError(fmt.Sprintf(\\"unsupported payment provider: %s\\", provider))\\n\\t}\\n\\n\\t// Forward request to provider\\n\\tresp, err := client.Get(ctx, fmt.Sprintf(\\"/api/v1/payment-methods?user_id=%s\\", userID), nil)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to get payment methods\\", 500)\\n\\t}\\n\\n\\tvar methods []*model.PaymentMethod\\n\\tif err := resp.DecodeJSON(&methods); err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to decode payment methods\\", 500)\\n\\t}\\n\\n\\treturn methods, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26","name":"GetPaymentMethods","node_type":"function"},{"code":"func (s *GatewayService) CreatePaymentMethod(ctx context.Context, req *model.CreatePaymentMethodRequest) (*model.PaymentMethod, error) {\\n\\t// Validate provider\\n\\tclient, ok := s.providerClients[req.Provider]\\n\\tif !ok {\\n\\t\\treturn nil, errors.ValidationError(fmt.Sprintf(\\"unsupported payment provider: %s\\", req.Provider))\\n\\t}\\n\\n\\t// Forward request to provider\\n\\tresp, err := client.Post(ctx, \\"/api/v1/payment-methods\\", req, nil)\\n\\tif err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to create payment method\\", 500)\\n\\t}\\n\\n\\tif !resp.IsSuccess() {\\n\\t\\treturn nil, errors.InternalServerError(\\"failed to create payment method with provider\\")\\n\\t}\\n\\n\\tvar pm model.PaymentMethod\\n\\tif err := resp.DecodeJSON(&pm); err != nil {\\n\\t\\treturn nil, errors.Wrap(err, errors.CodeInternalServerError, \\"failed to decode payment method response\\", 500)\\n\\t}\\n\\n\\treturn &pm, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:152:26","name":"CreatePaymentMethod","node_type":"function"},{"code":"func (h *Handler) listProviders(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tproviders := h.gatewayService.GetSupportedProviders()\\n\\tresponse.OK(w, map[string]interface{}{\\n\\t\\t\\"providers\\": providers,\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19","name":"listProviders","node_type":"function"},{"code":"func (s *GatewayService) GetSupportedProviders() []string {\\n\\treturn []string{\\n\\t\\tmodel.ProviderStripe,\\n\\t\\tmodel.ProviderBraintree,\\n\\t\\tmodel.ProviderWorldpay,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:220:26","name":"GetSupportedProviders","node_type":"function"},{"code":"func (h *Handler) providerHealth(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\thealth := h.gatewayService.CheckProviderHealth(r.Context())\\n\\tresponse.OK(w, map[string]interface{}{\\n\\t\\t\\"providers\\": health,\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","name":"providerHealth","node_type":"function"},{"code":"func (s *GatewayService) CheckProviderHealth(ctx context.Context) []*model.ProviderHealthResponse {\\n\\tvar results []*model.ProviderHealthResponse\\n\\n\\tfor provider, client := range s.providerClients {\\n\\t\\tstart := time.Now()\\n\\t\\tresp, err := client.Get(ctx, \\"/health\\", nil)\\n\\t\\tlatency := time.Since(start).Milliseconds()\\n\\n\\t\\tresult := &model.ProviderHealthResponse{\\n\\t\\t\\tProvider:  provider,\\n\\t\\t\\tAvailable: err == nil && resp.IsSuccess(),\\n\\t\\t\\tLatency:   latency,\\n\\t\\t}\\n\\t\\tresults = append(results, result)\\n\\t}\\n\\n\\treturn results\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:200:26","name":"CheckProviderHealth","node_type":"function"}]'),on=JSON.parse('[{"column":27,"line":45,"source":"/home/evan/Code/rinder/services/payment-gateway/cmd/main.go:21:1","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:25:6","val":1},{"column":14,"line":48,"source":"/home/evan/Code/rinder/services/payment-gateway/cmd/main.go:21:1","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:18:6","val":1},{"column":3,"line":52,"source":"/home/evan/Code/rinder/services/payment-gateway/cmd/main.go:21:1","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","val":1},{"column":29,"line":26,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:41:19","val":1},{"column":45,"line":29,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","val":1},{"column":17,"line":48,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","val":1},{"column":17,"line":54,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","val":1},{"column":33,"line":68,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","val":1},{"column":26,"line":69,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","val":1},{"column":49,"line":69,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","val":1},{"column":4,"line":97,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","val":1},{"column":37,"line":246,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","val":1},{"column":42,"line":246,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","val":1},{"column":54,"line":246,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","val":1},{"column":23,"line":248,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","val":1},{"column":24,"line":97,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","val":1},{"column":87,"line":97,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","val":1},{"column":4,"line":99,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26","val":1},{"column":24,"line":99,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","val":1},{"column":81,"line":99,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26","val":1},{"column":17,"line":70,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","val":1},{"column":13,"line":74,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19","val":1},{"column":45,"line":30,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","val":1},{"column":17,"line":79,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","val":1},{"column":17,"line":85,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","val":1},{"column":17,"line":90,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","val":1},{"column":33,"line":94,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","val":1},{"column":26,"line":120,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","val":1},{"column":49,"line":120,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","val":1},{"column":4,"line":144,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:256:26","val":1},{"column":37,"line":266,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:256:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:256:26","val":1},{"column":23,"line":144,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","val":1},{"column":28,"line":144,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26","val":1},{"column":17,"line":96,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","val":1},{"column":13,"line":100,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19","val":1},{"column":45,"line":33,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","val":1},{"column":18,"line":110,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","val":1},{"column":35,"line":118,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26","val":1},{"column":85,"line":181,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26","val":1},{"column":25,"line":185,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26","val":1},{"column":80,"line":185,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26","val":1},{"column":18,"line":120,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","val":1},{"column":14,"line":123,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","val":1},{"column":18,"line":128,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","val":1},{"column":30,"line":136,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:152:26","val":1},{"column":26,"line":159,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:152:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:152:26","val":1},{"column":58,"line":159,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:152:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:152:26","val":1},{"column":18,"line":138,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","val":1},{"column":19,"line":141,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","val":1},{"column":17,"line":144,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19","val":1},{"column":39,"line":36,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19","val":1},{"column":17,"line":150,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19","val":1},{"column":31,"line":154,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:220:26","val":1},{"column":13,"line":155,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19","val":1},{"column":46,"line":37,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","val":1},{"column":17,"line":162,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","val":1},{"column":28,"line":166,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:200:26","val":1},{"column":26,"line":204,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:200:26","target":"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:200:26","val":1},{"column":13,"line":167,"source":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","target":"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19","val":1}]'),Xr={nodes:an,links:on},et=Object.freeze(Object.defineProperty({__proto__:null,default:Xr,links:on,nodes:an},Symbol.toStringTag,{value:"Module"})),nt=[{id:"/home/evan/Code/rinder/services/payment-gateway/cmd/main.go:21:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:25:6",name:"NewGatewayService",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:18:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:25:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:41:19",name:"healthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:47:19",name:"charge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:50:26",name:"Charge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:229:26",name:"publishPaymentEvent",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:78:19",name:"refund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:107:26",name:"Refund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:256:26",name:"publishRefundEvent",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:104:19",name:"paymentMethods",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:178:26",name:"GetPaymentMethods",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:152:26",name:"CreatePaymentMethod",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:149:19",name:"listProviders",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:220:26",name:"GetSupportedProviders",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/handler/handler.go:161:19",name:"providerHealth",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-gateway/internal/service/gateway_service.go:200:26",name:"CheckProviderHealth",node_type:"function"}],rt=Object.freeze(Object.defineProperty({__proto__:null,default:nt},Symbol.toStringTag,{value:"Module"})),sn=19,dn="service-payment-braintree",ln="/home/evan/Code/rinder/services/payment-braintree",cn="cmd/main.go",un="main",hn="github.com/rinder",pn=null,vn="2026-01-30T09:45:04.58756129Z",mn="2026-01-30T09:45:07.255103453Z",_n="analyzing-completed",fn=JSON.parse(`[{"id":251,"type":"http","method":"GET","path":"/api/v1/client-token","source_function_name":"RegisterRoutes","function_name":"clientToken","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","outputs":[{"id":1501,"handler_id":251,"type":"http","label":"Braintree Create Customer API call (Customer().Create)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28","function_name":"getOrCreateCustomer","description":"When generating the client token, the service ensures a Braintree customer exists. If no cached customer ID exists for the given user_id, it issues a call to the Braintree API to create a customer with CustomFields {\\"user_id\\": user_id}. This external HTTP call may fail; on failure the code creates a mock customer ID locally and does not persist it to Braintree.","created_at":"2026-01-30T09:46:10.149378503Z","updated_at":null},{"id":1502,"handler_id":251,"type":"http","label":"Braintree Generate Client Token API call (ClientToken().Generate)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28","function_name":"GenerateClientToken","description":"After ensuring (or mocking) a customer, the service calls the Braintree API to generate a client token (ClientToken().Generate). If this external call fails, the service returns a generated demo placeholder token instead of failing the request.","created_at":"2026-01-30T09:46:10.150518543Z","updated_at":null},{"id":1497,"handler_id":251,"type":"http_response","label":"HTTP 200 JSON response with client_token","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","function_name":"clientToken","description":"If request method is GET and a user_id query parameter is provided and GenerateClientToken returns a token, the handler writes an HTTP 200 response containing JSON {\\"client_token\\": \\"<token>\\"} to the client.","created_at":"2026-01-30T09:46:10.130829658Z","updated_at":null},{"id":1499,"handler_id":251,"type":"http_response","label":"HTTP 400 Bad Request response (missing user_id)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","function_name":"clientToken","description":"If the user_id query parameter is missing or empty, the handler returns an HTTP error response for a bad request (via response.Error).","created_at":"2026-01-30T09:46:10.146302033Z","updated_at":null},{"id":1498,"handler_id":251,"type":"http_response","label":"HTTP 405 Method Not Allowed response","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","function_name":"clientToken","description":"If the incoming HTTP request method is not GET, the handler returns an HTTP error response indicating method not allowed (via response.Error).","created_at":"2026-01-30T09:46:10.143434593Z","updated_at":null},{"id":1500,"handler_id":251,"type":"http_response","label":"HTTP error response from GenerateClientToken failure","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","function_name":"clientToken","description":"If BraintreeService.GenerateClientToken returns an error, the handler returns an HTTP error response to the client (via response.Error). The exact HTTP status depends on response.Error's implementation.","created_at":"2026-01-30T09:46:10.14812774Z","updated_at":null}],"created_at":"2026-01-30T09:45:33.62538803Z","updated_at":null},{"id":249,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","outputs":[{"id":1519,"handler_id":249,"type":"http","label":"HTTP request to Braintree: Create Customer","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28","function_name":"getOrCreateCustomer","description":"When creating a payment method for a user without a cached customer ID, the service invokes the Braintree client to create a Customer (s.client.Customer().Create). This is an outbound HTTP call to the Braintree API; if it fails the code falls back to creating a mock customer ID locally.","created_at":"2026-01-30T09:46:24.652842154Z","updated_at":null},{"id":1520,"handler_id":249,"type":"http","label":"HTTP request to Braintree: Create Payment Method","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:168:28","function_name":"CreatePaymentMethod","description":"During POST processing, the service calls the Braintree client's PaymentMethod().Create to create a payment method from the provided nonce/token. This is an outbound HTTP call to the Braintree API; on error the code continues and creates a mock payment method locally.","created_at":"2026-01-30T09:46:24.654198264Z","updated_at":null},{"id":1516,"handler_id":249,"type":"http_response","label":"HTTP 200 OK (GET payment methods)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"On a successful GET with a user_id, the handler returns an HTTP 200 response containing the list of payment methods (possibly empty) as the response body.","created_at":"2026-01-30T09:46:24.646267839Z","updated_at":null},{"id":1521,"handler_id":249,"type":"http_response","label":"HTTP 201 Created (payment method created)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"On successful POST processing (CreatePaymentMethod returns a payment method or a mock used as fallback), the handler returns an HTTP 201 Created response with the created payment method in the response body.","created_at":"2026-01-30T09:46:24.655547628Z","updated_at":null},{"id":1518,"handler_id":249,"type":"http_response","label":"HTTP 400 Bad Request (invalid POST body)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If the POST request body is invalid JSON and cannot be decoded into a CreatePaymentMethodRequest, the handler returns an HTTP error response (bad request).","created_at":"2026-01-30T09:46:24.650483044Z","updated_at":null},{"id":1515,"handler_id":249,"type":"http_response","label":"HTTP 400 Bad Request (missing user_id)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If the GET request is missing the required user_id query parameter, the handler returns an HTTP error response (bad request).","created_at":"2026-01-30T09:46:24.633125617Z","updated_at":null},{"id":1522,"handler_id":249,"type":"http_response","label":"HTTP error (CreatePaymentMethod failed)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If h.braintreeService.CreatePaymentMethod returns an error while processing a POST request, the handler returns an HTTP error response to the client.","created_at":"2026-01-30T09:46:24.656730187Z","updated_at":null},{"id":1517,"handler_id":249,"type":"http_response","label":"HTTP error (GetPaymentMethods failed)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If h.braintreeService.GetPaymentMethods returns an error during processing of a GET request, the handler returns an HTTP error response to the client.","created_at":"2026-01-30T09:46:24.649140695Z","updated_at":null},{"id":1523,"handler_id":249,"type":"http_response","label":"HTTP error (method not allowed)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If the request method is neither GET nor POST, the handler returns an HTTP error response indicating the method is not allowed.","created_at":"2026-01-30T09:46:24.657918532Z","updated_at":null}],"created_at":"2026-01-30T09:45:33.623149774Z","updated_at":null},{"id":246,"type":"http","method":"GET","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:40:19","outputs":[{"id":1496,"handler_id":246,"type":"http_response","label":"HTTP 200 JSON response","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:40:19","function_name":"healthCheck","description":"The HTTP handler writes a 200 OK response with Content-Type: application/json and the JSON body {\\"status\\":\\"healthy\\",\\"service\\":\\"payment-braintree\\",\\"provider\\":\\"braintree\\"}. This is returned to the client that invoked the handler.","created_at":"2026-01-30T09:45:45.646427951Z","updated_at":null}],"created_at":"2026-01-30T09:45:33.60565764Z","updated_at":null},{"id":247,"type":"http","method":"POST","path":"/api/v1/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","outputs":[{"id":1511,"handler_id":247,"type":"http","label":"Braintree Customer Create API call (Customer().Create)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28","function_name":"getOrCreateCustomer","description":"If there is no cached Braintree customer ID for the given user, the service will call the Braintree Customer Create API via s.client.Customer().Create(ctx, customerReq). This call may succeed (returning a Braintree customer ID) or fail; on failure the code generates a local mock customer ID and continues without propagating the error.","created_at":"2026-01-30T09:46:22.94712167Z","updated_at":null},{"id":1512,"handler_id":247,"type":"http","label":"Braintree Transaction Create API call (Transaction().Create)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","function_name":"Charge","description":"When a payment method token (PaymentMethodID) is provided in the request, the service will call the Braintree Transaction Create API via s.client.Transaction().Create(ctx, txnReq) to create/submit a transaction. If that API call returns an error, the code falls back to simulating a successful charge instead of returning the error.","created_at":"2026-01-30T09:46:22.948698868Z","updated_at":null},{"id":1513,"handler_id":247,"type":"http_response","label":"HTTP 200 response with ChargeResponse (success or failure payload)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","function_name":"charge","description":"On normal completion (the BraintreeService returns a ChargeResponse and nil error), the handler writes an HTTP 200 response to the client containing the ChargeResponse (success/failure/status/transaction id) in the response body.","created_at":"2026-01-30T09:46:22.950114351Z","updated_at":null},{"id":1510,"handler_id":247,"type":"http_response","label":"HTTP error response (bad request - invalid JSON body)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","function_name":"charge","description":"If the request body cannot be decoded as the expected JSON ChargeRequest, the handler writes an HTTP error response to the client indicating a bad request (invalid request body, e.g., 400).","created_at":"2026-01-30T09:46:22.944375806Z","updated_at":null},{"id":1509,"handler_id":247,"type":"http_response","label":"HTTP error response (method not allowed)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","function_name":"charge","description":"If the incoming HTTP request method is not POST, the handler writes an HTTP error response to the client indicating the method is not allowed (e.g., 405).","created_at":"2026-01-30T09:46:22.931270786Z","updated_at":null},{"id":1514,"handler_id":247,"type":"http_response","label":"HTTP error response (propagated from service error)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","function_name":"charge","description":"If h.braintreeService.Charge returns a non-nil error, the handler writes an HTTP error response to the client based on that error (status depends on response.Error implementation).","created_at":"2026-01-30T09:46:22.951481536Z","updated_at":null}],"created_at":"2026-01-30T09:45:33.617907737Z","updated_at":null},{"id":250,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","outputs":[{"id":1526,"handler_id":250,"type":"http","label":"Braintree Create Customer API call","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28","function_name":"getOrCreateCustomer","description":"When creating a payment method for a user that does not have a cached Braintree customer ID, the service calls the Braintree Customer().Create API (via the Braintree client) to create a customer with custom_fields {\\"user_id\\": userID}. If this external call fails, the code falls back to generating a mock customer ID locally.","created_at":"2026-01-30T09:46:26.29080284Z","updated_at":null},{"id":1527,"handler_id":250,"type":"http","label":"Braintree Create PaymentMethod API call","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:168:28","function_name":"CreatePaymentMethod","description":"When creating a payment method, the service calls the Braintree PaymentMethod().Create API (via the Braintree client) with a PaymentMethodRequest containing CustomerId, PaymentMethodNonce (token), and options (MakeDefault). If this external call fails, the code falls back to creating a mock payment method locally.","created_at":"2026-01-30T09:46:26.294279848Z","updated_at":null},{"id":1528,"handler_id":250,"type":"http_response","label":"HTTP 200 OK (payment methods JSON)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"For a GET /paymentMethods request with a valid user_id, the handler returns HTTP 200 with a JSON body containing the user's payment methods (an empty array if none are stored).","created_at":"2026-01-30T09:46:26.29586122Z","updated_at":null},{"id":1530,"handler_id":250,"type":"http_response","label":"HTTP 201 Created (payment method JSON)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"For a successful POST /paymentMethods request, after creating (or mock-creating) a payment method, the handler returns HTTP 201 with the created payment method as JSON in the response body.","created_at":"2026-01-30T09:46:26.298648943Z","updated_at":null},{"id":1529,"handler_id":250,"type":"http_response","label":"HTTP 400 Bad Request (invalid request body)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If a POST /paymentMethods request contains an invalid JSON body (cannot be decoded into CreatePaymentMethodRequest), the handler returns an HTTP error response indicating a bad request.","created_at":"2026-01-30T09:46:26.297300366Z","updated_at":null},{"id":1525,"handler_id":250,"type":"http_response","label":"HTTP 400 Bad Request (user_id is required)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If the GET /paymentMethods request omits the required user_id query parameter, the handler returns an HTTP error response to the client indicating a bad request.","created_at":"2026-01-30T09:46:26.278907466Z","updated_at":null},{"id":1531,"handler_id":250,"type":"http_response","label":"HTTP error response (propagated service error)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If the Braintree service methods return an error (from GetPaymentMethods or CreatePaymentMethod), the handler propagates that error back to the client as an HTTP error response (status and body determined by the error handling layer).","created_at":"2026-01-30T09:46:26.299970124Z","updated_at":null}],"created_at":"2026-01-30T09:45:33.624264962Z","updated_at":null},{"id":248,"type":"http","method":"POST","path":"/api/v1/refund","source_function_name":"RegisterRoutes","function_name":"refund","source_function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","outputs":[{"id":1504,"handler_id":248,"type":"http","label":"Braintree Transaction.Refund (full refund)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","function_name":"Refund","description":"A network call from the Braintree client to Braintree's Transaction.Refund API to issue a full refund for the given transaction ID (no amount supplied).","created_at":"2026-01-30T09:46:14.248209404Z","updated_at":null},{"id":1503,"handler_id":248,"type":"http","label":"Braintree Transaction.Refund (partial amount)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","function_name":"Refund","description":"A network call from the Braintree client to Braintree's Transaction.Refund API to issue a partial refund for the given transaction ID and amount.","created_at":"2026-01-30T09:46:14.235853574Z","updated_at":null},{"id":1505,"handler_id":248,"type":"http_response","label":"HTTP 200 JSON response (RefundResponse)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","function_name":"refund","description":"The HTTP handler writes a successful HTTP response to the client containing the RefundResponse payload (Success, RefundID, Status). This is produced when the service returns a RefundResponse and response.OK is called.","created_at":"2026-01-30T09:46:14.251731154Z","updated_at":null},{"id":1507,"handler_id":248,"type":"http_response","label":"HTTP error response (bad request - invalid JSON body)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","function_name":"refund","description":"When the request body cannot be decoded as the expected RefundRequest, the handler returns a bad-request HTTP error response to the client via response.Error.","created_at":"2026-01-30T09:46:14.255239669Z","updated_at":null},{"id":1506,"handler_id":248,"type":"http_response","label":"HTTP error response (method not allowed)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","function_name":"refund","description":"When the incoming request method is not POST, the handler returns an error HTTP response (method-not-allowed) to the client via response.Error.","created_at":"2026-01-30T09:46:14.253664553Z","updated_at":null},{"id":1508,"handler_id":248,"type":"http_response","label":"HTTP error response (service error)","function_id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","function_name":"refund","description":"If the BraintreeService.Refund call returns an error, the handler returns an HTTP error response to the client via response.Error. (Note: the BraintreeService may instead simulate a successful refund on API error and return a successful RefundResponse.)","created_at":"2026-01-30T09:46:14.256603257Z","updated_at":null}],"created_at":"2026-01-30T09:45:33.62163603Z","updated_at":null}]`),tt={id:sn,name:dn,git_repo_url:ln,entrypoint_path:cn,entrypoint_function:un,git_org_url:hn,git_commit:pn,created_at:vn,updated_at:mn,status:_n,handlers:fn},it=Object.freeze(Object.defineProperty({__proto__:null,created_at:vn,default:tt,entrypoint_function:un,entrypoint_path:cn,git_commit:pn,git_org_url:hn,git_repo_url:ln,handlers:fn,id:sn,name:dn,status:_n,updated_at:mn},Symbol.toStringTag,{value:"Module"})),gn=JSON.parse('[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"payment-braintree\\", 8093)\\n\\n\\t// Braintree credentials (use sandbox for development)\\n\\tmerchantID := config.GetEnv(\\"BRAINTREE_MERCHANT_ID\\", \\"sandbox_merchant_id\\")\\n\\tpublicKey := config.GetEnv(\\"BRAINTREE_PUBLIC_KEY\\", \\"sandbox_public_key\\")\\n\\tprivateKey := config.GetEnv(\\"BRAINTREE_PRIVATE_KEY\\", \\"sandbox_private_key\\")\\n\\tsandbox := config.GetEnv(\\"BRAINTREE_SANDBOX\\", \\"true\\") == \\"true\\"\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting Braintree payment service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t\\tzap.Bool(\\"sandbox\\", sandbox),\\n\\t)\\n\\n\\t// Initialize Braintree service\\n\\tbraintreeService := service.NewBraintreeService(merchantID, publicKey, privateKey, sandbox)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(braintreeService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  30 * time.Second,\\n\\t\\tWriteTimeout: 30 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"Braintree payment service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt signal\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Graceful shutdown\\n\\tctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer cancel()\\n\\n\\tif err := server.Shutdown(ctx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server exited properly\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/cmd/main.go:20:1","name":"ROOT","node_type":"function"},{"code":"func NewBraintreeService(merchantID, publicKey, privateKey string, sandbox bool) *BraintreeService {\\n\\tenv := braintree.Production\\n\\tif sandbox {\\n\\t\\tenv = braintree.Sandbox\\n\\t}\\n\\n\\tclient := braintree.New(env, merchantID, publicKey, privateKey)\\n\\n\\treturn &BraintreeService{\\n\\t\\tclient:         client,\\n\\t\\tcustomers:      make(map[string]string),\\n\\t\\tpaymentMethods: make(map[string][]*model.PaymentMethod),\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:24:6","name":"NewBraintreeService","node_type":"function"},{"code":"func NewHandler(braintreeService *service.BraintreeService) *Handler {\\n\\treturn &Handler{\\n\\t\\tbraintreeService: braintreeService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:18:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\t// Health check\\n\\tmux.HandleFunc(\\"/health\\", h.healthCheck)\\n\\n\\t// Payment routes\\n\\tmux.HandleFunc(\\"/api/v1/charge\\", h.charge)\\n\\tmux.HandleFunc(\\"/api/v1/refund\\", h.refund)\\n\\n\\t// Payment method routes\\n\\tmux.HandleFunc(\\"/api/v1/payment-methods\\", h.paymentMethods)\\n\\n\\t// Client token for SDK\\n\\tmux.HandleFunc(\\"/api/v1/client-token\\", h.clientToken)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) healthCheck(w http.ResponseWriter, r *http.Request) {\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tw.Write([]byte(`{\\"status\\":\\"healthy\\",\\"service\\":\\"payment-braintree\\",\\"provider\\":\\"braintree\\"}`))\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:40:19","name":"healthCheck","node_type":"function"},{"code":"func (h *Handler) charge(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.ChargeRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tif req.Currency == \\"\\" {\\n\\t\\treq.Currency = \\"USD\\"\\n\\t}\\n\\n\\tresult, err := h.braintreeService.Charge(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","name":"charge","node_type":"function"},{"code":"func (s *BraintreeService) Charge(ctx context.Context, req *model.ChargeRequest) (*model.ChargeResponse, error) {\\n\\tlogger.Info(\\"processing Braintree charge\\",\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t\\tzap.String(\\"currency\\", req.Currency),\\n\\t\\tzap.String(\\"user_id\\", req.UserID),\\n\\t)\\n\\n\\t// Get or create Braintree customer\\n\\tcustomerID, err := s.getOrCreateCustomer(ctx, req.UserID)\\n\\tif err != nil {\\n\\t\\tlogger.Error(\\"failed to get/create Braintree customer\\", zap.Error(err))\\n\\t\\treturn &model.ChargeResponse{\\n\\t\\t\\tSuccess:      false,\\n\\t\\t\\tStatus:       \\"failed\\",\\n\\t\\t\\tErrorMessage: \\"failed to process customer\\",\\n\\t\\t\\tErrorCode:    \\"customer_error\\",\\n\\t\\t}, nil\\n\\t}\\n\\n\\t// Create transaction request\\n\\ttxnReq := &braintree.TransactionRequest{\\n\\t\\tType:               \\"sale\\",\\n\\t\\tAmount:             braintree.NewDecimal(int64(req.Amount*100), 2),\\n\\t\\tCustomerID:         customerID,\\n\\t\\tOrderId:            req.SubscriptionID,\\n\\t\\tMerchantAccountId:  \\"\\", // Use default\\n\\t\\tOptions: &braintree.TransactionOptions{\\n\\t\\t\\tSubmitForSettlement: true,\\n\\t\\t},\\n\\t}\\n\\n\\t// Use payment method token if provided\\n\\tif req.PaymentMethodID != \\"\\" {\\n\\t\\ttxnReq.PaymentMethodToken = req.PaymentMethodID\\n\\t} else {\\n\\t\\t// For demo purposes without a real payment method, simulate success\\n\\t\\treturn s.simulateSuccessfulCharge(req)\\n\\t}\\n\\n\\t// Create the transaction\\n\\ttxn, err := s.client.Transaction().Create(ctx, txnReq)\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"Braintree API error, simulating success\\", zap.Error(err))\\n\\t\\treturn s.simulateSuccessfulCharge(req)\\n\\t}\\n\\n\\t// Check transaction status\\n\\tif txn.Status == braintree.TransactionStatusSubmittedForSettlement ||\\n\\t\\ttxn.Status == braintree.TransactionStatusSettled ||\\n\\t\\ttxn.Status == braintree.TransactionStatusAuthorized {\\n\\t\\treturn &model.ChargeResponse{\\n\\t\\t\\tSuccess:       true,\\n\\t\\t\\tTransactionID: txn.Id,\\n\\t\\t\\tStatus:        string(txn.Status),\\n\\t\\t}, nil\\n\\t}\\n\\n\\treturn &model.ChargeResponse{\\n\\t\\tSuccess:       false,\\n\\t\\tTransactionID: txn.Id,\\n\\t\\tStatus:        string(txn.Status),\\n\\t\\tErrorMessage:  \\"transaction not completed\\",\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","name":"Charge","node_type":"function"},{"code":"func (s *BraintreeService) getOrCreateCustomer(ctx context.Context, userID string) (string, error) {\\n\\t// Check if we have a cached customer ID\\n\\tif customerID, ok := s.customers[userID]; ok {\\n\\t\\treturn customerID, nil\\n\\t}\\n\\n\\t// Create a new Braintree customer\\n\\tcustomerReq := &braintree.CustomerRequest{\\n\\t\\tCustomFields: map[string]string{\\n\\t\\t\\t\\"user_id\\": userID,\\n\\t\\t},\\n\\t}\\n\\n\\tcustomer, err := s.client.Customer().Create(ctx, customerReq)\\n\\tif err != nil {\\n\\t\\t// For demo purposes, create a mock customer ID\\n\\t\\tmockID := uuid.New().String()[:8]\\n\\t\\ts.customers[userID] = mockID\\n\\t\\treturn mockID, nil\\n\\t}\\n\\n\\ts.customers[userID] = customer.Id\\n\\treturn customer.Id, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28","name":"getOrCreateCustomer","node_type":"function"},{"code":"func (s *BraintreeService) simulateSuccessfulCharge(req *model.ChargeRequest) (*model.ChargeResponse, error) {\\n\\t// Generate a Braintree-like transaction ID\\n\\ttxnID := uuid.New().String()[:8]\\n\\n\\tlogger.Info(\\"simulated Braintree charge successful\\",\\n\\t\\tzap.String(\\"transaction_id\\", txnID),\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t)\\n\\n\\treturn &model.ChargeResponse{\\n\\t\\tSuccess:       true,\\n\\t\\tTransactionID: txnID,\\n\\t\\tStatus:        \\"submitted_for_settlement\\",\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:106:28","name":"simulateSuccessfulCharge","node_type":"function"},{"code":"func (h *Handler) refund(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.RefundRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tresult, err := h.braintreeService.Refund(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","name":"refund","node_type":"function"},{"code":"func (s *BraintreeService) Refund(ctx context.Context, req *model.RefundRequest) (*model.RefundResponse, error) {\\n\\tlogger.Info(\\"processing Braintree refund\\",\\n\\t\\tzap.String(\\"transaction_id\\", req.TransactionID),\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t)\\n\\n\\tvar txn *braintree.Transaction\\n\\tvar err error\\n\\n\\tif req.Amount > 0 {\\n\\t\\t// Partial refund\\n\\t\\ttxn, err = s.client.Transaction().Refund(ctx, req.TransactionID, braintree.NewDecimal(int64(req.Amount*100), 2))\\n\\t} else {\\n\\t\\t// Full refund\\n\\t\\ttxn, err = s.client.Transaction().Refund(ctx, req.TransactionID)\\n\\t}\\n\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"Braintree refund API error, simulating success\\", zap.Error(err))\\n\\t\\treturn s.simulateSuccessfulRefund(req), nil\\n\\t}\\n\\n\\treturn &model.RefundResponse{\\n\\t\\tSuccess:  txn.Status == braintree.TransactionStatusSubmittedForSettlement,\\n\\t\\tRefundID: txn.Id,\\n\\t\\tStatus:   string(txn.Status),\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","name":"Refund","node_type":"function"},{"code":"func (s *BraintreeService) simulateSuccessfulRefund(req *model.RefundRequest) *model.RefundResponse {\\n\\trefundID := uuid.New().String()[:8]\\n\\n\\tlogger.Info(\\"simulated Braintree refund successful\\",\\n\\t\\tzap.String(\\"refund_id\\", refundID),\\n\\t)\\n\\n\\treturn &model.RefundResponse{\\n\\t\\tSuccess:  true,\\n\\t\\tRefundID: refundID,\\n\\t\\tStatus:   \\"submitted_for_settlement\\",\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:153:28","name":"simulateSuccessfulRefund","node_type":"function"},{"code":"func (h *Handler) paymentMethods(w http.ResponseWriter, r *http.Request) {\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\tuserID := r.URL.Query().Get(\\"user_id\\")\\n\\t\\tif userID == \\"\\" {\\n\\t\\t\\tresponse.Error(w, &badRequestError{message: \\"user_id is required\\"})\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tmethods, err := h.braintreeService.GetPaymentMethods(r.Context(), userID)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, methods)\\n\\n\\tcase http.MethodPost:\\n\\t\\tvar req model.CreatePaymentMethodRequest\\n\\t\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tpm, err := h.braintreeService.CreatePaymentMethod(r.Context(), &req)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.Created(w, pm)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","name":"paymentMethods","node_type":"function"},{"code":"func (s *BraintreeService) GetPaymentMethods(ctx context.Context, userID string) ([]*model.PaymentMethod, error) {\\n\\tmethods, ok := s.paymentMethods[userID]\\n\\tif !ok {\\n\\t\\treturn []*model.PaymentMethod{}, nil\\n\\t}\\n\\treturn methods, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:229:28","name":"GetPaymentMethods","node_type":"function"},{"code":"func (s *BraintreeService) CreatePaymentMethod(ctx context.Context, req *model.CreatePaymentMethodRequest) (*model.PaymentMethod, error) {\\n\\tlogger.Info(\\"creating Braintree payment method\\",\\n\\t\\tzap.String(\\"user_id\\", req.UserID),\\n\\t)\\n\\n\\t// Get or create customer first\\n\\tcustomerID, err := s.getOrCreateCustomer(ctx, req.UserID)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\t// In production, this would create a payment method from a nonce\\n\\tpmReq := &braintree.PaymentMethodRequest{\\n\\t\\tCustomerId:         customerID,\\n\\t\\tPaymentMethodNonce: req.Token,\\n\\t\\tOptions: &braintree.PaymentMethodRequestOptions{\\n\\t\\t\\tMakeDefault: len(s.paymentMethods[req.UserID]) == 0,\\n\\t\\t},\\n\\t}\\n\\n\\tpm, err := s.client.PaymentMethod().Create(ctx, pmReq)\\n\\tif err != nil {\\n\\t\\t// For demo, create a mock payment method\\n\\t\\tlogger.Warn(\\"Braintree payment method creation failed, creating mock\\", zap.Error(err))\\n\\t}\\n\\n\\tvar token, last4, brand string\\n\\tif pm != nil {\\n\\t\\tif cc, ok := pm.(*braintree.CreditCard); ok {\\n\\t\\t\\ttoken = cc.Token\\n\\t\\t\\tlast4 = cc.Last4\\n\\t\\t\\tbrand = cc.CardType\\n\\t\\t}\\n\\t}\\n\\n\\tif token == \\"\\" {\\n\\t\\ttoken = fmt.Sprintf(\\"bt_%s\\", uuid.New().String()[:16])\\n\\t\\tlast4 = \\"1111\\"\\n\\t\\tbrand = \\"mastercard\\"\\n\\t}\\n\\n\\tpaymentMethod := &model.PaymentMethod{\\n\\t\\tID:          token,\\n\\t\\tUserID:      req.UserID,\\n\\t\\tProvider:    \\"braintree\\",\\n\\t\\tType:        \\"card\\",\\n\\t\\tLast4:       last4,\\n\\t\\tBrand:       brand,\\n\\t\\tExpiryMonth: 12,\\n\\t\\tExpiryYear:  2028,\\n\\t\\tIsDefault:   len(s.paymentMethods[req.UserID]) == 0,\\n\\t\\tCreatedAt:   time.Now(),\\n\\t}\\n\\n\\t// Store in memory\\n\\ts.paymentMethods[req.UserID] = append(s.paymentMethods[req.UserID], paymentMethod)\\n\\n\\treturn paymentMethod, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:168:28","name":"CreatePaymentMethod","node_type":"function"},{"code":"func (h *Handler) clientToken(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodGet {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tuserID := r.URL.Query().Get(\\"user_id\\")\\n\\tif userID == \\"\\" {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"user_id is required\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\ttoken, err := h.braintreeService.GenerateClientToken(r.Context(), userID)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, map[string]string{\\n\\t\\t\\"client_token\\": token,\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","name":"clientToken","node_type":"function"},{"code":"func (s *BraintreeService) GenerateClientToken(ctx context.Context, userID string) (string, error) {\\n\\t_, err := s.getOrCreateCustomer(ctx, userID)\\n\\tif err != nil {\\n\\t\\treturn \\"\\", err\\n\\t}\\n\\n\\ttoken, err := s.client.ClientToken().Generate(ctx)\\n\\tif err != nil {\\n\\t\\t// Return a placeholder token for demo\\n\\t\\treturn \\"demo_client_token_\\" + uuid.New().String(), nil\\n\\t}\\n\\n\\treturn token, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28","name":"GenerateClientToken","node_type":"function"}]'),yn=JSON.parse('[{"column":29,"line":38,"source":"/home/evan/Code/rinder/services/payment-braintree/cmd/main.go:20:1","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:24:6","val":1},{"column":30,"line":29,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:24:6","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:24:6","val":1},{"column":42,"line":29,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:24:6","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:24:6","val":1},{"column":53,"line":29,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:24:6","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:24:6","val":1},{"column":14,"line":41,"source":"/home/evan/Code/rinder/services/payment-braintree/cmd/main.go:20:1","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:18:6","val":1},{"column":3,"line":45,"source":"/home/evan/Code/rinder/services/payment-braintree/cmd/main.go:20:1","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","val":1},{"column":29,"line":26,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:40:19","val":1},{"column":36,"line":29,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","val":1},{"column":17,"line":47,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","val":1},{"column":17,"line":53,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","val":1},{"column":35,"line":61,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","val":1},{"column":22,"line":47,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28","val":1},{"column":45,"line":250,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28","val":1},{"column":42,"line":47,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","val":1},{"column":11,"line":75,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:106:28","val":1},{"column":36,"line":75,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","val":1},{"column":43,"line":79,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","val":1},{"column":11,"line":82,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:106:28","val":1},{"column":36,"line":82,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28","val":1},{"column":17,"line":63,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","val":1},{"column":13,"line":67,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19","val":1},{"column":36,"line":30,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","val":1},{"column":17,"line":72,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","val":1},{"column":17,"line":78,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","val":1},{"column":35,"line":82,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","val":1},{"column":43,"line":133,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","val":1},{"column":43,"line":136,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","val":1},{"column":11,"line":141,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:153:28","val":1},{"column":36,"line":141,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28","val":1},{"column":17,"line":84,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","val":1},{"column":13,"line":88,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19","val":1},{"column":45,"line":33,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","val":1},{"column":18,"line":96,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","val":1},{"column":37,"line":100,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:229:28","val":1},{"column":18,"line":102,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","val":1},{"column":14,"line":105,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","val":1},{"column":18,"line":110,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","val":1},{"column":32,"line":114,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:168:28","val":1},{"column":22,"line":173,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:168:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28","val":1},{"column":42,"line":173,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:168:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:168:28","val":1},{"column":44,"line":187,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:168:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:168:28","val":1},{"column":18,"line":116,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","val":1},{"column":19,"line":119,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","val":1},{"column":17,"line":122,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19","val":1},{"column":42,"line":36,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","val":1},{"column":17,"line":128,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","val":1},{"column":17,"line":134,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","val":1},{"column":34,"line":138,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28","val":1},{"column":13,"line":264,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28","val":1},{"column":33,"line":264,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28","val":1},{"column":38,"line":264,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28","val":1},{"column":47,"line":269,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28","target":"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28","val":1},{"column":17,"line":140,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","val":1},{"column":13,"line":144,"source":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19","val":1}]'),at={nodes:gn,links:yn},ot=Object.freeze(Object.defineProperty({__proto__:null,default:at,links:yn,nodes:gn},Symbol.toStringTag,{value:"Module"})),st=[{id:"/home/evan/Code/rinder/services/payment-braintree/cmd/main.go:20:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:24:6",name:"NewBraintreeService",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:18:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:25:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:40:19",name:"healthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:46:19",name:"charge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:40:28",name:"Charge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:238:28",name:"getOrCreateCustomer",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:106:28",name:"simulateSuccessfulCharge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:71:19",name:"refund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:123:28",name:"Refund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:153:28",name:"simulateSuccessfulRefund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:92:19",name:"paymentMethods",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:229:28",name:"GetPaymentMethods",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:168:28",name:"CreatePaymentMethod",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/handler/handler.go:127:19",name:"clientToken",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-braintree/internal/service/braintree_service.go:264:28",name:"GenerateClientToken",node_type:"function"}],dt=Object.freeze(Object.defineProperty({__proto__:null,default:st},Symbol.toStringTag,{value:"Module"})),Cn=20,Tn="service-payment-stripe",bn="/home/evan/Code/rinder/services/payment-stripe",wn="cmd/main.go",Sn="main",En="github.com/rinder",In=null,Pn="2026-01-30T09:45:37.495275322Z",Rn="2026-01-30T09:45:42.262594154Z",xn="analyzing-completed",Dn=JSON.parse(`[{"id":252,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:37:19","outputs":[{"id":1524,"handler_id":252,"type":"http_response","label":"HTTP 200 JSON response","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:37:19","function_name":"healthCheck","description":"An HTTP 200 response is returned to the client with Content-Type: application/json and body '{\\"status\\":\\"healthy\\",\\"service\\":\\"payment-stripe\\",\\"provider\\":\\"stripe\\"}'.","created_at":"2026-01-30T09:46:26.096310089Z","updated_at":null}],"created_at":"2026-01-30T09:46:08.809635226Z","updated_at":null},{"id":255,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","outputs":[{"id":1533,"handler_id":255,"type":"http_response","label":"HTTP 200 OK (JSON list of payment methods)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"For a GET request with a valid 'user_id', the handler calls StripeService.GetPaymentMethods and returns an HTTP 200 OK response with a JSON array of payment methods (possibly an empty array) to the client (via response.OK).","created_at":"2026-01-30T09:46:47.422953427Z","updated_at":null},{"id":1536,"handler_id":255,"type":"http_response","label":"HTTP 201 Created (JSON payment method)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"For a valid POST request, the handler calls StripeService.CreatePaymentMethod which returns a new payment method, and the handler returns an HTTP 201 Created response with the created payment method as JSON to the client (via response.Created).","created_at":"2026-01-30T09:46:47.429989142Z","updated_at":null},{"id":1535,"handler_id":255,"type":"http_response","label":"HTTP 400 Bad Request (invalid request body)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"For a POST request whose body cannot be decoded into CreatePaymentMethodRequest (invalid JSON/body), the handler returns an HTTP 400 Bad Request error to the client (via response.Error).","created_at":"2026-01-30T09:46:47.428157015Z","updated_at":null},{"id":1532,"handler_id":255,"type":"http_response","label":"HTTP 400 Bad Request (user_id is required)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"When the handler receives a GET request without the required query parameter 'user_id', it returns an HTTP 400 Bad Request error to the client (via response.Error).","created_at":"2026-01-30T09:46:47.40989751Z","updated_at":null},{"id":1538,"handler_id":255,"type":"http_response","label":"HTTP 405 Method Not Allowed","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"If the request uses an HTTP method other than GET or POST, the handler returns an HTTP 405 Method Not Allowed error to the client (via response.Error with methodNotAllowedError).","created_at":"2026-01-30T09:46:47.433206284Z","updated_at":null},{"id":1537,"handler_id":255,"type":"http_response","label":"HTTP error response (create service error forwarded to client)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"If StripeService.CreatePaymentMethod returns an error, the handler forwards that error to the client as an HTTP error response (via response.Error).","created_at":"2026-01-30T09:46:47.43190732Z","updated_at":null},{"id":1534,"handler_id":255,"type":"http_response","label":"HTTP error response (service error forwarded to client)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"If StripeService.GetPaymentMethods returns an error, the handler forwards that error to the client as an HTTP error response (via response.Error).","created_at":"2026-01-30T09:46:47.426047557Z","updated_at":null}],"created_at":"2026-01-30T09:46:08.826425126Z","updated_at":null},{"id":253,"type":"http","method":"POST","path":"/api/v1/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19","outputs":[{"id":1546,"handler_id":253,"type":"http","label":"Stripe API: Create Customer (customer.New)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:246:25","function_name":"getOrCreateCustomer","description":"The service attempts to create a Stripe Customer by calling the Stripe API via the Stripe client library (customer.New). This is an outbound HTTP request to Stripe.","created_at":"2026-01-30T09:47:05.548245218Z","updated_at":null},{"id":1547,"handler_id":253,"type":"http","label":"Stripe API: Create PaymentIntent (paymentintent.New)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:41:25","function_name":"Charge","description":"The service creates a Stripe PaymentIntent (possibly confirming it immediately if a payment method ID is provided) by calling the Stripe API via the Stripe client library (paymentintent.New). This is an outbound HTTP request to Stripe.","created_at":"2026-01-30T09:47:05.549544425Z","updated_at":null},{"id":1549,"handler_id":253,"type":"http_response","label":"HTTP 200 JSON response (charge result)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19","function_name":"charge","description":"On successful processing (including simulated success when no payment method is provided), the handler returns an HTTP 200 response with the ChargeResponse JSON payload to the client.","created_at":"2026-01-30T09:47:05.552076732Z","updated_at":null},{"id":1545,"handler_id":253,"type":"http_response","label":"HTTP 400 Bad Request (invalid request body)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19","function_name":"charge","description":"If the request body cannot be decoded as JSON into the charge request model, the handler returns an HTTP 400-like error response to the client.","created_at":"2026-01-30T09:47:05.546385353Z","updated_at":null},{"id":1548,"handler_id":253,"type":"http_response","label":"HTTP error response (error from stripe service)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19","function_name":"charge","description":"If the stripe service returns an error result, the handler returns an HTTP error response to the client containing the error information.","created_at":"2026-01-30T09:47:05.550990918Z","updated_at":null},{"id":1544,"handler_id":253,"type":"http_response","label":"HTTP error response (method not allowed)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19","function_name":"charge","description":"If the incoming request is not POST, the handler returns an HTTP error response indicating the method is not allowed to the client.","created_at":"2026-01-30T09:47:05.5323829Z","updated_at":null}],"created_at":"2026-01-30T09:46:08.822976773Z","updated_at":null},{"id":256,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","outputs":[{"id":1554,"handler_id":256,"type":"http_response","label":"HTTP 200 OK with JSON list of payment methods (response.OK)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"On a successful GET with a user_id, the handler writes an HTTP 200 response containing the list (possibly empty) of payment methods returned by StripeService.GetPaymentMethods.","created_at":"2026-01-30T09:47:10.874637669Z","updated_at":null},{"id":1556,"handler_id":256,"type":"http_response","label":"HTTP 201 Created with created payment method (response.Created)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"On a successful POST that creates a payment method, the handler returns an HTTP 201 Created response containing the created payment method object to the HTTP client via response.Created.","created_at":"2026-01-30T09:47:10.877557199Z","updated_at":null},{"id":1552,"handler_id":256,"type":"http_response","label":"HTTP 400 Bad Request (invalid request body)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"If the POST request body cannot be decoded into model.CreatePaymentMethodRequest, the handler returns a 400 Bad Request response to the HTTP client via response.Error.","created_at":"2026-01-30T09:47:10.870120063Z","updated_at":null},{"id":1551,"handler_id":256,"type":"http_response","label":"HTTP 400 Bad Request (user_id is required)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"If the query parameter \`user_id\` is missing on a GET request, the handler returns a 400 Bad Request response to the HTTP client via response.Error.","created_at":"2026-01-30T09:47:10.857396855Z","updated_at":null},{"id":1553,"handler_id":256,"type":"http_response","label":"HTTP 405 Method Not Allowed","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"If the incoming HTTP method is not GET or POST, the handler returns a 405 Method Not Allowed response to the HTTP client via response.Error.","created_at":"2026-01-30T09:47:10.873081691Z","updated_at":null},{"id":1555,"handler_id":256,"type":"http_response","label":"HTTP error response forwarded from service (response.Error)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","function_name":"paymentMethods","description":"If h.stripeService.GetPaymentMethods or h.stripeService.CreatePaymentMethod returns an error, the handler forwards that error into an HTTP error response to the client via response.Error. (The handler does not itself convert service errors into any other external call.)","created_at":"2026-01-30T09:47:10.87628082Z","updated_at":null},{"id":1558,"handler_id":256,"type":"other","label":"Append created payment method to in-memory paymentMethods map","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:209:25","function_name":"CreatePaymentMethod","description":"StripeService.CreatePaymentMethod constructs a new payment method object and appends it to the in-memory map s.paymentMethods[req.UserID], mutating server memory (no external DB or network interaction).","created_at":"2026-01-30T09:47:10.880017703Z","updated_at":null},{"id":1557,"handler_id":256,"type":"other","label":"Read in-memory paymentMethods map","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:237:25","function_name":"GetPaymentMethods","description":"StripeService.GetPaymentMethods reads from the in-memory map s.paymentMethods[userID] and returns the slice (or an empty slice)  this is an internal in-memory read (not a DB or network call).","created_at":"2026-01-30T09:47:10.87887792Z","updated_at":null}],"created_at":"2026-01-30T09:46:08.828192422Z","updated_at":null},{"id":254,"type":"http","method":"POST","path":"/api/v1/refund","source_function_name":"RegisterRoutes","function_name":"refund","source_function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19","outputs":[{"id":1541,"handler_id":254,"type":"http","label":"HTTP request to Stripe Refund API (refund.New)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:149:25","function_name":"Refund","description":"The service calls the Stripe library to create a refund using the provided PaymentIntent (transaction id). This results in an outbound HTTP request to Stripe's Refunds API with parameters PaymentIntent, optional Amount (in cents) for partial refunds, and optional Reason. This happens when refund.New(params) succeeds (r, err := refund.New(params)).","created_at":"2026-01-30T09:46:51.179556217Z","updated_at":null},{"id":1542,"handler_id":254,"type":"http_response","label":"HTTP 200 OK response with refund result","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19","function_name":"refund","description":"When the StripeService returns a RefundResponse (either from a successful Stripe API call or a simulated successful refund), the handler writes an HTTP 200 OK response containing the refund result to the client via response.OK.","created_at":"2026-01-30T09:46:51.181084394Z","updated_at":null},{"id":1540,"handler_id":254,"type":"http_response","label":"HTTP error response (400 Bad Request - invalid JSON body)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19","function_name":"refund","description":"If the request body cannot be decoded as the expected RefundRequest JSON, the handler writes an HTTP 400-style error response to the client via response.Error.","created_at":"2026-01-30T09:46:51.17667281Z","updated_at":null},{"id":1539,"handler_id":254,"type":"http_response","label":"HTTP error response (method not allowed)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19","function_name":"refund","description":"If the incoming HTTP request method is not POST, the handler writes an HTTP error response (method not allowed) to the client via response.Error.","created_at":"2026-01-30T09:46:51.164031127Z","updated_at":null},{"id":1543,"handler_id":254,"type":"http_response","label":"HTTP error response (service error returned by StripeService)","function_id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19","function_name":"refund","description":"If StripeService.Refund returns an error (not handled by the service as a simulated success), the handler writes an HTTP error response to the client via response.Error containing that error.","created_at":"2026-01-30T09:46:51.182222758Z","updated_at":null}],"created_at":"2026-01-30T09:46:08.824562041Z","updated_at":null}]`),lt={id:Cn,name:Tn,git_repo_url:bn,entrypoint_path:wn,entrypoint_function:Sn,git_org_url:En,git_commit:In,created_at:Pn,updated_at:Rn,status:xn,handlers:Dn},ct=Object.freeze(Object.defineProperty({__proto__:null,created_at:Pn,default:lt,entrypoint_function:Sn,entrypoint_path:wn,git_commit:In,git_org_url:En,git_repo_url:bn,handlers:Dn,id:Cn,name:Tn,status:xn,updated_at:Rn},Symbol.toStringTag,{value:"Module"})),Nn=JSON.parse('[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"payment-stripe\\", 8092)\\n\\n\\t// Stripe API key (use test key for development)\\n\\tstripeAPIKey := config.GetEnv(\\"STRIPE_API_KEY\\", \\"sk_test_placeholder\\")\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting Stripe payment service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t)\\n\\n\\t// Initialize Stripe service\\n\\tstripeService := service.NewStripeService(stripeAPIKey)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(stripeService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  30 * time.Second,\\n\\t\\tWriteTimeout: 30 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"Stripe payment service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt signal\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Graceful shutdown\\n\\tctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer cancel()\\n\\n\\tif err := server.Shutdown(ctx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server exited properly\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/cmd/main.go:20:1","name":"ROOT","node_type":"function"},{"code":"func NewStripeService(apiKey string) *StripeService {\\n\\t// Set the Stripe API key globally\\n\\tstripe.Key = apiKey\\n\\n\\treturn &StripeService{\\n\\t\\tapiKey:         apiKey,\\n\\t\\tcustomers:      make(map[string]string),\\n\\t\\tpaymentMethods: make(map[string][]*model.PaymentMethod),\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:29:6","name":"NewStripeService","node_type":"function"},{"code":"func NewHandler(stripeService *service.StripeService) *Handler {\\n\\treturn &Handler{\\n\\t\\tstripeService: stripeService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:18:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\t// Health check\\n\\tmux.HandleFunc(\\"/health\\", h.healthCheck)\\n\\n\\t// Payment routes\\n\\tmux.HandleFunc(\\"/api/v1/charge\\", h.charge)\\n\\tmux.HandleFunc(\\"/api/v1/refund\\", h.refund)\\n\\n\\t// Payment method routes\\n\\tmux.HandleFunc(\\"/api/v1/payment-methods\\", h.paymentMethods)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) healthCheck(w http.ResponseWriter, r *http.Request) {\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tw.Write([]byte(`{\\"status\\":\\"healthy\\",\\"service\\":\\"payment-stripe\\",\\"provider\\":\\"stripe\\"}`))\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:37:19","name":"healthCheck","node_type":"function"},{"code":"func (h *Handler) charge(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.ChargeRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tif req.Currency == \\"\\" {\\n\\t\\treq.Currency = \\"usd\\"\\n\\t}\\n\\n\\tresult, err := h.stripeService.Charge(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19","name":"charge","node_type":"function"},{"code":"func (s *StripeService) Charge(ctx context.Context, req *model.ChargeRequest) (*model.ChargeResponse, error) {\\n\\tlogger.Info(\\"processing Stripe charge\\",\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t\\tzap.String(\\"currency\\", req.Currency),\\n\\t\\tzap.String(\\"user_id\\", req.UserID),\\n\\t)\\n\\n\\t// Convert amount to cents\\n\\tamountCents := int64(req.Amount * 100)\\n\\n\\t// Get or create Stripe customer\\n\\tcustomerID, err := s.getOrCreateCustomer(ctx, req.UserID)\\n\\tif err != nil {\\n\\t\\tlogger.Error(\\"failed to get/create Stripe customer\\", zap.Error(err))\\n\\t\\treturn &model.ChargeResponse{\\n\\t\\t\\tSuccess:      false,\\n\\t\\t\\tStatus:       \\"failed\\",\\n\\t\\t\\tErrorMessage: \\"failed to process customer\\",\\n\\t\\t\\tErrorCode:    \\"customer_error\\",\\n\\t\\t}, nil\\n\\t}\\n\\n\\t// Create PaymentIntent (Stripe\'s recommended approach)\\n\\tparams := &stripe.PaymentIntentParams{\\n\\t\\tAmount:   stripe.Int64(amountCents),\\n\\t\\tCurrency: stripe.String(req.Currency),\\n\\t\\tCustomer: stripe.String(customerID),\\n\\t\\tMetadata: make(map[string]string),\\n\\t}\\n\\n\\t// Add metadata\\n\\tif req.SubscriptionID != \\"\\" {\\n\\t\\tparams.Metadata[\\"subscription_id\\"] = req.SubscriptionID\\n\\t}\\n\\tparams.Metadata[\\"user_id\\"] = req.UserID\\n\\n\\t// Add description\\n\\tif req.Description != \\"\\" {\\n\\t\\tparams.Description = stripe.String(req.Description)\\n\\t}\\n\\n\\t// If payment method specified, attach it\\n\\tif req.PaymentMethodID != \\"\\" {\\n\\t\\tparams.PaymentMethod = stripe.String(req.PaymentMethodID)\\n\\t\\tparams.Confirm = stripe.Bool(true)\\n\\t\\tparams.OffSession = stripe.Bool(true)\\n\\t} else {\\n\\t\\t// For demo purposes without a real payment method, simulate success\\n\\t\\treturn s.simulateSuccessfulCharge(req)\\n\\t}\\n\\n\\t// Create the payment intent\\n\\tpi, err := paymentintent.New(params)\\n\\tif err != nil {\\n\\t\\tif stripeErr, ok := err.(*stripe.Error); ok {\\n\\t\\t\\tlogger.Warn(\\"Stripe API error\\",\\n\\t\\t\\t\\tzap.String(\\"code\\", string(stripeErr.Code)),\\n\\t\\t\\t\\tzap.String(\\"message\\", stripeErr.Msg),\\n\\t\\t\\t)\\n\\t\\t\\treturn &model.ChargeResponse{\\n\\t\\t\\t\\tSuccess:      false,\\n\\t\\t\\t\\tStatus:       \\"failed\\",\\n\\t\\t\\t\\tErrorMessage: stripeErr.Msg,\\n\\t\\t\\t\\tErrorCode:    string(stripeErr.Code),\\n\\t\\t\\t}, nil\\n\\t\\t}\\n\\t\\treturn &model.ChargeResponse{\\n\\t\\t\\tSuccess:      false,\\n\\t\\t\\tStatus:       \\"failed\\",\\n\\t\\t\\tErrorMessage: err.Error(),\\n\\t\\t}, nil\\n\\t}\\n\\n\\t// Check payment intent status\\n\\tif pi.Status == stripe.PaymentIntentStatusSucceeded {\\n\\t\\treturn &model.ChargeResponse{\\n\\t\\t\\tSuccess:       true,\\n\\t\\t\\tTransactionID: pi.ID,\\n\\t\\t\\tStatus:        \\"succeeded\\",\\n\\t\\t}, nil\\n\\t}\\n\\n\\treturn &model.ChargeResponse{\\n\\t\\tSuccess:       false,\\n\\t\\tTransactionID: pi.ID,\\n\\t\\tStatus:        string(pi.Status),\\n\\t\\tErrorMessage:  \\"payment not completed\\",\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:41:25","name":"Charge","node_type":"function"},{"code":"func (s *StripeService) getOrCreateCustomer(ctx context.Context, userID string) (string, error) {\\n\\t// Check if we have a cached customer ID\\n\\tif customerID, ok := s.customers[userID]; ok {\\n\\t\\treturn customerID, nil\\n\\t}\\n\\n\\t// Create a new Stripe customer\\n\\tparams := &stripe.CustomerParams{\\n\\t\\tMetadata: map[string]string{\\n\\t\\t\\t\\"user_id\\": userID,\\n\\t\\t},\\n\\t}\\n\\n\\tc, err := customer.New(params)\\n\\tif err != nil {\\n\\t\\t// For demo purposes, create a mock customer ID\\n\\t\\tmockID := fmt.Sprintf(\\"cus_%s\\", uuid.New().String()[:24])\\n\\t\\ts.customers[userID] = mockID\\n\\t\\treturn mockID, nil\\n\\t}\\n\\n\\ts.customers[userID] = c.ID\\n\\treturn c.ID, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:246:25","name":"getOrCreateCustomer","node_type":"function"},{"code":"func (s *StripeService) simulateSuccessfulCharge(req *model.ChargeRequest) (*model.ChargeResponse, error) {\\n\\t// Generate a fake Stripe-like transaction ID\\n\\ttxnID := fmt.Sprintf(\\"pi_%s\\", uuid.New().String()[:24])\\n\\n\\tlogger.Info(\\"simulated Stripe charge successful\\",\\n\\t\\tzap.String(\\"transaction_id\\", txnID),\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t)\\n\\n\\treturn &model.ChargeResponse{\\n\\t\\tSuccess:       true,\\n\\t\\tTransactionID: txnID,\\n\\t\\tStatus:        \\"succeeded\\",\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:132:25","name":"simulateSuccessfulCharge","node_type":"function"},{"code":"func (h *Handler) refund(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.RefundRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tresult, err := h.stripeService.Refund(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19","name":"refund","node_type":"function"},{"code":"func (s *StripeService) Refund(ctx context.Context, req *model.RefundRequest) (*model.RefundResponse, error) {\\n\\tlogger.Info(\\"processing Stripe refund\\",\\n\\t\\tzap.String(\\"transaction_id\\", req.TransactionID),\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t)\\n\\n\\tparams := &stripe.RefundParams{\\n\\t\\tPaymentIntent: stripe.String(req.TransactionID),\\n\\t}\\n\\n\\t// Partial refund if amount specified\\n\\tif req.Amount > 0 {\\n\\t\\tparams.Amount = stripe.Int64(int64(req.Amount * 100))\\n\\t}\\n\\n\\tif req.Reason != \\"\\" {\\n\\t\\tswitch req.Reason {\\n\\t\\tcase \\"duplicate\\":\\n\\t\\t\\tparams.Reason = stripe.String(string(stripe.RefundReasonDuplicate))\\n\\t\\tcase \\"fraudulent\\":\\n\\t\\t\\tparams.Reason = stripe.String(string(stripe.RefundReasonFraudulent))\\n\\t\\tdefault:\\n\\t\\t\\tparams.Reason = stripe.String(string(stripe.RefundReasonRequestedByCustomer))\\n\\t\\t}\\n\\t}\\n\\n\\tr, err := refund.New(params)\\n\\tif err != nil {\\n\\t\\t// For demo purposes, simulate successful refund\\n\\t\\tif stripeErr, ok := err.(*stripe.Error); ok {\\n\\t\\t\\tlogger.Warn(\\"Stripe refund API error, simulating success\\",\\n\\t\\t\\t\\tzap.String(\\"code\\", string(stripeErr.Code)),\\n\\t\\t\\t)\\n\\t\\t}\\n\\t\\treturn s.simulateSuccessfulRefund(req), nil\\n\\t}\\n\\n\\treturn &model.RefundResponse{\\n\\t\\tSuccess:  r.Status == stripe.RefundStatusSucceeded,\\n\\t\\tRefundID: r.ID,\\n\\t\\tStatus:   string(r.Status),\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:149:25","name":"Refund","node_type":"function"},{"code":"func (s *StripeService) simulateSuccessfulRefund(req *model.RefundRequest) *model.RefundResponse {\\n\\trefundID := fmt.Sprintf(\\"re_%s\\", uuid.New().String()[:24])\\n\\n\\tlogger.Info(\\"simulated Stripe refund successful\\",\\n\\t\\tzap.String(\\"refund_id\\", refundID),\\n\\t)\\n\\n\\treturn &model.RefundResponse{\\n\\t\\tSuccess:  true,\\n\\t\\tRefundID: refundID,\\n\\t\\tStatus:   \\"succeeded\\",\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:194:25","name":"simulateSuccessfulRefund","node_type":"function"},{"code":"func (h *Handler) paymentMethods(w http.ResponseWriter, r *http.Request) {\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\tuserID := r.URL.Query().Get(\\"user_id\\")\\n\\t\\tif userID == \\"\\" {\\n\\t\\t\\tresponse.Error(w, &badRequestError{message: \\"user_id is required\\"})\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tmethods, err := h.stripeService.GetPaymentMethods(r.Context(), userID)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, methods)\\n\\n\\tcase http.MethodPost:\\n\\t\\tvar req model.CreatePaymentMethodRequest\\n\\t\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tpm, err := h.stripeService.CreatePaymentMethod(r.Context(), &req)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.Created(w, pm)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19","name":"paymentMethods","node_type":"function"},{"code":"func (s *StripeService) GetPaymentMethods(ctx context.Context, userID string) ([]*model.PaymentMethod, error) {\\n\\tmethods, ok := s.paymentMethods[userID]\\n\\tif !ok {\\n\\t\\treturn []*model.PaymentMethod{}, nil\\n\\t}\\n\\treturn methods, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:237:25","name":"GetPaymentMethods","node_type":"function"},{"code":"func (s *StripeService) CreatePaymentMethod(ctx context.Context, req *model.CreatePaymentMethodRequest) (*model.PaymentMethod, error) {\\n\\tlogger.Info(\\"creating Stripe payment method\\",\\n\\t\\tzap.String(\\"user_id\\", req.UserID),\\n\\t)\\n\\n\\t// In production, this would attach a tokenized payment method to a customer\\n\\t// For demo purposes, we\'ll create a mock payment method\\n\\n\\tpm := &model.PaymentMethod{\\n\\t\\tID:          fmt.Sprintf(\\"pm_%s\\", uuid.New().String()[:24]),\\n\\t\\tUserID:      req.UserID,\\n\\t\\tProvider:    \\"stripe\\",\\n\\t\\tType:        \\"card\\",\\n\\t\\tLast4:       \\"4242\\",\\n\\t\\tBrand:       \\"visa\\",\\n\\t\\tExpiryMonth: 12,\\n\\t\\tExpiryYear:  2027,\\n\\t\\tIsDefault:   len(s.paymentMethods[req.UserID]) == 0,\\n\\t\\tCreatedAt:   time.Now(),\\n\\t}\\n\\n\\t// Store in memory\\n\\ts.paymentMethods[req.UserID] = append(s.paymentMethods[req.UserID], pm)\\n\\n\\treturn pm, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:209:25","name":"CreatePaymentMethod","node_type":"function"}]'),Hn=[{column:26,line:34,source:"/home/evan/Code/rinder/services/payment-stripe/cmd/main.go:20:1",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:29:6",val:1},{column:14,line:37,source:"/home/evan/Code/rinder/services/payment-stripe/cmd/main.go:20:1",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:18:6",val:1},{column:3,line:41,source:"/home/evan/Code/rinder/services/payment-stripe/cmd/main.go:20:1",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19",val:1},{column:29,line:26,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:37:19",val:1},{column:36,line:29,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",val:1},{column:17,line:44,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",val:1},{column:17,line:50,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",val:1},{column:32,line:58,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:41:25",val:1},{column:22,line:51,source:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:41:25",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:246:25",val:1},{column:42,line:51,source:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:41:25",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:41:25",val:1},{column:11,line:88,source:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:41:25",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:132:25",val:1},{column:36,line:88,source:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:41:25",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:41:25",val:1},{column:17,line:60,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",val:1},{column:13,line:64,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",val:1},{column:36,line:30,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",val:1},{column:17,line:69,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",val:1},{column:17,line:75,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",val:1},{column:32,line:79,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:149:25",val:1},{column:11,line:182,source:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:149:25",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:194:25",val:1},{column:36,line:182,source:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:149:25",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:149:25",val:1},{column:17,line:81,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",val:1},{column:13,line:85,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",val:1},{column:45,line:33,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",val:1},{column:18,line:93,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",val:1},{column:34,line:97,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:237:25",val:1},{column:18,line:99,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",val:1},{column:14,line:102,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",val:1},{column:18,line:107,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",val:1},{column:29,line:111,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:209:25",val:1},{column:18,line:113,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",val:1},{column:19,line:116,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",val:1},{column:17,line:119,source:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",target:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",val:1}],ut={nodes:Nn,links:Hn},ht=Object.freeze(Object.defineProperty({__proto__:null,default:ut,links:Hn,nodes:Nn},Symbol.toStringTag,{value:"Module"})),pt=[{id:"/home/evan/Code/rinder/services/payment-stripe/cmd/main.go:20:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:29:6",name:"NewStripeService",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:18:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:25:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:37:19",name:"healthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:43:19",name:"charge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:41:25",name:"Charge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:246:25",name:"getOrCreateCustomer",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:132:25",name:"simulateSuccessfulCharge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:68:19",name:"refund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:149:25",name:"Refund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:194:25",name:"simulateSuccessfulRefund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/handler/handler.go:89:19",name:"paymentMethods",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:237:25",name:"GetPaymentMethods",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-stripe/internal/service/stripe_service.go:209:25",name:"CreatePaymentMethod",node_type:"function"}],vt=Object.freeze(Object.defineProperty({__proto__:null,default:pt},Symbol.toStringTag,{value:"Module"})),qn=21,kn="service-payment-worldpay",Un="/home/evan/Code/rinder/services/payment-worldpay",Mn="cmd/main.go",On="main",An="github.com/rinder",Zn=null,Gn="2026-01-30T09:46:08.765907362Z",Bn="2026-01-30T09:46:12.265426095Z",Ln="analyzing-completed",zn=JSON.parse(`[{"id":260,"type":"http","method":"GET","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","outputs":[{"id":1577,"handler_id":260,"type":"http_response","label":"HTTP 200 OK with JSON body (response.OK)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"When a GET request is made with a valid user_id, the handler calls WorldpayService.GetPaymentMethods, and the resulting slice of payment methods is written back to the HTTP client as a 200 OK JSON response.","created_at":"2026-01-30T09:47:35.724650955Z","updated_at":null},{"id":1578,"handler_id":260,"type":"http_response","label":"HTTP 201 Created with JSON body (response.Created)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"When a POST request with a valid CreatePaymentMethodRequest body is received, the handler calls WorldpayService.CreatePaymentMethod and returns the created payment method to the HTTP client as a 201 Created JSON response.","created_at":"2026-01-30T09:47:35.73623586Z","updated_at":null},{"id":1580,"handler_id":260,"type":"http_response","label":"HTTP 400 Bad Request (invalid request body) (response.Error)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If a POST request contains an invalid JSON body that cannot be decoded to CreatePaymentMethodRequest, the handler responds to the HTTP client with a bad-request error (via response.Error).","created_at":"2026-01-30T09:47:35.73834742Z","updated_at":null},{"id":1579,"handler_id":260,"type":"http_response","label":"HTTP 400 Bad Request (missing user_id) (response.Error)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If a GET request is missing the required user_id query parameter, the handler responds to the HTTP client with a bad-request error (via response.Error).","created_at":"2026-01-30T09:47:35.737396619Z","updated_at":null},{"id":1582,"handler_id":260,"type":"http_response","label":"HTTP 405 Method Not Allowed (response.Error)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If the request method is not GET or POST, the handler responds to the HTTP client with a method-not-allowed error (via response.Error).","created_at":"2026-01-30T09:47:35.740089352Z","updated_at":null},{"id":1581,"handler_id":260,"type":"http_response","label":"HTTP Error response for service errors (response.Error)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If WorldpayService.GetPaymentMethods or WorldpayService.CreatePaymentMethod returns an error, the handler forwards an error response to the HTTP client using response.Error. (The specific HTTP status depends on the error handling implementation inside response.Error.)","created_at":"2026-01-30T09:47:35.739277143Z","updated_at":null},{"id":1583,"handler_id":260,"type":"other","label":"In-memory payment methods map updated","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:230:27","function_name":"CreatePaymentMethod","description":"CreatePaymentMethod constructs a new PaymentMethod and appends it to the service's in-memory map s.paymentMethods[userID] (an in-process state mutation). This is not an external call but is a side-effect of handling POST.","created_at":"2026-01-30T09:47:35.740943187Z","updated_at":null},{"id":1584,"handler_id":260,"type":"other","label":"Read from in-memory payment methods map","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:260:27","function_name":"GetPaymentMethods","description":"GetPaymentMethods reads the slice of payment methods for the given userID from the service's in-memory map (returns an empty slice if none exist). This is an internal read used to produce the response.","created_at":"2026-01-30T09:47:35.741851306Z","updated_at":null}],"created_at":"2026-01-30T09:46:47.505481316Z","updated_at":null},{"id":257,"type":"http","method":"GET","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:40:19","outputs":[{"id":1550,"handler_id":257,"type":"http_response","label":"HTTP 200 JSON response (Content-Type: application/json)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:40:19","function_name":"healthCheck","description":"The handler returns an HTTP 200 response to the client with Content-Type header set to application/json and the JSON body '{\\"status\\":\\"healthy\\",\\"service\\":\\"payment-worldpay\\",\\"provider\\":\\"worldpay\\"}'.","created_at":"2026-01-30T09:47:07.886897119Z","updated_at":null}],"created_at":"2026-01-30T09:46:47.501074058Z","updated_at":null},{"id":258,"type":"http","method":"POST","path":"/api/v1/charge","source_function_name":"RegisterRoutes","function_name":"charge","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","outputs":[{"id":1587,"handler_id":258,"type":"http","label":"POST {s.apiURL}/orders","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:115:27","function_name":"createOrder","description":"Outbound HTTP POST to the Worldpay API /orders endpoint. The request body is the JSON-marshaled model.WorldpayOrderRequest; request includes Content-Type: application/json and Authorization header (s.apiKey). The response body is read and unmarshaled into model.WorldpayOrderResponse.","created_at":"2026-01-30T09:47:39.44333721Z","updated_at":null},{"id":1589,"handler_id":258,"type":"http_response","label":"HTTP 200 JSON (response.OK with model.ChargeResponse)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","function_name":"charge","description":"On successful processing of the charge (either simulated success or successful/authorized Worldpay order), the handler returns an HTTP 200 response containing the model.ChargeResponse JSON (fields: Success, TransactionID, Status, optional ErrorMessage).","created_at":"2026-01-30T09:47:39.446775977Z","updated_at":null},{"id":1586,"handler_id":258,"type":"http_response","label":"HTTP 400 Bad Request (response.Error with badRequestError for invalid JSON)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","function_name":"charge","description":"If the request body cannot be decoded as JSON into model.ChargeRequest, the handler returns an HTTP Bad Request error response.","created_at":"2026-01-30T09:47:39.439915807Z","updated_at":null},{"id":1585,"handler_id":258,"type":"http_response","label":"HTTP 405 Method Not Allowed (response.Error with methodNotAllowedError)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","function_name":"charge","description":"If the incoming request uses a method other than POST, the handler returns an HTTP error response indicating Method Not Allowed.","created_at":"2026-01-30T09:47:39.4277897Z","updated_at":null},{"id":1588,"handler_id":258,"type":"http_response","label":"HTTP error response (response.Error with error from worldpayService.Charge)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","function_name":"charge","description":"If worldpayService.Charge returns an error, the handler returns an HTTP error response to the client based on that error.","created_at":"2026-01-30T09:47:39.445202788Z","updated_at":null}],"created_at":"2026-01-30T09:46:47.503507463Z","updated_at":null},{"id":261,"type":"http","method":"POST","path":"/api/v1/payment-methods","source_function_name":"RegisterRoutes","function_name":"paymentMethods","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","outputs":[{"id":1572,"handler_id":261,"type":"http_response","label":"HTTP 200 response with JSON list of payment methods","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"When handling a GET with a valid user_id, the handler returns an HTTP 200 response to the client containing the list of payment methods (possibly an empty list) returned from the service.","created_at":"2026-01-30T09:47:33.811206201Z","updated_at":null},{"id":1575,"handler_id":261,"type":"http_response","label":"HTTP 201 Created with created payment method","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"After successfully creating (mocking) a payment method in memory, the handler returns an HTTP 201 Created response to the client containing the created PaymentMethod.","created_at":"2026-01-30T09:47:33.815920826Z","updated_at":null},{"id":1573,"handler_id":261,"type":"http_response","label":"HTTP error response (400 Bad Request) - invalid request body","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If the incoming POST request body cannot be decoded as the expected CreatePaymentMethodRequest JSON, the handler returns an HTTP error response indicating an invalid request body.","created_at":"2026-01-30T09:47:33.812802946Z","updated_at":null},{"id":1570,"handler_id":261,"type":"http_response","label":"HTTP error response (400 Bad Request) - user_id is required","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If the incoming GET request does not include the required \`user_id\` query parameter, the handler returns an HTTP error response to the client indicating that \`user_id\` is required.","created_at":"2026-01-30T09:47:33.795535502Z","updated_at":null},{"id":1576,"handler_id":261,"type":"http_response","label":"HTTP error response (405 Method Not Allowed)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","function_name":"paymentMethods","description":"If the incoming request uses an HTTP method other than GET or POST, the handler returns an HTTP error response indicating the method is not allowed.","created_at":"2026-01-30T09:47:33.81753922Z","updated_at":null},{"id":1571,"handler_id":261,"type":"other","label":"Read payment methods from in-memory store","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:260:27","function_name":"GetPaymentMethods","description":"WorldpayService.GetPaymentMethods reads the service's in-memory map (s.paymentMethods) for the given userID and returns the stored slice of PaymentMethod (may be empty). This is an internal memory read (no external DB or network calls).","created_at":"2026-01-30T09:47:33.807515058Z","updated_at":null},{"id":1574,"handler_id":261,"type":"other","label":"Store new payment method in in-memory map","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:230:27","function_name":"CreatePaymentMethod","description":"WorldpayService.CreatePaymentMethod constructs a new PaymentMethod object (mock token, timestamps, etc.) and appends it to the service's in-memory map at s.paymentMethods[UserID]. This mutates in-process memory state (no external DB or network call).","created_at":"2026-01-30T09:47:33.814313691Z","updated_at":null}],"created_at":"2026-01-30T09:46:47.506292621Z","updated_at":null},{"id":259,"type":"http","method":"POST","path":"/api/v1/refund","source_function_name":"RegisterRoutes","function_name":"refund","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","outputs":[{"id":1565,"handler_id":259,"type":"http","label":"POST {apiURL}/orders/{transaction_id}/refund","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","function_name":"Refund","description":"Outbound HTTP POST to the Worldpay API endpoint /orders/{transaction_id}/refund. The request body is JSON with at least {\\"orderCode\\": transaction_id} and optionally an \\"amount\\" in minor units. Headers set: Content-Type: application/json and Authorization: s.apiKey. The request is created with http.NewRequestWithContext and executed via s.httpClient.Do.","created_at":"2026-01-30T09:47:31.747403357Z","updated_at":null},{"id":1566,"handler_id":259,"type":"http_response","label":"HTTP 200 JSON response (refund result)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","function_name":"refund","description":"On successful handling (worldpayService.Refund returns a result and no error), the handler writes an HTTP 200 response to the client containing the RefundResponse (Success, RefundID, Status) using response.OK.","created_at":"2026-01-30T09:47:31.761264212Z","updated_at":null},{"id":1568,"handler_id":259,"type":"http_response","label":"HTTP 400 Bad Request response (invalid request body)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","function_name":"refund","description":"If the request body cannot be decoded into the RefundRequest structure (JSON decode fails), the handler returns a bad-request error to the client via response.Error.","created_at":"2026-01-30T09:47:31.76578289Z","updated_at":null},{"id":1567,"handler_id":259,"type":"http_response","label":"HTTP 405 Method Not Allowed response","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","function_name":"refund","description":"If the incoming request method is not POST, the handler returns a method-not-allowed error to the client via response.Error.","created_at":"2026-01-30T09:47:31.763610267Z","updated_at":null},{"id":1569,"handler_id":259,"type":"http_response","label":"HTTP error response (service error)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","function_name":"refund","description":"If worldpayService.Refund returns an error, the handler returns an error response to the client via response.Error. (Note: in the provided Refund implementation it returns a RefundResponse and nil error in normal and simulated paths, but this branch is present in the handler.)","created_at":"2026-01-30T09:47:31.767656266Z","updated_at":null}],"created_at":"2026-01-30T09:46:47.504572371Z","updated_at":null},{"id":262,"type":"http","method":"POST","path":"/api/v1/tokens","source_function_name":"RegisterRoutes","function_name":"createToken","source_function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","outputs":[{"id":1559,"handler_id":262,"type":"http","label":"HTTP POST to {apiURL}/tokens (Worldpay token creation)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:269:27","function_name":"CreateToken","description":"A POST request is made to the Worldpay API /tokens endpoint with a JSON body containing the card paymentInstrument and with Content-Type: application/json and Authorization header set to the service apiKey. This is the external call that requests a token from Worldpay.","created_at":"2026-01-30T09:47:28.826996469Z","updated_at":null},{"id":1560,"handler_id":262,"type":"http_response","label":"HTTP 201 Created JSON response","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","function_name":"createToken","description":"On success, the handler returns an HTTP 201 Created response to the client with a JSON body {\\"token_id\\": \\"<token>\\"} containing the token (either returned by Worldpay or a locally-generated mock token).","created_at":"2026-01-30T09:47:28.840596679Z","updated_at":null},{"id":1562,"handler_id":262,"type":"http_response","label":"HTTP 400 Bad Request (invalid JSON body)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","function_name":"createToken","description":"If the request body cannot be decoded as JSON, the handler returns an HTTP error response for a bad request (response.Error with badRequestError).","created_at":"2026-01-30T09:47:28.84404541Z","updated_at":null},{"id":1563,"handler_id":262,"type":"http_response","label":"HTTP 400 Bad Request (missing payment_instrument)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","function_name":"createToken","description":"If the decoded request JSON does not include a payment_instrument, the handler returns an HTTP error response for a bad request (response.Error with badRequestError).","created_at":"2026-01-30T09:47:28.845169221Z","updated_at":null},{"id":1561,"handler_id":262,"type":"http_response","label":"HTTP error response for non-POST method (method not allowed)","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","function_name":"createToken","description":"If the incoming request method is not POST, the handler returns an HTTP error response indicating the method is not allowed (triggered by response.Error with methodNotAllowedError).","created_at":"2026-01-30T09:47:28.842562768Z","updated_at":null},{"id":1564,"handler_id":262,"type":"http_response","label":"HTTP error response when token creation fails","function_id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","function_name":"createToken","description":"If the Worldpay service returns an error from CreateToken, the handler forwards an HTTP error response to the client via response.Error(w, err). The exact status/code depends on the error and response.Error implementation.","created_at":"2026-01-30T09:47:28.84632707Z","updated_at":null}],"created_at":"2026-01-30T09:46:47.507144045Z","updated_at":null}]`),mt={id:qn,name:kn,git_repo_url:Un,entrypoint_path:Mn,entrypoint_function:On,git_org_url:An,git_commit:Zn,created_at:Gn,updated_at:Bn,status:Ln,handlers:zn},_t=Object.freeze(Object.defineProperty({__proto__:null,created_at:Gn,default:mt,entrypoint_function:On,entrypoint_path:Mn,git_commit:Zn,git_org_url:An,git_repo_url:Un,handlers:zn,id:qn,name:kn,status:Ln,updated_at:Bn},Symbol.toStringTag,{value:"Module"})),Wn=JSON.parse('[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"payment-worldpay\\", 8094)\\n\\n\\t// Worldpay credentials (use sandbox for development)\\n\\tmerchantCode := config.GetEnv(\\"WORLDPAY_MERCHANT_CODE\\", \\"sandbox_merchant\\")\\n\\tapiKey := config.GetEnv(\\"WORLDPAY_API_KEY\\", \\"sandbox_api_key\\")\\n\\tsandbox := config.GetEnv(\\"WORLDPAY_SANDBOX\\", \\"true\\") == \\"true\\"\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting Worldpay payment service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t\\tzap.Bool(\\"sandbox\\", sandbox),\\n\\t)\\n\\n\\t// Initialize Worldpay service\\n\\tworldpayService := service.NewWorldpayService(merchantCode, apiKey, sandbox)\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(worldpayService)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware\\n\\tvar httpHandler http.Handler = mux\\n\\thttpHandler = middleware.Logging(httpHandler)\\n\\thttpHandler = middleware.Recovery(httpHandler)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      httpHandler,\\n\\t\\tReadTimeout:  30 * time.Second,\\n\\t\\tWriteTimeout: 30 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"Worldpay payment service listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt signal\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Graceful shutdown\\n\\tctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer cancel()\\n\\n\\tif err := server.Shutdown(ctx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server exited properly\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/cmd/main.go:20:1","name":"ROOT","node_type":"function"},{"code":"func NewWorldpayService(merchantCode, apiKey string, sandbox bool) *WorldpayService {\\n\\tapiURL := \\"https://api.worldpay.com/v1\\"\\n\\tif sandbox {\\n\\t\\tapiURL = \\"https://api.sandbox.worldpay.com/v1\\"\\n\\t}\\n\\n\\t// Create HTTP client with reasonable timeouts\\n\\tclient := &http.Client{\\n\\t\\tTimeout: 30 * time.Second,\\n\\t\\tTransport: &http.Transport{\\n\\t\\t\\tTLSClientConfig: &tls.Config{\\n\\t\\t\\t\\tMinVersion: tls.VersionTLS12,\\n\\t\\t\\t},\\n\\t\\t},\\n\\t}\\n\\n\\treturn &WorldpayService{\\n\\t\\thttpClient:     client,\\n\\t\\tapiURL:         apiURL,\\n\\t\\tmerchantCode:   merchantCode,\\n\\t\\tapiKey:         apiKey,\\n\\t\\tcustomers:      make(map[string]string),\\n\\t\\tpaymentMethods: make(map[string][]*model.PaymentMethod),\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:31:6","name":"NewWorldpayService","node_type":"function"},{"code":"func NewHandler(worldpayService *service.WorldpayService) *Handler {\\n\\treturn &Handler{\\n\\t\\tworldpayService: worldpayService,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:18:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\t// Health check\\n\\tmux.HandleFunc(\\"/health\\", h.healthCheck)\\n\\n\\t// Payment routes\\n\\tmux.HandleFunc(\\"/api/v1/charge\\", h.charge)\\n\\tmux.HandleFunc(\\"/api/v1/refund\\", h.refund)\\n\\n\\t// Payment method routes\\n\\tmux.HandleFunc(\\"/api/v1/payment-methods\\", h.paymentMethods)\\n\\n\\t// Token creation\\n\\tmux.HandleFunc(\\"/api/v1/tokens\\", h.createToken)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) healthCheck(w http.ResponseWriter, r *http.Request) {\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tw.Write([]byte(`{\\"status\\":\\"healthy\\",\\"service\\":\\"payment-worldpay\\",\\"provider\\":\\"worldpay\\"}`))\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:40:19","name":"healthCheck","node_type":"function"},{"code":"func (h *Handler) charge(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.ChargeRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tif req.Currency == \\"\\" {\\n\\t\\treq.Currency = \\"GBP\\" // Worldpay default\\n\\t}\\n\\n\\tresult, err := h.worldpayService.Charge(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","name":"charge","node_type":"function"},{"code":"func (s *WorldpayService) Charge(ctx context.Context, req *model.ChargeRequest) (*model.ChargeResponse, error) {\\n\\tlogger.Info(\\"processing Worldpay charge\\",\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t\\tzap.String(\\"currency\\", req.Currency),\\n\\t\\tzap.String(\\"user_id\\", req.UserID),\\n\\t)\\n\\n\\t// Convert amount to minor units (cents/pence)\\n\\tamountMinor := int64(req.Amount * 100)\\n\\n\\t// Build Worldpay order request\\n\\torderReq := &model.WorldpayOrderRequest{\\n\\t\\tOrderType:        \\"ECOM\\",\\n\\t\\tOrderDescription: req.Description,\\n\\t\\tAmount:           amountMinor,\\n\\t\\tCurrencyCode:     req.Currency,\\n\\t\\tCustomerIdentifiers: &model.CustomerIdentifiers{\\n\\t\\t\\tCustomerID: req.UserID,\\n\\t\\t},\\n\\t}\\n\\n\\t// Add payment method if specified\\n\\tif req.PaymentMethodID != \\"\\" {\\n\\t\\torderReq.PaymentMethod = &model.WorldpayPaymentMethod{\\n\\t\\t\\tType:    \\"token\\",\\n\\t\\t\\tTokenID: req.PaymentMethodID,\\n\\t\\t}\\n\\t} else {\\n\\t\\t// For demo purposes without a real payment method, simulate success\\n\\t\\treturn s.simulateSuccessfulCharge(req)\\n\\t}\\n\\n\\t// Make API call\\n\\torderResp, err := s.createOrder(ctx, orderReq)\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"Worldpay API error, simulating success\\", zap.Error(err))\\n\\t\\treturn s.simulateSuccessfulCharge(req)\\n\\t}\\n\\n\\t// Check payment status\\n\\tif orderResp.PaymentStatus == \\"SUCCESS\\" || orderResp.PaymentStatus == \\"AUTHORIZED\\" {\\n\\t\\treturn &model.ChargeResponse{\\n\\t\\t\\tSuccess:       true,\\n\\t\\t\\tTransactionID: orderResp.OrderCode,\\n\\t\\t\\tStatus:        orderResp.PaymentStatus,\\n\\t\\t}, nil\\n\\t}\\n\\n\\treturn &model.ChargeResponse{\\n\\t\\tSuccess:       false,\\n\\t\\tTransactionID: orderResp.OrderCode,\\n\\t\\tStatus:        orderResp.PaymentStatus,\\n\\t\\tErrorMessage:  \\"payment not authorized\\",\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","name":"Charge","node_type":"function"},{"code":"func (s *WorldpayService) simulateSuccessfulCharge(req *model.ChargeRequest) (*model.ChargeResponse, error) {\\n\\t// Generate a Worldpay-like order code\\n\\torderCode := fmt.Sprintf(\\"WP%s\\", uuid.New().String()[:12])\\n\\n\\tlogger.Info(\\"simulated Worldpay charge successful\\",\\n\\t\\tzap.String(\\"order_code\\", orderCode),\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t)\\n\\n\\treturn &model.ChargeResponse{\\n\\t\\tSuccess:       true,\\n\\t\\tTransactionID: orderCode,\\n\\t\\tStatus:        \\"SUCCESS\\",\\n\\t}, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:149:27","name":"simulateSuccessfulCharge","node_type":"function"},{"code":"func (s *WorldpayService) createOrder(ctx context.Context, orderReq *model.WorldpayOrderRequest) (*model.WorldpayOrderResponse, error) {\\n\\tbody, err := json.Marshal(orderReq)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\treq, err := http.NewRequestWithContext(ctx, http.MethodPost, s.apiURL+\\"/orders\\", bytes.NewReader(body))\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\treq.Header.Set(\\"Content-Type\\", \\"application/json\\")\\n\\treq.Header.Set(\\"Authorization\\", s.apiKey)\\n\\n\\tresp, err := s.httpClient.Do(req)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\tdefer resp.Body.Close()\\n\\n\\trespBody, err := io.ReadAll(resp.Body)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\tvar orderResp model.WorldpayOrderResponse\\n\\tif err := json.Unmarshal(respBody, &orderResp); err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\n\\treturn &orderResp, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:115:27","name":"createOrder","node_type":"function"},{"code":"func (h *Handler) refund(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req model.RefundRequest\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tresult, err := h.worldpayService.Refund(r.Context(), &req)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.OK(w, result)\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","name":"refund","node_type":"function"},{"code":"func (s *WorldpayService) Refund(ctx context.Context, req *model.RefundRequest) (*model.RefundResponse, error) {\\n\\tlogger.Info(\\"processing Worldpay refund\\",\\n\\t\\tzap.String(\\"transaction_id\\", req.TransactionID),\\n\\t\\tzap.Float64(\\"amount\\", req.Amount),\\n\\t)\\n\\n\\t// Build refund request\\n\\trefundReq := map[string]interface{}{\\n\\t\\t\\"orderCode\\": req.TransactionID,\\n\\t}\\n\\tif req.Amount > 0 {\\n\\t\\trefundReq[\\"amount\\"] = int64(req.Amount * 100)\\n\\t}\\n\\n\\tbody, err := json.Marshal(refundReq)\\n\\tif err != nil {\\n\\t\\treturn s.simulateSuccessfulRefund(req), nil\\n\\t}\\n\\n\\thttpReq, err := http.NewRequestWithContext(ctx, http.MethodPost,\\n\\t\\tfmt.Sprintf(\\"%s/orders/%s/refund\\", s.apiURL, req.TransactionID),\\n\\t\\tbytes.NewReader(body))\\n\\tif err != nil {\\n\\t\\treturn s.simulateSuccessfulRefund(req), nil\\n\\t}\\n\\n\\thttpReq.Header.Set(\\"Content-Type\\", \\"application/json\\")\\n\\thttpReq.Header.Set(\\"Authorization\\", s.apiKey)\\n\\n\\tresp, err := s.httpClient.Do(httpReq)\\n\\tif err != nil {\\n\\t\\tlogger.Warn(\\"Worldpay refund API error, simulating success\\", zap.Error(err))\\n\\t\\treturn s.simulateSuccessfulRefund(req), nil\\n\\t}\\n\\tdefer resp.Body.Close()\\n\\n\\tif resp.StatusCode >= 200 && resp.StatusCode < 300 {\\n\\t\\trefundID := fmt.Sprintf(\\"WPR%s\\", uuid.New().String()[:10])\\n\\t\\treturn &model.RefundResponse{\\n\\t\\t\\tSuccess:  true,\\n\\t\\t\\tRefundID: refundID,\\n\\t\\t\\tStatus:   \\"SUCCESS\\",\\n\\t\\t}, nil\\n\\t}\\n\\n\\treturn s.simulateSuccessfulRefund(req), nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","name":"Refund","node_type":"function"},{"code":"func (s *WorldpayService) simulateSuccessfulRefund(req *model.RefundRequest) *model.RefundResponse {\\n\\trefundID := fmt.Sprintf(\\"WPR%s\\", uuid.New().String()[:10])\\n\\n\\tlogger.Info(\\"simulated Worldpay refund successful\\",\\n\\t\\tzap.String(\\"refund_id\\", refundID),\\n\\t)\\n\\n\\treturn &model.RefundResponse{\\n\\t\\tSuccess:  true,\\n\\t\\tRefundID: refundID,\\n\\t\\tStatus:   \\"SUCCESS\\",\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:215:27","name":"simulateSuccessfulRefund","node_type":"function"},{"code":"func (h *Handler) paymentMethods(w http.ResponseWriter, r *http.Request) {\\n\\tswitch r.Method {\\n\\tcase http.MethodGet:\\n\\t\\tuserID := r.URL.Query().Get(\\"user_id\\")\\n\\t\\tif userID == \\"\\" {\\n\\t\\t\\tresponse.Error(w, &badRequestError{message: \\"user_id is required\\"})\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tmethods, err := h.worldpayService.GetPaymentMethods(r.Context(), userID)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.OK(w, methods)\\n\\n\\tcase http.MethodPost:\\n\\t\\tvar req model.CreatePaymentMethodRequest\\n\\t\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tpm, err := h.worldpayService.CreatePaymentMethod(r.Context(), &req)\\n\\t\\tif err != nil {\\n\\t\\t\\tresponse.Error(w, err)\\n\\t\\t\\treturn\\n\\t\\t}\\n\\t\\tresponse.Created(w, pm)\\n\\n\\tdefault:\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","name":"paymentMethods","node_type":"function"},{"code":"func (s *WorldpayService) GetPaymentMethods(ctx context.Context, userID string) ([]*model.PaymentMethod, error) {\\n\\tmethods, ok := s.paymentMethods[userID]\\n\\tif !ok {\\n\\t\\treturn []*model.PaymentMethod{}, nil\\n\\t}\\n\\treturn methods, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:260:27","name":"GetPaymentMethods","node_type":"function"},{"code":"func (s *WorldpayService) CreatePaymentMethod(ctx context.Context, req *model.CreatePaymentMethodRequest) (*model.PaymentMethod, error) {\\n\\tlogger.Info(\\"creating Worldpay payment method\\",\\n\\t\\tzap.String(\\"user_id\\", req.UserID),\\n\\t)\\n\\n\\t// In production, this would call Worldpay\'s token API\\n\\t// For demo purposes, create a mock payment method\\n\\n\\ttoken := fmt.Sprintf(\\"wp_tok_%s\\", uuid.New().String()[:16])\\n\\n\\tpm := &model.PaymentMethod{\\n\\t\\tID:          token,\\n\\t\\tUserID:      req.UserID,\\n\\t\\tProvider:    \\"worldpay\\",\\n\\t\\tType:        \\"card\\",\\n\\t\\tLast4:       \\"0005\\",\\n\\t\\tBrand:       \\"amex\\",\\n\\t\\tExpiryMonth: 6,\\n\\t\\tExpiryYear:  2029,\\n\\t\\tIsDefault:   len(s.paymentMethods[req.UserID]) == 0,\\n\\t\\tCreatedAt:   time.Now(),\\n\\t}\\n\\n\\t// Store in memory\\n\\ts.paymentMethods[req.UserID] = append(s.paymentMethods[req.UserID], pm)\\n\\n\\treturn pm, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:230:27","name":"CreatePaymentMethod","node_type":"function"},{"code":"func (h *Handler) createToken(w http.ResponseWriter, r *http.Request) {\\n\\tif r.Method != http.MethodPost {\\n\\t\\tresponse.Error(w, &methodNotAllowedError{})\\n\\t\\treturn\\n\\t}\\n\\n\\tvar req struct {\\n\\t\\tUserID          string                   `json:\\"user_id\\"`\\n\\t\\tPaymentInstrument *model.PaymentInstrument `json:\\"payment_instrument\\"`\\n\\t}\\n\\tif err := json.NewDecoder(r.Body).Decode(&req); err != nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"invalid request body\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\tif req.PaymentInstrument == nil {\\n\\t\\tresponse.Error(w, &badRequestError{message: \\"payment_instrument is required\\"})\\n\\t\\treturn\\n\\t}\\n\\n\\ttoken, err := h.worldpayService.CreateToken(r.Context(), req.PaymentInstrument, req.UserID)\\n\\tif err != nil {\\n\\t\\tresponse.Error(w, err)\\n\\t\\treturn\\n\\t}\\n\\n\\tresponse.Created(w, map[string]string{\\n\\t\\t\\"token_id\\": token,\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","name":"createToken","node_type":"function"},{"code":"func (s *WorldpayService) CreateToken(ctx context.Context, instrument *model.PaymentInstrument, userID string) (string, error) {\\n\\t// Build token request (Worldpay Access token creation)\\n\\ttokenReq := map[string]interface{}{\\n\\t\\t\\"paymentMethod\\": map[string]interface{}{\\n\\t\\t\\t\\"type\\": \\"card\\",\\n\\t\\t\\t\\"paymentInstrument\\": map[string]interface{}{\\n\\t\\t\\t\\t\\"type\\":           \\"card/plain\\",\\n\\t\\t\\t\\t\\"cardHolderName\\": instrument.CardHolderName,\\n\\t\\t\\t\\t\\"cardNumber\\":     instrument.CardNumber,\\n\\t\\t\\t\\t\\"expiryMonth\\":    instrument.ExpiryMonth,\\n\\t\\t\\t\\t\\"expiryYear\\":     instrument.ExpiryYear,\\n\\t\\t\\t\\t\\"cvc\\":            instrument.Cvc,\\n\\t\\t\\t},\\n\\t\\t},\\n\\t\\t\\"reusable\\": true,\\n\\t}\\n\\n\\tbody, err := json.Marshal(tokenReq)\\n\\tif err != nil {\\n\\t\\treturn \\"\\", err\\n\\t}\\n\\n\\treq, err := http.NewRequestWithContext(ctx, http.MethodPost, s.apiURL+\\"/tokens\\", bytes.NewReader(body))\\n\\tif err != nil {\\n\\t\\treturn \\"\\", err\\n\\t}\\n\\n\\treq.Header.Set(\\"Content-Type\\", \\"application/json\\")\\n\\treq.Header.Set(\\"Authorization\\", s.apiKey)\\n\\n\\tresp, err := s.httpClient.Do(req)\\n\\tif err != nil {\\n\\t\\t// Return mock token for demo\\n\\t\\treturn fmt.Sprintf(\\"wp_tok_%s\\", uuid.New().String()[:16]), nil\\n\\t}\\n\\tdefer resp.Body.Close()\\n\\n\\tvar tokenResp struct {\\n\\t\\tTokenID string `json:\\"tokenId\\"`\\n\\t}\\n\\n\\tif err := json.NewDecoder(resp.Body).Decode(&tokenResp); err != nil {\\n\\t\\treturn fmt.Sprintf(\\"wp_tok_%s\\", uuid.New().String()[:16]), nil\\n\\t}\\n\\n\\treturn tokenResp.TokenID, nil\\n}","external":"false","id":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:269:27","name":"CreateToken","node_type":"function"}]'),Fn=JSON.parse('[{"column":28,"line":37,"source":"/home/evan/Code/rinder/services/payment-worldpay/cmd/main.go:20:1","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:31:6","val":1},{"column":14,"line":40,"source":"/home/evan/Code/rinder/services/payment-worldpay/cmd/main.go:20:1","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:18:6","val":1},{"column":3,"line":44,"source":"/home/evan/Code/rinder/services/payment-worldpay/cmd/main.go:20:1","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","val":1},{"column":29,"line":26,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:40:19","val":1},{"column":36,"line":29,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","val":1},{"column":17,"line":47,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","val":1},{"column":17,"line":53,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","val":1},{"column":34,"line":61,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","val":1},{"column":11,"line":86,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:149:27","val":1},{"column":36,"line":86,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","val":1},{"column":21,"line":90,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:115:27","val":1},{"column":27,"line":115,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:115:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:115:27","val":1},{"column":40,"line":120,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:115:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:115:27","val":1},{"column":33,"line":90,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","val":1},{"column":11,"line":93,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:149:27","val":1},{"column":36,"line":93,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27","val":1},{"column":17,"line":63,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","val":1},{"column":13,"line":67,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19","val":1},{"column":36,"line":30,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","val":1},{"column":17,"line":72,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","val":1},{"column":17,"line":78,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","val":1},{"column":34,"line":82,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","val":1},{"column":11,"line":181,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:215:27","val":1},{"column":36,"line":181,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","val":1},{"column":44,"line":184,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","val":1},{"column":11,"line":188,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:215:27","val":1},{"column":36,"line":188,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","val":1},{"column":11,"line":197,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:215:27","val":1},{"column":36,"line":197,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","val":1},{"column":10,"line":210,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:215:27","val":1},{"column":35,"line":210,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27","val":1},{"column":17,"line":84,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","val":1},{"column":13,"line":88,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19","val":1},{"column":45,"line":33,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","val":1},{"column":18,"line":96,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","val":1},{"column":36,"line":100,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:260:27","val":1},{"column":18,"line":102,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","val":1},{"column":14,"line":105,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","val":1},{"column":18,"line":110,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","val":1},{"column":31,"line":114,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:230:27","val":1},{"column":18,"line":116,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","val":1},{"column":19,"line":119,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","val":1},{"column":17,"line":122,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19","val":1},{"column":36,"line":36,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","val":1},{"column":17,"line":128,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","val":1},{"column":17,"line":137,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","val":1},{"column":17,"line":142,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","val":1},{"column":33,"line":146,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:269:27","val":1},{"column":40,"line":290,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:269:27","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:269:27","val":1},{"column":17,"line":148,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","val":1},{"column":18,"line":152,"source":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","target":"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19","val":1}]'),ft={nodes:Wn,links:Fn},gt=Object.freeze(Object.defineProperty({__proto__:null,default:ft,links:Fn,nodes:Wn},Symbol.toStringTag,{value:"Module"})),yt=[{id:"/home/evan/Code/rinder/services/payment-worldpay/cmd/main.go:20:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:31:6",name:"NewWorldpayService",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:18:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:25:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:40:19",name:"healthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:46:19",name:"charge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:58:27",name:"Charge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:149:27",name:"simulateSuccessfulCharge",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:115:27",name:"createOrder",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:71:19",name:"refund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:166:27",name:"Refund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:215:27",name:"simulateSuccessfulRefund",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:92:19",name:"paymentMethods",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:260:27",name:"GetPaymentMethods",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:230:27",name:"CreatePaymentMethod",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/handler/handler.go:127:19",name:"createToken",node_type:"function"},{id:"/home/evan/Code/rinder/services/payment-worldpay/internal/service/worldpay_service.go:269:27",name:"CreateToken",node_type:"function"}],Ct=Object.freeze(Object.defineProperty({__proto__:null,default:yt},Symbol.toStringTag,{value:"Module"})),$n=9,jn="service-gateway",Jn="/home/evan/Code/rinder/services/gateway",Kn="cmd/main.go",Vn="main",Yn="github.com/rinder",Qn=null,Xn="2026-01-21T10:18:45.644263748Z",er="2026-01-21T10:18:48.633648053Z",nr="analyzing-completed",rr=JSON.parse(`[{"id":305,"type":"http","method":"ANY","path":"/api/v1/","source_function_name":"RegisterRoutes","function_name":"routeAPI","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","outputs":[{"id":1860,"handler_id":305,"type":"http","label":"HTTP proxy to backend service","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"When a request is proxied to a registered backend service, the proxy handler invokes the backend service's http.Handler (proxy.ServeHTTP). This forwards the request to the configured backend implementation (i.e., performs the actual proxied HTTP handling to the backend service).","created_at":"2026-01-30T10:26:56.043443877Z","updated_at":null},{"id":1855,"handler_id":305,"type":"http_response","label":"HTTP 401 JSON response (Invalid authorization header format)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"When an authenticated route is hit but the Authorization header does not have the expected 'Bearer <token>' format, the gateway returns HTTP 401 with a JSON error body to the client.","created_at":"2026-01-30T10:26:56.035761611Z","updated_at":null},{"id":1856,"handler_id":305,"type":"http_response","label":"HTTP 401 JSON response (Invalid or expired token)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"When token validation fails (invalid or expired) during processing of an authenticated route, the gateway returns HTTP 401 with a JSON error body to the client.","created_at":"2026-01-30T10:26:56.038313143Z","updated_at":null},{"id":1854,"handler_id":305,"type":"http_response","label":"HTTP 401 JSON response (Missing authorization header)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"When an authenticated route is hit but the Authorization header is missing, the gateway returns HTTP 401 with a JSON error body to the client.","created_at":"2026-01-30T10:26:56.033061476Z","updated_at":null},{"id":1852,"handler_id":305,"type":"http_response","label":"HTTP 404 JSON response (Endpoint not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_name":"routeAPI","description":"If the incoming request path under /api/v1 does not match any configured route, the gateway returns an HTTP 404 response with a JSON error body to the client.","created_at":"2026-01-30T10:26:54.21630289Z","updated_at":null},{"id":1857,"handler_id":305,"type":"http_response","label":"HTTP 404 JSON response (Service not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"When proxying, if the named backend service is not registered in the proxy manager's services map, the proxy handler returns HTTP 404 with a JSON error body to the client.","created_at":"2026-01-30T10:26:56.041045484Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.967563685Z","updated_at":null},{"id":316,"type":"http","method":"ANY","path":"/api/v1/analytics","source_function_name":"routeAPI","function_name":"proxyToService","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19","outputs":[{"id":1733,"handler_id":316,"type":"http","label":"Forward HTTP request to backend service (proxy handler invoked)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"If the named service exists in the proxy manager's services map, the stored http.Handler for that service is invoked via ServeHTTP(w, r). That handler is expected to proxy/forward the incoming HTTP request (full path preserved) to the backend service, resulting in outgoing HTTP requests to that backend and the backend's HTTP response being returned to the original client.","created_at":"2026-01-30T10:26:23.021900252Z","updated_at":null},{"id":1734,"handler_id":316,"type":"http_response","label":"HTTP 404 JSON response (service not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"If the named service does not exist in the proxy manager's services map, the handler writes an HTTP 404 response with Content-Type: application/json and a JSON body: {\\"success\\":false,\\"error\\":{\\"code\\":\\"SERVICE_NOT_FOUND\\",\\"message\\":\\"Service not found\\"}}.","created_at":"2026-01-30T10:26:23.033189866Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.99214106Z","updated_at":null},{"id":306,"type":"http","method":"ANY","path":"/api/v1/auth","source_function_name":"routeAPI","function_name":"proxyToService","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19","outputs":[{"id":1843,"handler_id":306,"type":"http","label":"Request forwarded to registered service handler (proxy.ServeHTTP)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"When the requested service exists in m.services, the gateway invokes the registered service handler's ServeHTTP (proxy.ServeHTTP). That handler is responsible for performing any network calls to backend services and for writing the HTTP response back to the client. In other words, the incoming HTTP request is forwarded to the proxied handler which performs the actual external interactions.","created_at":"2026-01-30T10:26:41.011205419Z","updated_at":null},{"id":1842,"handler_id":306,"type":"http_response","label":"HTTP 404 JSON response (SERVICE_NOT_FOUND)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"If the requested service name is not registered in the proxy manager, the gateway returns an HTTP 404 response with Content-Type: application/json and a JSON body {\\"success\\":false,\\"error\\":{\\"code\\":\\"SERVICE_NOT_FOUND\\",\\"message\\":\\"Service not found\\"}}.","created_at":"2026-01-30T10:26:40.999486223Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.969361926Z","updated_at":null},{"id":312,"type":"http","method":"ANY","path":"/api/v1/matches","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[{"id":1840,"handler_id":312,"type":"http","label":"HTTP request(s) to backend service (proxied)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"When the named backend service exists, the proxy handler's ServeHTTP is invoked; that handler will perform one or more outbound HTTP request(s) to the backend service using the original request method/path. The incoming request has X-User-ID and X-User-Email headers set before proxying.","created_at":"2026-01-30T10:26:39.900936636Z","updated_at":null},{"id":1837,"handler_id":312,"type":"http_response","label":"HTTP 401 Unauthorized JSON response (invalid authorization header format)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the Authorization header is present but not in the expected \\"Bearer <token>\\" format, the handler writes a 401 response with a JSON error body and returns immediately to the client.","created_at":"2026-01-30T10:26:39.893208235Z","updated_at":null},{"id":1838,"handler_id":312,"type":"http_response","label":"HTTP 401 Unauthorized JSON response (invalid or expired token)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If JWT validation (h.jwtAuth.ValidateToken) returns an error, the handler writes a 401 response with a JSON error body and returns immediately to the client.","created_at":"2026-01-30T10:26:39.897253829Z","updated_at":null},{"id":1836,"handler_id":312,"type":"http_response","label":"HTTP 401 Unauthorized JSON response (missing authorization header)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the incoming request has no Authorization header, the handler writes a 401 response with a JSON error body and returns immediately to the client.","created_at":"2026-01-30T10:26:39.880920644Z","updated_at":null},{"id":1839,"handler_id":312,"type":"http_response","label":"HTTP 404 Not Found JSON response (service not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"When proxying, if the requested backend service name does not exist in the proxy manager's service map, the proxy handler writes a 404 response with a JSON error body to the client.","created_at":"2026-01-30T10:26:39.899354504Z","updated_at":null},{"id":1841,"handler_id":312,"type":"http_response","label":"HTTP response proxied back to original client","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"The response returned by the backend service (from the proxy's outbound HTTP request) is written back to the original client by the proxy handler (i.e., the proxied response is forwarded to the client).","created_at":"2026-01-30T10:26:39.902432972Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.978540276Z","updated_at":null},{"id":315,"type":"http","method":"ANY","path":"/api/v1/media","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[{"id":1770,"handler_id":315,"type":"http","label":"HTTP request forwarded to backend service (proxied request)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"When the token is valid and the target service exists, the gateway proxies the incoming HTTP request to the backend service handler. The proxied request is forwarded with the original path and method and includes the added headers (X-User-ID and X-User-Email). The actual network request to the backend is performed by the service's http.Handler via proxy.ServeHTTP.","created_at":"2026-01-30T10:26:27.062379985Z","updated_at":null},{"id":1767,"handler_id":315,"type":"http_response","label":"HTTP 401 JSON response (Invalid authorization header format)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the Authorization header is present but not in the expected 'Bearer <token>' format, the gateway returns an HTTP 401 response with a JSON error body indicating an invalid authorization header format.","created_at":"2026-01-30T10:26:27.057292492Z","updated_at":null},{"id":1768,"handler_id":315,"type":"http_response","label":"HTTP 401 JSON response (Invalid or expired token)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the provided bearer token fails validation (invalid or expired), the gateway returns an HTTP 401 response with a JSON error body indicating an invalid or expired token.","created_at":"2026-01-30T10:26:27.060006405Z","updated_at":null},{"id":1766,"handler_id":315,"type":"http_response","label":"HTTP 401 JSON response (Missing authorization header)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the incoming request has no Authorization header, the gateway returns an HTTP 401 response with a JSON error body indicating a missing authorization header.","created_at":"2026-01-30T10:26:27.044362478Z","updated_at":null},{"id":1769,"handler_id":315,"type":"http_response","label":"HTTP 404 JSON response (Service not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"If the requested backend service is not registered in the proxy manager (m.services), the gateway returns an HTTP 404 response with a JSON error body indicating the service was not found.","created_at":"2026-01-30T10:26:27.061317248Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.990716684Z","updated_at":null},{"id":313,"type":"http","method":"ANY","path":"/api/v1/notifications","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[{"id":1818,"handler_id":313,"type":"http","label":"Proxied HTTP request to downstream backend service","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"When a valid token is provided and a backend exists for the service, the proxy's ServeHTTP is invoked, which forwards (proxies) the incoming HTTP request to the configured backend service. This produces an outbound HTTP request to that downstream service.","created_at":"2026-01-30T10:26:32.218071452Z","updated_at":null},{"id":1814,"handler_id":313,"type":"http_response","label":"HTTP 401 JSON response (Invalid authorization header format)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the Authorization header is present but not in the expected 'Bearer <token>' format, the handler returns an HTTP 401 response with a JSON body indicating UNAUTHORIZED / Invalid authorization header format.","created_at":"2026-01-30T10:26:32.213865154Z","updated_at":null},{"id":1816,"handler_id":313,"type":"http_response","label":"HTTP 401 JSON response (Invalid or expired token)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If token validation fails (invalid or expired token), the handler returns an HTTP 401 response with a JSON body indicating UNAUTHORIZED / Invalid or expired token.","created_at":"2026-01-30T10:26:32.215756223Z","updated_at":null},{"id":1812,"handler_id":313,"type":"http_response","label":"HTTP 401 JSON response (Missing authorization header)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the incoming request has no Authorization header, the handler returns an HTTP 401 response with a JSON body indicating UNAUTHORIZED / Missing authorization header.","created_at":"2026-01-30T10:26:32.198906833Z","updated_at":null},{"id":1817,"handler_id":313,"type":"http_response","label":"HTTP 404 JSON response (Service not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"If the proxy manager has no backend registered for the requested service name, the returned handler writes an HTTP 404 response with a JSON body indicating SERVICE_NOT_FOUND.","created_at":"2026-01-30T10:26:32.217100487Z","updated_at":null},{"id":1819,"handler_id":313,"type":"http_response","label":"Proxied HTTP response forwarded to client","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"As part of proxying, the response returned by the downstream backend is written back to the original client (the proxied response is forwarded through the proxy to the client).","created_at":"2026-01-30T10:26:32.218709836Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.97975642Z","updated_at":null},{"id":309,"type":"http","method":"ANY","path":"/api/v1/profiles","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[{"id":1809,"handler_id":309,"type":"http","label":"Proxied request forwarded to backend service (via proxy.ServeHTTP)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"After successful token validation, the request (with X-User-ID and X-User-Email headers added) is forwarded to the configured backend service by invoking the service proxy's ServeHTTP. This results in an HTTP request being sent to the downstream/backend service.","created_at":"2026-01-30T10:26:32.014230571Z","updated_at":null},{"id":1807,"handler_id":309,"type":"http_response","label":"HTTP 401 Unauthorized JSON response (invalid authorization header format)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"The handler returns an HTTP 401 response to the client with a JSON body indicating the Authorization header format is invalid.","created_at":"2026-01-30T10:26:32.008492679Z","updated_at":null},{"id":1808,"handler_id":309,"type":"http_response","label":"HTTP 401 Unauthorized JSON response (invalid or expired token)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"The handler returns an HTTP 401 response to the client with a JSON body indicating the token is invalid or expired (on jwt validation failure).","created_at":"2026-01-30T10:26:32.012410804Z","updated_at":null},{"id":1806,"handler_id":309,"type":"http_response","label":"HTTP 401 Unauthorized JSON response (missing authorization header)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"The handler returns an HTTP 401 response to the client with a JSON body indicating the authorization header is missing.","created_at":"2026-01-30T10:26:31.996397792Z","updated_at":null},{"id":1810,"handler_id":309,"type":"http_response","label":"HTTP 404 Not Found JSON response (service not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"If the requested service is not registered in the proxy manager, the proxy handler returns an HTTP 404 response to the client with a JSON body indicating the service was not found.","created_at":"2026-01-30T10:26:32.015794614Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.974092421Z","updated_at":null},{"id":310,"type":"http","method":"ANY","path":"/api/v1/profiles/me","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[{"id":1848,"handler_id":310,"type":"http","label":"Outgoing HTTP request to backend service via proxy.ServeHTTP","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"When the requested service exists, the proxy's ServeHTTP is invoked which forwards the incoming HTTP request to the configured backend service (initiating an outbound HTTP request to that backend).","created_at":"2026-01-30T10:26:42.160613311Z","updated_at":null},{"id":1845,"handler_id":310,"type":"http_response","label":"HTTP 401 Unauthorized JSON (Invalid authorization header format)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the Authorization header is present but not in the expected \\"Bearer <token>\\" format, the handler returns an HTTP 401 response with a JSON error payload indicating invalid header format.","created_at":"2026-01-30T10:26:42.154207473Z","updated_at":null},{"id":1846,"handler_id":310,"type":"http_response","label":"HTTP 401 Unauthorized JSON (Invalid or expired token)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If ValidateToken returns an error (token invalid or expired), the handler returns an HTTP 401 response with a JSON error payload indicating the token is invalid or expired.","created_at":"2026-01-30T10:26:42.157170142Z","updated_at":null},{"id":1844,"handler_id":310,"type":"http_response","label":"HTTP 401 Unauthorized JSON (Missing authorization header)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the incoming request has no Authorization header, the handler returns an HTTP 401 response with a JSON error payload indicating the missing authorization header.","created_at":"2026-01-30T10:26:42.141253584Z","updated_at":null},{"id":1847,"handler_id":310,"type":"http_response","label":"HTTP 404 Not Found JSON (Service not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"When the proxy manager does not have a backend registered for the requested service name, the proxy handler returns an HTTP 404 response with a JSON error payload indicating the service was not found.","created_at":"2026-01-30T10:26:42.15900105Z","updated_at":null},{"id":1849,"handler_id":310,"type":"http_response","label":"HTTP response forwarded from backend to client by proxy","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"The proxy streams/forwards the backend service's HTTP response (status, headers, and body) back to the original client.","created_at":"2026-01-30T10:26:42.161982453Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.975572644Z","updated_at":null},{"id":311,"type":"http","method":"ANY","path":"/api/v1/swipes","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[{"id":1804,"handler_id":311,"type":"http","label":"Proxied HTTP request to backend service","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"When a valid token is provided and the requested service exists, the request is forwarded to the backend service handler (the proxied handler's ServeHTTP is invoked). The forwarded request includes the original request data and the added headers X-User-ID and X-User-Email.","created_at":"2026-01-30T10:26:31.813561158Z","updated_at":null},{"id":1801,"handler_id":311,"type":"http_response","label":"HTTP 401 Unauthorized JSON response (invalid authorization header format)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the Authorization header is present but not in the expected \\"Bearer <token>\\" format, the handler returns an HTTP 401 response with a JSON body indicating UNAUTHORIZED / Invalid authorization header format.","created_at":"2026-01-30T10:26:31.80612784Z","updated_at":null},{"id":1802,"handler_id":311,"type":"http_response","label":"HTTP 401 Unauthorized JSON response (invalid or expired token)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If token validation fails, the handler returns an HTTP 401 response with a JSON body indicating UNAUTHORIZED / Invalid or expired token.","created_at":"2026-01-30T10:26:31.808991371Z","updated_at":null},{"id":1800,"handler_id":311,"type":"http_response","label":"HTTP 401 Unauthorized JSON response (missing authorization header)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the incoming request has no Authorization header, the handler returns an HTTP 401 response with a JSON body indicating UNAUTHORIZED / Missing authorization header.","created_at":"2026-01-30T10:26:31.792064307Z","updated_at":null},{"id":1803,"handler_id":311,"type":"http_response","label":"HTTP 404 Not Found JSON response (service not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"If the proxy manager does not have an entry for the requested backend service name, the proxy handler returns an HTTP 404 response with a JSON body indicating SERVICE_NOT_FOUND / Service not found.","created_at":"2026-01-30T10:26:31.811522022Z","updated_at":null},{"id":1805,"handler_id":311,"type":"http_response","label":"Proxied backend response forwarded to client","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"The response produced by the backend service (whatever status/body it returns) is written back to the original client by the proxied handler.","created_at":"2026-01-30T10:26:31.815026152Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.977173379Z","updated_at":null},{"id":307,"type":"http","method":"ANY","path":"/api/v1/users","source_function_name":"routeAPI","function_name":"authenticatedProxy","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","outputs":[{"id":1859,"handler_id":307,"type":"http","label":"Outbound proxied HTTP request to backend service","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"When authentication succeeds and the requested service exists, the request is forwarded to the registered service handler (m.services[serviceName]). That handler (the proxied backend handler) will perform an outbound HTTP request to the backend service as part of proxying the incoming request. The request forwarded to the backend will include the added headers (X-User-ID and X-User-Email). (The invocation that triggers this is the call to proxy.ServeHTTP.)","created_at":"2026-01-30T10:26:56.045268444Z","updated_at":null},{"id":1851,"handler_id":307,"type":"http_response","label":"HTTP 401 JSON response (invalid authorization header format)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the incoming Authorization header is present but not in the expected 'Bearer <token>' format, the handler returns an HTTP 401 response with a JSON error body indicating an invalid authorization header format.","created_at":"2026-01-30T10:26:56.025693402Z","updated_at":null},{"id":1853,"handler_id":307,"type":"http_response","label":"HTTP 401 JSON response (invalid or expired token)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the JWT validation fails (invalid or expired token), the handler returns an HTTP 401 response with a JSON error body indicating an invalid or expired token.","created_at":"2026-01-30T10:26:56.029610956Z","updated_at":null},{"id":1850,"handler_id":307,"type":"http_response","label":"HTTP 401 JSON response (missing authorization header)","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","function_name":"authenticatedProxy","description":"If the incoming request has no Authorization header, the handler returns an HTTP 401 response with a JSON error body indicating a missing authorization header.","created_at":"2026-01-30T10:26:54.276596035Z","updated_at":null},{"id":1858,"handler_id":307,"type":"http_response","label":"HTTP 404 JSON response (service not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"If the requested backend service name is not registered in the proxy manager's services map, the proxy handler returns an HTTP 404 response with a JSON error body indicating the service was not found.","created_at":"2026-01-30T10:26:56.034411413Z","updated_at":null},{"id":1861,"handler_id":307,"type":"http_response","label":"HTTP response streamed back to client from proxied backend","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"After the proxied handler forwards the request to the backend, the backend's HTTP response is streamed/returned and written to the original client's ResponseWriter. This is performed by the proxied service handler which is invoked via proxy.ServeHTTP.","created_at":"2026-01-30T10:26:56.066361394Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.970928085Z","updated_at":null},{"id":303,"type":"http","method":"ANY","path":"/health","source_function_name":"RegisterRoutes","function_name":"healthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:35:19","outputs":[{"id":1625,"handler_id":303,"type":"http_response","label":"HTTP 200 JSON response","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:35:19","function_name":"healthCheck","description":"Returns an HTTP 200 response to the client with Content-Type 'application/json' and body '{\\"status\\":\\"healthy\\",\\"service\\":\\"gateway\\"}'.","created_at":"2026-01-30T10:26:00.850545412Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.951578048Z","updated_at":null},{"id":304,"type":"http","method":"ANY","path":"/health/services","source_function_name":"RegisterRoutes","function_name":"HealthCheck","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","outputs":[{"id":1659,"handler_id":304,"type":"http","label":"HTTP GET {service_url}/health (for each entry in m.urls)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","function_name":"HealthCheck","description":"For each configured backend URL in m.urls, the handler performs an HTTP GET request to that service's /health endpoint (healthURL := url + \\"/health\\"). The code treats any network error or any response with a non-200 status as the service being unhealthy.","created_at":"2026-01-30T10:26:10.630894848Z","updated_at":null},{"id":1661,"handler_id":304,"type":"http_response","label":"HTTP JSON response to the client (200 OK or 503 Service Unavailable)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","function_name":"HealthCheck","description":"The handler returns an HTTP response to the original client: it sets the Content-Type header to application/json, writes status 200 OK if all backend health checks returned 200, otherwise writes status 503 Service Unavailable. The body is a small JSON document of the form {\\"gateway\\":\\"healthy\\",\\"services\\":{...}} where each service name maps to \\"healthy\\" or \\"unhealthy\\".","created_at":"2026-01-30T10:26:10.643314352Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.964456759Z","updated_at":null},{"id":314,"type":"http","method":"GET","path":"/api/v1/media","source_function_name":"routeAPI","function_name":"proxyToService","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19","outputs":[{"id":1813,"handler_id":314,"type":"http","label":"Proxied HTTP request to backend service","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"If the named service exists, the proxy handler delegates the request to the configured service proxy (proxy.ServeHTTP). That delegation results in the incoming HTTP request being forwarded to the backend service configured in m.services[serviceName] (i.e., an outbound HTTP request from this gateway to the backend service).","created_at":"2026-01-30T10:26:32.210229806Z","updated_at":null},{"id":1811,"handler_id":314,"type":"http_response","label":"HTTP 404 JSON response (service not found)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"If the named service is not registered in the proxy manager (m.services[serviceName] does not exist), the proxy handler writes an HTTP 404 response with Content-Type: application/json and the JSON body: {\\"success\\":false,\\"error\\":{\\"code\\":\\"SERVICE_NOT_FOUND\\",\\"message\\":\\"Service not found\\"}}.","created_at":"2026-01-30T10:26:32.198824724Z","updated_at":null},{"id":1815,"handler_id":314,"type":"http_response","label":"HTTP response returned to the original client (proxied backend response)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","function_name":"Proxy","description":"As part of proxy.ServeHTTP handling, the response produced by the backend service (status, headers, body) is written back to the original http.ResponseWriter so the client receives the backend's HTTP response via the gateway.","created_at":"2026-01-30T10:26:32.214945004Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.987642365Z","updated_at":null},{"id":308,"type":"http","method":"GET","path":"/api/v1/profiles","source_function_name":"routeAPI","function_name":"proxyToService","source_function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","function_id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19","outputs":[{"id":1772,"handler_id":308,"type":"http","label":"Outgoing proxied HTTP request(s) to backend service","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"When the requested service is registered, the proxy handler forwards the incoming HTTP request to the backend service by invoking the stored proxy handler (proxy.ServeHTTP). This produces one or more outbound HTTP request(s) from this gateway to the target backend service (exact requests depend on the proxy implementation and configuration).","created_at":"2026-01-30T10:26:28.107746164Z","updated_at":null},{"id":1771,"handler_id":308,"type":"http_response","label":"HTTP 404 JSON response (SERVICE_NOT_FOUND)","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"If the requested service name is not registered in the proxy manager, the gateway returns an HTTP 404 response with Content-Type: application/json and the JSON body {\\"success\\":false,\\"error\\":{\\"code\\":\\"SERVICE_NOT_FOUND\\",\\"message\\":\\"Service not found\\"}}.","created_at":"2026-01-30T10:26:28.105378839Z","updated_at":null},{"id":1773,"handler_id":308,"type":"http_response","label":"HTTP response proxied from backend to client","function_id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","function_name":"anonymous-uDivQbIDR","description":"The response received from the backend service (resulting from the proxied outbound request(s)) is written back to the original client by the proxy handler (i.e., the gateway returns the proxied response to the client).","created_at":"2026-01-30T10:26:28.109221141Z","updated_at":null}],"created_at":"2026-01-30T10:25:47.972399931Z","updated_at":null}]`),Tt={id:$n,name:jn,git_repo_url:Jn,entrypoint_path:Kn,entrypoint_function:Vn,git_org_url:Yn,git_commit:Qn,created_at:Xn,updated_at:er,status:nr,handlers:rr},bt=Object.freeze(Object.defineProperty({__proto__:null,created_at:Xn,default:Tt,entrypoint_function:Vn,entrypoint_path:Kn,git_commit:Qn,git_org_url:Yn,git_repo_url:Jn,handlers:rr,id:$n,name:jn,status:nr,updated_at:er},Symbol.toStringTag,{value:"Module"})),tr=JSON.parse('[{"code":"func main() {\\n\\t// Load configuration\\n\\tcfg := config.NewServiceConfig(\\"gateway\\", 8080)\\n\\tjwtCfg := config.NewJWTConfig()\\n\\n\\t// Initialize logger\\n\\tlogger.Init(cfg.Name, cfg.LogLevel)\\n\\tlogger.Info(\\"starting gateway service\\",\\n\\t\\tzap.Int(\\"port\\", cfg.Port),\\n\\t\\tzap.String(\\"environment\\", cfg.Environment),\\n\\t)\\n\\n\\t// Initialize JWT auth\\n\\tjwtAuth := middleware.NewJWTAuth(jwtCfg.Secret)\\n\\n\\t// Initialize service proxies\\n\\tuserServiceURL := config.GetEnv(\\"USER_SERVICE_URL\\", \\"http://localhost:8081\\")\\n\\tprofileServiceURL := config.GetEnv(\\"PROFILE_SERVICE_URL\\", \\"http://localhost:8082\\")\\n\\tmatchingServiceURL := config.GetEnv(\\"MATCHING_SERVICE_URL\\", \\"http://localhost:8083\\")\\n\\tnotificationServiceURL := config.GetEnv(\\"NOTIFICATION_SERVICE_URL\\", \\"http://localhost:8084\\")\\n\\tmediaServiceURL := config.GetEnv(\\"MEDIA_SERVICE_URL\\", \\"http://localhost:8086\\")\\n\\tanalyticsServiceURL := config.GetEnv(\\"ANALYTICS_SERVICE_URL\\", \\"http://localhost:8087\\")\\n\\n\\tproxyManager := proxy.NewManager(map[string]string{\\n\\t\\t\\"user\\":         userServiceURL,\\n\\t\\t\\"profile\\":      profileServiceURL,\\n\\t\\t\\"matching\\":     matchingServiceURL,\\n\\t\\t\\"notification\\": notificationServiceURL,\\n\\t\\t\\"media\\":        mediaServiceURL,\\n\\t\\t\\"analytics\\":    analyticsServiceURL,\\n\\t})\\n\\n\\t// Initialize handler\\n\\th := handler.NewHandler(proxyManager, jwtAuth)\\n\\n\\t// Setup routes\\n\\tmux := http.NewServeMux()\\n\\th.RegisterRoutes(mux)\\n\\n\\t// Apply middleware\\n\\tvar handler http.Handler = mux\\n\\thandler = middleware.Logging(handler)\\n\\thandler = middleware.Recovery(handler)\\n\\thandler = middleware.CORS(handler)\\n\\n\\t// Create server\\n\\tserver := &http.Server{\\n\\t\\tAddr:         fmt.Sprintf(\\":%d\\", cfg.Port),\\n\\t\\tHandler:      handler,\\n\\t\\tReadTimeout:  15 * time.Second,\\n\\t\\tWriteTimeout: 15 * time.Second,\\n\\t\\tIdleTimeout:  60 * time.Second,\\n\\t}\\n\\n\\t// Start server\\n\\tgo func() {\\n\\t\\tlogger.Info(\\"gateway listening\\", zap.String(\\"addr\\", server.Addr))\\n\\t\\tif err := server.ListenAndServe(); err != nil && err != http.ErrServerClosed {\\n\\t\\t\\tlogger.Fatal(\\"failed to start server\\", zap.Error(err))\\n\\t\\t}\\n\\t}()\\n\\n\\t// Wait for interrupt signal\\n\\tquit := make(chan os.Signal, 1)\\n\\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\\n\\t<-quit\\n\\n\\tlogger.Info(\\"shutting down server...\\")\\n\\n\\t// Graceful shutdown\\n\\tctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\\n\\tdefer cancel()\\n\\n\\tif err := server.Shutdown(ctx); err != nil {\\n\\t\\tlogger.Fatal(\\"server forced to shutdown\\", zap.Error(err))\\n\\t}\\n\\n\\tlogger.Info(\\"server exited properly\\")\\n}","external":"false","id":"/home/evan/Code/rinder/services/gateway/cmd/main.go:20:1","name":"ROOT","node_type":"function"},{"code":"func NewManager(serviceURLs map[string]string) *Manager {\\n\\tmanager := &Manager{\\n\\t\\tservices: make(map[string]*httputil.ReverseProxy),\\n\\t\\turls:     serviceURLs,\\n\\t}\\n\\n\\tfor name, urlStr := range serviceURLs {\\n\\t\\ttargetURL, err := url.Parse(urlStr)\\n\\t\\tif err != nil {\\n\\t\\t\\tlogger.Error(\\"failed to parse service URL\\",\\n\\t\\t\\t\\tzap.String(\\"service\\", name),\\n\\t\\t\\t\\tzap.String(\\"url\\", urlStr),\\n\\t\\t\\t\\tzap.Error(err),\\n\\t\\t\\t)\\n\\t\\t\\tcontinue\\n\\t\\t}\\n\\n\\t\\tproxy := httputil.NewSingleHostReverseProxy(targetURL)\\n\\t\\tproxy.Transport = &http.Transport{\\n\\t\\t\\tMaxIdleConns:        100,\\n\\t\\t\\tMaxIdleConnsPerHost: 100,\\n\\t\\t\\tIdleConnTimeout:     90 * time.Second,\\n\\t\\t}\\n\\n\\t\\t// Custom error handler\\n\\t\\tproxy.ErrorHandler = func(w http.ResponseWriter, r *http.Request, err error) {\\n\\t\\t\\tlogger.Error(\\"proxy error\\",\\n\\t\\t\\t\\tzap.String(\\"service\\", name),\\n\\t\\t\\t\\tzap.String(\\"path\\", r.URL.Path),\\n\\t\\t\\t\\tzap.Error(err),\\n\\t\\t\\t)\\n\\t\\t\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\t\\t\\tw.WriteHeader(http.StatusBadGateway)\\n\\t\\t\\tw.Write([]byte(`{\\"success\\":false,\\"error\\":{\\"code\\":\\"SERVICE_UNAVAILABLE\\",\\"message\\":\\"Service temporarily unavailable\\"}}`))\\n\\t\\t}\\n\\n\\t\\t// Custom director to modify the request\\n\\t\\toriginalDirector := proxy.Director\\n\\t\\tproxy.Director = func(req *http.Request) {\\n\\t\\t\\toriginalDirector(req)\\n\\t\\t\\treq.Host = targetURL.Host\\n\\t\\t}\\n\\n\\t\\t// Modify response to prevent duplicate CORS headers\\n\\t\\tproxy.ModifyResponse = func(resp *http.Response) error {\\n\\t\\t\\t// Remove any CORS headers set by backend service\\n\\t\\t\\t// (gateway middleware will add them)\\n\\t\\t\\tresp.Header.Del(\\"Access-Control-Allow-Origin\\")\\n\\t\\t\\tresp.Header.Del(\\"Access-Control-Allow-Methods\\")\\n\\t\\t\\tresp.Header.Del(\\"Access-Control-Allow-Headers\\")\\n\\t\\t\\tresp.Header.Del(\\"Access-Control-Allow-Credentials\\")\\n\\t\\t\\tresp.Header.Del(\\"Access-Control-Max-Age\\")\\n\\t\\t\\treturn nil\\n\\t\\t}\\n\\n\\t\\tmanager.services[name] = proxy\\n\\t\\tlogger.Info(\\"registered service proxy\\",\\n\\t\\t\\tzap.String(\\"service\\", name),\\n\\t\\t\\tzap.String(\\"url\\", urlStr),\\n\\t\\t)\\n\\t}\\n\\n\\treturn manager\\n}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:22:6","name":"NewManager","node_type":"function"},{"code":"func NewHandler(proxyManager *proxy.Manager, jwtAuth *middleware.JWTAuth) *Handler {\\n\\treturn &Handler{\\n\\t\\tproxyManager: proxyManager,\\n\\t\\tjwtAuth:      jwtAuth,\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:18:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\\n\\t// Health check\\n\\tmux.HandleFunc(\\"/health\\", h.healthCheck)\\n\\tmux.Handle(\\"/health/services\\", h.proxyManager.HealthCheck())\\n\\n\\t// API v1 routes\\n\\tmux.HandleFunc(\\"/api/v1/\\", h.routeAPI)\\n}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) healthCheck(w http.ResponseWriter, r *http.Request) {\\n\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\tw.WriteHeader(http.StatusOK)\\n\\tw.Write([]byte(`{\\"status\\":\\"healthy\\",\\"service\\":\\"gateway\\"}`))\\n}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:35:19","name":"healthCheck","node_type":"function"},{"code":"func (m *Manager) HealthCheck() http.Handler {\\n\\treturn http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\\n\\t\\tresults := make(map[string]string)\\n\\t\\tallHealthy := true\\n\\n\\t\\tfor name, urlStr := range m.urls {\\n\\t\\t\\thealthURL := urlStr + \\"/health\\"\\n\\t\\t\\tresp, err := http.Get(healthURL)\\n\\t\\t\\tif err != nil || resp.StatusCode != http.StatusOK {\\n\\t\\t\\t\\tresults[name] = \\"unhealthy\\"\\n\\t\\t\\t\\tallHealthy = false\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tresults[name] = \\"healthy\\"\\n\\t\\t\\t}\\n\\t\\t\\tif resp != nil {\\n\\t\\t\\t\\tio.Copy(io.Discard, resp.Body)\\n\\t\\t\\t\\tresp.Body.Close()\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\t\\tif allHealthy {\\n\\t\\t\\tw.WriteHeader(http.StatusOK)\\n\\t\\t} else {\\n\\t\\t\\tw.WriteHeader(http.StatusServiceUnavailable)\\n\\t\\t}\\n\\n\\t\\t// Build response\\n\\t\\tw.Write([]byte(`{\\"gateway\\":\\"healthy\\",\\"services\\":{`))\\n\\t\\tfirst := true\\n\\t\\tfor name, status := range results {\\n\\t\\t\\tif !first {\\n\\t\\t\\t\\tw.Write([]byte(\\",\\"))\\n\\t\\t\\t}\\n\\t\\t\\tw.Write([]byte(`\\"` + name + `\\":\\"` + status + `\\"`))\\n\\t\\t\\tfirst = false\\n\\t\\t}\\n\\t\\tw.Write([]byte(`}}`))\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19","name":"HealthCheck","node_type":"function"},{"code":"func(w http.ResponseWriter, r *http.Request) {\\n\\t\\tresults := make(map[string]string)\\n\\t\\tallHealthy := true\\n\\n\\t\\tfor name, urlStr := range m.urls {\\n\\t\\t\\thealthURL := urlStr + \\"/health\\"\\n\\t\\t\\tresp, err := http.Get(healthURL)\\n\\t\\t\\tif err != nil || resp.StatusCode != http.StatusOK {\\n\\t\\t\\t\\tresults[name] = \\"unhealthy\\"\\n\\t\\t\\t\\tallHealthy = false\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tresults[name] = \\"healthy\\"\\n\\t\\t\\t}\\n\\t\\t\\tif resp != nil {\\n\\t\\t\\t\\tio.Copy(io.Discard, resp.Body)\\n\\t\\t\\t\\tresp.Body.Close()\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\t\\tif allHealthy {\\n\\t\\t\\tw.WriteHeader(http.StatusOK)\\n\\t\\t} else {\\n\\t\\t\\tw.WriteHeader(http.StatusServiceUnavailable)\\n\\t\\t}\\n\\n\\t\\t// Build response\\n\\t\\tw.Write([]byte(`{\\"gateway\\":\\"healthy\\",\\"services\\":{`))\\n\\t\\tfirst := true\\n\\t\\tfor name, status := range results {\\n\\t\\t\\tif !first {\\n\\t\\t\\t\\tw.Write([]byte(\\",\\"))\\n\\t\\t\\t}\\n\\t\\t\\tw.Write([]byte(`\\"` + name + `\\":\\"` + status + `\\"`))\\n\\t\\t\\tfirst = false\\n\\t\\t}\\n\\t\\tw.Write([]byte(`}}`))\\n\\t}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:140:25","name":"anonymous-nNivQbIvg","node_type":"anonymous_function"},{"code":"func (h *Handler) routeAPI(w http.ResponseWriter, r *http.Request) {\\n\\tpath := strings.TrimPrefix(r.URL.Path, \\"/api/v1\\")\\n\\n\\t// Route based on path prefix\\n\\tswitch {\\n\\t// Auth routes (public)\\n\\tcase strings.HasPrefix(path, \\"/auth\\"):\\n\\t\\th.proxyToService(w, r, \\"user\\")\\n\\n\\t// User routes (authenticated)\\n\\tcase strings.HasPrefix(path, \\"/users\\"):\\n\\t\\th.authenticatedProxy(w, r, \\"user\\")\\n\\n\\t// Profile routes - GET is public, others require auth\\n\\tcase strings.HasPrefix(path, \\"/profiles\\"):\\n\\t\\tif r.Method == http.MethodGet && !strings.HasPrefix(path, \\"/profiles/me\\") {\\n\\t\\t\\t// Public read access for browsing profiles\\n\\t\\t\\th.proxyToService(w, r, \\"profile\\")\\n\\t\\t} else {\\n\\t\\t\\t// Create, Update, Delete, and /me require authentication\\n\\t\\t\\th.authenticatedProxy(w, r, \\"profile\\")\\n\\t\\t}\\n\\n\\t// Matching routes (all authenticated)\\n\\tcase strings.HasPrefix(path, \\"/swipes\\"):\\n\\t\\th.authenticatedProxy(w, r, \\"matching\\")\\n\\tcase strings.HasPrefix(path, \\"/matches\\"):\\n\\t\\th.authenticatedProxy(w, r, \\"matching\\")\\n\\n\\t// Notification routes (all authenticated)\\n\\tcase strings.HasPrefix(path, \\"/notifications\\"):\\n\\t\\th.authenticatedProxy(w, r, \\"notification\\")\\n\\n\\t// Media routes - GET profile media is public, uploads require auth\\n\\tcase strings.HasPrefix(path, \\"/media\\"):\\n\\t\\tif r.Method == http.MethodGet {\\n\\t\\t\\t// Public read access for viewing photos\\n\\t\\t\\th.proxyToService(w, r, \\"media\\")\\n\\t\\t} else {\\n\\t\\t\\t// Upload, Delete require authentication\\n\\t\\t\\th.authenticatedProxy(w, r, \\"media\\")\\n\\t\\t}\\n\\n\\t// Analytics routes (public for demo, can be secured later)\\n\\tcase strings.HasPrefix(path, \\"/analytics\\"):\\n\\t\\th.proxyToService(w, r, \\"analytics\\")\\n\\n\\tdefault:\\n\\t\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\t\\tw.WriteHeader(http.StatusNotFound)\\n\\t\\tw.Write([]byte(`{\\"success\\":false,\\"error\\":{\\"code\\":\\"NOT_FOUND\\",\\"message\\":\\"Endpoint not found\\"}}`))\\n\\t}\\n}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19","name":"routeAPI","node_type":"function"},{"code":"func (h *Handler) proxyToService(w http.ResponseWriter, r *http.Request, service string) {\\n\\t// Proxy the full path as-is to the backend service\\n\\thandler := h.proxyManager.Proxy(service)\\n\\thandler.ServeHTTP(w, r)\\n}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19","name":"proxyToService","node_type":"function"},{"code":"func (m *Manager) Proxy(serviceName string) http.Handler {\\n\\treturn http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\\n\\t\\tproxy, exists := m.services[serviceName]\\n\\t\\tif !exists {\\n\\t\\t\\tlogger.Error(\\"service not found\\", zap.String(\\"service\\", serviceName))\\n\\t\\t\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\t\\t\\tw.WriteHeader(http.StatusNotFound)\\n\\t\\t\\tw.Write([]byte(`{\\"success\\":false,\\"error\\":{\\"code\\":\\"SERVICE_NOT_FOUND\\",\\"message\\":\\"Service not found\\"}}`))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tlogger.Debug(\\"proxying request\\",\\n\\t\\t\\tzap.String(\\"service\\", serviceName),\\n\\t\\t\\tzap.String(\\"method\\", r.Method),\\n\\t\\t\\tzap.String(\\"path\\", r.URL.Path),\\n\\t\\t)\\n\\n\\t\\tproxy.ServeHTTP(w, r)\\n\\t})\\n}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19","name":"Proxy","node_type":"function"},{"code":"func(w http.ResponseWriter, r *http.Request) {\\n\\t\\tproxy, exists := m.services[serviceName]\\n\\t\\tif !exists {\\n\\t\\t\\tlogger.Error(\\"service not found\\", zap.String(\\"service\\", serviceName))\\n\\t\\t\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\t\\t\\tw.WriteHeader(http.StatusNotFound)\\n\\t\\t\\tw.Write([]byte(`{\\"success\\":false,\\"error\\":{\\"code\\":\\"SERVICE_NOT_FOUND\\",\\"message\\":\\"Service not found\\"}}`))\\n\\t\\t\\treturn\\n\\t\\t}\\n\\n\\t\\tlogger.Debug(\\"proxying request\\",\\n\\t\\t\\tzap.String(\\"service\\", serviceName),\\n\\t\\t\\tzap.String(\\"method\\", r.Method),\\n\\t\\t\\tzap.String(\\"path\\", r.URL.Path),\\n\\t\\t)\\n\\n\\t\\tproxy.ServeHTTP(w, r)\\n\\t}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25","name":"anonymous-uDivQbIDR","node_type":"anonymous_function"},{"code":"func (h *Handler) authenticatedProxy(w http.ResponseWriter, r *http.Request, service string) {\\n\\t// Validate JWT and add user info to headers\\n\\tauthHeader := r.Header.Get(\\"Authorization\\")\\n\\tif authHeader == \\"\\" {\\n\\t\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\t\\tw.WriteHeader(http.StatusUnauthorized)\\n\\t\\tw.Write([]byte(`{\\"success\\":false,\\"error\\":{\\"code\\":\\"UNAUTHORIZED\\",\\"message\\":\\"Missing authorization header\\"}}`))\\n\\t\\treturn\\n\\t}\\n\\n\\tparts := strings.Split(authHeader, \\" \\")\\n\\tif len(parts) != 2 || parts[0] != \\"Bearer\\" {\\n\\t\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\t\\tw.WriteHeader(http.StatusUnauthorized)\\n\\t\\tw.Write([]byte(`{\\"success\\":false,\\"error\\":{\\"code\\":\\"UNAUTHORIZED\\",\\"message\\":\\"Invalid authorization header format\\"}}`))\\n\\t\\treturn\\n\\t}\\n\\n\\tclaims, err := h.jwtAuth.ValidateToken(parts[1])\\n\\tif err != nil {\\n\\t\\tw.Header().Set(\\"Content-Type\\", \\"application/json\\")\\n\\t\\tw.WriteHeader(http.StatusUnauthorized)\\n\\t\\tw.Write([]byte(`{\\"success\\":false,\\"error\\":{\\"code\\":\\"UNAUTHORIZED\\",\\"message\\":\\"Invalid or expired token\\"}}`))\\n\\t\\treturn\\n\\t}\\n\\n\\t// Add user info to headers for downstream services\\n\\tr.Header.Set(\\"X-User-ID\\", claims.UserID)\\n\\tr.Header.Set(\\"X-User-Email\\", claims.Email)\\n\\n\\th.proxyToService(w, r, service)\\n}","external":"false","id":"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19","name":"authenticatedProxy","node_type":"function"}]'),ir=[{column:23,line:42,source:"/home/evan/Code/rinder/services/gateway/cmd/main.go:20:1",target:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:22:6",val:1},{column:14,line:52,source:"/home/evan/Code/rinder/services/gateway/cmd/main.go:20:1",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:18:6",val:1},{column:3,line:56,source:"/home/evan/Code/rinder/services/gateway/cmd/main.go:20:1",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19",val:1},{column:29,line:27,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:35:19",val:1},{column:47,line:28,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19",target:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19",val:1},{column:25,line:140,source:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19",target:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:140:25",val:1},{column:30,line:31,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:4,line:47,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",val:1},{column:27,line:97,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",target:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19",val:1},{column:25,line:89,source:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19",target:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25",val:1},{column:59,line:91,source:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25",target:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19",val:1},{column:25,line:99,source:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25",target:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19",val:1},{column:59,line:91,source:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19",target:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19",val:1},{column:25,line:99,source:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19",target:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19",val:1},{column:33,line:97,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",val:1},{column:19,line:98,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",val:1},{column:22,line:98,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",val:1},{column:19,line:47,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:22,line:47,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:4,line:51,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",val:1},{column:3,line:132,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",val:1},{column:18,line:132,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",val:1},{column:21,line:132,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",val:1},{column:24,line:132,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",val:1},{column:23,line:51,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:26,line:51,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:5,line:57,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",val:1},{column:20,line:57,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:23,line:57,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:5,line:60,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",val:1},{column:24,line:60,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:27,line:60,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:4,line:65,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",val:1},{column:23,line:65,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:26,line:65,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:4,line:67,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",val:1},{column:23,line:67,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:26,line:67,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:4,line:71,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",val:1},{column:23,line:71,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:26,line:71,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:5,line:77,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",val:1},{column:20,line:77,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:23,line:77,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:5,line:80,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",val:1},{column:24,line:80,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:27,line:80,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:4,line:85,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",val:1},{column:19,line:85,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1},{column:22,line:85,source:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",target:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",val:1}],wt={nodes:tr,links:ir},St=Object.freeze(Object.defineProperty({__proto__:null,default:wt,links:ir,nodes:tr},Symbol.toStringTag,{value:"Module"})),Et=[{id:"/home/evan/Code/rinder/services/gateway/cmd/main.go:20:1",name:"ROOT",node_type:"function"},{id:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:22:6",name:"NewManager",node_type:"function"},{id:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:18:6",name:"NewHandler",node_type:"function"},{id:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:26:19",name:"RegisterRoutes",node_type:"function"},{id:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:35:19",name:"healthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:139:19",name:"HealthCheck",node_type:"function"},{id:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:140:25",name:"anonymous-nNivQbIvg",node_type:"anonymous_function"},{id:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:41:19",name:"routeAPI",node_type:"function"},{id:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:96:19",name:"proxyToService",node_type:"function"},{id:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:88:19",name:"Proxy",node_type:"function"},{id:"/home/evan/Code/rinder/services/gateway/internal/proxy/proxy.go:89:25",name:"anonymous-uDivQbIDR",node_type:"anonymous_function"},{id:"/home/evan/Code/rinder/services/gateway/internal/handler/handler.go:103:19",name:"authenticatedProxy",node_type:"function"}],It=Object.freeze(Object.defineProperty({__proto__:null,default:Et},Symbol.toStringTag,{value:"Module"})),Pt=Object.assign({"../../demo_data/links.json":or,"../../demo_data/services.json":dr,"../../demo_data/services/10.json":cr,"../../demo_data/services/10/callgraph.json":hr,"../../demo_data/services/10/callgraph/nodes.json":vr,"../../demo_data/services/11.json":_r,"../../demo_data/services/11/callgraph.json":gr,"../../demo_data/services/11/callgraph/nodes.json":Cr,"../../demo_data/services/12.json":br,"../../demo_data/services/12/callgraph.json":Sr,"../../demo_data/services/12/callgraph/nodes.json":Ir,"../../demo_data/services/13.json":Rr,"../../demo_data/services/13/callgraph.json":Dr,"../../demo_data/services/13/callgraph/nodes.json":Hr,"../../demo_data/services/14.json":kr,"../../demo_data/services/14/callgraph.json":Mr,"../../demo_data/services/14/callgraph/nodes.json":Ar,"../../demo_data/services/15.json":Gr,"../../demo_data/services/15/callgraph.json":Lr,"../../demo_data/services/15/callgraph/nodes.json":Wr,"../../demo_data/services/17.json":$r,"../../demo_data/services/17/callgraph.json":Jr,"../../demo_data/services/17/callgraph/nodes.json":Vr,"../../demo_data/services/18.json":Qr,"../../demo_data/services/18/callgraph.json":et,"../../demo_data/services/18/callgraph/nodes.json":rt,"../../demo_data/services/19.json":it,"../../demo_data/services/19/callgraph.json":ot,"../../demo_data/services/19/callgraph/nodes.json":dt,"../../demo_data/services/20.json":ct,"../../demo_data/services/20/callgraph.json":ht,"../../demo_data/services/20/callgraph/nodes.json":vt,"../../demo_data/services/21.json":_t,"../../demo_data/services/21/callgraph.json":gt,"../../demo_data/services/21/callgraph/nodes.json":Ct,"../../demo_data/services/9.json":bt,"../../demo_data/services/9/callgraph.json":St,"../../demo_data/services/9/callgraph/nodes.json":It}),i="http://localhost:8080";async function a(e){if(!e.ok){let n=`HTTP error! status: ${e.status}`;try{n=(await e.json()).error||n}catch{}throw new Error(n)}return await e.json()}async function t(e,n){{const d=`../../demo_data/${e.replace(/^\/+/,"")}.json`,l=Pt[d];if(l)return l.default;console.warn("Demo JSON not found for path",e,"->",d)}const r=await fetch(`${i}${e}`,{...n,method:"GET"});return a(r)}async function o(e,n,r){const s=await fetch(`${i}${e}`,{...r,method:"POST",headers:{"Content-Type":"application/json"},body:n!==void 0?JSON.stringify(n):void 0});return a(s)}async function Rt(e,n){const r=await fetch(`${i}${e}`,{...n,method:"DELETE"});return a(r)}async function xt(){return t("/services")}async function Dt(e){return o("/services",e)}async function Nt(e){return t(`/services/${e}`)}async function Ht(e,n){const r=n.join(",");await Rt(`/services/${e}/handlers/${r}`)}async function qt(e,n){const r=n.join(",");await o(`/services/${e}/handlers/${r}/jobs/identify_outputs`)}async function kt(e){await o(`/services/${e}/jobs/identify_handlers`)}async function Ut(e){return t(`/services/${e}/callgraph/nodes`)}async function Mt(e,n){const r=n?`?root_node_id=${encodeURIComponent(n)}`:"";return t(`/services/${e}/callgraph${r}`)}export{t as a,qt as b,Dt as c,Ht as d,Nt as e,Ut as f,xt as g,Mt as h,kt as r};
