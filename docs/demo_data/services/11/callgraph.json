{"nodes":[{"code":"func main() {\n\t// Load configuration\n\tcfg := config.NewServiceConfig(\"matching\", 8083)\n\tkafkaCfg := config.NewKafkaConfig(\"matching-service\")\n\n\t// Database config\n\tdbHost := config.GetEnv(\"DB_HOST\", \"localhost\")\n\tdbPort := config.GetEnv(\"DB_PORT\", \"5433\")\n\tdbUser := config.GetEnv(\"DB_USER\", \"rinder\")\n\tdbPassword := config.GetEnv(\"DB_PASSWORD\", \"rinder123\")\n\tdbName := config.GetEnv(\"DB_NAME\", \"rinder_matching\")\n\n\t// Redis config\n\tredisHost := config.GetEnv(\"REDIS_HOST\", \"localhost\")\n\tredisPort := config.GetEnv(\"REDIS_PORT\", \"6379\")\n\n\t// Profile service URL\n\tprofileServiceURL := config.GetEnv(\"PROFILE_SERVICE_URL\", \"http://localhost:8082\")\n\n\t// Initialize logger\n\tlogger.Init(cfg.Name, cfg.LogLevel)\n\tlogger.Info(\"starting matching service\",\n\t\tzap.Int(\"port\", cfg.Port),\n\t\tzap.String(\"environment\", cfg.Environment),\n\t)\n\n\t// Connect to PostgreSQL\n\tdsn := fmt.Sprintf(\"host=%s port=%s user=%s password=%s dbname=%s sslmode=disable\",\n\t\tdbHost, dbPort, dbUser, dbPassword, dbName)\n\n\tdb, err := sql.Open(\"postgres\", dsn)\n\tif err != nil {\n\t\tlogger.Fatal(\"failed to connect to database\", zap.Error(err))\n\t}\n\tdefer db.Close()\n\n\t// Verify connection\n\tif err := db.Ping(); err != nil {\n\t\tlogger.Fatal(\"failed to ping database\", zap.Error(err))\n\t}\n\tlogger.Info(\"connected to PostgreSQL\")\n\n\t// Run migrations\n\tif err := runMigrations(db); err != nil {\n\t\tlogger.Fatal(\"failed to run migrations\", zap.Error(err))\n\t}\n\tlogger.Info(\"database migrations complete\")\n\n\t// Connect to Redis\n\tredisClient := redis.NewClient(\u0026redis.Options{\n\t\tAddr:     fmt.Sprintf(\"%s:%s\", redisHost, redisPort),\n\t\tPassword: \"\",\n\t\tDB:       0,\n\t})\n\n\t// Verify Redis connection\n\tctx := context.Background()\n\tif err := redisClient.Ping(ctx).Err(); err != nil {\n\t\tlogger.Fatal(\"failed to connect to Redis\", zap.Error(err))\n\t}\n\tlogger.Info(\"connected to Redis\")\n\tdefer redisClient.Close()\n\n\t// Initialize Kafka producer\n\tproducer := kafka.NewProducer(kafkaCfg.Brokers, cfg.Name)\n\tdefer producer.Close()\n\n\t// Initialize repositories\n\tswipeRepo := repository.NewSwipeRepository(redisClient)\n\tmatchRepo := repository.NewMatchRepository(db)\n\n\t// Initialize service\n\tmatchingService := service.NewMatchingService(swipeRepo, matchRepo, producer, profileServiceURL)\n\n\t// Initialize handler\n\th := handler.NewHandler(matchingService)\n\n\t// Setup routes\n\tmux := http.NewServeMux()\n\th.RegisterRoutes(mux)\n\n\t// Apply middleware\n\tvar httpHandler http.Handler = mux\n\thttpHandler = middleware.Logging(httpHandler)\n\thttpHandler = middleware.Recovery(httpHandler)\n\n\t// Create server\n\tserver := \u0026http.Server{\n\t\tAddr:         fmt.Sprintf(\":%d\", cfg.Port),\n\t\tHandler:      httpHandler,\n\t\tReadTimeout:  15 * time.Second,\n\t\tWriteTimeout: 15 * time.Second,\n\t\tIdleTimeout:  60 * time.Second,\n\t}\n\n\t// Start server in goroutine\n\tgo func() {\n\t\tlogger.Info(\"matching service listening\", zap.String(\"addr\", server.Addr))\n\t\tif err := server.ListenAndServe(); err != nil \u0026\u0026 err != http.ErrServerClosed {\n\t\t\tlogger.Fatal(\"failed to start server\", zap.Error(err))\n\t\t}\n\t}()\n\n\t// Wait for interrupt\n\tquit := make(chan os.Signal, 1)\n\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\n\t\u003c-quit\n\n\tlogger.Info(\"shutting down server...\")\n\n\t// Graceful shutdown\n\tshutdownCtx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\n\tdefer cancel()\n\n\tif err := server.Shutdown(shutdownCtx); err != nil {\n\t\tlogger.Fatal(\"server forced to shutdown\", zap.Error(err))\n\t}\n\n\tlogger.Info(\"server stopped\")\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","name":"ROOT","node_type":"function"},{"code":"func runMigrations(db *sql.DB) error {\n\tmigrations := []string{\n\t\t`CREATE TABLE IF NOT EXISTS matches (\n\t\t\tid VARCHAR(36) PRIMARY KEY,\n\t\t\tuser1_id VARCHAR(36) NOT NULL,\n\t\t\tuser2_id VARCHAR(36) NOT NULL,\n\t\t\tprofile1_id VARCHAR(36),\n\t\t\tprofile2_id VARCHAR(36),\n\t\t\tcreated_at TIMESTAMP NOT NULL DEFAULT NOW(),\n\t\t\tupdated_at TIMESTAMP NOT NULL DEFAULT NOW(),\n\t\t\tUNIQUE(user1_id, user2_id)\n\t\t)`,\n\t\t`CREATE INDEX IF NOT EXISTS idx_matches_user1 ON matches(user1_id)`,\n\t\t`CREATE INDEX IF NOT EXISTS idx_matches_user2 ON matches(user2_id)`,\n\t\t`CREATE TABLE IF NOT EXISTS swipes (\n\t\t\tid VARCHAR(36) PRIMARY KEY,\n\t\t\tswiper_id VARCHAR(36) NOT NULL,\n\t\t\tprofile_id VARCHAR(36) NOT NULL,\n\t\t\towner_id VARCHAR(36) NOT NULL,\n\t\t\tdirection VARCHAR(10) NOT NULL,\n\t\t\tcreated_at TIMESTAMP NOT NULL DEFAULT NOW(),\n\t\t\tUNIQUE(swiper_id, profile_id)\n\t\t)`,\n\t\t`CREATE INDEX IF NOT EXISTS idx_swipes_swiper ON swipes(swiper_id)`,\n\t\t`CREATE INDEX IF NOT EXISTS idx_swipes_owner ON swipes(owner_id)`,\n\t}\n\n\tfor _, migration := range migrations {\n\t\tif _, err := db.Exec(migration); err != nil {\n\t\t\treturn fmt.Errorf(\"migration failed: %w\", err)\n\t\t}\n\t}\n\n\treturn nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/cmd/main.go:146:6","name":"runMigrations","node_type":"function"},{"code":"func NewSwipeRepository(client *redis.Client) *SwipeRepository {\n\treturn \u0026SwipeRepository{client: client}\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:17:6","name":"NewSwipeRepository","node_type":"function"},{"code":"func NewMatchRepository(db *sql.DB) *MatchRepository {\n\treturn \u0026MatchRepository{db: db}\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:18:6","name":"NewMatchRepository","node_type":"function"},{"code":"func NewMatchingService(\n\tswipeRepo *repository.SwipeRepository,\n\tmatchRepo *repository.MatchRepository,\n\tproducer *kafka.Producer,\n\tprofileServiceURL string,\n) *MatchingService {\n\treturn \u0026MatchingService{\n\t\tswipeRepo:     swipeRepo,\n\t\tmatchRepo:     matchRepo,\n\t\tproducer:      producer,\n\t\tprofileClient: httpclient.NewClient(profileServiceURL, \"profile-service\", 10*time.Second),\n\t}\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:27:6","name":"NewMatchingService","node_type":"function"},{"code":"func NewHandler(matchingService *service.MatchingService) *Handler {\n\treturn \u0026Handler{\n\t\tmatchingService: matchingService,\n\t}\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:21:6","name":"NewHandler","node_type":"function"},{"code":"func (h *Handler) RegisterRoutes(mux *http.ServeMux) {\n\tmux.HandleFunc(\"/health\", h.Health)\n\tmux.HandleFunc(\"/api/v1/swipe\", h.Swipe)\n\tmux.HandleFunc(\"/api/v1/swipe/queue\", h.GetSwipeQueue)\n\tmux.HandleFunc(\"/api/v1/matches\", h.handleMatches)\n\tmux.HandleFunc(\"/api/v1/matches/\", h.handleMatchByID)\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","name":"RegisterRoutes","node_type":"function"},{"code":"func (h *Handler) Health(w http.ResponseWriter, r *http.Request) {\n\tresponse.JSON(w, http.StatusOK, map[string]string{\n\t\t\"status\":  \"healthy\",\n\t\t\"service\": \"matching\",\n\t})\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","name":"Health","node_type":"function"},{"code":"func (h *Handler) Swipe(w http.ResponseWriter, r *http.Request) {\n\tif r.Method != http.MethodPost {\n\t\tresponse.Error(w, errors.BadRequest(\"Method not allowed\"))\n\t\treturn\n\t}\n\n\t// Get user ID from header (set by gateway)\n\tuserID := r.Header.Get(\"X-User-ID\")\n\tif userID == \"\" {\n\t\tresponse.Error(w, errors.Unauthorized(\"User not authenticated\"))\n\t\treturn\n\t}\n\n\t// Parse request\n\tvar req SwipeRequestWithOwner\n\tif err := json.NewDecoder(r.Body).Decode(\u0026req); err != nil {\n\t\tresponse.Error(w, errors.BadRequest(\"Invalid request body\"))\n\t\treturn\n\t}\n\n\t// Validate\n\tif req.ProfileID == \"\" {\n\t\tresponse.Error(w, errors.BadRequest(\"Profile ID is required\"))\n\t\treturn\n\t}\n\tif req.OwnerID == \"\" {\n\t\tresponse.Error(w, errors.BadRequest(\"Owner ID is required\"))\n\t\treturn\n\t}\n\tif req.Direction != model.SwipeRight \u0026\u0026 req.Direction != model.SwipeLeft {\n\t\tresponse.Error(w, errors.BadRequest(\"Direction must be 'right' or 'left'\"))\n\t\treturn\n\t}\n\n\t// Process swipe\n\tresult, err := h.matchingService.Swipe(r.Context(), userID, req.ProfileID, req.OwnerID, req.Direction)\n\tif err != nil {\n\t\tif strings.Contains(err.Error(), \"cannot swipe on your own\") {\n\t\t\tresponse.Error(w, errors.BadRequest(err.Error()))\n\t\t\treturn\n\t\t}\n\t\tif strings.Contains(err.Error(), \"already swiped\") {\n\t\t\tresponse.Error(w, errors.Conflict(err.Error()))\n\t\t\treturn\n\t\t}\n\t\tresponse.Error(w, errors.InternalServerError(\"Failed to process swipe\"))\n\t\treturn\n\t}\n\n\tresponse.Created(w, result)\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","name":"Swipe","node_type":"function"},{"code":"func (s *MatchingService) Swipe(ctx context.Context, swiperID, profileID, ownerID string, direction model.SwipeDirection) (*model.SwipeResponse, error) {\n\t// Don't allow users to swipe on their own profiles\n\tif swiperID == ownerID {\n\t\treturn nil, fmt.Errorf(\"cannot swipe on your own profile\")\n\t}\n\n\t// Check if already swiped\n\texistingSwipe, err := s.swipeRepo.GetSwipe(ctx, swiperID, ownerID)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to check existing swipe: %w\", err)\n\t}\n\tif existingSwipe != \"\" {\n\t\treturn nil, fmt.Errorf(\"already swiped on this profile\")\n\t}\n\n\t// Record swipe in Redis (fast)\n\terr = s.swipeRepo.RecordSwipe(ctx, swiperID, ownerID, string(direction))\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to record swipe: %w\", err)\n\t}\n\n\t// Create swipe object\n\tswipe := \u0026model.Swipe{\n\t\tID:        uuid.New().String(),\n\t\tSwiperID:  swiperID,\n\t\tProfileID: profileID,\n\t\tOwnerID:   ownerID,\n\t\tDirection: direction,\n\t\tCreatedAt: time.Now(),\n\t}\n\n\t// Also record in PostgreSQL for history/analytics\n\terr = s.matchRepo.RecordSwipeInDB(swipe)\n\tif err != nil {\n\t\tlogger.Warn(\"failed to record swipe in DB\", zap.Error(err))\n\t\t// Don't fail the swipe if DB recording fails\n\t}\n\n\tresponse := \u0026model.SwipeResponse{\n\t\tSwipe:   swipe,\n\t\tIsMatch: false,\n\t}\n\n\t// If it's a like, check for mutual match\n\tif direction == model.SwipeRight {\n\t\t// Check if the other user has already liked this user\n\t\tisMutual, err := s.swipeRepo.CheckMutualLike(ctx, swiperID, ownerID)\n\t\tif err != nil {\n\t\t\tlogger.Error(\"failed to check mutual like\", zap.Error(err))\n\t\t}\n\n\t\tif isMutual {\n\t\t\t// Check if match already exists\n\t\t\texists, err := s.matchRepo.MatchExists(swiperID, ownerID)\n\t\t\tif err != nil {\n\t\t\t\tlogger.Error(\"failed to check match exists\", zap.Error(err))\n\t\t\t}\n\n\t\t\tif !exists {\n\t\t\t\t// Get the profile that the other user liked (swiper's profile)\n\t\t\t\tswiperProfileID, err := s.getSwiperProfile(ctx, swiperID)\n\t\t\t\tif err != nil {\n\t\t\t\t\tlogger.Error(\"failed to get swiper profile\", zap.Error(err))\n\t\t\t\t\tswiperProfileID = \"\" // Continue without profile ID\n\t\t\t\t}\n\n\t\t\t\t// Create match!\n\t\t\t\tmatch, err := s.matchRepo.CreateMatch(swiperID, ownerID, swiperProfileID, profileID)\n\t\t\t\tif err != nil {\n\t\t\t\t\treturn nil, fmt.Errorf(\"failed to create match: %w\", err)\n\t\t\t\t}\n\n\t\t\t\tresponse.IsMatch = true\n\t\t\t\tresponse.Match = match\n\n\t\t\t\t// Publish match event\n\t\t\t\ts.publishMatchEvent(ctx, match)\n\t\t\t}\n\t\t}\n\t}\n\n\t// Publish swipe event\n\ts.publishSwipeEvent(ctx, swipe)\n\n\treturn response, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","name":"Swipe","node_type":"function"},{"code":"func (r *SwipeRepository) GetSwipe(ctx context.Context, swiperID, ownerID string) (string, error) {\n\tkey := fmt.Sprintf(\"swipe:%s:%s\", swiperID, ownerID)\n\n\tdirection, err := r.client.Get(ctx, key).Result()\n\tif err == redis.Nil {\n\t\treturn \"\", nil // No swipe found\n\t}\n\tif err != nil {\n\t\treturn \"\", fmt.Errorf(\"failed to get swipe: %w\", err)\n\t}\n\n\treturn direction, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","name":"GetSwipe","node_type":"function"},{"code":"func (r *SwipeRepository) RecordSwipe(ctx context.Context, swiperID, ownerID, direction string) error {\n\tkey := fmt.Sprintf(\"swipe:%s:%s\", swiperID, ownerID)\n\n\t// Store swipe with 30-day expiry\n\terr := r.client.Set(ctx, key, direction, 30*24*time.Hour).Err()\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to record swipe: %w\", err)\n\t}\n\n\t// If it's a right swipe (like), add to the likes set\n\tif direction == \"right\" {\n\t\tlikesKey := fmt.Sprintf(\"likes:%s\", ownerID)\n\t\terr = r.client.SAdd(ctx, likesKey, swiperID).Err()\n\t\tif err != nil {\n\t\t\treturn fmt.Errorf(\"failed to add to likes set: %w\", err)\n\t\t}\n\t\t// Set expiry on likes set\n\t\tr.client.Expire(ctx, likesKey, 30*24*time.Hour)\n\t}\n\n\treturn nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","name":"RecordSwipe","node_type":"function"},{"code":"func (r *MatchRepository) RecordSwipeInDB(swipe *model.Swipe) error {\n\tquery := `\n\t\tINSERT INTO swipes (id, swiper_id, profile_id, owner_id, direction, created_at)\n\t\tVALUES ($1, $2, $3, $4, $5, $6)\n\t\tON CONFLICT (swiper_id, profile_id) DO UPDATE SET direction = $4, created_at = $6\n\t`\n\n\t_, err := r.db.Exec(\n\t\tquery,\n\t\tswipe.ID,\n\t\tswipe.SwiperID,\n\t\tswipe.ProfileID,\n\t\tswipe.OwnerID,\n\t\tswipe.Direction,\n\t\tswipe.CreatedAt,\n\t)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to record swipe in DB: %w\", err)\n\t}\n\n\treturn nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:182:27","name":"RecordSwipeInDB","node_type":"function"},{"code":"func (r *SwipeRepository) CheckMutualLike(ctx context.Context, user1ID, user2ID string) (bool, error) {\n\t// Check if user2 has already liked user1\n\tliked, err := r.HasLiked(ctx, user2ID, user1ID)\n\tif err != nil {\n\t\treturn false, err\n\t}\n\treturn liked, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","name":"CheckMutualLike","node_type":"function"},{"code":"func (r *SwipeRepository) HasLiked(ctx context.Context, likerID, likedID string) (bool, error) {\n\tkey := fmt.Sprintf(\"swipe:%s:%s\", likerID, likedID)\n\n\tdirection, err := r.client.Get(ctx, key).Result()\n\tif err == redis.Nil {\n\t\treturn false, nil\n\t}\n\tif err != nil {\n\t\treturn false, fmt.Errorf(\"failed to check like: %w\", err)\n\t}\n\n\treturn direction == \"right\", nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","name":"HasLiked","node_type":"function"},{"code":"func (r *MatchRepository) MatchExists(user1ID, user2ID string) (bool, error) {\n\tquery := `\n\t\tSELECT EXISTS(\n\t\t\tSELECT 1 FROM matches\n\t\t\tWHERE (user1_id = $1 AND user2_id = $2)\n\t\t\t   OR (user1_id = $2 AND user2_id = $1)\n\t\t)\n\t`\n\n\tvar exists bool\n\terr := r.db.QueryRow(query, user1ID, user2ID).Scan(\u0026exists)\n\tif err != nil {\n\t\treturn false, fmt.Errorf(\"failed to check match exists: %w\", err)\n\t}\n\n\treturn exists, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","name":"MatchExists","node_type":"function"},{"code":"func (s *MatchingService) getSwiperProfile(ctx context.Context, userID string) (string, error) {\n\t// Call profile service to get user's profiles\n\tresp, err := s.profileClient.Get(ctx, fmt.Sprintf(\"/api/v1/profiles/user/%s\", userID), nil)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\n\tvar result struct {\n\t\tSuccess bool `json:\"success\"`\n\t\tData    []struct {\n\t\t\tID string `json:\"id\"`\n\t\t} `json:\"data\"`\n\t}\n\tif err := json.Unmarshal(resp.Body, \u0026result); err != nil {\n\t\treturn \"\", err\n\t}\n\n\tif !result.Success || len(result.Data) == 0 {\n\t\treturn \"\", fmt.Errorf(\"no profiles found\")\n\t}\n\n\treturn result.Data[0].ID, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","name":"getSwiperProfile","node_type":"function"},{"code":"func (r *MatchRepository) CreateMatch(user1ID, user2ID, profile1ID, profile2ID string) (*model.Match, error) {\n\tmatch := \u0026model.Match{\n\t\tID:         uuid.New().String(),\n\t\tUser1ID:    user1ID,\n\t\tUser2ID:    user2ID,\n\t\tProfile1ID: profile1ID,\n\t\tProfile2ID: profile2ID,\n\t\tCreatedAt:  time.Now(),\n\t\tUpdatedAt:  time.Now(),\n\t}\n\n\tquery := `\n\t\tINSERT INTO matches (id, user1_id, user2_id, profile1_id, profile2_id, created_at, updated_at)\n\t\tVALUES ($1, $2, $3, $4, $5, $6, $7)\n\t\tRETURNING id, user1_id, user2_id, profile1_id, profile2_id, created_at, updated_at\n\t`\n\n\terr := r.db.QueryRow(\n\t\tquery,\n\t\tmatch.ID,\n\t\tmatch.User1ID,\n\t\tmatch.User2ID,\n\t\tmatch.Profile1ID,\n\t\tmatch.Profile2ID,\n\t\tmatch.CreatedAt,\n\t\tmatch.UpdatedAt,\n\t).Scan(\n\t\t\u0026match.ID,\n\t\t\u0026match.User1ID,\n\t\t\u0026match.User2ID,\n\t\t\u0026match.Profile1ID,\n\t\t\u0026match.Profile2ID,\n\t\t\u0026match.CreatedAt,\n\t\t\u0026match.UpdatedAt,\n\t)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to create match: %w\", err)\n\t}\n\n\treturn match, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:23:27","name":"CreateMatch","node_type":"function"},{"code":"func (s *MatchingService) publishMatchEvent(ctx context.Context, match *model.Match) {\n\tevent := model.MatchEvent{\n\t\tEventType:  kafka.EventMatchCreated,\n\t\tMatchID:    match.ID,\n\t\tUser1ID:    match.User1ID,\n\t\tUser2ID:    match.User2ID,\n\t\tProfile1ID: match.Profile1ID,\n\t\tProfile2ID: match.Profile2ID,\n\t\tTimestamp:  match.CreatedAt.Format(time.RFC3339),\n\t}\n\n\tif err := s.producer.Publish(ctx, kafka.TopicMatchCreated, kafka.EventMatchCreated, event); err != nil {\n\t\tlogger.Error(\"failed to publish match event\", zap.Error(err))\n\t}\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:341:27","name":"publishMatchEvent","node_type":"function"},{"code":"func (s *MatchingService) publishSwipeEvent(ctx context.Context, swipe *model.Swipe) {\n\teventType := kafka.EventSwipeRight\n\tif swipe.Direction == model.SwipeLeft {\n\t\teventType = kafka.EventSwipeLeft\n\t}\n\n\tevent := model.SwipeEvent{\n\t\tEventType: eventType,\n\t\tSwipeID:   swipe.ID,\n\t\tSwiperID:  swipe.SwiperID,\n\t\tProfileID: swipe.ProfileID,\n\t\tOwnerID:   swipe.OwnerID,\n\t\tDirection: string(swipe.Direction),\n\t\tTimestamp: swipe.CreatedAt.Format(time.RFC3339),\n\t}\n\n\tif err := s.producer.Publish(ctx, kafka.TopicSwipeCreated, eventType, event); err != nil {\n\t\tlogger.Error(\"failed to publish swipe event\", zap.Error(err))\n\t}\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:319:27","name":"publishSwipeEvent","node_type":"function"},{"code":"func (h *Handler) GetSwipeQueue(w http.ResponseWriter, r *http.Request) {\n\tif r.Method != http.MethodGet {\n\t\tresponse.Error(w, errors.BadRequest(\"Method not allowed\"))\n\t\treturn\n\t}\n\n\t// Get user ID from header\n\tuserID := r.Header.Get(\"X-User-ID\")\n\tif userID == \"\" {\n\t\tresponse.Error(w, errors.Unauthorized(\"User not authenticated\"))\n\t\treturn\n\t}\n\n\t// Parse limit\n\tlimitStr := r.URL.Query().Get(\"limit\")\n\tlimit := 10\n\tif limitStr != \"\" {\n\t\tif l, err := strconv.Atoi(limitStr); err == nil \u0026\u0026 l \u003e 0 \u0026\u0026 l \u003c= 50 {\n\t\t\tlimit = l\n\t\t}\n\t}\n\n\t// Get queue\n\tprofiles, err := h.matchingService.GetSwipeQueue(r.Context(), userID, limit)\n\tif err != nil {\n\t\tresponse.Error(w, errors.InternalServerError(\"Failed to get swipe queue\"))\n\t\treturn\n\t}\n\n\tif profiles == nil {\n\t\tprofiles = []*model.SwipeQueueProfile{}\n\t}\n\n\tresponse.OK(w, profiles)\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","name":"GetSwipeQueue","node_type":"function"},{"code":"func (s *MatchingService) GetSwipeQueue(ctx context.Context, userID string, limit int) ([]*model.SwipeQueueProfile, error) {\n\t// Get IDs of users already swiped on\n\tswipedIDs, err := s.swipeRepo.GetSwipedProfiles(ctx, userID)\n\tif err != nil {\n\t\tlogger.Warn(\"failed to get swiped profiles\", zap.Error(err))\n\t\tswipedIDs = []string{}\n\t}\n\n\t// Fetch profiles from profile service, excluding swiped ones\n\tprofiles, err := s.fetchSwipeQueue(ctx, userID, swipedIDs, limit)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to fetch swipe queue: %w\", err)\n\t}\n\n\treturn profiles, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","name":"GetSwipeQueue","node_type":"function"},{"code":"func (r *SwipeRepository) GetSwipedProfiles(ctx context.Context, userID string) ([]string, error) {\n\tpattern := fmt.Sprintf(\"swipe:%s:*\", userID)\n\n\tvar swipedIDs []string\n\titer := r.client.Scan(ctx, 0, pattern, 0).Iterator()\n\tfor iter.Next(ctx) {\n\t\tkey := iter.Val()\n\t\t// Extract owner ID from key pattern \"swipe:{swiper}:{owner}\"\n\t\t// Key format: swipe:userID:ownerID\n\t\tif len(key) \u003e len(fmt.Sprintf(\"swipe:%s:\", userID)) {\n\t\t\townerID := key[len(fmt.Sprintf(\"swipe:%s:\", userID)):]\n\t\t\tswipedIDs = append(swipedIDs, ownerID)\n\t\t}\n\t}\n\tif err := iter.Err(); err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to scan swiped profiles: %w\", err)\n\t}\n\n\treturn swipedIDs, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","name":"GetSwipedProfiles","node_type":"function"},{"code":"func (s *MatchingService) fetchSwipeQueue(ctx context.Context, userID string, excludeOwnerIDs []string, limit int) ([]*model.SwipeQueueProfile, error) {\n\t// Build query params\n\tpath := fmt.Sprintf(\"/api/v1/profiles?exclude_user=%s\u0026limit=%d\", userID, limit)\n\n\tresp, err := s.profileClient.Get(ctx, path, nil)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\n\tvar result struct {\n\t\tSuccess bool                       `json:\"success\"`\n\t\tData    []*model.SwipeQueueProfile `json:\"data\"`\n\t}\n\tif err := json.Unmarshal(resp.Body, \u0026result); err != nil {\n\t\treturn nil, err\n\t}\n\n\tif !result.Success {\n\t\treturn nil, fmt.Errorf(\"failed to get profiles\")\n\t}\n\n\t// Filter out already swiped profiles\n\texcludeSet := make(map[string]bool)\n\tfor _, id := range excludeOwnerIDs {\n\t\texcludeSet[id] = true\n\t}\n\n\tvar filtered []*model.SwipeQueueProfile\n\tfor _, p := range result.Data {\n\t\tif !excludeSet[p.OwnerID] {\n\t\t\tfiltered = append(filtered, p)\n\t\t}\n\t}\n\n\treturn filtered, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","name":"fetchSwipeQueue","node_type":"function"},{"code":"func (h *Handler) handleMatches(w http.ResponseWriter, r *http.Request) {\n\tif r.Method != http.MethodGet {\n\t\tresponse.Error(w, errors.BadRequest(\"Method not allowed\"))\n\t\treturn\n\t}\n\n\t// Get user ID from header\n\tuserID := r.Header.Get(\"X-User-ID\")\n\tif userID == \"\" {\n\t\tresponse.Error(w, errors.Unauthorized(\"User not authenticated\"))\n\t\treturn\n\t}\n\n\t// Get matches\n\tmatches, err := h.matchingService.GetMatchesWithProfiles(r.Context(), userID)\n\tif err != nil {\n\t\tresponse.Error(w, errors.InternalServerError(\"Failed to get matches\"))\n\t\treturn\n\t}\n\n\tif matches == nil {\n\t\tmatches = []*model.MatchResponse{}\n\t}\n\n\tresponse.OK(w, matches)\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","name":"handleMatches","node_type":"function"},{"code":"func (s *MatchingService) GetMatchesWithProfiles(ctx context.Context, userID string) ([]*model.MatchResponse, error) {\n\tmatches, err := s.matchRepo.GetMatchesByUserID(userID)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to get matches: %w\", err)\n\t}\n\n\tvar responses []*model.MatchResponse\n\tfor _, match := range matches {\n\t\t// Determine the other user\n\t\totherUserID := match.User2ID\n\t\totherProfileID := match.Profile2ID\n\t\tif match.User1ID != userID {\n\t\t\totherUserID = match.User1ID\n\t\t\totherProfileID = match.Profile1ID\n\t\t}\n\n\t\t// Fetch profile info\n\t\tprofile, err := s.getProfileInfo(ctx, otherProfileID)\n\t\tif err != nil {\n\t\t\tlogger.Warn(\"failed to get profile info\", zap.String(\"profile_id\", otherProfileID), zap.Error(err))\n\t\t\tprofile = \u0026model.UserInfo{\n\t\t\t\tUserID:    otherUserID,\n\t\t\t\tProfileID: otherProfileID,\n\t\t\t\tName:      \"Unknown\",\n\t\t\t}\n\t\t}\n\n\t\tresponses = append(responses, \u0026model.MatchResponse{\n\t\t\tID:          match.ID,\n\t\t\tMatchedUser: profile,\n\t\t\tMatchedAt:   match.CreatedAt,\n\t\t})\n\t}\n\n\treturn responses, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","name":"GetMatchesWithProfiles","node_type":"function"},{"code":"func (r *MatchRepository) GetMatchesByUserID(userID string) ([]*model.Match, error) {\n\tquery := `\n\t\tSELECT id, user1_id, user2_id, profile1_id, profile2_id, created_at, updated_at\n\t\tFROM matches\n\t\tWHERE user1_id = $1 OR user2_id = $1\n\t\tORDER BY created_at DESC\n\t`\n\n\trows, err := r.db.Query(query, userID)\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to get matches: %w\", err)\n\t}\n\tdefer rows.Close()\n\n\tvar matches []*model.Match\n\tfor rows.Next() {\n\t\tmatch := \u0026model.Match{}\n\t\terr := rows.Scan(\n\t\t\t\u0026match.ID,\n\t\t\t\u0026match.User1ID,\n\t\t\t\u0026match.User2ID,\n\t\t\t\u0026match.Profile1ID,\n\t\t\t\u0026match.Profile2ID,\n\t\t\t\u0026match.CreatedAt,\n\t\t\t\u0026match.UpdatedAt,\n\t\t)\n\t\tif err != nil {\n\t\t\treturn nil, fmt.Errorf(\"failed to scan match: %w\", err)\n\t\t}\n\t\tmatches = append(matches, match)\n\t}\n\n\treturn matches, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:94:27","name":"GetMatchesByUserID","node_type":"function"},{"code":"func (s *MatchingService) getProfileInfo(ctx context.Context, profileID string) (*model.UserInfo, error) {\n\tresp, err := s.profileClient.Get(ctx, fmt.Sprintf(\"/api/v1/profiles/%s\", profileID), nil)\n\tif err != nil {\n\t\treturn nil, err\n\t}\n\n\tvar result struct {\n\t\tSuccess bool `json:\"success\"`\n\t\tData    struct {\n\t\t\tID     string `json:\"id\"`\n\t\t\tUserID string `json:\"user_id\"`\n\t\t\tName   string `json:\"name\"`\n\t\t\tBreed  string `json:\"breed\"`\n\t\t\tAge    int    `json:\"age\"`\n\t\t} `json:\"data\"`\n\t}\n\tif err := json.Unmarshal(resp.Body, \u0026result); err != nil {\n\t\treturn nil, err\n\t}\n\n\tif !result.Success {\n\t\treturn nil, fmt.Errorf(\"failed to get profile\")\n\t}\n\n\treturn \u0026model.UserInfo{\n\t\tUserID:    result.Data.UserID,\n\t\tProfileID: result.Data.ID,\n\t\tName:      result.Data.Name,\n\t\tBreed:     result.Data.Breed,\n\t\tAge:       result.Data.Age,\n\t}, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","name":"getProfileInfo","node_type":"function"},{"code":"func (h *Handler) handleMatchByID(w http.ResponseWriter, r *http.Request) {\n\t// Extract match ID from path\n\tpath := strings.TrimPrefix(r.URL.Path, \"/api/v1/matches/\")\n\tif path == \"\" || strings.Contains(path, \"/\") {\n\t\tresponse.Error(w, errors.NotFound(\"Match not found\"))\n\t\treturn\n\t}\n\tmatchID := path\n\n\t// Get user ID from header\n\tuserID := r.Header.Get(\"X-User-ID\")\n\tif userID == \"\" {\n\t\tresponse.Error(w, errors.Unauthorized(\"User not authenticated\"))\n\t\treturn\n\t}\n\n\tswitch r.Method {\n\tcase http.MethodDelete:\n\t\th.unmatch(w, r, userID, matchID)\n\tdefault:\n\t\tresponse.Error(w, errors.BadRequest(\"Method not allowed\"))\n\t}\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","name":"handleMatchByID","node_type":"function"},{"code":"func (h *Handler) unmatch(w http.ResponseWriter, r *http.Request, userID, matchID string) {\n\terr := h.matchingService.Unmatch(r.Context(), userID, matchID)\n\tif err != nil {\n\t\tif strings.Contains(err.Error(), \"not found\") {\n\t\t\tresponse.Error(w, errors.NotFound(\"Match not found\"))\n\t\t\treturn\n\t\t}\n\t\tif strings.Contains(err.Error(), \"not authorized\") {\n\t\t\tresponse.Error(w, errors.Forbidden(\"Not authorized to unmatch\"))\n\t\t\treturn\n\t\t}\n\t\tresponse.Error(w, errors.InternalServerError(\"Failed to unmatch\"))\n\t\treturn\n\t}\n\n\tresponse.OK(w, map[string]string{\"message\": \"Successfully unmatched\"})\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","name":"unmatch","node_type":"function"},{"code":"func (s *MatchingService) Unmatch(ctx context.Context, userID, matchID string) error {\n\t// Verify the match exists and involves this user\n\tmatch, err := s.matchRepo.GetMatchByID(matchID)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to get match: %w\", err)\n\t}\n\tif match == nil {\n\t\treturn fmt.Errorf(\"match not found\")\n\t}\n\n\tif match.User1ID != userID \u0026\u0026 match.User2ID != userID {\n\t\treturn fmt.Errorf(\"not authorized to unmatch\")\n\t}\n\n\t// Delete the match\n\terr = s.matchRepo.DeleteMatch(matchID)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to delete match: %w\", err)\n\t}\n\n\t// Publish unmatch event\n\ts.publishUnmatchEvent(ctx, match)\n\n\treturn nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","name":"Unmatch","node_type":"function"},{"code":"func (r *MatchRepository) GetMatchByID(id string) (*model.Match, error) {\n\tquery := `\n\t\tSELECT id, user1_id, user2_id, profile1_id, profile2_id, created_at, updated_at\n\t\tFROM matches\n\t\tWHERE id = $1\n\t`\n\n\tmatch := \u0026model.Match{}\n\terr := r.db.QueryRow(query, id).Scan(\n\t\t\u0026match.ID,\n\t\t\u0026match.User1ID,\n\t\t\u0026match.User2ID,\n\t\t\u0026match.Profile1ID,\n\t\t\u0026match.Profile2ID,\n\t\t\u0026match.CreatedAt,\n\t\t\u0026match.UpdatedAt,\n\t)\n\tif err == sql.ErrNoRows {\n\t\treturn nil, nil\n\t}\n\tif err != nil {\n\t\treturn nil, fmt.Errorf(\"failed to get match: %w\", err)\n\t}\n\n\treturn match, nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:66:27","name":"GetMatchByID","node_type":"function"},{"code":"func (r *MatchRepository) DeleteMatch(matchID string) error {\n\tquery := `DELETE FROM matches WHERE id = $1`\n\n\tresult, err := r.db.Exec(query, matchID)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"failed to delete match: %w\", err)\n\t}\n\n\trows, _ := result.RowsAffected()\n\tif rows == 0 {\n\t\treturn fmt.Errorf(\"match not found\")\n\t}\n\n\treturn nil\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:149:27","name":"DeleteMatch","node_type":"function"},{"code":"func (s *MatchingService) publishUnmatchEvent(ctx context.Context, match *model.Match) {\n\tevent := model.MatchEvent{\n\t\tEventType:  kafka.EventMatchDeleted,\n\t\tMatchID:    match.ID,\n\t\tUser1ID:    match.User1ID,\n\t\tUser2ID:    match.User2ID,\n\t\tProfile1ID: match.Profile1ID,\n\t\tProfile2ID: match.Profile2ID,\n\t\tTimestamp:  time.Now().Format(time.RFC3339),\n\t}\n\n\tif err := s.producer.Publish(ctx, kafka.TopicMatchDeleted, kafka.EventMatchDeleted, event); err != nil {\n\t\tlogger.Error(\"failed to publish unmatch event\", zap.Error(err))\n\t}\n}","external":"false","id":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:358:27","name":"publishUnmatchEvent","node_type":"function"}],"links":[{"column":11,"line":67,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/cmd/main.go:146:6","val":1},{"column":25,"line":92,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:17:6","val":1},{"column":25,"line":93,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:18:6","val":1},{"column":28,"line":96,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:27:6","val":1},{"column":14,"line":99,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:21:6","val":1},{"column":3,"line":103,"source":"/home/evan/Code/rinder/services/matching/cmd/main.go:25:1","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","val":1},{"column":29,"line":28,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","val":1},{"column":15,"line":37,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:37:19","val":1},{"column":35,"line":29,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":53,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":60,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":67,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":73,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":77,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":81,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":34,"line":86,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":35,"line":48,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","val":1},{"column":35,"line":50,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","val":1},{"column":45,"line":50,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","val":1},{"column":32,"line":52,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:50:27","val":1},{"column":44,"line":48,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":49,"line":48,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":59,"line":48,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":19,"line":57,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":35,"line":26,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":45,"line":26,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":21,"line":29,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":31,"line":29,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":38,"line":36,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":22,"line":37,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":37,"line":37,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":18,"line":42,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:26:27","val":1},{"column":31,"line":57,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":36,"line":57,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":46,"line":57,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":62,"line":57,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":19,"line":73,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:182:27","val":1},{"column":31,"line":87,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","val":1},{"column":17,"line":81,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","val":1},{"column":35,"line":65,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","val":1},{"column":44,"line":65,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","val":1},{"column":32,"line":67,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:65:27","val":1},{"column":26,"line":81,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","val":1},{"column":31,"line":81,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","val":1},{"column":40,"line":81,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:80:27","val":1},{"column":47,"line":87,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":52,"line":87,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":62,"line":87,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":30,"line":94,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","val":1},{"column":29,"line":139,"source":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","val":1},{"column":38,"line":139,"source":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:130:27","val":1},{"column":42,"line":94,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":52,"line":94,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":30,"line":101,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","val":1},{"column":34,"line":223,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","val":1},{"column":79,"line":223,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:222:27","val":1},{"column":47,"line":101,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":52,"line":101,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":30,"line":108,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:23:27","val":1},{"column":42,"line":108,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":52,"line":108,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":78,"line":108,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":6,"line":117,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:341:27","val":1},{"column":30,"line":351,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:341:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:341:27","val":1},{"column":24,"line":117,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":3,"line":123,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:319:27","val":1},{"column":30,"line":334,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:319:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:319:27","val":1},{"column":21,"line":123,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:42:27","val":1},{"column":18,"line":89,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":18,"line":93,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":17,"line":96,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":18,"line":100,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:52:19","val":1},{"column":41,"line":30,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","val":1},{"column":17,"line":106,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","val":1},{"column":17,"line":113,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","val":1},{"column":36,"line":127,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":31,"line":205,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":38,"line":102,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":23,"line":105,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":15,"line":106,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":45,"line":110,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":47,"line":111,"source":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/swipe_repository.go:102:27","val":1},{"column":49,"line":205,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":54,"line":205,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":20,"line":212,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","val":1},{"column":66,"line":282,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","val":1},{"column":74,"line":282,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","val":1},{"column":34,"line":284,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:281:27","val":1},{"column":36,"line":212,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":41,"line":212,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":60,"line":212,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:204:27","val":1},{"column":17,"line":129,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","val":1},{"column":13,"line":137,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:105:19","val":1},{"column":37,"line":31,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","val":1},{"column":17,"line":143,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","val":1},{"column":17,"line":150,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","val":1},{"column":35,"line":155,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","val":1},{"column":29,"line":139,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:94:27","val":1},{"column":32,"line":101,"source":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:94:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:94:27","val":1},{"column":48,"line":139,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","val":1},{"column":20,"line":155,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","val":1},{"column":34,"line":247,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","val":1},{"column":74,"line":247,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:247:27","val":1},{"column":35,"line":155,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:139:27","val":1},{"column":17,"line":157,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","val":1},{"column":13,"line":165,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:142:19","val":1},{"column":38,"line":32,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:28:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1},{"column":17,"line":173,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1},{"column":17,"line":181,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1},{"column":4,"line":187,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":26,"line":195,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","val":1},{"column":27,"line":178,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:66:27","val":1},{"column":29,"line":73,"source":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:66:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:66:27","val":1},{"column":40,"line":178,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","val":1},{"column":19,"line":191,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:149:27","val":1},{"column":33,"line":151,"source":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:149:27","target":"/home/evan/Code/rinder/services/matching/internal/repository/match_repository.go:149:27","val":1},{"column":31,"line":191,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","val":1},{"column":3,"line":197,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:358:27","val":1},{"column":30,"line":368,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:358:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:358:27","val":1},{"column":23,"line":197,"source":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","target":"/home/evan/Code/rinder/services/matching/internal/service/matching_service.go:177:27","val":1},{"column":47,"line":195,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":55,"line":195,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":18,"line":198,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":18,"line":202,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":17,"line":205,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":13,"line":209,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:195:19","val":1},{"column":12,"line":187,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1},{"column":15,"line":187,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1},{"column":17,"line":189,"source":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","target":"/home/evan/Code/rinder/services/matching/internal/handler/handler.go:170:19","val":1}]}